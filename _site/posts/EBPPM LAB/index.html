<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangwon Ju, SNU GSPA">
<meta name="dcterms.date" content="2022-08-06">

<title>Sangwon Ju - Textmining on UN SDG Voluntary National Review: 6 Countries</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Sangwon Ju</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../data_analytics.html">
 <span class="menu-text">Data Analytics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.qmd">
 <span class="menu-text">CV (as of January 2023)</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#analysis-of-voluntary-national-review" id="toc-analysis-of-voluntary-national-review" class="nav-link active" data-scroll-target="#analysis-of-voluntary-national-review">1. Analysis of Voluntary National Review</a>
  <ul class="collapse">
  <li><a href="#goal" id="toc-goal" class="nav-link" data-scroll-target="#goal">Goal</a></li>
  <li><a href="#voluntary-national-review-vnr" id="toc-voluntary-national-review-vnr" class="nav-link" data-scroll-target="#voluntary-national-review-vnr">Voluntary National Review (VNR)</a></li>
  <li><a href="#countries-of-analysis" id="toc-countries-of-analysis" class="nav-link" data-scroll-target="#countries-of-analysis">Countries of analysis</a></li>
  </ul></li>
  <li><a href="#analysis-topic-modelling" id="toc-analysis-topic-modelling" class="nav-link" data-scroll-target="#analysis-topic-modelling">2. Analysis: Topic Modelling</a>
  <ul class="collapse">
  <li><a href="#loading-package-setting-working-directory" id="toc-loading-package-setting-working-directory" class="nav-link" data-scroll-target="#loading-package-setting-working-directory">Loading Package &amp; Setting Working Directory</a></li>
  <li><a href="#tokening-custom-functions" id="toc-tokening-custom-functions" class="nav-link" data-scroll-target="#tokening-custom-functions">Tokening custom functions</a></li>
  </ul></li>
  <li><a href="#korea-vnr" id="toc-korea-vnr" class="nav-link" data-scroll-target="#korea-vnr">3. Korea VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess" id="toc-preprocess" class="nav-link" data-scroll-target="#preprocess">Preprocess</a></li>
  <li><a href="#tokenizing-words" id="toc-tokenizing-words" class="nav-link" data-scroll-target="#tokenizing-words">Tokenizing words</a></li>
  <li><a href="#n-grams" id="toc-n-grams" class="nav-link" data-scroll-target="#n-grams">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis" id="toc-remove-inadequate-words-for-analysis" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table" id="toc-frequency-table" class="nav-link" data-scroll-target="#frequency-table">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph" id="toc-tf-idf-per-paragraph" class="nav-link" data-scroll-target="#tf-idf-per-paragraph">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling" id="toc-topic-modeling" class="nav-link" data-scroll-target="#topic-modeling">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set" id="toc-using-perplexity-for-hold-out-set" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6" id="toc-cast-lda-k6" class="nav-link" data-scroll-target="#cast-lda-k6">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph" id="toc-network-graph" class="nav-link" data-scroll-target="#network-graph">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count" id="toc-pairwise-count" class="nav-link" data-scroll-target="#pairwise-count">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes" id="toc-building-links-and-nodes" class="nav-link" data-scroll-target="#building-links-and-nodes">Building links and nodes</a></li>
  <li><a href="#building-networks" id="toc-building-networks" class="nav-link" data-scroll-target="#building-networks">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic" id="toc-network-graph-of-inter-topic" class="nav-link" data-scroll-target="#network-graph-of-inter-topic">Network graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic" id="toc-network-graph-within-topic" class="nav-link" data-scroll-target="#network-graph-within-topic">Network graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#germany-vnr" id="toc-germany-vnr" class="nav-link" data-scroll-target="#germany-vnr">4. Germany VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-1" id="toc-preprocess-1" class="nav-link" data-scroll-target="#preprocess-1">Preprocess</a></li>
  <li><a href="#tokenizing-words-1" id="toc-tokenizing-words-1" class="nav-link" data-scroll-target="#tokenizing-words-1">Tokenizing words</a></li>
  <li><a href="#n-grams-1" id="toc-n-grams-1" class="nav-link" data-scroll-target="#n-grams-1">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-1" id="toc-remove-inadequate-words-for-analysis-1" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-1">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-1" id="toc-frequency-table-1" class="nav-link" data-scroll-target="#frequency-table-1">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-1" id="toc-tf-idf-per-paragraph-1" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-1">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-1" id="toc-topic-modeling-1" class="nav-link" data-scroll-target="#topic-modeling-1">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-1" id="toc-using-perplexity-for-hold-out-set-1" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-1">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-1" id="toc-cast-lda-k6-1" class="nav-link" data-scroll-target="#cast-lda-k6-1">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-1" id="toc-network-graph-1" class="nav-link" data-scroll-target="#network-graph-1">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-1" id="toc-pairwise-count-1" class="nav-link" data-scroll-target="#pairwise-count-1">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-1" id="toc-building-links-and-nodes-1" class="nav-link" data-scroll-target="#building-links-and-nodes-1">Building links and nodes</a></li>
  <li><a href="#building-networks-1" id="toc-building-networks-1" class="nav-link" data-scroll-target="#building-networks-1">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic-1" id="toc-network-graph-of-inter-topic-1" class="nav-link" data-scroll-target="#network-graph-of-inter-topic-1">Network graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic-1" id="toc-network-graph-within-topic-1" class="nav-link" data-scroll-target="#network-graph-within-topic-1">Network graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#finland-vnr" id="toc-finland-vnr" class="nav-link" data-scroll-target="#finland-vnr">5. Finland VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-2" id="toc-preprocess-2" class="nav-link" data-scroll-target="#preprocess-2">Preprocess</a></li>
  <li><a href="#tokenizing-words-2" id="toc-tokenizing-words-2" class="nav-link" data-scroll-target="#tokenizing-words-2">Tokenizing words</a></li>
  <li><a href="#n-grams-2" id="toc-n-grams-2" class="nav-link" data-scroll-target="#n-grams-2">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-2" id="toc-remove-inadequate-words-for-analysis-2" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-2">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-2" id="toc-frequency-table-2" class="nav-link" data-scroll-target="#frequency-table-2">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-2" id="toc-tf-idf-per-paragraph-2" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-2">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-2" id="toc-topic-modeling-2" class="nav-link" data-scroll-target="#topic-modeling-2">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-2" id="toc-using-perplexity-for-hold-out-set-2" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-2">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-2" id="toc-cast-lda-k6-2" class="nav-link" data-scroll-target="#cast-lda-k6-2">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-2" id="toc-network-graph-2" class="nav-link" data-scroll-target="#network-graph-2">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-2" id="toc-pairwise-count-2" class="nav-link" data-scroll-target="#pairwise-count-2">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-2" id="toc-building-links-and-nodes-2" class="nav-link" data-scroll-target="#building-links-and-nodes-2">Building links and nodes</a></li>
  <li><a href="#building-networks-2" id="toc-building-networks-2" class="nav-link" data-scroll-target="#building-networks-2">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic-2" id="toc-network-graph-of-inter-topic-2" class="nav-link" data-scroll-target="#network-graph-of-inter-topic-2">Network Graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic-2" id="toc-network-graph-within-topic-2" class="nav-link" data-scroll-target="#network-graph-within-topic-2">Network Graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#japan-vnr" id="toc-japan-vnr" class="nav-link" data-scroll-target="#japan-vnr">6. Japan VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-3" id="toc-preprocess-3" class="nav-link" data-scroll-target="#preprocess-3">Preprocess</a></li>
  <li><a href="#tokenizing-words-3" id="toc-tokenizing-words-3" class="nav-link" data-scroll-target="#tokenizing-words-3">Tokenizing words</a></li>
  <li><a href="#n-grams-3" id="toc-n-grams-3" class="nav-link" data-scroll-target="#n-grams-3">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-3" id="toc-remove-inadequate-words-for-analysis-3" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-3">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-3" id="toc-frequency-table-3" class="nav-link" data-scroll-target="#frequency-table-3">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-3" id="toc-tf-idf-per-paragraph-3" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-3">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-3" id="toc-topic-modeling-3" class="nav-link" data-scroll-target="#topic-modeling-3">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-3" id="toc-using-perplexity-for-hold-out-set-3" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-3">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k10" id="toc-cast-lda-k10" class="nav-link" data-scroll-target="#cast-lda-k10">Cast LDA (k=10)</a></li>
  </ul></li>
  <li><a href="#network-graph-3" id="toc-network-graph-3" class="nav-link" data-scroll-target="#network-graph-3">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-3" id="toc-pairwise-count-3" class="nav-link" data-scroll-target="#pairwise-count-3">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-3" id="toc-building-links-and-nodes-3" class="nav-link" data-scroll-target="#building-links-and-nodes-3">Building links and nodes</a></li>
  <li><a href="#building-networks-3" id="toc-building-networks-3" class="nav-link" data-scroll-target="#building-networks-3">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic-3" id="toc-network-graph-of-inter-topic-3" class="nav-link" data-scroll-target="#network-graph-of-inter-topic-3">Network Graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic-3" id="toc-network-graph-within-topic-3" class="nav-link" data-scroll-target="#network-graph-within-topic-3">Network Graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#uk-vnr" id="toc-uk-vnr" class="nav-link" data-scroll-target="#uk-vnr">7. UK VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-4" id="toc-preprocess-4" class="nav-link" data-scroll-target="#preprocess-4">Preprocess</a></li>
  <li><a href="#tokenizing-words-4" id="toc-tokenizing-words-4" class="nav-link" data-scroll-target="#tokenizing-words-4">Tokenizing words</a></li>
  <li><a href="#n-grams-4" id="toc-n-grams-4" class="nav-link" data-scroll-target="#n-grams-4">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-4" id="toc-remove-inadequate-words-for-analysis-4" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-4">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-4" id="toc-frequency-table-4" class="nav-link" data-scroll-target="#frequency-table-4">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-4" id="toc-tf-idf-per-paragraph-4" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-4">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-4" id="toc-topic-modeling-4" class="nav-link" data-scroll-target="#topic-modeling-4">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-4" id="toc-using-perplexity-for-hold-out-set-4" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-4">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-3" id="toc-cast-lda-k6-3" class="nav-link" data-scroll-target="#cast-lda-k6-3">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-4" id="toc-network-graph-4" class="nav-link" data-scroll-target="#network-graph-4">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-4" id="toc-pairwise-count-4" class="nav-link" data-scroll-target="#pairwise-count-4">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-4" id="toc-building-links-and-nodes-4" class="nav-link" data-scroll-target="#building-links-and-nodes-4">Building links and nodes</a></li>
  <li><a href="#building-networks-4" id="toc-building-networks-4" class="nav-link" data-scroll-target="#building-networks-4">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic-4" id="toc-network-graph-of-inter-topic-4" class="nav-link" data-scroll-target="#network-graph-of-inter-topic-4">Network Graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic-4" id="toc-network-graph-within-topic-4" class="nav-link" data-scroll-target="#network-graph-within-topic-4">Network Graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#austrailia-vnr" id="toc-austrailia-vnr" class="nav-link" data-scroll-target="#austrailia-vnr">8. Austrailia VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-5" id="toc-preprocess-5" class="nav-link" data-scroll-target="#preprocess-5">Preprocess</a></li>
  <li><a href="#tokenizing-words-5" id="toc-tokenizing-words-5" class="nav-link" data-scroll-target="#tokenizing-words-5">Tokenizing words</a></li>
  <li><a href="#n-grams-5" id="toc-n-grams-5" class="nav-link" data-scroll-target="#n-grams-5">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-5" id="toc-remove-inadequate-words-for-analysis-5" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-5">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-5" id="toc-frequency-table-5" class="nav-link" data-scroll-target="#frequency-table-5">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-5" id="toc-tf-idf-per-paragraph-5" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-5">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-5" id="toc-topic-modeling-5" class="nav-link" data-scroll-target="#topic-modeling-5">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-5" id="toc-using-perplexity-for-hold-out-set-5" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-5">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-4" id="toc-cast-lda-k6-4" class="nav-link" data-scroll-target="#cast-lda-k6-4">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-5" id="toc-network-graph-5" class="nav-link" data-scroll-target="#network-graph-5">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-5" id="toc-pairwise-count-5" class="nav-link" data-scroll-target="#pairwise-count-5">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-5" id="toc-building-links-and-nodes-5" class="nav-link" data-scroll-target="#building-links-and-nodes-5">Building links and nodes</a></li>
  <li><a href="#building-networks-5" id="toc-building-networks-5" class="nav-link" data-scroll-target="#building-networks-5">Building networks</a></li>
  <li><a href="#network-graph-of-inter-topic-5" id="toc-network-graph-of-inter-topic-5" class="nav-link" data-scroll-target="#network-graph-of-inter-topic-5">Network Graph of inter-topic</a></li>
  <li><a href="#network-graph-within-topic-5" id="toc-network-graph-within-topic-5" class="nav-link" data-scroll-target="#network-graph-within-topic-5">Network Graph within topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparing-six-countries" id="toc-comparing-six-countries" class="nav-link" data-scroll-target="#comparing-six-countries">9. Comparing Six countries</a>
  <ul class="collapse">
  <li><a href="#comparing-word-frequencies-of-six-countries" id="toc-comparing-word-frequencies-of-six-countries" class="nav-link" data-scroll-target="#comparing-word-frequencies-of-six-countries">Comparing Word Frequencies of Six Countries</a></li>
  <li><a href="#comparing-bigrams-of-six-countries" id="toc-comparing-bigrams-of-six-countries" class="nav-link" data-scroll-target="#comparing-bigrams-of-six-countries">Comparing bigrams of Six Countries</a></li>
  <li><a href="#comparing-tf-idf-of-six-countries" id="toc-comparing-tf-idf-of-six-countries" class="nav-link" data-scroll-target="#comparing-tf-idf-of-six-countries">Comparing Tf-idf of Six Countries</a></li>
  <li><a href="#comparing-the-word-frequencies" id="toc-comparing-the-word-frequencies" class="nav-link" data-scroll-target="#comparing-the-word-frequencies">Comparing the word frequencies</a></li>
  <li><a href="#correlation-of-words" id="toc-correlation-of-words" class="nav-link" data-scroll-target="#correlation-of-words">Correlation of words</a></li>
  <li><a href="#document-similarity" id="toc-document-similarity" class="nav-link" data-scroll-target="#document-similarity">Document Similarity</a>
  <ul class="collapse">
  <li><a href="#convert-data-from-r-objects" id="toc-convert-data-from-r-objects" class="nav-link" data-scroll-target="#convert-data-from-r-objects">Convert data from R objects</a></li>
  <li><a href="#tokenizer" id="toc-tokenizer" class="nav-link" data-scroll-target="#tokenizer">Tokenizer</a></li>
  <li><a href="#cosine-similarity" id="toc-cosine-similarity" class="nav-link" data-scroll-target="#cosine-similarity">Cosine Similarity</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">10. Conclusion</a>
  <ul class="collapse">
  <li><a href="#summary-of-vnr-analysis-results-in-korea" id="toc-summary-of-vnr-analysis-results-in-korea" class="nav-link" data-scroll-target="#summary-of-vnr-analysis-results-in-korea">Summary of VNR Analysis Results in Korea</a></li>
  <li><a href="#vnr-comparison-analysis-summary-with-korea-and-other-countries" id="toc-vnr-comparison-analysis-summary-with-korea-and-other-countries" class="nav-link" data-scroll-target="#vnr-comparison-analysis-summary-with-korea-and-other-countries">VNR Comparison Analysis Summary with Korea and Other Countries</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Textmining on UN SDG Voluntary National Review: 6 Countries</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Evidence-Based Research Lab-PPM Projects</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangwon Ju, SNU GSPA </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 6, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In conclusion, while maintaining the mediating and organizing role of the centralized government, it is necessary to diverge from the current SDGs structure in which all detailed topics are converges to the one centalized entity. Instead, promoting policy development in the direction of strengthening cooperation outward with other countries and strengthening connectivity inward with local communities is the most effective and efficient way to achieve sustainable development goals.</p>
<section id="analysis-of-voluntary-national-review" class="level1">
<h1>1. Analysis of Voluntary National Review</h1>
<section id="goal" class="level2">
<h2 class="anchored" data-anchor-id="goal">Goal</h2>
<ul>
<li>According to the annual ranking of SDGs released by the UN, Republic of Korea ranked 28th as of 2021, lower than other developed countries.</li>
<li>Accordingly, this section presents the strategic direction of environmental policy to achieve and promote SDGs.</li>
<li>To achieve this goal, this section analyzes VNRs of five developed countries to verify the characteristics of 17 SDGs directed policies and to present the direction in which SDGs-related environmental policies should be developed in the future through comparative analysis with the Republic of Korea VNR.</li>
</ul>
</section>
<section id="voluntary-national-review-vnr" class="level2">
<h2 class="anchored" data-anchor-id="voluntary-national-review-vnr">Voluntary National Review (VNR)</h2>
<ul>
<li><p>The United Nations (UN) member states are required to report their SDGs objectives and implementation plans to the United Nations High-Level Political Forum (HLPF) and the material submitted at the forum is a ‘Voluntary National Review’.</p></li>
<li><p>The purpose of VNRs is to present a snapshot of where the country stands in the implementation of the Sustainable Development Goals, with a view to help accelerate progress through experience sharing, peer-learning, identifying gaps and good practices, and mobilizing partnerships. (UN, 2021)</p></li>
<li><p>Each member (54 countries) started submitting VNRs to the UN’s ‘Sustainable Development Knowledge Platform’ since 2016 and was recommended to submit them at least once every four years</p></li>
<li><p>The report contains voluntary assessment of the objectives and performance of each member countries SDGs and follows no uniform form</p></li>
</ul>
</section>
<section id="countries-of-analysis" class="level2">
<h2 class="anchored" data-anchor-id="countries-of-analysis">Countries of analysis</h2>
<p>Republic of Korea, Germany, Finland, United Kingdom, Japan, Australia</p>
<ul>
<li>In this chapter, Korea, Germany, Finland, the United Kingdom, Japan, and Australia were selected as target countries</li>
<li>Selected based on the <a href="https://dashboards.sdgindex.org/rankings">rankings of Sustainable Development Goals index announced by the UN</a>, and the rest of the countries tried to select evenly by continent, starting with Finland, which ranked first</li>
<li>Identifying global trends on SDGs can be achieved through this analysis</li>
</ul>
</section>
</section>
<section id="analysis-topic-modelling" class="level1 page-columns page-full">
<h1>2. Analysis: Topic Modelling</h1>
<ul>
<li>The analysis was conducted in three steps.
<ul>
<li><p>First, the text was preprocessed. The original data of the report were organized based on the original form of the word by normalizing it through lemmatization, excluding unnecessary parts for the analysis</p></li>
<li><p>Next, LDA was applied to the input of the DTM (Document and Word) to determine the probability matrix representing the association of key keywords for each topic, and the number of topic clusters (k) which best summarize the contents of the report was determined</p></li>
<li><p>Finally, the keyword was selected. By closely examining the analysis result - combination of beta (β), which is the probability that the topic will be included in the topic, and gamma (γ), which is the probability that the topic will be included in each country’s report -, topic and major keywords were determined.</p></li>
</ul></li>
</ul>
<div class="column-body">
<p><img src="https://www.tidytextmining.com/images/tmwr_0601.png" class="img-fluid"> Figure: A flowchart of a text analysis that incorporates topic modeling (Silge &amp; Robinson, 2017)</p>
</div>
<section id="loading-package-setting-working-directory" class="level2">
<h2 class="anchored" data-anchor-id="loading-package-setting-working-directory">Loading Package &amp; Setting Working Directory</h2>
<div class="cell" data-result="hide">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"reticulate"</span>,<span class="st">"tidyverse"</span>,<span class="st">"tidymodels"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tidytext"</span>,<span class="st">"lda"</span>,<span class="st">"readr"</span>,<span class="st">"igraph"</span>,<span class="st">"forcats"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"sna"</span>,<span class="st">"ergm"</span>,<span class="st">"network"</span>,<span class="st">"stringr"</span>,<span class="st">"magrittr"</span>,<span class="st">"showtext"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tokenizers"</span>,<span class="st">"janeaustenr"</span>,<span class="st">"forcats"</span>,<span class="st">"RColorBrewer"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"viridis"</span>,<span class="st">"stopwords"</span>,<span class="st">"purrr"</span>,<span class="st">"widyr"</span>,<span class="st">"textmineR"</span>,<span class="st">"stm"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ggraph"</span>,<span class="st">"tidygraph"</span>,<span class="st">"ggfortify"</span>,<span class="st">"ggthemes"</span>,<span class="st">"cowplot"</span>,<span class="st">"fs"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"knitr"</span>,<span class="st">"kableExtra"</span>,<span class="st">"ggrepel"</span>,<span class="st">"grid"</span>,<span class="st">"gridExtra"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"topicmodels"</span>,<span class="st">"scales"</span>,<span class="st">"ggpattern"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"magick"</span>,<span class="st">"corrplot"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Font Setting</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name=</span><span class="st">"Nanum Gothic"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ger_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/germany.txt"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>fin_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/finland.txt"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>kor_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/korea.txt"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>jp_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/japan.txt"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>uk_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/uk.txt"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>astl_path <span class="ot">=</span> <span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/austrailia.txt"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokening-custom-functions" class="level2">
<h2 class="anchored" data-anchor-id="tokening-custom-functions">Tokening custom functions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sentence_word1<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span><span class="fu">tokenize_sentences</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">tibble</span>(<span class="at">words=</span>.),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentence=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(words))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>sentence_word2<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span>textstem<span class="sc">::</span><span class="fu">lemmatize_strings</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">tokenize_words</span>(<span class="at">stopwords =</span>  <span class="fu">as.vector</span>(stop_words<span class="sc">$</span>word),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">strip_numeric =</span> T) <span class="sc">%&gt;%</span>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">unlist</span>())</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sentence_word3<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span>textstem<span class="sc">::</span><span class="fu">lemmatize_strings</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">tokenize_ngrams</span>(.,<span class="at">n =</span> <span class="dv">2</span>, <span class="at">n_min =</span> <span class="dv">2</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">stopwords =</span> <span class="fu">as.vector</span>(stop_words<span class="sc">$</span>word)) <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">unlist</span>())</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="korea-vnr" class="level1 page-columns page-full">
<h1>3. Korea VNR</h1>
<section id="preprocess" class="level2">
<h2 class="anchored" data-anchor-id="preprocess">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>korea <span class="ot">&lt;-</span>  <span class="fu">readLines</span>(kor_path) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words">Tokenizing words</h2>
<p>Break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="ot">&lt;-</span> korea <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams" class="level2">
<h2 class="anchored" data-anchor-id="n-grams">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>korea_ngram  <span class="ot">&lt;-</span>  korea <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="ot">&lt;-</span> korea_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"</span><span class="sc">\\</span><span class="st">d+[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[a-z]*</span><span class="sc">\\</span><span class="st">d+"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"kor[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rok[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>korea_ngram <span class="ot">&lt;-</span> korea_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"</span><span class="sc">\\</span><span class="st">d+[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[a-z]*</span><span class="sc">\\</span><span class="st">d+"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"kor[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rok[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(korea_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#CD313A'</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#0047A0'</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Republic of Korea"</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(korea_ngram <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#CD313A'</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#0047A0'</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Republic of Korea"</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> a1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>korea_tfidf <span class="ot">&lt;-</span> korea_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>korea_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> conflict </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1379310 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.4480599 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> governmental </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1538462 </td>
   <td style="text-align:right;"> 2.842970 </td>
   <td style="text-align:right;"> 0.4373799 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> institutional </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 2.437504 </td>
   <td style="text-align:right;"> 0.4062507 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> saemaul </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1219512 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.3961506 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> undong </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1219512 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.3961506 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> disability </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0.1304348 </td>
   <td style="text-align:right;"> 3.025291 </td>
   <td style="text-align:right;"> 0.3946032 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> humanitarian </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1555556 </td>
   <td style="text-align:right;"> 2.437504 </td>
   <td style="text-align:right;"> 0.3791674 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 89 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.0961538 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.3789983 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mechanism </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 2.236834 </td>
   <td style="text-align:right;"> 0.3728056 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.0823529 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.3246009 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> indicator </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 0.1500000 </td>
   <td style="text-align:right;"> 2.069780 </td>
   <td style="text-align:right;"> 0.3104669 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> person </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1014493 </td>
   <td style="text-align:right;"> 3.025291 </td>
   <td style="text-align:right;"> 0.3069136 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> south </td>
   <td style="text-align:right;"> 91 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0645161 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2990148 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> indicator </td>
   <td style="text-align:right;"> 94 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 2.069780 </td>
   <td style="text-align:right;"> 0.2956828 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> oda </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 1.690290 </td>
   <td style="text-align:right;"> 0.2817150 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> principle </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1304348 </td>
   <td style="text-align:right;"> 2.149822 </td>
   <td style="text-align:right;"> 0.2804116 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> correspond </td>
   <td style="text-align:right;"> 33 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0689655 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.2718332 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> discrimination </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.0579710 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2686799 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> administration </td>
   <td style="text-align:right;"> 89 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0576923 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2673882 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> age </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0937500 </td>
   <td style="text-align:right;"> 2.842970 </td>
   <td style="text-align:right;"> 0.2665284 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>korea_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_dtm.old</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>korea_dtm <span class="ot">&lt;-</span> korea_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>korea_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(korea_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>korea_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(korea_split)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>korea_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_train_dtm.old</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>korea_train_dtm <span class="ot">&lt;-</span> korea_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>korea_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(korea_split)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>korea_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_valid_dtm.old</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_valid_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>korea_valid_dtm <span class="ot">&lt;-</span> korea_valid_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(korea_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> korea_valid_dtm)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>korea_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>korea_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>korea_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">government, implementation, policy, international, establish, national, framework, ministry, stakeholder, oda, cooperation, humanitarian, assistance, project, strategy, saemual,  undong, partnership, global,</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">disability, sector, service, increase, public, act, person, welfare, strengthen, promote, ensure,</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">economic, social, plan, goal, target, integrate, environmental, society, relate,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">sustainable, development, create, environment, organization, civil, report,</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">girl, country, initiative, life, education, develop, health, quality, school, capacity"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>korea_topic_update <span class="ot">&lt;-</span> korea_topic <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>korea_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Government Policy"</span>, <span class="st">"International Cooperation"</span>, <span class="st">"Welfare"</span>, <span class="st">"Integrated Goal"</span>, <span class="st">"Sustainable Development"</span>, <span class="st">"Local Community"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>korea_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(korea_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>korea_tp_6 <span class="ot">&lt;-</span> korea_lda <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(korea_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>korea_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(korea_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Clustered into 6 topics: ‘government policy’, ‘international cooperation’, ‘welfare’, ‘integrated goal setting’, ‘sustainable development’, and ‘human rights’</li>
<li>Looking at the first topic, ‘government policy’ and its main keywords, it can be seen that the government is taking the lead in setting and implementing goals of sustainable development</li>
<li>The implementation of Sustainable Development in Korea is centered on topics such as “international cooperation”, “welfare”, and “human rights”. For Sustainable Development, the international community is trying to promote cooperation with other countries as well as guaranteeing human rights at home and abroad</li>
<li>In order to achieve sustainable development, Korea is striving to set an integrated goal, which is usually intended to achieve social and environmental development as well as economic development</li>
<li>Frequency of the words is listed in the order of occurrence frequencies, words such as ‘conflict’, ‘governmental’, ‘institutional’, ‘saemaul’, and ‘undong’ are at the top, so it can be deduced that the Korea is pursuing policies led by the government</li>
</ul>
</section>
</section>
<section id="network-graph" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph">Network Graph</h2>
<section id="pairwise-count" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>korea_coocur <span class="ot">&lt;-</span> korea_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> korea_coocur <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>korea_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks" class="level3">
<h3 class="anchored" data-anchor-id="building-networks">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>korea_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>korea_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(korea_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic">Network graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>korea_g <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.</code></pre>
</div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic">Network graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>korea_g <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking at the Network graph within topic, words of ‘government policy’ and ‘integrated goal setting’ has major connections to other words, which means that various discussions on the subject have been dealt with densely</li>
<li>Sustainable and development in Sustainable Development show the strongest connectivity in the entire network, central to the overall network structure, and ‘international cooperation’. Considering that ‘welfare’ and ‘human rights’ are not seem to be a major factor in the sustainable development of the Republic of Korea</li>
<li>Looking at the Network graph by topic, ‘sustainable development’, ‘government policy’, and ‘integrated goal setting’ had a majority of connection between words within and outside the topic, wheres in the case of ‘Welfare’, ‘Human Rights’, International Cooperation’, the connection was relatively weak.</li>
<li>Sustainable development topics have high connectivity with other topics, especially government policy topics (‘government’, ‘implementation’ and ‘policy’). Sustainable development in Korea is mainly based on government-led integrated goals</li>
</ul>
</section>
</section>
</section>
<section id="germany-vnr" class="level1 page-columns page-full">
<h1>4. Germany VNR</h1>
<section id="preprocess-1" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-1">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>germany<span class="ot">&lt;-</span><span class="fu">readLines</span>(ger_path) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-1" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-1">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>germany_tokenized <span class="ot">&lt;-</span> germany <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-1" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-1">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>germany_ngram  <span class="ot">&lt;-</span>  germany <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-1">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>germany_tokenized <span class="ot">&lt;-</span> germany_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"germa[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>germany_ngram <span class="ot">&lt;-</span> germany_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"germa[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-1" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-1">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#FF0000'</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFCC00'</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Germany"</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(germany_ngram <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#FF0000'</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFCC00'</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Germany"</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> b1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-1" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-1">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>germany_tfidf <span class="ot">&lt;-</span> germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>germany_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> fracking </td>
   <td style="text-align:right;"> 141 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 3.961866 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> civil </td>
   <td style="text-align:right;"> 352 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 3.109586 </td>
   <td style="text-align:right;"> 2.073057 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> hospital </td>
   <td style="text-align:right;"> 81 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.980933 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> wood </td>
   <td style="text-align:right;"> 318 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 5.249652 </td>
   <td style="text-align:right;"> 1.749884 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> administration </td>
   <td style="text-align:right;"> 288 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.333361 </td>
   <td style="text-align:right;"> 1.733345 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> import </td>
   <td style="text-align:right;"> 363 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 4.844187 </td>
   <td style="text-align:right;"> 1.614729 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> urban </td>
   <td style="text-align:right;"> 252 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 3.052428 </td>
   <td style="text-align:right;"> 1.526214 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> norway </td>
   <td style="text-align:right;"> 327 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2857143 </td>
   <td style="text-align:right;"> 5.249652 </td>
   <td style="text-align:right;"> 1.499901 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> job </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.745575 </td>
   <td style="text-align:right;"> 1.498230 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> adaptation </td>
   <td style="text-align:right;"> 307 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.640214 </td>
   <td style="text-align:right;"> 1.456086 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> farm </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.544904 </td>
   <td style="text-align:right;"> 1.417962 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> criminal </td>
   <td style="text-align:right;"> 339 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 4.151040 </td>
   <td style="text-align:right;"> 1.383680 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> family </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.996889 </td>
   <td style="text-align:right;"> 1.332296 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> migration </td>
   <td style="text-align:right;"> 235 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2727273 </td>
   <td style="text-align:right;"> 4.844187 </td>
   <td style="text-align:right;"> 1.321142 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mint </td>
   <td style="text-align:right;"> 104 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> arctic </td>
   <td style="text-align:right;"> 305 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> profit </td>
   <td style="text-align:right;"> 365 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> disability </td>
   <td style="text-align:right;"> 233 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3000000 </td>
   <td style="text-align:right;"> 4.333361 </td>
   <td style="text-align:right;"> 1.300008 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> labour </td>
   <td style="text-align:right;"> 194 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.170211 </td>
   <td style="text-align:right;"> 1.268084 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> south </td>
   <td style="text-align:right;"> 369 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.170211 </td>
   <td style="text-align:right;"> 1.268084 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-1">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>germany_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_dtm.old</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>germany_dtm <span class="ot">&lt;-</span> germany_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-1" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-1">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>germany_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(germany_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>germany_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(germany_split)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>germany_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_train_dtm.old</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>germany_train_dtm <span class="ot">&lt;-</span> germany_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>germany_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(germany_split)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>germany_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_test_dtm.old</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>germany_test_dtm <span class="ot">&lt;-</span> germany_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(germany_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> germany_test_dtm)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>germany_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>germany_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-1">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>germany_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="st">action, indicator, policy, plan, goal, gas, basis. ministry, assign, provision, conflict, body,</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">sustainability, city, urban, supply, chain, national, human, local, adopt community,</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">woman, train, social, act, opportunity, child, labour, vocational, law,</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="st">food, quality, farm, land, agricultural, natural, population, organic,</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="st">consumption, transition, public, innovation, focus, transport, build, </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="st">country, global, fund, world, financial, condition, covid, contribution"</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>germany_topic_update <span class="ot">&lt;-</span> germany_topic <span class="sc">%&gt;%</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>germany_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Government Policy"</span>, <span class="st">"Local Community"</span>, <span class="st">"Human Rights"</span>, <span class="st">"Food Resources"</span>, <span class="st">"Social Innovation"</span>, <span class="st">"International Cooperation"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>germany_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(germany_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>germany_tp_6 <span class="ot">&lt;-</span> germany_lda <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(germany_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>germany_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(germany_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Clustered into 6 topics: ‘Government Policy’, Local Community’, ‘Human Rights’, ‘Food Resources’, ‘Social Innovation’, ‘International Cooperation’</li>
<li>In the case of Germany, in that ‘Government Policy’, Local Community’ topic are formed, it can be deduced that goals related to sustainable development are being achieved not only by government-led policies but also by local communities</li>
<li>In addition, Germany covers various topics related to sustainable development, such as ‘Human Rights’, ‘Food Resources’, ‘Social Innovation’</li>
</ul>
</section>
</section>
<section id="network-graph-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-1">Network Graph</h2>
<section id="pairwise-count-1" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-1">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>germany_coocur <span class="ot">&lt;-</span> germany_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-1" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-1">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> germany_coocur <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>germany_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-1" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-1">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>germany_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>germany_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(germany_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic-1">Network graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>germany_g <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic-1">Network graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>germany_g <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking at the Network graph within topic, in the case of ‘International Cooperation’, ‘Local Community’, and ‘Human Rights’ topics, the connection between words is stronger than that of other topics</li>
<li>In particular, keywords such as ‘global’ and ‘country’ show the strongest connection in the ‘International Cooperation’ topic, indicating that Germany is promoting sustainable development through cooperation with other countries around the world</li>
<li>Looking at the Network graph of inter-topic, topics such as ‘International cooperation’, ‘Human rights’, and ‘Local Community’ showed strong connectivity between the keywords</li>
<li>In particular, Germany’s sustainable development is being planned and implemented based on international cooperation, as keywords such as “global” and “country” of “International Cooperation” show strong connectivity</li>
</ul>
</section>
</section>
</section>
<section id="finland-vnr" class="level1 page-columns page-full">
<h1>5. Finland VNR</h1>
<section id="preprocess-2" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-2">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>finland <span class="ot">&lt;-</span>  <span class="fu">readLines</span>(fin_path) <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-2" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-2">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>finland_tokenized <span class="ot">&lt;-</span> finland <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-2" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-2">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>finland_ngram  <span class="ot">&lt;-</span>  finland <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-2">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>finland_tokenized <span class="ot">&lt;-</span>finland_tokenized  <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finl[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finn[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"million"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"line"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>finland_ngram <span class="ot">&lt;-</span> finland_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finl[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finn[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"million"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"line"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-2" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-2">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#003580'</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Finland"</span>) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(finland_ngram <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#003580'</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Finland"</span>) <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> c1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-2" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-2">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>finland_tfidf <span class="ot">&lt;-</span> finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>finland_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> species </td>
   <td style="text-align:right;"> 549 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2941176 </td>
   <td style="text-align:right;"> 4.330733 </td>
   <td style="text-align:right;"> 1.2737451 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> preparation </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 3.392464 </td>
   <td style="text-align:right;"> 1.2721739 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> city </td>
   <td style="text-align:right;"> 97 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3000000 </td>
   <td style="text-align:right;"> 3.963009 </td>
   <td style="text-align:right;"> 1.1889026 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> loss </td>
   <td style="text-align:right;"> 564 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 4.448516 </td>
   <td style="text-align:right;"> 0.9885592 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> version </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.429346 </td>
   <td style="text-align:right;"> 0.9871538 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> audit </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2352941 </td>
   <td style="text-align:right;"> 4.043051 </td>
   <td style="text-align:right;"> 0.9513062 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ministry </td>
   <td style="text-align:right;"> 123 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 2.814386 </td>
   <td style="text-align:right;"> 0.9381286 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> attitude </td>
   <td style="text-align:right;"> 245 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.141664 </td>
   <td style="text-align:right;"> 0.9348479 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> film </td>
   <td style="text-align:right;"> 114 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.9325654 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fishery </td>
   <td style="text-align:right;"> 204 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.9325654 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> annually </td>
   <td style="text-align:right;"> 657 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0.2127660 </td>
   <td style="text-align:right;"> 4.330733 </td>
   <td style="text-align:right;"> 0.9214326 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> minority </td>
   <td style="text-align:right;"> 244 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2142857 </td>
   <td style="text-align:right;"> 4.225373 </td>
   <td style="text-align:right;"> 0.9054370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> plastic </td>
   <td style="text-align:right;"> 514 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 5.141664 </td>
   <td style="text-align:right;"> 0.8569439 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> waste </td>
   <td style="text-align:right;"> 517 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 3.819908 </td>
   <td style="text-align:right;"> 0.8488684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 646 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2272727 </td>
   <td style="text-align:right;"> 3.694745 </td>
   <td style="text-align:right;"> 0.8397147 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> alien </td>
   <td style="text-align:right;"> 568 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 5.834811 </td>
   <td style="text-align:right;"> 0.8335444 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> invasive </td>
   <td style="text-align:right;"> 568 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 5.834811 </td>
   <td style="text-align:right;"> 0.8335444 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fish </td>
   <td style="text-align:right;"> 553 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2000000 </td>
   <td style="text-align:right;"> 4.130063 </td>
   <td style="text-align:right;"> 0.8260125 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> backlog </td>
   <td style="text-align:right;"> 479 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1250000 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.8159947 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nordic </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.2058824 </td>
   <td style="text-align:right;"> 3.963009 </td>
   <td style="text-align:right;"> 0.8159135 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-2">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>finland_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> finland_dtm.old</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(finland_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>finland_dtm <span class="ot">&lt;-</span> finland_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-2" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-2">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
</section>
<section id="cast-lda-k6-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-2">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>finland_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="st">government, national, policy, report, implementation, plan, ministry, parliament, committee, commission,</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="st">innovation, development, sustainable, society, research, commitment, company, business, public, sector,</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="st">indicator, assessment, people, panel, union, organisation, participate, issue, include, act,</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">education, increase, social, health, service, equality, woman, population, child,</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="st">energy, water, carbon, food, emission, consumption, reduce, economy, forest,</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">country, global, climate, international, cooperation, develop, promote, change"</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>finland_topic_update <span class="ot">&lt;-</span> finland_topic <span class="sc">%&gt;%</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>finland_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Government Policy"</span>, <span class="st">"Social Innovation"</span>, <span class="st">"Governance"</span>, <span class="st">"Human Rights"</span>, <span class="st">"Resources Management"</span>, <span class="st">"International Cooperation"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>finland_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(finland_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>finland_tp_6 <span class="ot">&lt;-</span> finland_lda <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(finland_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>finland_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(finland_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Clustered into 6 topics: ‘Government Policy’, ‘Social Innovation’, ‘Governance’, ‘Human Rights’, ‘Resource Management’, ‘International Cooperation’.</p></li>
<li><p>When looking at topics of ‘Government Policy’, ‘Governance’, it can be seen that the facilitator of the Sustainable Development Policy in Finland is not only the government but also various stakeholders participating in policy decision-making process</p></li>
<li><p>It can be seen that people are concerned about various topics related to society and people who have interest in ‘human rights’ and ‘social innovation’, and this contributes to attaining the sustainability of development</p></li>
<li><p>Interest in ‘Resource Management’, which is an essential element of sustainable development, is highlighted by topics covering carbon emissions as well as water and food, indicating that Finland is paying attention to resources and the environment</p></li>
<li><p>In the case of Finland, it can be deduced that cooperation with other nations is promoted in that there is topic regarding ‘International Cooperation’</p></li>
</ul>
</section>
</section>
<section id="network-graph-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-2">Network Graph</h2>
<section id="pairwise-count-2" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-2">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>finland_coocur <span class="ot">&lt;-</span> finland_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-2" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-2">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> finland_coocur <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>finland_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-2" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-2">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>finland_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>finland_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(finland_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic-2">Network Graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>finland_g <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic-2">Network Graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>finland_g <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking the Network Graph within topic, the topics of ‘Social Innovation’, ‘Government Policy’, and ‘International Cooperation’ show a stronger connection between words than other topics</li>
<li>This means that Finland’s efforts on achieving above three topics have been promoted relatively well</li>
<li>In particular, keywords such as ‘sustainable’ and ‘development’ show the strongest connection in the ‘Social Innovation’ topic, indicating that Finland is pursuing a high level of social innovation to achieve sustainable development</li>
<li>Looking at the Network Graph of inter-topic, the topic of ‘Social Innovation’, which accounts for the largest portion of the network, is frequently linked to ‘government policy’ keywords such as ‘government’ and ‘policy’, indicating that sustainable development based on social innovation in Finland is the governmen-driven</li>
</ul>
</section>
</section>
</section>
<section id="japan-vnr" class="level1 page-columns page-full">
<h1>6. Japan VNR</h1>
<section id="preprocess-3" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-3">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>japan<span class="ot">&lt;-</span><span class="fu">readLines</span>(jp_path) <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-3" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-3">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>japan_tokenized <span class="ot">&lt;-</span> japan <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-3" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-3">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>japan_ngram  <span class="ot">&lt;-</span>  japan <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-3" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-3">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>japan_tokenized <span class="ot">&lt;-</span> japan_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"jap*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"asia[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>japan_ngram <span class="ot">&lt;-</span> japan_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"jap*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"asia[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-3" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-3">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(japan_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#BC002D'</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Japan"</span>) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(japan_ngram <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#BC002D'</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Japan"</span>) <span class="sc">+</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> d1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-3" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-3">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>japan_tfidf <span class="ot">&lt;-</span> japan_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>japan_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> smoke </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2083333 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 1.2508098 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mekong </td>
   <td style="text-align:right;"> 271 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.8576982 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 347 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0.2083333 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.7930547 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> expectancy </td>
   <td style="text-align:right;"> 128 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1351351 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.7176676 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 348 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 0.1803279 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.6864473 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> suicide </td>
   <td style="text-align:right;"> 299 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 0.1494253 </td>
   <td style="text-align:right;"> 4.394449 </td>
   <td style="text-align:right;"> 0.6566418 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> household </td>
   <td style="text-align:right;"> 284 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.1935484 </td>
   <td style="text-align:right;"> 3.364830 </td>
   <td style="text-align:right;"> 0.6512574 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> reliance </td>
   <td style="text-align:right;"> 286 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1176471 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.6247929 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> litter </td>
   <td style="text-align:right;"> 232 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1515152 </td>
   <td style="text-align:right;"> 4.057977 </td>
   <td style="text-align:right;"> 0.6148450 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> traffic </td>
   <td style="text-align:right;"> 176 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1129032 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.5995997 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> city </td>
   <td style="text-align:right;"> 364 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2307692 </td>
   <td style="text-align:right;"> 2.477527 </td>
   <td style="text-align:right;"> 0.5717369 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> food </td>
   <td style="text-align:right;"> 335 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2105263 </td>
   <td style="text-align:right;"> 2.708050 </td>
   <td style="text-align:right;"> 0.5701158 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> relation </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1578947 </td>
   <td style="text-align:right;"> 3.605992 </td>
   <td style="text-align:right;"> 0.5693671 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1458333 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.5551383 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> investment </td>
   <td style="text-align:right;"> 358 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1904762 </td>
   <td style="text-align:right;"> 2.912845 </td>
   <td style="text-align:right;"> 0.5548275 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> railway </td>
   <td style="text-align:right;"> 177 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0909091 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.5458079 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> investor </td>
   <td style="text-align:right;"> 359 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.5438089 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> accident </td>
   <td style="text-align:right;"> 239 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1086957 </td>
   <td style="text-align:right;"> 4.905275 </td>
   <td style="text-align:right;"> 0.5331820 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> approximately </td>
   <td style="text-align:right;"> 287 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1578947 </td>
   <td style="text-align:right;"> 3.364830 </td>
   <td style="text-align:right;"> 0.5312889 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> icon </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0869565 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.5220771 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-3">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>japan_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_dtm.old</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>japan_dtm <span class="ot">&lt;-</span> japan_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-3" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-3">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>japan_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(japan_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>japan_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(japan_split)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>japan_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_train_dtm.old</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>japan_train_dtm <span class="ot">&lt;-</span> japan_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>japan_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(japan_split)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>japan_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_test_dtm.old</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>japan_test_dtm <span class="ot">&lt;-</span> japan_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(japan_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> japan_test_dtm)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>japan_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>japan_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k10" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k10">Cast LDA (k=10)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>japan_topic<span class="ot">=</span><span class="st">"covid, pandemic, system, poverty, life, population, age, service, people, local, government, city, promote, regional, aim, organization, private, public, initiative, disaster, increase, numb, water, reduction, survey, time, rate, worker, result, previous, compare, approximately, society, woman, gender, human, include, business, equality, activity, company, civil, child, education, school, national, awareness, raise, disability, center, student, generation, country, development, international, develop, cooperation, contribute, nation, provide, fund, peace,food, forest, resource, waste, marine, plastic, loss, management, fishery, biodiversity, change, economic, social, infrastructure, sustainable, quality, environment, technology, growth, innovation, energy, transportation, renewable, consumption, addition, emission, reduce, power, project, promotion, effort, plan, policy, action, achieve, target, goal, stakeholder"</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>japan_topic_update <span class="ot">&lt;-</span> japan_topic <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>japan_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> T, <span class="at">topic =</span> <span class="fu">c</span>(1L,2L,3L,4L,5L,6L,7L,8L,9L,10L),               <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Quality of Life"</span>,<span class="st">"Government Policy"</span>,<span class="st">"Disaster Management"</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Human Rights"</span>,<span class="st">"Education"</span>,<span class="st">"International Cooperation"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Natural Resources"</span>,<span class="st">"Innovative Development"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Renewable Energy"</span>,<span class="st">"Goal-oriented Development"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>japan_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(japan_dtm, <span class="at">k =</span> <span class="dv">10</span>,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>japan_tp_10 <span class="ot">&lt;-</span> japan_lda <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(japan_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>japan_tp_10 <span class="sc">%&gt;%</span> </span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(japan_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>)) <span class="sc">+</span> </span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>( <span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Clustered into 10 topics: ‘Quality of Life’,‘Government Policy’,‘Disaster Management’,‘Human Rights’,‘Education’,‘International Cooperation’,‘Natural Resources’,‘Innovative Development’,‘Renewable Energy’,‘Goal-oriented Development’</li>
<li>Through topics such as “Government Policy,” Goal-Oriented Development” and “Innovative Growth,” it is expected that Japan’s policy process will be goal-oriented and emphasizing innovation</li>
<li>In addition, due to Japan’s frequent natural disasters such as earthquakes and tsunamis, preparation and response to disasters are considered an important topic (‘Disaster Management’). In addition, it is found that the government is focusing on utilizing renewable energy and fostering human resources to reduce the country’s development and dependence on energy by reflecting the fact that natural resources are highly dependent on foreign countries due to their low reserves (‘Education’ and ‘Renewable Energy’).</li>
<li>Furthermore, efforts are being made for modern universal values and activities such as ‘human rights’ and ‘international cooperation’.</li>
<li>When the frequency of the appearance of certain words is listed in the order of many, words such as ‘government’, ‘promote’, ‘social’, ‘development’, and ‘country’ are at the top, so it can be expected that Japan is implementing policies led by the government.</li>
</ul>
</section>
</section>
<section id="network-graph-3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-3">Network Graph</h2>
<section id="pairwise-count-3" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-3">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>japan_coocur <span class="ot">&lt;-</span> japan_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>item1<span class="sc">==</span><span class="st">"gender"</span><span class="sc">&amp;!</span>item2<span class="sc">==</span><span class="st">"gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-3" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-3">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> japan_coocur <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">150</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>japan_tp_10,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-3" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-3">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>japan_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>japan_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(japan_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic-3">Network Graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>japan_g <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> topic) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>)[<span class="sc">-</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic-3">Network Graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>japan_g <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>)[<span class="sc">-</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking at the Network Graph within topic, the connection between words is more vivid than those other topics in the case of ‘Government Policy’, ‘International Cooperation’, ‘Goal-oriented Development’, and ‘Human Rights’ topics</li>
<li>Through this, it can be inferred that govenrment efforts related to these four topics are relatively well constructed</li>
<li>In particular, in the ‘Government Policy’ topic, the relationship between keywords such as ‘government’ and ‘promote’, ‘government’ and ‘local’ is clear, indicating that the government-led top-down policy process is adopted</li>
<li>Looking at the Network Graph of inter-topic, strong connection between keywords within ‘Governmental Policy’ and ‘International Cooperation’ topics is easy to recognize</li>
<li>In particular, keywords of ‘promote’ and ‘government’ of ‘Government Policy” topic showed a strong connection with ’international’, ‘development’, ‘cooperation’, and ‘human’ of ‘international cooperation’ topic, and in Japan, policies related to sustainable development at domestic and foreign are led by the central government</li>
</ul>
</section>
</section>
</section>
<section id="uk-vnr" class="level1 page-columns page-full">
<h1>7. UK VNR</h1>
<section id="preprocess-4" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-4">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>uk <span class="ot">&lt;-</span><span class="fu">readLines</span>(uk_path) <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-4" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-4">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>uk_tokenized <span class="ot">&lt;-</span> uk <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-4" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-4">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>uk_ngram  <span class="ot">&lt;-</span>  uk <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-4" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-4">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>uk_tokenized <span class="ot">&lt;-</span> uk_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"uk[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wale*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"scot*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eng*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"irel*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wt*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rbmps*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inn*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"whilst*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"npt*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"britain*"</span>)) </span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>uk_ngram <span class="ot">&lt;-</span> uk_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"uk[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wale*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"scot*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eng*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"irel*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wt*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rbmps*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inn*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"whilst*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"npt*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"britain*"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-4" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-4">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>(uk_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00247D'</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#CF142B'</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"United Kingdom"</span>) <span class="sc">+</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>(uk_ngram <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00247D'</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#CF142B'</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"United Kingdom"</span>) <span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> e1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-4" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-4">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>uk_tfidf <span class="ot">&lt;-</span> uk_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>uk_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> bus </td>
   <td style="text-align:right;"> 705 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.7500000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 4.747291 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nihr </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 7.022868 </td>
   <td style="text-align:right;"> 4.681912 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> daily </td>
   <td style="text-align:right;"> 709 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.636574 </td>
   <td style="text-align:right;"> 3.757716 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> abortion </td>
   <td style="text-align:right;"> 201 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 3.487406 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nhs </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.943427 </td>
   <td style="text-align:right;"> 3.295618 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> hour </td>
   <td style="text-align:right;"> 533 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.624973 </td>
   <td style="text-align:right;"> 3.083315 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> contact </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.636574 </td>
   <td style="text-align:right;"> 2.818287 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> victim </td>
   <td style="text-align:right;"> 997 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.189655 </td>
   <td style="text-align:right;"> 2.793103 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lgbt </td>
   <td style="text-align:right;"> 652 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 4.624973 </td>
   <td style="text-align:right;"> 2.774984 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> day </td>
   <td style="text-align:right;"> 429 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.132496 </td>
   <td style="text-align:right;"> 2.754998 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> birth </td>
   <td style="text-align:right;"> 1002 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.413430 </td>
   <td style="text-align:right;"> 2.706715 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cardiovascular </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 7.022868 </td>
   <td style="text-align:right;"> 2.633576 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> landfill </td>
   <td style="text-align:right;"> 769 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 2.615554 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> conviction </td>
   <td style="text-align:right;"> 334 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> participatory </td>
   <td style="text-align:right;"> 1014 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> paramilitarism </td>
   <td style="text-align:right;"> 1027 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> road </td>
   <td style="text-align:right;"> 207 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.5555556 </td>
   <td style="text-align:right;"> 4.537961 </td>
   <td style="text-align:right;"> 2.521090 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pupil </td>
   <td style="text-align:right;"> 312 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 4.189655 </td>
   <td style="text-align:right;"> 2.513793 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mobility </td>
   <td style="text-align:right;"> 670 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.4615385 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 2.414358 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> product </td>
   <td style="text-align:right;"> 758 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 3.557132 </td>
   <td style="text-align:right;"> 2.371421 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-4" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-4">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>uk_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_dtm.old</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>uk_dtm <span class="ot">&lt;-</span> uk_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-4" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-4">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>uk_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(uk_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>uk_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(uk_split)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>uk_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_train_dtm.old</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>uk_train_dtm <span class="ot">&lt;-</span> uk_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>uk_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(uk_split)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>uk_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_test_dtm.old</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>uk_test_dtm <span class="ot">&lt;-</span> uk_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(uk_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> uk_test_dtm)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>uk_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>uk_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-3">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>uk_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="st">plastic, quality, population, land, significant, impact, priority, monitor, air,</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="st">child, school, fund, girl, disability, family, adult, additional,</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="st">goal, community, local, national, public, risk, act, approach, opportunity, authority,</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="st">plan, action, policy, publish, gap, launch, focus, fair, ambition,</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="st">global, country, commit, build, job, capacity, poor, africa, bank,</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="st">food, supply, transport, company, standard, city, productivity, aim, product"</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>uk_topic_update <span class="ot">&lt;-</span> uk_topic <span class="sc">%&gt;%</span> </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>uk_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Environment"</span>, <span class="st">"Human Rights"</span>, <span class="st">"Governance"</span>, <span class="st">"Government Policy"</span>, <span class="st">"International Cooperation"</span>, <span class="st">"Food Security"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>uk_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(uk_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>uk_tp_6 <span class="ot">&lt;-</span> uk_lda <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(uk_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>uk_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(uk_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Clustered into 6 topics: ‘Environment’, ‘Human Rights’, ‘Governance’, ‘Government Policy’, ‘International Cooperation’, ‘Food Security’</li>
<li>The policy process is expected to take place in a way that cooperates with civil society, not just the top-down way in the past, despite the fact that the government plays a leading role.</li>
<li>In addition, due to the recent climate crisis and Russian-Ukraine war, food problems have emerged as an important issue not only in developing countries but also in major developed countries, and the concept of security is expanding to a area of food security.</li>
<li>UK showed great effort ot attain mordern universial values such as ‘Human Rights’ and ‘International Cooperation’.</li>
<li>When the keywords are sorted in the order of occurrence frequencies, keywords such as ‘goal’, ‘plan’, ‘action’, ‘national’, ‘community’, and ‘local’ are at the top, so it can be deduced that the UK has a cooperative approach with civil society, while total scheme being led by the central government.</li>
</ul>
</section>
</section>
<section id="network-graph-4" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-4">Network Graph</h2>
<section id="pairwise-count-4" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-4">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>uk_coocur <span class="ot">&lt;-</span> uk_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item1<span class="sc">==</span><span class="st">"school"</span><span class="sc">&amp;</span>item2<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"school"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"family"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"child"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"family"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-4" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-4">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> uk_coocur <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>uk_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic) <span class="sc">%&gt;%</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(nodes <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"school"</span>,<span class="st">"child"</span>,<span class="st">"family"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-4" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-4">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>uk_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>uk_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(uk_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic-4" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic-4">Network Graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>uk_g <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic-4" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic-4">Network Graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>uk_g <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking at the Network Graph within topic, the connection between words is more evident than other topics like ‘Governance’, ‘International Cooperation’, and ‘Government Policy’</li>
<li>This allows us to deduce that policy efforts related to the these four topics are organized relatively well</li>
<li>In particular, the relationship between keywords of ‘plan’ and ‘action’ in the ‘government’ topic is clear, and the relationship between ‘local’ and ‘community’, ‘authority’, ‘national’ and ‘goal’ in the government topic shows that the government forms and executes policies in cooperation with the community and civil society</li>
<li>Looking at the Network Graph of inter-topic, there is a strong connection between the words constituting ‘Governance’ and ‘Government Policy’, ‘Governance’ and ‘International Cooperation’</li>
<li>In particular, the connection between keywords such as ‘Goal’, ‘Action’ and ‘Plan’ is relatively strong</li>
<li>Therefore, it can be inferred that the British government is actively working on international cooperation and establishing policies in cooperation with civil society</li>
</ul>
</section>
</section>
</section>
<section id="austrailia-vnr" class="level1 page-columns page-full">
<h1>8. Austrailia VNR</h1>
<section id="preprocess-5" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-5">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>austrailia<span class="ot">&lt;-</span><span class="fu">readLines</span>(astl_path) <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-5" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-5">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>austrailia_tokenized <span class="ot">&lt;-</span> austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-5" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-5">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>austrailia_ngram  <span class="ot">&lt;-</span>  austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-5" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-5">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>austrailia_tokenized <span class="ot">&lt;-</span> austrailia_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"austra*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"torres*"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"cent"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>austrailia_ngram <span class="ot">&lt;-</span> austrailia_ngram <span class="sc">%&gt;%</span> </span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"austrail[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"torres*"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"cent"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-5" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-5">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(austrailia_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00008B'</span>,</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Austrailia"</span>) <span class="sc">+</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(austrailia_ngram <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00008B'</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Austrailia"</span>) <span class="sc">+</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> f1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-81-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-5" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-5">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf <span class="ot">&lt;-</span> austrailia_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> broadband </td>
   <td style="text-align:right;"> 206 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.3076923 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.837311 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> scarcity </td>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.833987 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> park </td>
   <td style="text-align:right;"> 294 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.744730 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fish </td>
   <td style="text-align:right;"> 305 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.3888889 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.696265 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> child </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 2.926739 </td>
   <td style="text-align:right;"> 1.463370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> child </td>
   <td style="text-align:right;"> 111 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 2.926739 </td>
   <td style="text-align:right;"> 1.463370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> carbon </td>
   <td style="text-align:right;"> 283 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 3.668677 </td>
   <td style="text-align:right;"> 1.375754 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lgbtiqa </td>
   <td style="text-align:right;"> 103 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.326947 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> discrimination </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.774037 </td>
   <td style="text-align:right;"> 1.258012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> world </td>
   <td style="text-align:right;"> 293 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 1.963929 </td>
   <td style="text-align:right;"> 1.178357 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> profit </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2500000 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.146242 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> basin </td>
   <td style="text-align:right;"> 163 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2727273 </td>
   <td style="text-align:right;"> 4.179502 </td>
   <td style="text-align:right;"> 1.139864 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> goal </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.406312 </td>
   <td style="text-align:right;"> 1.135438 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> collaboration </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.406312 </td>
   <td style="text-align:right;"> 1.135438 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> human </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.4545455 </td>
   <td style="text-align:right;"> 2.474754 </td>
   <td style="text-align:right;"> 1.124888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> rubbish </td>
   <td style="text-align:right;"> 301 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1875000 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.119612 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> park </td>
   <td style="text-align:right;"> 303 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2500000 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.090456 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mhfa </td>
   <td style="text-align:right;"> 102 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.085684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mikta </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.085684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> wto </td>
   <td style="text-align:right;"> 371 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2352941 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.078816 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-5" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-5">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_dtm.old</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>austrailia_dtm <span class="ot">&lt;-</span> austrailia_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-5" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-5">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>austrailia_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(austrailia_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>austrailia_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(austrailia_split)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>austrailia_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_train_dtm.old</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>austrailia_train_dtm <span class="ot">&lt;-</span> austrailia_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>austrailia_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(austrailia_split)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>austrailia_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_test_dtm.old</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>austrailia_test_dtm <span class="ot">&lt;-</span> austrailia_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(austrailia_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> austrailia_test_dtm)}</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>austrailia_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>austrailia_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-4" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-4">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>austrailia_topic<span class="ot">=</span><span class="st">" organisation, approach, policy, indicator, civil, social, financial, action,</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="st">food, supply, cost, world, agricultural, risk, aim, production,</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="st">woman, aboriginal, disability, child, school, participation, girl, family,</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="st">human, national, law, public, activity, institution, commit, land, discrimination,</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="st">city, plan, community, sustainability, build, growth, local, urban, opportunity, council,</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="st">pacific, country, fund, island, indo, capacity, asia, aid, major, bank, assist"</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>austrailia_topic_update <span class="ot">&lt;-</span> austrailia_topic <span class="sc">%&gt;%</span> </span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>austrailia_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"Government Policy"</span>, <span class="st">"Food Security"</span>, <span class="st">"Human Rights"</span>, <span class="st">"Public Value"</span>, <span class="st">"Governance"</span>, <span class="st">"International Cooperation"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>austrailia_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(austrailia_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>austrailia_tp_6 <span class="ot">&lt;-</span> austrailia_lda <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(austrailia_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>austrailia_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(austrailia_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Clustered into 6 topics: ‘Government Policy’, ‘Food Security’, ‘Human Rights’, ‘Public Value’, ‘Governance’, ‘International Cooperation’</li>
<li>It is expected that the policy process will be conducted in a way that cooperates with civil society, not the top-down way in the past, even if the government plays a leading role through the topics of ‘Governance’ and ‘Government Policy’.</li>
<li>In addition, it can be deduced that there is a high interest in community values and order such as ‘Public value’ and ‘Human rights’</li>
<li>In particular, the human rights issue seems to reflect the situation in Australia, which has a native (Aborigine) problem unlike other comparable countries</li>
<li>When the keywords are sorted in the order of occurrence frequencies, the words ‘community’, ‘country’, ‘woman’, ‘national’, and ‘original’ are at the top, so Australia seems like promoting policies in cooperation with civil society and deal with human rights issues, especially women and natives</li>
</ul>
</section>
</section>
<section id="network-graph-5" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-5">Network Graph</h2>
<section id="pairwise-count-5" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-5">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>austrailia_coocur <span class="ot">&lt;-</span> austrailia_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-5" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-5">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> austrailia_coocur <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>austrailia_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-5" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-5">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>austrailia_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(austrailia_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-of-inter-topic-5" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-of-inter-topic-5">Network Graph of inter-topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-within-topic-5" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-within-topic-5">Network Graph within topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic"</span>,</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Looking at the Network Graph within topic, the connection between words is more evident in topics like ‘Governance’, ‘International Cooperation’, ‘Human Rights’, and ‘Government Policy’ than other topics</li>
<li>Through this, it can be inferred that policy efforts related to these four topics are relatively well constructed</li>
<li>In particular, the relationship between keywords such as ‘community’ and ‘build’, ‘local’, ‘city’, and ‘impact’ is evident in the ‘Governance’ topic, indicating that a bottom-up policy process in which the government cooperates with the community and civil society rather than simply leading the policy process</li>
<li>The relationship between keywords of ‘aboriginal’ and ‘straits’ in the ‘human rights’ topic and ‘indo’ and ‘country’ in the ‘international cooperation’ topic, we can see that the Australian government is paying attention to aboriginal poverty and international cooperation in the Indo-Pacific region</li>
<li>Looking at the Network Graph of inter-topic, there is a strong connection between words that constitutes ‘Governance’ and ‘Government Policy’, ‘Governance’ and ‘Human Rights’</li>
<li>In particular, the connection between keywords such as ‘community’ and ‘social’, ‘organization’, ‘approach’, ‘country’, ‘Pacific’, ‘Aboriginal’, ‘straight’, and ‘focus’ is relatively strong</li>
<li>Therefore, it can be inferred that the Australian government is continuously taking human rights issues into account while establishing policies in cooperation with civil society and actively engaging in international cooperation</li>
</ul>
</section>
</section>
</section>
<section id="comparing-six-countries" class="level1 page-columns page-full">
<h1>9. Comparing Six countries</h1>
<section id="comparing-word-frequencies-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-word-frequencies-of-six-countries">Comparing Word Frequencies of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"Korea"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"Germany"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"Finland"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(japan_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"Japan"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(uk_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"United Kingdom"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(austrailia_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"Austrailia"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">key=</span><span class="fu">as_factor</span>(key)) <span class="ot">-&gt;</span> total_tokenized</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key,words) <span class="sc">%&gt;%</span> </span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(n, <span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">reorder_within</span>(words, n, key)) <span class="sc">%&gt;%</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>words)) <span class="sc">+</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>key),<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Comparing Word Frequencies of Six Countries"</span>) <span class="sc">+</span></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-bigrams-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-bigrams-of-six-countries">Comparing bigrams of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(a1,b1,c1,d1,e1,f1, <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Comparing Bigrams of Six Countries"</span>,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fontsize =</span> <span class="dv">40</span>,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fontfamily=</span><span class="st">"Nanum Gothic"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-tf-idf-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-tf-idf-of-six-countries">Comparing Tf-idf of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key,words) <span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, key, n) <span class="sc">%&gt;%</span> </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(tf_idf, <span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">reorder_within</span>(words, tf_idf, key)) <span class="sc">%&gt;%</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tf_idf, <span class="at">y=</span>words)) <span class="sc">+</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>key),<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Comparing TF-IDF of Six Countries"</span>) <span class="sc">+</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))  <span class="sc">+</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-the-word-frequencies" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-the-word-frequencies">Comparing the word frequencies</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>compare_six <span class="ot">&lt;-</span> total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key, words) <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> key, <span class="at">values_from =</span> proportion) <span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"key"</span>, <span class="at">values_to =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Words that are far from the line are words that are found more in one set of texts than another.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expect a warning about rows with missing values being removed</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>compare_six <span class="sc">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> proportion, <span class="at">y =</span> Korea, <span class="at">color =</span> <span class="fu">abs</span>(Korea <span class="sc">-</span> proportion))) <span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> words), <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>), </span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">low =</span> <span class="st">"darkgreen"</span>, <span class="at">high =</span>  <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Republic of Korea"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">40</span>),</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-of-words" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="correlation-of-words">Correlation of words</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key, words) <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> key, <span class="at">values_from =</span> proportion) <span class="sc">%&gt;%</span> </span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> words) <span class="ot">-&gt;</span> correlation_total  </span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>testRes<span class="ot">=</span>corrplot<span class="sc">::</span><span class="fu">cor.mtest</span>(correlation_total, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>correlation_total <span class="sc">%&gt;%</span> </span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    .[<span class="fu">order</span>(.[ , <span class="dv">1</span>],<span class="at">decreasing =</span> T), <span class="fu">order</span>(.[ <span class="dv">1</span>, ],<span class="at">decreasing =</span> T)] <span class="sc">%&gt;%</span> </span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">corrplot</span>(<span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">diag=</span>T, </span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">type=</span><span class="st">"lower"</span>,</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">method=</span><span class="st">"color"</span>,</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">cl.pos=</span><span class="st">"n"</span>,</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">addCoef.col =</span> <span class="dv">1</span>,</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">number.cex =</span> <span class="dv">4</span>,</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">tl.cex =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-result="hide">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>cortrix <span class="ot">=</span> <span class="cf">function</span> (R, <span class="at">histogram =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"kendall"</span>, </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"spearman"</span>), ...) </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">as.matrix</span>(R, <span class="at">method =</span> <span class="st">"matrix"</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(method)) </span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    method <span class="ot">=</span> method[<span class="dv">1</span>]</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  cormeth <span class="ot">&lt;-</span> method</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> cormeth, cex.cor, ...) {</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>)</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">use =</span> use, <span class="at">method =</span> method)</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste</span>(prefix, txt, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(cex.cor)) </span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>      cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(x), <span class="fu">as.numeric</span>(y), <span class="at">method =</span> method)</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>    Signif <span class="ot">&lt;-</span> <span class="fu">symnum</span>(test<span class="sc">$</span>p.value, <span class="at">corr =</span> <span class="cn">FALSE</span>, <span class="at">na =</span> <span class="cn">FALSE</span>, </span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, </span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">" "</span>))</span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex)</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>, Signif, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(t, <span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd.xts</span>(x))</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>  dotargs <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>  dotargs<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(method)</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>  hist.panel <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">... =</span> <span class="cn">NULL</span>) {</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">"light blue"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="st">"FD"</span>)</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rug</span>(x)</span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (histogram) </span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairs</span>(x, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">lower.panel =</span> panel.smooth, <span class="at">upper.panel =</span> panel.cor, </span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">diag.panel =</span> hist.panel, ...)</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">pairs</span>(x, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">lower.panel =</span> panel.smooth, <span class="at">upper.panel =</span> panel.cor, </span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>    ...)</span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>correlation_total <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cortrix</span>(<span class="at">histogram=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" style="width:150.0%"></p>
</figure>
</div>
</div>
</div>
<p>***: 0 - 0.001</p>
</section>
<section id="document-similarity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="document-similarity">Document Similarity</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>korea_string <span class="ot">&lt;-</span> korea <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>germany_string <span class="ot">&lt;-</span> germany <span class="sc">%&gt;%</span> </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>finland_string <span class="ot">&lt;-</span> finland <span class="sc">%&gt;%</span> </span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>japan_string <span class="ot">&lt;-</span> japan <span class="sc">%&gt;%</span> </span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>uk_string <span class="ot">&lt;-</span> uk <span class="sc">%&gt;%</span> </span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>austrailia_string <span class="ot">&lt;-</span> austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>mpl.rc(<span class="st">'font'</span>, family<span class="op">=</span><span class="st">'NanumGothic'</span>) <span class="co"># 폰트 설정</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>mpl.rc(<span class="st">'axes'</span>, unicode_minus<span class="op">=</span><span class="va">False</span>) <span class="co"># 유니코드에서 음수 부호 설정</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 차트 스타일 설정</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font<span class="op">=</span><span class="st">"NanumGothic"</span>, rc<span class="op">=</span>{<span class="st">"axes.unicode_minus"</span>:<span class="va">False</span>}, style<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="convert-data-from-r-objects" class="level3">
<h3 class="anchored" data-anchor-id="convert-data-from-r-objects">Convert data from R objects</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>document_df <span class="op">=</span> pd.DataFrame.from_dict(</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'filename'</span>: [<span class="st">"Korea"</span>, <span class="st">"Germany"</span>, <span class="st">"Finland"</span>, <span class="st">"Japan"</span>, <span class="st">"UK"</span>, <span class="st">"Austrailia"</span>],</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'opinion_text'</span>:[r.korea_string, r.germany_string, r.finland_string, </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    r.japan_string, r.uk_string, r.austrailia_string]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizer" class="level3">
<h3 class="anchored" data-anchor-id="tokenizer">Tokenizer</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단어 원형 추출 함수</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>lemmar <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LemTokens(tokens):</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [lemmar.lemmatize(token) <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 특수 문자 사전 생성: {33: None ...}</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ord(): 아스키 코드 생성</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>remove_punct_dict <span class="op">=</span> <span class="bu">dict</span>((<span class="bu">ord</span>(punct), <span class="va">None</span>) <span class="cf">for</span> punct <span class="kw">in</span> string.punctuation)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 특수 문자 제거 및 단어 원형 추출</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LemNormalize(text):</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    text_new <span class="op">=</span> text.lower().translate(remove_punct_dict)</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    word_tokens <span class="op">=</span> nltk.word_tokenize(text_new)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> LemTokens(word_tokens)</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('punkt')</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('wordnet')</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('omw-1.4')</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>tfidf_vect <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span><span class="st">'english'</span> , ngram_range<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>                             tokenizer <span class="op">=</span> LemNormalize, min_df<span class="op">=</span><span class="fl">0.05</span>, max_df<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>feature_vect <span class="op">=</span> tfidf_vect.fit_transform(document_df[<span class="st">'opinion_text'</span>])    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cosine-similarity" class="level3">
<h3 class="anchored" data-anchor-id="cosine-similarity">Cosine Similarity</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>similarity_pair <span class="op">=</span> cosine_similarity(feature_vect[<span class="dv">0</span>] , feature_vect)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>document_df[<span class="st">"similarity"</span>] <span class="op">=</span> similarity_pair.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualization" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>vis<span class="op">=</span>document_df.iloc[<span class="dv">1</span>:].sort_values(by<span class="op">=</span><span class="st">"similarity"</span>,ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"seaborn-pastel"</span>)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">"similarity"</span>, y<span class="op">=</span><span class="st">"filename"</span>, data<span class="op">=</span>vis)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Korea'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>10. Conclusion</h1>
<section id="summary-of-vnr-analysis-results-in-korea" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-vnr-analysis-results-in-korea">Summary of VNR Analysis Results in Korea</h2>
<ul>
<li><p>The major keywords used in the VNR report of Korea are classified into six topics:‘International Cooperation’, ‘Welfare’, ‘Human Rights’, and ‘Government Policy’, ‘Sustainable Development’ and ‘Integrated Goal-Setting’</p></li>
<li><p>Looking at the analysis results of the network within and inter topics of 6 topics, it can be concluded that SDGs in Korea are being implemented centered on the connectivity between ‘sustainable development’ and ‘government policy’</p></li>
<li><p>Although topics such as ‘Human Rights’, ‘Welfare’ are formed, it can be judged that the government-led policy does not receive attention sufficiently since those topics shows minimal connection with sustainable development policies</p></li>
</ul>
</section>
<section id="vnr-comparison-analysis-summary-with-korea-and-other-countries" class="level2">
<h2 class="anchored" data-anchor-id="vnr-comparison-analysis-summary-with-korea-and-other-countries">VNR Comparison Analysis Summary with Korea and Other Countries</h2>
<ul>
<li><p>Comparing the results of VNR analysis in Korea with other countries, the same-word occurrence frequency correlation showed a relatively high correlation with Finland (0.8) and the UK (0.69), while Germany (0.58) and Australia (0.5) showed a relatively low correlation</p></li>
<li><p>Unlike Korea, Finland operate the SDGs that social innovation played a major role in the establishment and implementation of SDGs policy goals, local community played a large role in establishing and implementing in Germany, Japan’s discussion on civil rights was more important than Korea</p></li>
<li><p>Conclusion 1: Deriving key features related to current SDGs in Korea</p>
<ul>
<li>As a result of the analysis, it can be judged that the policy direction for SDGs in Korea is going in the right direction, such as carrying out the ‘integrated goal setting’ process to achieve ‘sustainable development’</li>
<li>However, the biggest difference between Korea and other countries is that majority of the government policy-making and enforcement of the SDGs were led by the government, whereas influence of other actors such as ‘community’, ‘social innovation’, and ‘governance’ is weak</li>
<li>In conclusion, it is necessary to develop policies in a way that diversifies the measures of adopting them and attains sustainable development through cooperation with other actors rather than the direction of the government itself</li>
</ul></li>
<li><p>Conclusion 2: Proposing the policy direction of SDGs in Korea</p>
<ul>
<li>As a final conclusion of this analysis, it can be judged that the establishment and implementation of the SDGs of the Korea should adopt approaches of German, Britain and Austrailian models to take their advantages</li>
<li>As shown in the above analysis, the main characteristic of SDGs in these countries and the most different from that of Korea is the role of the ‘community’</li>
<li>Germany’s “community” topic shows strong connectivity in the center along with ‘international cooperation’ and ‘government policy’</li>
<li>This can be inferred that the ‘community’ in the German SDGs discussion not only emphasizes the role as a community or as a part of the community in the city, but discusses the relationship between urban and rural areas, central and local areas</li>
<li>On the other hand, in Korea, the government-centered development that has extended since the 1960s and achieved rapid growth, but from the perspective of SDGs, it is no longer efficient nor effective in maintaining the development only resorting to pure government’s capacity</li>
<li>In order to pursue and attain sustainable development, it is imperative to construct international diplomatic relationships, central-local relationships prior to establishing and implementing SDGs goals</li>
<li>In conclusion, while maintaining the mediating and organizing role of the centralized government, it is necessary to diverge from the current SDGs structure in which all detailed topics are converges to the one centalized entity. Instead, promoting policy development in the direction of strengthening cooperation outward with other countries and strengthening connectivity inward with local communities is the most effective and efficient way to achieve sustainable development goals.</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>