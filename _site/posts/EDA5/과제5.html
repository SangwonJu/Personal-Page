<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangwon Ju, Yonsei Public Administration">
<meta name="dcterms.date" content="2021-05-11">

<title>Sangwon Ju - EDA Assignment 5: Chapter 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Sangwon Ju</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">About Me</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">Research</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../../research_interests.html">
 <span class="dropdown-text">Research Interests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../publication.html">
 <span class="dropdown-text">Publications / Working Papers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../data_analytics.html">Data Analytics</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html">CV (as of January 2023)</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#추가과제-titanic" id="toc-추가과제-titanic" class="nav-link active" data-scroll-target="#추가과제-titanic">추가과제: titanic</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1)</a></li>
  </ul></li>
  <li><a href="#번" id="toc-번" class="nav-link" data-scroll-target="#번">1번</a></li>
  <li><a href="#번-1" id="toc-번-1" class="nav-link" data-scroll-target="#번-1">2번</a>
  <ul class="collapse">
  <li><a href="#심프슨-역설의-예시" id="toc-심프슨-역설의-예시" class="nav-link" data-scroll-target="#심프슨-역설의-예시">심프슨 역설의 예시</a></li>
  </ul></li>
  <li><a href="#번-2" id="toc-번-2" class="nav-link" data-scroll-target="#번-2">3번</a>
  <ul class="collapse">
  <li><a href="#년-과-최근-자료를-각각-분석한다." id="toc-년-과-최근-자료를-각각-분석한다." class="nav-link" data-scroll-target="#년-과-최근-자료를-각각-분석한다.">(1) 1988년 과 최근 자료를 각각 분석한다.</a></li>
  <li><a href="#년-자료와-kosis-최근-자료의-범주가-약간-다른-점에-주의하면서-이들의-시간차약-30여년에-따른-태도의-변화를-서로-비교하여-분석한다." id="toc-년-자료와-kosis-최근-자료의-범주가-약간-다른-점에-주의하면서-이들의-시간차약-30여년에-따른-태도의-변화를-서로-비교하여-분석한다." class="nav-link" data-scroll-target="#년-자료와-kosis-최근-자료의-범주가-약간-다른-점에-주의하면서-이들의-시간차약-30여년에-따른-태도의-변화를-서로-비교하여-분석한다.">(2) 1988년 자료와 KOSIS 최근 자료의 범주가 약간 다른 점에 주의하면서 이들의 시간차(약 30여년)에 따른 태도의 변화를 서로 비교하여 분석한다.</a>
  <ul class="collapse">
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis">residual Analysis</a></li>
  </ul></li>
  <li><a href="#two-way-plot-과-coded-plot" id="toc-two-way-plot-과-coded-plot" class="nav-link" data-scroll-target="#two-way-plot-과-coded-plot">two-way plot 과 Coded plot</a>
  <ul class="collapse">
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">1988</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">2018</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">2020</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">EDA Assignment 5: Chapter 7</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Exploratory Data Analysis (2021 Spring) [in Korean]</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangwon Ju, Yonsei Public Administration </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 11, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>7장. 2원 자료, 빈도 표의 탐색</p>
<section id="추가과제-titanic" class="level1">
<h1>추가과제: titanic</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">1)</h2>
<p>On your own; The survival rates differ in Children?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span> Age<span class="sc">+</span>Sex<span class="sc">+</span>Survived, <span class="at">data =</span> Titanic,<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"brown"</span>,<span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>성인 집단에서는 여성과 남성 사이의 생존율에는 큰 차이가 보여지고 있는데에 비해, 어린아이들의 집단에서는 여성과 남성의 생존율이 큰 차이가 있지 않는 것으로 보인다. 일반적인 상황에서 선원들의 통제가 잘 이루어지지 않는 경우 여성들과 아이들의 생존율이 매우 낮아지지만, 타이타닉호 사건 때는 승객들에 대한 통제도와 선원들의 상선사관들의 명령 복종정도가 높았기 때문에 여자와 아이들 먼저 규칙에 의해 남자아이들의 생존율이 성인 남자의 생존율에 비해서 상당히 높게 나타났다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span> Class <span class="sc">+</span> Age  <span class="sc">+</span> Survived, <span class="at">data =</span> Titanic, <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"brown"</span>,<span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>1등석과 2등석의 아이들은 1명빼고 전부 살아남았지만, 3등실에서 구조되지 못한 어린이는 구조된 수의 거의 두 배에 가까웠다. 3등석의 아이들이 1등석과 2등석에 비해서 살아남기 힘들었던 이유는 배 안의 구조가 복잡했기 때문이다. 3등석에는 영어를 잘 하지 못하는 승객들도 많았기에 갑판과 적절한 의사소통을 하지못해 밖으로 나가는 것을 실패한 사람들이 많다는 점에서 그 이유를 찾을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span> Sex <span class="sc">+</span> Class <span class="sc">+</span> Age <span class="sc">+</span> Survived, <span class="at">data =</span> Titanic, <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"brown"</span>,<span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>모든 요인을 합친 그래프이다. 1등석, 2등석 모두 어린아이들이 어른에 비해, 여자들이 남자들에 비해 생존확률이 월등히 높다. 3등석의 경우에도 여자 아이들이 남자아이들에 비해서 생존 확률이 월등히 높았다는 점에서 “여자와 아이”먼저 원칙이 지켜지고 있음이 확인되고 있다. 함장 로버트 샐먼드(Robert Salmond) 해군 대령 이하 육해군 장병들은 갑판에 부동 자세로 도열한 채로 질서를 유지하였기 대문에 규칙이 지켜질 수 있었고, 승객들은 명령에 복종할 수 밖에 없었던 것으로 보인다.</p>
</section>
</section>
<section id="번" class="level1">
<h1>1번</h1>
<p>아래 자료를 분석하여라. The data are part of a larger experiments to determine the effectiveness of blast furnace slags (고로 슬랙) as agricultural liming materials (중화작업) on three types of soil, sandy loams(I), sandy clay loam(II), and loamy sand(III). The treatments were all applied at 4000 lbs per acre, and what was measured was the corn yield in bushels per acre.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>treatment<span class="ot">=</span><span class="fu">c</span>(<span class="fl">11.1</span>,<span class="fl">32.6</span>,<span class="fl">63.3</span>,<span class="fl">15.3</span>,<span class="fl">40.8</span>,<span class="fl">65.0</span>,<span class="fl">22.7</span>,<span class="fl">52.1</span>,<span class="fl">58.8</span>,<span class="fl">23.8</span>,<span class="fl">52.8</span>,<span class="fl">61.4</span>,<span class="fl">25.6</span>,<span class="fl">63.1</span>,<span class="fl">41.1</span>,<span class="fl">31.2</span>,<span class="fl">59.5</span>,<span class="fl">78.1</span>,<span class="fl">25.8</span>,<span class="fl">55.3</span>,<span class="fl">60.2</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">mean</span>(treatment)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.74286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>treatment<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(treatment,<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(treatment)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"sandy loams(I)"</span>, <span class="st">"sandy clay loam(II)"</span>, <span class="st">"loamy sand(III)"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(treatment)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"None"</span>,<span class="st">"Coarse slag"</span>,<span class="st">"Mediaum slag"</span>,<span class="st">"Agricultural slag"</span>,<span class="st">"Agricultural limestone"</span>,<span class="st">"Agricultural slag + minor limestone"</span>,<span class="st">"Agricultural limestone + minor elements"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>treatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sandy loams(I) sandy clay loam(II)
None                                              11.1                32.6
Coarse slag                                       15.3                40.8
Mediaum slag                                      22.7                52.1
Agricultural slag                                 23.8                52.8
Agricultural limestone                            25.6                63.1
Agricultural slag + minor limestone               31.2                59.5
Agricultural limestone + minor elements           25.8                55.3
                                        loamy sand(III)
None                                               63.3
Coarse slag                                        65.0
Mediaum slag                                       58.8
Agricultural slag                                  61.4
Agricultural limestone                             41.1
Agricultural slag + minor limestone                78.1
Agricultural limestone + minor elements            60.2</code></pre>
</div>
</div>
<p>행은 blast furnace slags의 유형 / 열은 토양의 종류를 의미한다. 고로 슬랙과 토양이 농업 중화 작업에 영향을 미치고 있는데 각각이 영향을 미치는 정도에 대해서 분석을 진행해보고자 한다.</p>
<p>고로 슬랙을 i, 토양을 j로 표기하고 i와 j에 따른 중화작업의 효과를 y_ij로 나타내고자 한다. y_ij에 대한 Additivity Model y_ij=μ (all) + α_i (row_effect) + β_j (column_effect) + e_ij (residual), e~(0,sigma), i=(1,…,7),j=(1,…,3)을 고려한다. (All, Common, Constant )</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>treatment<span class="ot">=</span><span class="fu">c</span>(<span class="fl">11.1</span>,<span class="fl">32.6</span>,<span class="fl">63.3</span>,<span class="fl">15.3</span>,<span class="fl">40.8</span>,<span class="fl">65.0</span>,<span class="fl">22.7</span>,<span class="fl">52.1</span>,<span class="fl">58.8</span>,<span class="fl">23.8</span>,<span class="fl">52.8</span>,<span class="fl">61.4</span>,<span class="fl">25.6</span>,<span class="fl">63.1</span>,<span class="fl">41.1</span>,<span class="fl">31.2</span>,<span class="fl">59.5</span>,<span class="fl">78.1</span>,<span class="fl">25.8</span>,<span class="fl">55.3</span>,<span class="fl">60.2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">mean</span>(treatment)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.74286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>treatment<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(treatment,<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(treatment)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"sandy loams(I)"</span>, <span class="st">"sandy clay loam(II)"</span>, <span class="st">"loamy sand(III)"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(treatment)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"None"</span>,<span class="st">"Coarse slag"</span>,<span class="st">"Mediaum slag"</span>,<span class="st">"Agricultural slag"</span>,<span class="st">"Agricultural limestone"</span>,<span class="st">"Agricultural slag + minor limestone"</span>,<span class="st">"Agricultural limestone + minor elements"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>treatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sandy loams(I) sandy clay loam(II)
None                                              11.1                32.6
Coarse slag                                       15.3                40.8
Mediaum slag                                      22.7                52.1
Agricultural slag                                 23.8                52.8
Agricultural limestone                            25.6                63.1
Agricultural slag + minor limestone               31.2                59.5
Agricultural limestone + minor elements           25.8                55.3
                                        loamy sand(III)
None                                               63.3
Coarse slag                                        65.0
Mediaum slag                                       58.8
Agricultural slag                                  61.4
Agricultural limestone                             41.1
Agricultural slag + minor limestone                78.1
Agricultural limestone + minor elements            60.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>treatment_polished<span class="ot">=</span><span class="fu">medpolish</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 109.3
2: 84.6
Final: 84.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>treatment_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "treatment")

Overall: 52.8

Row Effects:
                                   None                             Coarse slag 
                                  -13.4                                    -9.2 
                           Mediaum slag                       Agricultural slag 
                                   -1.8                                     0.0 
                 Agricultural limestone     Agricultural slag + minor limestone 
                                    1.1                                     6.7 
Agricultural limestone + minor elements 
                                    1.3 

Column Effects:
     sandy loams(I) sandy clay loam(II)     loamy sand(III) 
              -28.3                 0.0                 8.6 

Residuals:
                                        sandy loams(I) sandy clay loam(II)
None                                               0.0                -6.8
Coarse slag                                        0.0                -2.8
Mediaum slag                                       0.0                 1.1
Agricultural slag                                 -0.7                 0.0
Agricultural limestone                             0.0                 9.2
Agricultural slag + minor limestone                0.0                 0.0
Agricultural limestone + minor elements            0.0                 1.2
                                        loamy sand(III)
None                                               15.3
Coarse slag                                        12.8
Mediaum slag                                       -0.8
Agricultural slag                                   0.0
Agricultural limestone                            -21.4
Agricultural slag + minor limestone                10.0
Agricultural limestone + minor elements            -2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># medpolish()를 이용하여 중간값 다듬기를 진행하였는데 maxiter=1일 때는 수렴하지 않았다는 경고 메시지를 확인할 수 있었고 maxiter를 설정하지 않고 분석한 결과 maxiter=2에서 결과 값이 나오는 것을 확인하였다.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(treatment_polished)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0의 값들이 상당히 많은 것이 확인되고 있다. 0 라인 밖에 있는 점들은 딱 6개만 확인되고 있기 때문에 따로 선을 그리기가 어렵다.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(treatment_polished)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">10</span>) <span class="co"># 적절하지 않다. </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">10</span>) <span class="co"># 적절하지 않다. </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">as.vector</span>(treatment_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.vector</span>(<span class="fu">outer</span>(treatment_polished<span class="sc">$</span>row,treatment_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>treatment_polished<span class="sc">$</span>overall)),<span class="at">col=</span><span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">as.vector</span>(treatment_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.vector</span>(<span class="fu">outer</span>(treatment_polished<span class="sc">$</span>row,treatment_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>treatment_polished<span class="sc">$</span>overall))[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                                                                                     (Intercept) 
                                                                                       0.8341529 
as.vector(outer(treatment_polished$row, treatment_polished$col, "*")/treatment_polished$overall) 
                                                                                      -0.5110273 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기울기 -0.5110이므로 1과는 다르다. (log 변환의 필요성이 떨어진다.)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 직선을 그리기가 어렵다. (경향성이 따로 보이지는 않아보인다.)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot에서 어떠한 의미있는 패턴이 나타나지 않기 때문에 변환이 요구되지 않는 것으로 보인다.</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(treatment_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual 값을 가지고 boxplot을 그려보았는데 sandy loams에는 outlier 1개, sandy clay loam에는 outlier 2개, loamy sand에는 outlier 1개이다.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 행 효과 크기 순으로 재정렬한 잔차표</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(treatment_polished<span class="sc">$</span>residuals[<span class="fu">order</span>(treatment_polished<span class="sc">$</span>row),],<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sandy loams(I) sandy clay loam(II)
None                                               0.0                -6.8
Coarse slag                                        0.0                -2.8
Mediaum slag                                       0.0                 1.1
Agricultural slag                                 -0.7                 0.0
Agricultural limestone                             0.0                 9.2
Agricultural limestone + minor elements            0.0                 1.2
Agricultural slag + minor limestone                0.0                 0.0
                                        loamy sand(III)
None                                               15.3
Coarse slag                                        12.8
Mediaum slag                                       -0.8
Agricultural slag                                   0.0
Agricultural limestone                            -21.4
Agricultural limestone + minor elements            -2.5
Agricultural slag + minor limestone                10.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Decomposition</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>decomposed<span class="ot">=</span>(treatment_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(treatment_polished<span class="sc">$</span>row,treatment_polished<span class="sc">$</span>col, <span class="st">"+"</span>) <span class="sc">+</span> treatment_polished<span class="sc">$</span>residuals)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">round</span>(decomposed,<span class="dv">1</span>)<span class="sc">==</span>treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가법성 모형이 확인되어지고 있다.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison Values</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">outer</span>(treatment_polished<span class="sc">$</span>row,treatment_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>treatment_polished<span class="sc">$</span>overall,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sandy loams(I) sandy clay loam(II)
None                                              7.18                   0
Coarse slag                                       4.93                   0
Mediaum slag                                      0.96                   0
Agricultural slag                                 0.00                   0
Agricultural limestone                           -0.59                   0
Agricultural slag + minor limestone              -3.59                   0
Agricultural limestone + minor elements          -0.70                   0
                                        loamy sand(III)
None                                              -2.18
Coarse slag                                       -1.50
Mediaum slag                                      -0.29
Agricultural slag                                  0.00
Agricultural limestone                             0.18
Agricultural slag + minor limestone                1.09
Agricultural limestone + minor elements            0.21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison value 기준으로 0값이 총 9개 확인됨. 그런데 더 많은 값들이 Additivity Plot의 x축과 y축 근처에 존재하는 것으로 보아 몇몇 피팅에서 벗어난 값을 제외하면 대부분 0근처에서 존재하고 있는 것이 확인된다. </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 필요 없지만 그려서 확인하기</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Log 변환 모형과 비교해보기</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>treatment_polished2<span class="ot">=</span><span class="fu">medpolish</span>(<span class="fu">log</span>(treatment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 2.631752
2: 2.157306
Final: 2.157306</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>treatment_polished2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "log(treatment)")

Overall: 3.966511

Row Effects:
                                   None                             Coarse slag 
                            -0.48219890                             -0.25782911 
                           Mediaum slag                       Agricultural slag 
                            -0.04326798                              0.00000000 
                 Agricultural limestone     Agricultural slag + minor limestone 
                             0.07290677                              0.24058022 
Agricultural limestone + minor elements 
                             0.04626172 

Column Effects:
     sandy loams(I) sandy clay loam(II)     loamy sand(III) 
         -0.7968256           0.0000000           0.1508986 

Residuals:
                                        sandy loams(I) sandy clay loam(II)
None                                        -0.2805416            0.000000
Coarse slag                                 -0.1840036            0.000000
Mediaum slag                                -0.0040527            0.029922
Agricultural slag                            0.0000000            0.000000
Agricultural limestone                       0.0000000            0.105303
Agricultural slag + minor limestone          0.0301523           -0.121115
Agricultural limestone + minor elements      0.0344272            0.000000
                                        loamy sand(III)
None                                           0.512674
Coarse slag                                    0.314807
Mediaum slag                                   0.000000
Agricultural slag                              0.000000
Agricultural limestone                        -0.474308
Agricultural slag + minor limestone            0.000000
Agricultural limestone + minor elements       -0.065999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(treatment_polished2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outer</span>(treatment_polished2<span class="sc">$</span>row,treatment_polished2<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>treatment_polished2<span class="sc">$</span>overall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sandy loams(I) sandy clay loam(II)
None                                       0.096868108                   0
Coarse slag                                0.051794846                   0
Mediaum slag                               0.008692030                   0
Agricultural slag                          0.000000000                   0
Agricultural limestone                    -0.014646116                   0
Agricultural slag + minor limestone       -0.048329747                   0
Agricultural limestone + minor elements   -0.009293437                   0
                                        loamy sand(III)
None                                       -0.018344373
Coarse slag                                -0.009808636
Mediaum slag                               -0.001646051
Agricultural slag                           0.000000000
Agricultural limestone                      0.002773604
Agricultural slag + minor limestone         0.009152433
Agricultural limestone + minor elements     0.001759942</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log 변환 이전과 이후의 Residual 값들을 비교하였을 때 한개 값을 제외하면 변환이전의 값들이 더 0 근처에 모여있다는 점에서 변환 이전의 데이터를 사용하고자 한다.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(treatment_polished<span class="sc">$</span>residuals);<span class="fu">stem</span>(treatment_polished2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

  -2 | 1
  -1 | 
  -0 | 73311
   0 | 000000000119
   1 | 035</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  -4 | 7
  -2 | 8
  -0 | 8270
   0 | 0000000003331
   2 | 1
   4 | 1</code></pre>
</div>
</div>
<p>Raw Data를 활용하여 Column Effect(토양)와 Row Effect(고로 슬랙)를 시각화해보고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(treatment_polished<span class="sc">$</span>row, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">15</span>), <span class="at">main=</span><span class="st">"Agriculutre Slag의 효과"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>treatment_polished<span class="sc">$</span>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   None                             Coarse slag 
                                  -13.4                                    -9.2 
                           Mediaum slag                       Agricultural slag 
                                   -1.8                                     0.0 
                 Agricultural limestone     Agricultural slag + minor limestone 
                                    1.1                                     6.7 
Agricultural limestone + minor elements 
                                    1.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(treatment_polished<span class="sc">$</span>col, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">10</span>) , <span class="at">main=</span><span class="st">"Soil의 효과"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>treatment_polished<span class="sc">$</span>col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sandy loams(I) sandy clay loam(II)     loamy sand(III) 
              -28.3                 0.0                 8.6 </code></pre>
</div>
</div>
<p>먼저, Row Effect에 대해서 분석해보고자 한다. 6가지의 처치 중 Agricultural slag + minor limestone이 6.7으로 가장 효과적인 것으로 보이며, Coarce Slag이 덜 효과적인 것이 확인된다. 나머지 처리들도 전부 토양 중성화에 어느정도 효과적인 것으로 보인다. y축의 단위가 무엇인지 정확히 알 수 없기에 단순히 중화수준이 높게 나온다고 좋다고 말할 수는 없지만 (왜냐하면 토양 산도는 너무 높아져도 너무 낮아져도 안되고 적정수준을 유지해야하기 때문이다.) 중화작업엔 Agricultural slag + minor limestone이 효과적인 것으로 보인다. 다음은 Column Effect에 대해서 분석해보고자 한다. 3가지 토양 종류 중 loamy sand에서 중화 효과가 가장 좋고,sandy loams의 중화효과는 나쁘게 나타난다. 위에서 언급하였듯이 결과변수의 단위가 정확히 무엇인지 언급되어있지 않기 때문에 단순히 loamy sand가 sandy loams에 비해서 더 좋다고 이야기 하기 힘들다. 하지만 토양 중성화가 강하게 요구되는 작물의 경우 loamy sand에서 키우는 것이 가장 효과적일 것으로 보인다. 토양효과가 가장 적은 sangy clay loam에서 각 treatment들의 효과를 비교하면 더 잘 드러나게 될 것으로 보인다.</p>
<p>각 Soil을 묶어서 보았을 때에는 Agricultural slag + minor limestone이 중화효과가 가장 높게 나타났지만, Sandy loams에서는 Agricultural slag + minor limestone을 사용하더라도 중화효과가 거의 나타나지 않을 수도 있다. 또한 loamy sand의 중화효과가 가장 높게 나타났음에도 불구하고 Agricultural limestone을 사용할 경우에 중화효과에 부정적인 영향을 줄 수 있다는 것을 확인하는 것이 필요하다. 따라서, 자신의 작물을 키우는 Soil에 적합한 slag을 선택하는 것이 최적의 중화효과를 달성하는데 있어서 가장 적절할 것으로 보인다.<br>
우선, 자신의 농장이 Sandy Loams일 경우 Agricultural Slag을 사용해서는 안되고, Slag을 사용하였을 때 사용하지 않았을 때에 비해 중화효과는 큰 차이가 없을 것이다. 자신의 농장이 Sandy Clay Loams일 경우 Agricultural limestone이 가장 효과적이다. 자신의 농장이 Loamy sand일 경우 Agricultural limestone은 중화에 부정적인 영향을 미칠 뿐만 아니라 아무런 처치를 하지 않았을 때 중화효과가 가장 높게 나타난다. 따라서, Slag의 Treatment는 자신의 농장이 sandy clay loams토양으로 이루어져 있을 때에만 agricultural limestone 위주로 사용하는 것이 좋고 나머지 토양에서는 treatment가 효과가 없거나 부정적인 효과를 보일 수 있으므로 사용하지 않는 것이 바람직 할 것으로 보인다.</p>
</section>
<section id="번-1" class="level1">
<h1>2번</h1>
<p>교과서 7.4절 버클리 대학교 대학원 지원자 자료의 분석 내용을 그대로 따라 실행하고 분석하여라. (본인이 책을 읽고 이해한 후 책을 덮고 이해한 분석 내용을 본인의 문자으로 적어 내면 됨. 거의 똑같아도 됨.) 인터넷에서 심프슨의 역설에 대한 예를 세 개 찾아보아라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UCBAdmissions) <span class="co"># 3차원 배열</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>adm<span class="ot">=</span>UCBAdmissions</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>adm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , Dept = A

          Gender
Admit      Male Female
  Admitted  512     89
  Rejected  313     19

, , Dept = B

          Gender
Admit      Male Female
  Admitted  353     17
  Rejected  207      8

, , Dept = C

          Gender
Admit      Male Female
  Admitted  120    202
  Rejected  205    391

, , Dept = D

          Gender
Admit      Male Female
  Admitted  138    131
  Rejected  279    244

, , Dept = E

          Gender
Admit      Male Female
  Admitted   53     94
  Rejected  138    299

, , Dept = F

          Gender
Admit      Male Female
  Admitted   22     24
  Rejected  351    317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#결측치 확인</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(adm) <span class="co"># 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , Dept = A

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE

, , Dept = B

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE

, , Dept = C

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE

, , Dept = D

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE

, , Dept = E

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE

, , Dept = F

          Gender
Admit       Male Female
  Admitted FALSE  FALSE
  Rejected FALSE  FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(Tab1<span class="ot">&lt;-</span>adm[<span class="dv">1</span>,,]) <span class="co"># Admitted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Dept
Gender     A   B   C   D   E   F
  Male   512 353 120 138  53  22
  Female  89  17 202 131  94  24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(Tab2<span class="ot">&lt;-</span>adm[<span class="dv">2</span>,,]) <span class="co"># Rejected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Dept
Gender     A   B   C   D   E   F
  Male   313 207 205 279 138 351
  Female  19   8 391 244 299 317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Tab=</span>Tab1<span class="sc">+</span>Tab2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Dept
Gender     A   B   C   D   E   F
  Male   825 560 325 417 191 373
  Female 108  25 593 375 393 341</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Tab3<span class="ot">=</span><span class="fu">addmargins</span>(Tab)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List 다루기 힘들어서 변환</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>Tab<span class="ot">=</span><span class="fu">matrix</span>(Tab,<span class="at">byrow=</span>F,<span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Tab)<span class="ot">=</span><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Tab)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>Tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         A   B   C   D   E   F
Male   825 560 325 417 191 373
Female 108  25 593 375 393 341</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 학과별 남여 지원 비율 비교</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pTab<span class="ot">=</span><span class="fu">prop.table</span>(Tab,<span class="dv">2</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>pTab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               A          B         C         D         E        F
Male   0.8842444 0.95726496 0.3540305 0.5265152 0.3270548 0.522409
Female 0.1157556 0.04273504 0.6459695 0.4734848 0.6729452 0.477591</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(Tab,<span class="at">legend=</span><span class="fu">rownames</span>(Tab),<span class="at">ylab=</span><span class="st">"count"</span>,<span class="at">main=</span><span class="st">"All Applicants w/ exact per dpt"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"skyblue"</span>,<span class="st">"hotpink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pTab<span class="sc">*</span><span class="dv">100</span>,<span class="at">legend=</span><span class="fu">rownames</span>(Tab),<span class="at">ylab=</span><span class="st">"%"</span>,<span class="at">main=</span><span class="st">"All Applicants w/ proportional per dpt"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"skyblue"</span>,<span class="st">"hotpink"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ghibli)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>ghibli_palettes<span class="sc">$</span>MarnieLight1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;colors&gt;
#95918EFF #AF9699FF #80C7C9FF #8EBBD2FF #E3D1C3FF #B3DDEBFF #F3E8CCFF </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 성별 학과 지원 비율 비교</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pTab2<span class="ot">=</span><span class="fu">prop.table</span>(Tab,<span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>pTab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                A          B         C         D          E         F
Male   0.30657748 0.20810108 0.1207729 0.1549610 0.07097733 0.1386102
Female 0.05885559 0.01362398 0.3231608 0.2043597 0.21416894 0.1858311</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(Tab),<span class="at">beside=</span>T,<span class="at">legend=</span><span class="fu">colnames</span>(Tab),<span class="at">ylab=</span><span class="st">"count"</span>,<span class="at">main=</span><span class="st">"All Applicants w/ exact per sex"</span>,<span class="at">col=</span>ghibli_palettes<span class="sc">$</span>MarnieLight1[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(pTab2)<span class="sc">*</span><span class="dv">100</span>,<span class="at">beside=</span>T,<span class="at">legend=</span><span class="fu">colnames</span>(Tab),<span class="at">ylab=</span><span class="st">"%"</span>,<span class="at">main=</span><span class="st">"All Applicants w/ proportional per sex"</span>,<span class="at">col=</span>ghibli_palettes<span class="sc">$</span>MarnieLight1[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 남성들의 경우 A과나 B과에 50% 이상 배정되어 있는 것에 비해 여성들의 경우 대부분(90%) C,D,E,F과에 재학중인 것이 확인된다.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 성별 합격률 비교</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>Tab.M<span class="ot">&lt;-</span>adm[,<span class="dv">1</span>,]</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>Tab.M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Dept
Admit        A   B   C   D   E   F
  Admitted 512 353 120 138  53  22
  Rejected 313 207 205 279 138 351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Tab.F<span class="ot">&lt;-</span>adm[,<span class="dv">2</span>,]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Tab.F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Dept
Admit        A   B   C   D   E   F
  Admitted  89  17 202 131  94  24
  Rejected  19   8 391 244 299 317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Tab.M=</span><span class="fu">matrix</span>(Tab.M,<span class="at">byrow=</span>F,<span class="at">ncol=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]  512  353  120  138   53   22
[2,]  313  207  205  279  138  351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Tab.M)<span class="ot">=</span><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Tab.M)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Admitted"</span>,<span class="st">"Rejected"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>Tab.M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           A   B   C   D   E   F
Admitted 512 353 120 138  53  22
Rejected 313 207 205 279 138 351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>p.Tab.M<span class="ot">=</span><span class="fu">prop.table</span>(Tab.M,<span class="dv">2</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(p.Tab.M<span class="sc">*</span><span class="dv">100</span>,<span class="at">legend=</span><span class="fu">rownames</span>(Tab.M),<span class="at">ylab=</span><span class="st">"%"</span>,<span class="at">main=</span><span class="st">"Male Admission"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"skyblue"</span>,<span class="st">"hotpink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Tab.M<span class="ot">=</span><span class="fu">cbind</span>(Tab.M,<span class="fu">apply</span>(Tab.M,<span class="dv">1</span>,sum))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>Tab.M<span class="ot">=</span><span class="fu">rbind</span>(Tab.M,<span class="fu">apply</span>(Tab.M,<span class="dv">2</span>,sum))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>Tab.M[<span class="dv">1</span>,<span class="dv">7</span>]<span class="sc">/</span>Tab.M[<span class="dv">3</span>,<span class="dv">7</span>] <span class="co">#전체합격률</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4451877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Tab.M<span class="ot">=</span><span class="fu">rbind</span>(Tab.M,<span class="fu">round</span>((Tab.M[<span class="dv">1</span>,]<span class="sc">/</span>Tab.M[<span class="dv">3</span>,])<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)) <span class="co"># 마지막줄 과별 합격률 %</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>Tab.M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              A      B      C      D      E     F        
Admitted 512.00 353.00 120.00 138.00  53.00  22.0 1198.00
Rejected 313.00 207.00 205.00 279.00 138.00 351.0 1493.00
         825.00 560.00 325.00 417.00 191.00 373.0 2691.00
          62.06  63.04  36.92  33.09  27.75   5.9   44.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Tab.F=</span><span class="fu">matrix</span>(Tab.F,<span class="at">byrow=</span>F,<span class="at">ncol=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]   89   17  202  131   94   24
[2,]   19    8  391  244  299  317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Tab.F)<span class="ot">=</span><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Tab.F)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Admitted"</span>,<span class="st">"Rejected"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Tab.F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          A  B   C   D   E   F
Admitted 89 17 202 131  94  24
Rejected 19  8 391 244 299 317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>p.Tab.F<span class="ot">=</span><span class="fu">prop.table</span>(Tab.F,<span class="dv">2</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(p.Tab.F<span class="sc">*</span><span class="dv">100</span>,<span class="at">legend=</span><span class="fu">rownames</span>(Tab.F),<span class="at">ylab=</span><span class="st">"%"</span>,<span class="at">main=</span><span class="st">"Female Admission"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"skyblue"</span>,<span class="st">"hotpink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>Tab.F<span class="ot">=</span><span class="fu">cbind</span>(Tab.F,<span class="fu">apply</span>(Tab.F,<span class="dv">1</span>,sum))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>Tab.F<span class="ot">=</span><span class="fu">rbind</span>(Tab.F,<span class="fu">apply</span>(Tab.F,<span class="dv">2</span>,sum))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>Tab.F[<span class="dv">1</span>,<span class="dv">7</span>]<span class="sc">/</span>Tab.F[<span class="dv">3</span>,<span class="dv">7</span>] <span class="co">#전체합격률</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3035422</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Tab.F<span class="ot">=</span><span class="fu">rbind</span>(Tab.F,<span class="fu">round</span>((Tab.F[<span class="dv">1</span>,]<span class="sc">/</span>Tab.F[<span class="dv">3</span>,])<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)) <span class="co"># 마지막줄 과별 합격률 %</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>Tab.F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              A  B      C      D      E      F        
Admitted  89.00 17 202.00 131.00  94.00  24.00  557.00
Rejected  19.00  8 391.00 244.00 299.00 317.00 1278.00
         108.00 25 593.00 375.00 393.00 341.00 1835.00
          82.41 68  34.06  34.93  23.92   7.04   30.35</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#전체 합격률에서는 남자가 높은 것이 확인되어지지만, 학과별로 보았을 때에는 여자의 합격률이 다소 높은 것이 확인되어 진다.</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#심프슨의 역설</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 부분에 대한 평균이 크다고 해서 전체에 대한 평균까지 크지는 않다는 의미이다. 영국의 통계학자 에드워드 심슨이 정리한 역설로(심프슨의 역설이라고도 한다) 각각의 변수에 신경 쓰지 않고 전체 통계 결과를 유추하다 일어나는 오류이다.</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 계량경제학에서 자주 사용되는 개념인 내생성!</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 모자이크 플롯</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Dept<span class="sc">+</span>Gender,<span class="at">data=</span>adm,<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">main=</span><span class="st">"Dept, Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Gender<span class="sc">+</span>Dept,<span class="at">data=</span>adm,<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">main=</span><span class="st">"Gender, Dept"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 성비가 학과별로 유의미하게 다른 것이 확인되어 진다.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 모자이크 플롯</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Dept<span class="sc">+</span>Admit,<span class="at">data=</span>adm[,<span class="dv">1</span>,],<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">main=</span><span class="st">"Male, Admit~Dept"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Dept<span class="sc">+</span>Admit,<span class="at">data=</span>adm[,<span class="dv">2</span>,],<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">main=</span><span class="st">"Female, Admit~Dept"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 학과별로 합격률이 매우 다르다. A에서 F로 갈 수록 합격률이 급격하게 감소하고 있는 것이 확인되어진다.</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 모자이크 플롯</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Dept<span class="sc">+</span>Admit<span class="sc">+</span>Gender,<span class="at">data=</span>adm,<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">main=</span><span class="st">"Admit, Dept, Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 학과 내에서는 성별로 합격률 차이가 거의 나지 않는다.</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Admit<span class="sc">+</span>Gender,<span class="at">data=</span>adm,<span class="at">color=</span>ghibli_palettes<span class="sc">$</span>MononokeLight[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">main=</span><span class="st">"Admit,Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-7-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 그럼에도 불구하고 합격여부에 관해서 성 차이가 있는 것처럼 착시현상을 보인다.</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 이러한 착시현상이 발생하는 이유는 여성들의 이공계 기피에 의해 발생한다. (각 학과별로는 그렇지 않은데 전체로는 합격률이 낮은 것 처럼 보임)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="심프슨-역설의-예시" class="level2">
<h2 class="anchored" data-anchor-id="심프슨-역설의-예시">심프슨 역설의 예시</h2>
<ol type="1">
<li><p>미국 중위소득의 감소 https://economix.blogs.nytimes.com/2013/05/01/can-every-group-be-worse-than-average-yes/ 2000년 이래로 미국의 중위소득은 인플레이션을 고려하더라도 1%만큼 증가한 것이 확인된다. 그러나, 고등학교 중퇴자 집단, 고등학교 졸업자 집단, 전문대학 졸업자 집단 그리고 4년제 대학 졸업자 및 대학원 졸업자 집단의 소득은 모두 감소하였다. (모든 교육 하위집단에서 중위소득은 2000년도보다 낮은 수준으로 확인되어진다.) 그러한 요인이 발생한 이유는 교육수준에 따른 하위집단에 속하는 인구 비율이 달라졌기 때문이다. (2000년 이래로 13년동안 대학교 졸업자수는 더 낮은 교육을 받은 사람들에 비해서 더 많이 증가했지만, 그들의 임금은 종합적으로 보았을 때 1.2%정도 훨씬 더 천천히 감소하였기 때문이다. ) 전체적인 관점에서는 임금이 증가하였다는 결론을 낼 수 있지만, 개인의 관점에서는 임금이 오히려 감소하였다고 보는 것이 가능하다.</p></li>
<li><p>벨기에의 COVID-19 사망률 (성별, 나이)</p></li>
</ol>
<p>https://link.springer.com/article/10.1007/s11192-020-03830-w https://www.medrxiv.org/content/10.1101/2020.06.20.20136234v2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>belgium<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.02</span>,<span class="fl">0.01</span>,<span class="fl">0.29</span>,<span class="fl">0.14</span>,<span class="fl">2.92</span>,<span class="fl">1.61</span>,<span class="fl">5.56</span>,<span class="fl">3.35</span>,<span class="fl">13.20</span>,<span class="fl">11.07</span>,<span class="fl">1.18</span>,<span class="fl">1.31</span>),<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>bel<span class="ot">=</span><span class="fu">array</span>(belgium,<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">2</span>),<span class="at">dimnames=</span><span class="fu">list</span>(<span class="at">age=</span><span class="fu">c</span>(<span class="st">"0~24"</span>,<span class="st">"25~44"</span>,<span class="st">"45~64"</span>,<span class="st">"65~74"</span>,<span class="st">"75~84"</span>,<span class="st">"85 and older"</span>,<span class="st">"All Ages"</span>),<span class="at">gender=</span><span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>)))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>bel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              gender
age             Male Female
  0~24          0.00   0.00
  25~44         0.02   0.01
  45~64         0.29   0.14
  65~74         2.92   1.61
  75~84         5.56   3.35
  85 and older 13.20  11.07
  All Ages      1.18   1.31</code></pre>
</div>
</div>
<p>R.R.’s local Flemish newspaper, De Standaard에서 2020년 6월 기사 인용. 모든 나이 Group들에서 남성의 COVID-19 감염 후 사망률이 높게 측정되고 있음에도 불구하고 전체 인구를 고려하였을 때 여성의 COVID-19 감염 후 사망률이 오히려 높게 나타나는 결과로 이어짐. 이러한 결과가 나타나는 인구는 벨기에에서는 남자노인들보다 여자 노인들이 훨신 더 많기 때문임으로 보인다.</p>
<ol start="3" type="1">
<li>Titanic Dataset</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Titanic</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>tdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Titanic)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>Tita <span class="ot">&lt;-</span> tdf[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tdf), tdf<span class="sc">$</span>Freq), <span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">dcast</span>(Tita,Class<span class="sc">~</span>Survived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using Survived as value column: use value.var to override.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Aggregation function missing: defaulting to length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>A<span class="sc">$</span><span class="st">"prop(%)"</span><span class="ot">=</span><span class="fu">round</span>(A<span class="sc">$</span>Yes<span class="sc">/</span>(A<span class="sc">$</span>No<span class="sc">+</span>A<span class="sc">$</span>Yes),<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Class  No Yes prop(%)
1   1st 122 203   62.46
2   2nd 167 118   41.40
3   3rd 528 178   25.21
4  Crew 673 212   23.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>B<span class="ot">=</span><span class="fu">dcast</span>(Tita,Class<span class="sc">~</span>Survived<span class="sc">+</span>Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using Survived as value column: use value.var to override.
Aggregation function missing: defaulting to length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span><span class="st">"Maleprop(%)"</span><span class="ot">=</span><span class="fu">round</span>(B<span class="sc">$</span>Yes_Male<span class="sc">/</span>(B<span class="sc">$</span>Yes_Male<span class="sc">+</span>B<span class="sc">$</span>No_Male),<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span><span class="st">"Femaleprop(%)"</span><span class="ot">=</span><span class="fu">round</span>(B<span class="sc">$</span>Yes_Female<span class="sc">/</span>(B<span class="sc">$</span>Yes_Female<span class="sc">+</span>B<span class="sc">$</span>No_Female),<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>Final<span class="ot">=</span>B[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Final)<span class="ot">=</span>A<span class="sc">$</span>Class</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>A;Final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Class  No Yes prop(%)
1   1st 122 203   62.46
2   2nd 167 118   41.40
3   3rd 528 178   25.21
4  Crew 673 212   23.95</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Yes_Male No_Male Maleprop(%) Yes_Female No_Female Femaleprop(%)
1st        62     118       34.44        141         4         97.24
2nd        25     154       13.97         93        13         87.74
3rd        88     422       17.25         90       106         45.92
Crew      192     670       22.27         20         3         86.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3등석과 선원들 비교 비교</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Class<span class="sc">+</span>Survived,Titanic,<span class="at">color=</span>T,<span class="at">main=</span><span class="st">"Class~Survived"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>Class<span class="sc">+</span>Survived<span class="sc">+</span>Sex,Titanic,<span class="at">color=</span>T,<span class="at">main=</span><span class="st">"Class~Survived Under Sex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>3등석과 선원들의 생존률을 비교해보자. 남성과 여성 모두 선원들이 3등석 승객들에 비해 생존확률이 높았음에도 불구하고 (남성 승객 17.25% &lt; 선원 22.27% , 여성 승객 45.92% &lt; 선원 86.96%) 성별에 상관없이 모든 데이터를 비교하였을 때 3등석 승객들의 생존확률이 선원들의 생존확률보다 높은 것으로 나타난다. (승객 25.21% &gt; 선원 23.95%) 이것의 요인으로는 내생변수 (숨겨진 변수)가 그러한 결과가 나타나는데 영향을 미쳤음을 확인할 수 있다. 3등석의 여성의 비율이 선원의 여성의 비율에 비해서 훨씬 높다는 것을 확인할 수 있다. 3등석 승객들과 선원들의 성비의 차이가 이러한 결과로 이어지게 되었음을 확인할 수 있다.</p>
</section>
</section>
<section id="번-2" class="level1">
<h1>3번</h1>
<p>[노부모 부양에 대한 태도 자료] 1988년 자료 (유인물 첨부 파일) 와 KOSIS 싸이트의 최근 자료를 비교하여 분석하라. KOSIS에서 여러 주제별 통계가 있는 데, 있을 만한 곳을 계속 찾아 들어간다. 나이별 부양책임 주체에 대한 부분만 분석한다.</p>
<ul>
<li>Median Polish와 barplot 병행</li>
<li>two-way plot 과 Coded plot 등 손으로 그려야 하는 부분은 오려 붙여 제출한다. 제출하고, YSCEC에 올리는 파일에는 이 부분이 빠져 있어도 된다.</li>
</ul>
<section id="년-과-최근-자료를-각각-분석한다." class="level2">
<h2 class="anchored" data-anchor-id="년-과-최근-자료를-각각-분석한다.">(1) 1988년 과 최근 자료를 각각 분석한다.</h2>
</section>
<section id="년-자료와-kosis-최근-자료의-범주가-약간-다른-점에-주의하면서-이들의-시간차약-30여년에-따른-태도의-변화를-서로-비교하여-분석한다." class="level2">
<h2 class="anchored" data-anchor-id="년-자료와-kosis-최근-자료의-범주가-약간-다른-점에-주의하면서-이들의-시간차약-30여년에-따른-태도의-변화를-서로-비교하여-분석한다.">(2) 1988년 자료와 KOSIS 최근 자료의 범주가 약간 다른 점에 주의하면서 이들의 시간차(약 30여년)에 따른 태도의 변화를 서로 비교하여 분석한다.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>pop1988<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">16.4</span>,<span class="fl">14.5</span>,<span class="fl">0.8</span>,<span class="fl">44.4</span>,<span class="fl">17.4</span>,<span class="fl">6.5</span>,<span class="fl">16.8</span>,<span class="fl">16.3</span>,<span class="fl">0.4</span>,<span class="fl">43.5</span>,<span class="fl">17.1</span>,<span class="fl">5.9</span>,<span class="fl">19.5</span>,<span class="fl">17.6</span>,<span class="fl">0.4</span>,<span class="fl">38.9</span>,<span class="fl">18.5</span>,<span class="fl">5.1</span>,<span class="fl">29.0</span>,<span class="fl">18.8</span>,<span class="fl">0.5</span>,<span class="fl">31.1</span>,<span class="fl">16.4</span>,<span class="fl">4.2</span>,<span class="fl">36.6</span>,<span class="fl">21.2</span>,<span class="fl">0.3</span>,<span class="fl">25.6</span>,<span class="fl">12.6</span>,<span class="fl">3.7</span>,<span class="fl">48.1</span>,<span class="fl">20.2</span>,<span class="fl">0.4</span>,<span class="fl">19.8</span>,<span class="fl">8.1</span>,<span class="fl">3.4</span>),<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>pop1988<span class="ot">=</span><span class="fu">as.data.frame</span>(pop1988)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pop1988)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"장남"</span>,<span class="st">"아들모두"</span>,<span class="st">"딸"</span>,<span class="st">"아들딸모두"</span>,<span class="st">"자립"</span>,<span class="st">"사회및기타"</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pop1988)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"15~19세"</span>,<span class="st">"20~29세"</span>,<span class="st">"30~39세"</span>,<span class="st">"40~49세"</span>,<span class="st">"50~59세"</span>,<span class="st">"60세이상"</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>pop1988</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         장남 아들모두  딸 아들딸모두 자립 사회및기타
15~19세  16.4     14.5 0.8       44.4 17.4        6.5
20~29세  16.8     16.3 0.4       43.5 17.1        5.9
30~39세  19.5     17.6 0.4       38.9 18.5        5.1
40~49세  29.0     18.8 0.5       31.1 16.4        4.2
50~59세  36.6     21.2 0.3       25.6 12.6        3.7
60세이상 48.1     20.2 0.4       19.8  8.1        3.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>pop2018<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                연령 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"13∼19세"</span>,<span class="st">"20∼29세"</span>,<span class="st">"30∼39세"</span>,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"40∼49세"</span>,<span class="st">"50∼59세"</span>,<span class="st">"60세이상"</span>),</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                자립 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">17.5</span>, <span class="fl">19.2</span>, <span class="fl">17.3</span>, <span class="fl">16.9</span>, <span class="fl">17.8</span>, <span class="dv">25</span>),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                장남 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">2.9</span>),</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>              아들모두 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>),</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                 딸 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>),</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>             모든_자녀 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">26.4</span>, <span class="dv">21</span>, <span class="fl">19.1</span>, <span class="dv">18</span>, <span class="fl">17.6</span>, <span class="fl">17.4</span>),</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                능력 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">3.9</span>, <span class="fl">4.7</span>, <span class="fl">4.6</span>, <span class="fl">4.4</span>, <span class="fl">4.7</span>, <span class="dv">6</span>),</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>            가족정부사회 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">45.8</span>, <span class="fl">49.5</span>, <span class="fl">52.4</span>, <span class="fl">53.1</span>, <span class="fl">51.7</span>, <span class="fl">38.8</span>),</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>              정부사회 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">4.2</span>, <span class="dv">4</span>, <span class="fl">4.7</span>, <span class="fl">5.5</span>, <span class="fl">5.9</span>, <span class="fl">7.9</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pop2018)<span class="ot">=</span>pop2018<span class="sc">$</span>연령</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>pop2018<span class="ot">=</span>pop2018[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>)]</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>pop2020<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>                        연령 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"15∼19세"</span>,</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"20∼29세"</span>,<span class="st">"30∼39세"</span>,<span class="st">"40∼49세"</span>,<span class="st">"50∼59세"</span>,<span class="st">"60세이상"</span>,</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"65세이상"</span>),</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>            부모_스스로 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">11.1</span>, <span class="fl">11.6</span>, <span class="fl">14.4</span>, <span class="dv">11</span>, <span class="fl">10.7</span>, <span class="dv">16</span>, <span class="dv">17</span>),</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>                가족 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">27.2</span>, <span class="fl">21.8</span>, <span class="fl">19.4</span>, <span class="fl">19.4</span>, <span class="fl">19.2</span>, <span class="dv">26</span>, <span class="fl">27.3</span>),</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>        가족정부사회가_함께 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">58.9</span>, <span class="fl">64.4</span>, <span class="fl">63.7</span>, <span class="fl">66.5</span>, <span class="fl">66.5</span>, <span class="fl">52.8</span>, <span class="fl">49.9</span>),</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>             정부_사회 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">2.7</span>, <span class="fl">2.2</span>, <span class="fl">2.5</span>, <span class="fl">3.1</span>, <span class="fl">3.6</span>, <span class="fl">5.2</span>, <span class="fl">5.8</span>),</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>                기타 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pop2020)<span class="ot">=</span><span class="fu">c</span>(pop2020<span class="sc">$</span>연령)</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>pop2020<span class="ot">=</span>pop2020[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)]</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>pop1988; pop2018; pop2020 <span class="co">#2010년도 데이터부터 65세 이상 데이터가 추가됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         장남 아들모두  딸 아들딸모두 자립 사회및기타
15~19세  16.4     14.5 0.8       44.4 17.4        6.5
20~29세  16.8     16.3 0.4       43.5 17.1        5.9
30~39세  19.5     17.6 0.4       38.9 18.5        5.1
40~49세  29.0     18.8 0.5       31.1 16.4        4.2
50~59세  36.6     21.2 0.3       25.6 12.6        3.7
60세이상 48.1     20.2 0.4       19.8  8.1        3.4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>         자립 장남 아들모두  딸 모든_자녀 능력 가족정부사회 정부사회
13∼19세 17.5  0.6      1.2 0.4      26.4  3.9         45.8      4.2
20∼29세 19.2  0.6      0.7 0.3      21.0  4.7         49.5      4.0
30∼39세 17.3  0.8      0.9 0.2      19.1  4.6         52.4      4.7
40∼49세 16.9  1.1      0.8 0.2      18.0  4.4         53.1      5.5
50∼59세 17.8  1.3      0.8 0.2      17.6  4.7         51.7      5.9
60세이상 25.0  2.9      1.6 0.4      17.4  6.0         38.8      7.9</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
15∼19세        11.1 27.2                58.9       2.7  0.1
20∼29세        11.6 21.8                64.4       2.2  0.0
30∼39세        14.4 19.4                63.7       2.5  0.0
40∼49세        11.0 19.4                66.5       3.1  0.0
50∼59세        10.7 19.2                66.5       3.6  0.0
60세이상        16.0 26.0                52.8       5.2  0.0
65세이상        17.0 27.3                49.9       5.8  0.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020년도의 경우 가족 형태가 바뀌면서 노인 부양을 담당하는 주체가 변경되어 column name들이 변경되어진 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>총 세개 시점의 데이터가 존재한다. 만약 그 데이터들이 가법적 모형을 따를경우 다음과 같은 모형으로 표현할 수 있을 것이다. y_ijk=μk+α_ik+β_jk+e_ijk ,e_ijk~(0,σ),i=(1,…,6) (row effect),j=(1,…,5 or 6 or 8)(column effect), k=(1,2,3) (Time)을 고려한다. 1988데이터는 row * col = 6<em>6 2010데이터는 row</em> col = 6<em>8 2020데이터는 row</em> col = 6*5 개의 효과를 가짐</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>pop1988_polished<span class="ot">=</span><span class="fu">medpolish</span>(pop1988)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 155.4
2: 144.8
Final: 144.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>pop1988_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "pop1988")

Overall: 17.45

Row Effects:
 15~19세  20~29세  30~39세  40~49세  50~59세 60세이상 
   0.525    0.175    0.125   -0.125   -0.625   -0.725 

Column Effects:
      장남   아들모두         딸 아들딸모두       자립 사회및기타 
      6.80       0.75     -17.00      17.55      -0.75     -12.80 

Residuals:
           장남 아들모두     딸 아들딸모두   자립 사회및기타
15~19세  -8.375   -4.225 -0.175      8.875  0.175      1.325
20~29세  -7.625   -2.075 -0.225      8.325  0.225      1.075
30~39세  -4.875   -0.725 -0.175      3.775  1.675      0.325
40~49세   4.875    0.725  0.175     -3.775 -0.175     -0.325
50~59세  12.975    3.625  0.475     -8.775 -3.475     -0.325
60세이상 24.575    2.725  0.675    -14.475 -7.875     -0.525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="ot">=</span><span class="fu">medpolish</span>(pop2018)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 63.8
2: 58.5
Final: 58.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="sc">$</span>residuals<span class="ot">=</span><span class="fu">round</span>(pop2018_polished<span class="sc">$</span>residuals,<span class="dv">5</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="sc">$</span>col<span class="ot">=</span><span class="fu">round</span>(pop2018_polished<span class="sc">$</span>col,<span class="dv">5</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="sc">$</span>row<span class="ot">=</span><span class="fu">round</span>(pop2018_polished<span class="sc">$</span>row,<span class="dv">5</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>pop2018_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "pop2018")

Overall: 4.85

Row Effects:
13∼19세 20∼29세 30∼39세 40∼49세 50∼59세 60세이상 
-0.36250  0.00000  0.00000  0.00000  0.06875  1.11250 

Column Effects:
        자립         장남     아들모두           딸    모든_자녀         능력 
    12.94688     -3.81875     -4.08438     -4.65000     13.70000     -0.23438 
가족정부사회     정부사회 
    45.71562      0.25000 

Residuals:
             자립     장남 아들모두       딸 모든_자녀     능력 가족정부사회
13∼19세  0.06562 -0.06875  0.79688  0.56250    8.2125 -0.35312      -4.4031
20∼29세  1.40312 -0.43125 -0.06562  0.10000    2.4500  0.08438      -1.0656
30∼39세 -0.49687 -0.23125  0.13438  0.00000    0.5500 -0.01562       1.8344
40∼49세 -0.89688  0.06875  0.03438  0.00000   -0.5500 -0.21562       2.5344
50∼59세 -0.06562  0.20000 -0.03438 -0.06875   -1.0188  0.01562       1.0656
60세이상  6.09063  0.75625 -0.27812 -0.91250   -2.2625  0.27187     -12.8781
         정부사회
13∼19세 -0.53750
20∼29세 -1.10000
30∼39세 -0.40000
40∼49세  0.40000
50∼59세  0.73125
60세이상  1.68750</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="ot">=</span><span class="fu">medpolish</span>(pop2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 86.5
2: 76
Final: 76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="sc">$</span>residuals<span class="ot">=</span><span class="fu">round</span>(pop2020_polished<span class="sc">$</span>residuals,<span class="dv">5</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="sc">$</span>col<span class="ot">=</span><span class="fu">round</span>(pop2020_polished<span class="sc">$</span>col,<span class="dv">5</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="sc">$</span>row<span class="ot">=</span><span class="fu">round</span>(pop2020_polished<span class="sc">$</span>row,<span class="dv">5</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>pop2020_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "pop2020")

Overall: 11.7

Row Effects:
15∼19세 20∼29세 30∼39세 40∼49세 50∼59세 60세이상 65세이상 
     0.0     -0.1      0.2     -0.1     -0.1      2.9      3.5 

Column Effects:
        부모_스스로                가족 가족정부사회가_함께           정부_사회 
                0.0                10.2                51.8                -9.4 
               기타 
              -11.6 

Residuals:
         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
15∼19세        -0.6  5.3                -4.6       0.4  0.0
20∼29세         0.0  0.0                 1.0       0.0  0.0
30∼39세         2.5 -2.7                 0.0       0.0 -0.3
40∼49세        -0.6 -2.4                 3.1       0.9  0.0
50∼59세        -0.9 -2.6                 3.1       1.4  0.0
60세이상         1.4  1.2               -13.6       0.0 -3.0
65세이상         1.8  1.9               -17.1       0.0 -3.6</code></pre>
</div>
</div>
<p>Median Polish의 시행과 이후 Tukey Additivity Plot &amp; 잔차 분석</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1988년</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop1988_polished)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#직선이 경향성을 정확히 보인다고 보기 어렵다.</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">as.vector</span>(pop1988_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop1988_polished<span class="sc">$</span>row,pop1988_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop1988_polished<span class="sc">$</span>overall)),<span class="at">col=</span><span class="st">"orange"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">as.vector</span>(pop1988_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop1988_polished<span class="sc">$</span>row,pop1988_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop1988_polished<span class="sc">$</span>overall))[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                                                                               (Intercept) 
                                                                                 0.2173017 
as.vector(outer(pop1988_polished$row, pop1988_polished$col, "*")/pop1988_polished$overall) 
                                                                                 2.8429224 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀 직선의 기울기가 2.8429224 이므로 1과 같다고 보기 어렵다.  따라서 로그 변환을 해서는 안된다.</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차의 Boxplot을 통해서 분석할 경우 </span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pop1988_polished<span class="sc">$</span>residuals) <span class="co">#Outlier는 보이지 않았다. 따라서 제거할 값은 보이지 않는다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 행 효과 크기 순으로 재정렬한 잔차표</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pop1988_polished<span class="sc">$</span>residuals[<span class="fu">order</span>(pop1988_polished<span class="sc">$</span>row),],<span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         장남 아들모두   딸 아들딸모두 자립 사회및기타
60세이상 24.6      2.7  0.7      -14.5 -7.9       -0.5
50~59세  13.0      3.6  0.5       -8.8 -3.5       -0.3
40~49세   4.9      0.7  0.2       -3.8 -0.2       -0.3
30~39세  -4.9     -0.7 -0.2        3.8  1.7        0.3
20~29세  -7.6     -2.1 -0.2        8.3  0.2        1.1
15~19세  -8.4     -4.2 -0.2        8.9  0.2        1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 나이가 많을수록 아들, 특히 장남이 부모님을 부양하고자 하는 경우가 많다. (60세이상의 집단의 잔차 24.6)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 나이가 적을수록 모든 자녀(아들,딸)이 부모님 부양을 분담하고자 하는 경향성이 나타난다.</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Decomposition</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>decomposed_88<span class="ot">=</span>(pop1988_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop1988_polished<span class="sc">$</span>row,pop1988_polished<span class="sc">$</span>col, <span class="st">"+"</span>) <span class="sc">+</span> pop1988_polished<span class="sc">$</span>residuals)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">round</span>(decomposed_88,<span class="dv">3</span>)<span class="sc">==</span>pop1988)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가법성 모형이 확인되어지고 있다.</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison Values</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">outer</span>(pop1988_polished<span class="sc">$</span>row,pop1988_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop1988_polished<span class="sc">$</span>overall,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          장남 아들모두    딸 아들딸모두  자립 사회및기타
15~19세   0.20     0.02 -0.51       0.53 -0.02      -0.39
20~29세   0.07     0.01 -0.17       0.18 -0.01      -0.13
30~39세   0.05     0.01 -0.12       0.13 -0.01      -0.09
40~49세  -0.05    -0.01  0.12      -0.13  0.01       0.09
50~59세  -0.24    -0.03  0.61      -0.63  0.03       0.46
60세이상 -0.28    -0.03  0.71      -0.73  0.03       0.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison value 기준으로 0 값이 확인되지는 않는다. 그러나 대다수는 0근처에 존재하고 있으므로 Fitting에서 많이 벗어나지 않았다.</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(pop1988_polished<span class="sc">$</span>residuals) <span class="co"># Gap이 있는 것을 제외하고는 전체적으로 대칭적으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

  -1 | 4
  -0 | 98885
  -0 | 443211000000
   0 | 0000011112344
   0 | 589
   1 | 3
   1 | 
   2 | 
   2 | 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2018년</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop2018_polished) </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#직선이 경향성을 정확히 보인다고 보기 어렵다.</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">as.vector</span>(pop2018_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop2018_polished<span class="sc">$</span>row,pop2018_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2018_polished<span class="sc">$</span>overall)),<span class="at">col=</span><span class="st">"orange"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">as.vector</span>(pop2018_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop2018_polished<span class="sc">$</span>row,pop2018_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2018_polished<span class="sc">$</span>overall))[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                                                                               (Intercept) 
                                                                                 0.2056009 
as.vector(outer(pop2018_polished$row, pop2018_polished$col, "*")/pop2018_polished$overall) 
                                                                                -0.8088495 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀 직선의 기울기가  -0.8088495 이므로 1과 같다고 보기 어렵다. 따라서 로그 변환을 해서는 안된다.</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차의 Boxplot을 통해서 분석할 경우 </span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pop2018_polished<span class="sc">$</span>residuals) <span class="co">#Residual들의 Outlier가 확인되어진다 (5개). 만약 제거된다면 Additivity plot이 어떻게 변할까?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>pop2018_polished2<span class="ot">=</span>pop2018_polished</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>pop2018_polished2<span class="sc">$</span>residuals[,<span class="dv">1</span>][<span class="dv">6</span>]<span class="ot">=</span><span class="fu">mean</span>(pop2018_polished<span class="sc">$</span>residuals[,<span class="dv">1</span>])</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>pop2018_polished2<span class="sc">$</span>residuals[,<span class="dv">3</span>][<span class="dv">1</span>]<span class="ot">=</span><span class="fu">mean</span>(pop2018_polished<span class="sc">$</span>residuals[,<span class="dv">3</span>])</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>pop2018_polished2<span class="sc">$</span>residuals[,<span class="dv">5</span>][<span class="dv">1</span>]<span class="ot">=</span><span class="fu">mean</span>(pop2018_polished<span class="sc">$</span>residuals[,<span class="dv">5</span>])</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pop2018_polished2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop2018_polished2)  <span class="co"># 경향성이 크게 바뀌지 않기 때문에 Raw Data 사용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 행 효과 크기 순으로 재정렬한 잔차표</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pop2018_polished<span class="sc">$</span>residuals[<span class="fu">order</span>(pop2018_polished<span class="sc">$</span>row),],<span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         자립 장남 아들모두   딸 모든_자녀 능력 가족정부사회 정부사회
13∼19세  0.1 -0.1      0.8  0.6       8.2 -0.4         -4.4     -0.5
20∼29세  1.4 -0.4     -0.1  0.1       2.5  0.1         -1.1     -1.1
30∼39세 -0.5 -0.2      0.1  0.0       0.6  0.0          1.8     -0.4
40∼49세 -0.9  0.1      0.0  0.0      -0.6 -0.2          2.5      0.4
50∼59세 -0.1  0.2      0.0 -0.1      -1.0  0.0          1.1      0.7
60세이상  6.1  0.8     -0.3 -0.9      -2.3  0.3        -12.9      1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 나이에 따른 경향성이 거의 나타나지 않는 것으로 보인다. </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Decomposition</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>decomposed_18<span class="ot">=</span>(pop2018_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop2018_polished<span class="sc">$</span>row,pop2018_polished<span class="sc">$</span>col, <span class="st">"+"</span>) <span class="sc">+</span> pop2018_polished<span class="sc">$</span>residuals)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">round</span>(decomposed_18,<span class="dv">2</span>)<span class="sc">==</span>pop2018)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가법성 모형이 확인되어지고 있다.</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison Values</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">outer</span>(pop2018_polished<span class="sc">$</span>row,pop2018_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2018_polished<span class="sc">$</span>overall,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          자립  장남 아들모두    딸 모든_자녀  능력 가족정부사회 정부사회
13∼19세 -0.97  0.29     0.31  0.35     -1.02  0.02        -3.42    -0.02
20∼29세  0.00  0.00     0.00  0.00      0.00  0.00         0.00     0.00
30∼39세  0.00  0.00     0.00  0.00      0.00  0.00         0.00     0.00
40∼49세  0.00  0.00     0.00  0.00      0.00  0.00         0.00     0.00
50∼59세  0.18 -0.05    -0.06 -0.07      0.19  0.00         0.65     0.00
60세이상  2.97 -0.88    -0.94 -1.07      3.14 -0.05        10.49     0.06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison value 기준으로 23개의 0이 발견됨. 대다수의 값들이 0근처에 존재하고 있으므로 Fitting에서 많이 벗어나지 않았다. </span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(pop2018_polished<span class="sc">$</span>residuals) <span class="co"># Gap이 있는데 이건 Boxplot을 통해 확인된 outlier들을 재확인해준다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is at the |

  -12 | 9
  -10 | 
   -8 | 
   -6 | 
   -4 | 4
   -2 | 3
   -0 | 11099655444322111100
    0 | 000011111234667881478
    2 | 55
    4 | 
    6 | 1
    8 | 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 대다수의 값들이 0 근처에 몰려있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020년</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop2020_polished) </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#직선이 경향성을 정확히 보인다고 보기 어렵다.</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">as.vector</span>(pop2020_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop2020_polished<span class="sc">$</span>row,pop2020_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2020_polished<span class="sc">$</span>overall)),<span class="at">col=</span><span class="st">"orange"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">as.vector</span>(pop2020_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.vector</span>(<span class="fu">outer</span>(pop2020_polished<span class="sc">$</span>row,pop2020_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2020_polished<span class="sc">$</span>overall))[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
                                                                               (Intercept) 
                                                                                -0.2362669 
as.vector(outer(pop2020_polished$row, pop2020_polished$col, "*")/pop2020_polished$overall) 
                                                                                -0.8937232 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀 직선의 기울기가 -0.9335803 이므로 1과 같다고 보기 어렵다. 따라서 로그 변환을 해서는 안된다.</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot으로 Outlier Check</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pop2020_polished<span class="sc">$</span>residuals)  <span class="co">#Outlier는 보이지 않았다. 따라서 제거할 값은 보이지 않는다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 행 효과 크기 순으로 재정렬한 잔차표</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pop2020_polished<span class="sc">$</span>residuals[<span class="fu">order</span>(pop2020_polished<span class="sc">$</span>row),],<span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
20∼29세         0.0  0.0                 1.0       0.0  0.0
40∼49세        -0.6 -2.4                 3.1       0.9  0.0
50∼59세        -0.9 -2.6                 3.1       1.4  0.0
15∼19세        -0.6  5.3                -4.6       0.4  0.0
30∼39세         2.5 -2.7                 0.0       0.0 -0.3
60세이상         1.4  1.2               -13.6       0.0 -3.0
65세이상         1.8  1.9               -17.1       0.0 -3.6</code></pre>
</div>
</div>
<p>60세 이상 집단과 30~39세 집단에서는 본인 스스로 부모님을 부양해야 한다고 생각하고 있는 것으로 보인다. 60대 집단의 경우 정부 사회 등 외부에 의존하기보다는 본인이 직접 노후 대비를 해야한다는 인식이 있는 것으로 보인다. 1988년 조사에서 노인 집단에서 장남이 부모 부양을 담당해야 한다고 생각했던 것에서 변화한 것으로 보인다. 반면 40대 50대는 가족정부사회와 함께 부모를 부양해야 한다는 인식이 많다. (본인이 직접 본인 부모의 노후 대비를 담당해야하는 상황이기 때문에 이러한 경향성이 나타나는 것으로 예측된다.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Decomposition</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>decomposed_20<span class="ot">=</span>(pop2020_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop2020_polished<span class="sc">$</span>row,pop2020_polished<span class="sc">$</span>col, <span class="st">"+"</span>) <span class="sc">+</span> pop2020_polished<span class="sc">$</span>residuals)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">round</span>(decomposed_20,<span class="dv">1</span>)<span class="sc">==</span>pop2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가법성 모형이 확인되어지고 있다.</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison Values</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">outer</span>(pop2020_polished<span class="sc">$</span>row,pop2020_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>pop2020_polished<span class="sc">$</span>overall,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로  가족 가족정부사회가_함께 정부_사회  기타
15∼19세           0  0.00                0.00      0.00  0.00
20∼29세           0 -0.09               -0.44      0.08  0.10
30∼39세           0  0.17                0.89     -0.16 -0.20
40∼49세           0 -0.09               -0.44      0.08  0.10
50∼59세           0 -0.09               -0.44      0.08  0.10
60세이상           0  2.53               12.84     -2.33 -2.88
65세이상           0  3.05               15.50     -2.81 -3.47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison value 기준으로 0값이 총 5개 확인됨. </span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 대다수의 값들이 Additivity Plot의 x축과 y축 근처에 존재하는 것으로 보아 몇몇 피팅에서 벗어난 값을 제외하면 대부분 0근처에서 존재하고 있는 것이 확인된다. </span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(pop2020_polished<span class="sc">$</span>residuals) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is at the |

  -16 | 1
  -14 | 
  -12 | 6
  -10 | 
   -8 | 
   -6 | 
   -4 | 6
   -2 | 60764
   -0 | 9663
    0 | 0000000000049024489
    2 | 511
    4 | 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gap이 있음에도 Boxplot 상으로는 Outlier는 보이지 않았다. 3~4개 값을 제외 하면 잔차들이 0근처에 잘 모여있는 것이 확인된다.</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co">#log 변환해서 경향성이 있는지 확인하기 (어느정도 y=x 경향성을 따르는 것이 아닐까?)</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>pop20202<span class="ot">=</span>pop2020</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>pop20202<span class="sc">$</span>기타<span class="ot">=</span><span class="fu">ifelse</span>(pop20202<span class="sc">$</span>기타<span class="sc">==</span><span class="dv">0</span>,<span class="fl">0.1</span>,pop20202<span class="sc">$</span>기타) <span class="co"># 책에서 사용하던 기법 활용 (log0은 존재하지 않기에)</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">medpolish</span>(<span class="fu">log</span>(pop20202))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 5.073833
2: 4.168534
Final: 4.168534</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(k<span class="sc">$</span>residuals) <span class="co">#Gap이 줄어들은 것은 사실이지만 아직도 존재함 &amp; 변환이전이후 둘다 대칭성은 차이 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  -5 | 3
  -4 | 30
  -3 | 
  -2 | 974
  -1 | 5
  -0 | 8653
   0 | 000000000001445689
   1 | 00
   2 | 228
   3 | 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(k<span class="sc">$</span>residuals) <span class="co">#원래 Oulier가 없었는데 변환이후 생기게 됨 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서 로그 변환을 하지 않고 원래 자료를 기준으로 그대로 분석할 예정임. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Raw Data를 활용하여 연도별 Column Effect(부양책임)와 Row Effect(나이)를 시각화해보고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1988</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect </span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop1988_polished<span class="sc">$</span>row, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">main=</span><span class="st">"나이_1988년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>pop1988_polished<span class="sc">$</span>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 15~19세  20~29세  30~39세  40~49세  50~59세 60세이상 
   0.525    0.175    0.125   -0.125   -0.625   -0.725 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop1988_polished<span class="sc">$</span>col, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">main=</span><span class="st">"부양유형_1988년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>pop1988_polished<span class="sc">$</span>col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      장남   아들모두         딸 아들딸모두       자립 사회및기타 
      6.80       0.75     -17.00      17.55      -0.75     -12.80 </code></pre>
</div>
</div>
<p>Row 젊은 사람들일 수록 부모님을 부양하는 것을 부담스럽지 않게 여기다가 나이를 먹음에 따라 직접 부담을 지게되면서 어려움을 느끼거나 타인에게 부양을 요구하는 것을 부담스럽게 여기는 것으로 보인다.</p>
<p>Column 1988년도에도 장남 또는 맏며느리인 경우 딸 또는 사위일 때에 비해 부모님 부양에 대해서 긍정적인 태도를 보였던 것으로 보인다.모든 자녀,아들과 딸이 그러한 부담을 분담하고자 하는 인식이 가장 많았다는 점에서 1988년에도 부모님 부양을 한 집안에서 책임지는 것은 쉽지 않았다는 것을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2018</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect </span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop2018_polished<span class="sc">$</span>row, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>), <span class="at">main=</span><span class="st">"나이_2018년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="sc">$</span>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13∼19세 20∼29세 30∼39세 40∼49세 50∼59세 60세이상 
-0.36250  0.00000  0.00000  0.00000  0.06875  1.11250 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop2018_polished<span class="sc">$</span>col, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">50</span>), <span class="at">main=</span><span class="st">"부양유형_2018년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>pop2018_polished<span class="sc">$</span>col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        자립         장남     아들모두           딸    모든_자녀         능력 
    12.94688     -3.81875     -4.08438     -4.65000     13.70000     -0.23438 
가족정부사회     정부사회 
    45.71562      0.25000 </code></pre>
</div>
</div>
<p>Row 1988년도와는 달리 2018년에는 15~19세의 경우 모든 연령대중에서 부모님 부양에 대한 인식이 가장 좋지 못한 것으로 확인된다. 나머지 나이대에서는 60대를 제외 하면 나이에 따른 인식에 대한 영향이 크게 나타나지 않는 것으로 보인다. 직접적으로 부양을 받는 세대인 은퇴를 앞둔 60대의 입장에서는 본인의 은퇴이후의 삶에 대한 고민이 반영되었기 때문에 부모부양에 대한 강한 인식을 보이고 있지만, 이외의 세대에서는 부양에 대한 인식이 그렇게 높지 않은 것이 확인되어 진다.</p>
<p>Column 남녀 평등 교육이 시작되면서 장남들이 부양을 전적으로 책임져야한다는 인식은 감소하게 된 것으로 보인다. 또한 여성들의 부모님 부양에 대한 부정적 인식도 다소 감소한 것으로 보인다. 설령 여유가 있더라도 한 사람이 모든 부양을 책임지라는 인식 보다는 자립하거나 자녀들이 분담하여 부모님을 부양하고자 하는 인식이 강해진 것을 확인할 수 있다. 정부와 사회의 외부집단에 부모님 부양을 전적으로 의존하기 보다는 가족이 일정정도는 기여하여야 한다는 인식이 높은 것으로 나타난다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect </span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop2020_polished<span class="sc">$</span>row, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>), <span class="at">main=</span><span class="st">"나이_2020년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="sc">$</span>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>15∼19세 20∼29세 30∼39세 40∼49세 50∼59세 60세이상 65세이상 
     0.0     -0.1      0.2     -0.1     -0.1      2.9      3.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pop2020_polished<span class="sc">$</span>col, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">60</span>), <span class="at">main=</span><span class="st">"부양유형_2020년"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>pop2020_polished<span class="sc">$</span>col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        부모_스스로                가족 가족정부사회가_함께           정부_사회 
                0.0                10.2                51.8                -9.4 
               기타 
              -11.6 </code></pre>
</div>
</div>
<p>Row 앞의 자료들과 엄밀한 비교가 하기 어려운 것이 Column의 항목들이 바뀌었기 때문이다. 2020년도 데이터는 가족에 의한 부양 항목들이 세분화되지 않았기 때문에 해석에 유의가 필요하다. 직접적으로 부양을 받는 세대인 은퇴를 앞둔 60대의 입장에서는 본인의 은퇴이후의 삶에 대한 고민이 반영되었기 때문에 부모부양에 대한 강한 인식을 보이고 있지만, 이외의 세대에서는 부양에 대한 인식이 그렇게 높지 않은 것이 확인되어 진다.</p>
<p>Column 단순히 가족 외부의 정부_사회적 제도에 의존 (-8.512)하려는 인식 보다는 가족 정부 사회가 함께(52.3) 부양에 대한 부담을 분담 해야 한다는 인식이 공유되어 있음이 확인되어 진다. 자립 혹은 가족에 대한 긍정적 인식은 적은데 한국사회의 경우 대부분의 노후자금이 토지에 묶여 있는 경우가 많고 자녀 교육 비용이 많이 지출되기 때문에 부모 스스로 부양을 하는 것이 쉽지 않다는 인식이 공유된 것으로 보인다.</p>
<section id="residual-analysis" class="level3">
<h3 class="anchored" data-anchor-id="residual-analysis">residual Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1988</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (..., no.readonly = FALSE) 
{
    .Pars.readonly &lt;- c("cin", "cra", "csi", "cxy", "din", "page")
    single &lt;- FALSE
    args &lt;- list(...)
    if (!length(args)) 
        args &lt;- as.list(if (no.readonly) 
            .Pars[-match(.Pars.readonly, .Pars)]
        else .Pars)
    else {
        if (all(unlist(lapply(args, is.character)))) 
            args &lt;- as.list(unlist(args))
        if (length(args) == 1) {
            if (is.list(args[[1L]]) || is.null(args[[1L]])) 
                args &lt;- args[[1L]]
            else if (is.null(names(args))) 
                single &lt;- TRUE
        }
    }
    value &lt;- .External2(C_par, args)
    if (single) 
        value &lt;- value[[1L]]
    if (!is.null(names(args))) 
        invisible(value)
    else value
}
&lt;bytecode: 0x000001f4940bb3e8&gt;
&lt;environment: namespace:graphics&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop1988_polished<span class="sc">$</span>residuals[i,],<span class="at">main=</span><span class="fu">rownames</span>(pop1988)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-6.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop1988_polished<span class="sc">$</span>residuals[,i],<span class="at">main=</span><span class="fu">names</span>(pop1988)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-7.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-8.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-9.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-10.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-11.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-20-12.png" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
<p>10대 부터 30대 까지는 장남의 부양이 아닌 남녀에 상관없이 사회에 의존하거나 자녀 모두가 부모 부양을 분담해야한다는 인식이 많았으나, 40대 이후에서는 이러한 인식이 정 반대인 것으로 나타난다. 장남이 부모님의 부양을 담당해야한다는 인식이 가장 많았고 분담에 대한 부정적인 인식이 많았다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2018</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop2018_polished<span class="sc">$</span>residuals[i,],<span class="at">main=</span><span class="fu">rownames</span>(pop2018)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-5.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-6.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop2018_polished<span class="sc">$</span>residuals[,i],<span class="at">main=</span><span class="fu">names</span>(pop2018)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-7.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-8.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-9.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-10.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-11.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-12.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-13.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-21-14.png" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
<p>88년도에 20대였던 사람들이 50대, 30대였던 사람들이 60대인 시점 전 세대에서 장남 혼자, 딸 혼자, 능력있는 자식 등 한명이 부모님 부양에 대한 책임을 독점하는 것에 대해 부정적인 시각을 가지고 있다. 10~20대 까지는 자녀들이 부모님 부양에 대한 책임을 분담해야 한다고 주장하다가, 30대와 40대, 50대에서는 가족 정부 사회가 부모님 부양 책임을 분담해야한다는 인식이 가장 크다. 50대에서는 자녀들이 부모님 부양하는 것을 부정적으로 생각하는 것이 확인된다. 신기했던 포인트는 60대이상 계층에서 자립을 강조하는 모습이다. 가족이나 정부 사회에 의존한 부양에 대해서 부정적인 인식을 가지고 있는 것으로 보이므로 의존하지 않고 본인이 본인의 노후 설계를 해야 한다는 생각이 공유되는 것이 확인된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2020</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) </span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop2020_polished<span class="sc">$</span>residuals[i,],<span class="at">main=</span><span class="fu">rownames</span>(pop2020)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-5.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-6.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">barplot</span>(pop2020_polished<span class="sc">$</span>residuals[,i],<span class="at">main=</span><span class="fu">names</span>(pop2020)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-7.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-8.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-9.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-10.png" class="img-fluid" style="width:70.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-22-11.png" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
<p>40대부터 50대 까지는 부모님 부양에 대한 직접 책임을 지기 때문에 가족에 의한 부양에 대해서 부정적인 인식을 보이고 있는 것이 확인되어 진다. 60대 이상의 계층에서는 가족정부사회가 함께 부양을 해야 한다고 보지 않고 전통적인 노인 부양 방식에 대해서 오히려 긍정적인 인식을 가진 것을 확인할 수 있다. 10대의 20대 경우 가족에 의한 노인 부양에 긍정적인 시선을 가지고 있는데 이는 교육에 의한 규범적인 요인들에 의해 형성된 시각이라고 생각한다. 특이점은 이전 조사들과는 다르게 30대에서 부모님의 자립에 긍정적인 인식이 있는 것이 확인되어 지는데 일시적으로 확인되는 이상치일 가능성이 있다.</p>
</section>
</section>
<section id="two-way-plot-과-coded-plot" class="level2">
<h2 class="anchored" data-anchor-id="two-way-plot-과-coded-plot">two-way plot 과 Coded plot</h2>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">1988</h3>
<ul>
<li>1988년도 Two way plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>fit_1988<span class="ot">=</span>pop1988_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop1988_polished<span class="sc">$</span>row,pop1988_polished<span class="sc">$</span>col, <span class="st">"+"</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>fit_1988<span class="ot">=</span>fit_1988[<span class="fu">c</span>(<span class="fu">order</span>(fit_1988[,<span class="dv">1</span>],<span class="at">decreasing=</span>T)),]</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>fit_1988<span class="ot">=</span>fit_1988[,<span class="fu">c</span>(<span class="fu">order</span>(fit_1988[<span class="dv">1</span>,],<span class="at">decreasing=</span>T))]</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_1988=</span>pop1988_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           장남 아들모두     딸 아들딸모두   자립 사회및기타
15~19세  -8.375   -4.225 -0.175      8.875  0.175      1.325
20~29세  -7.625   -2.075 -0.225      8.325  0.225      1.075
30~39세  -4.875   -0.725 -0.175      3.775  1.675      0.325
40~49세   4.875    0.725  0.175     -3.775 -0.175     -0.325
50~59세  12.975    3.625  0.475     -8.775 -3.475     -0.325
60세이상 24.575    2.725  0.675    -14.475 -7.875     -0.525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(<span class="fu">as.vector</span>(resid_1988)) <span class="co"># hinge 밖에 있는 값들은 Residual로 표현 안함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.475  -2.775   0.000   1.500  24.575</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>twoway<span class="sc">::</span><span class="fu">twoway</span>(pop1988,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median polish decomposition (Dataset: "pop1988"; Response: Value)
Residuals bordered by row effects, column effects, and overall

           장남    아들모두 딸      아들딸모두 자립    사회및기타   roweff 
         + ------- -------  ------- -------    ------- -------    + -------
15~19세  |  -8.375  -4.225   -0.175   8.875      0.175   1.325    :   0.525
20~29세  |  -7.625  -2.075   -0.225   8.325      0.225   1.075    :   0.175
30~39세  |  -4.875  -0.725   -0.175   3.775      1.675   0.325    :   0.125
40~49세  |   4.875   0.725    0.175  -3.775     -0.175  -0.325    :  -0.125
50~59세  |  12.975   3.625    0.475  -8.775     -3.475  -0.325    :  -0.625
60세이상 |  24.575   2.725    0.675 -14.475     -7.875  -0.525    :  -0.725
         + ....... .......  ....... .......    ....... .......    + .......
coleff   |   6.800   0.750  -17.000  17.550     -0.750 -12.800    :  17.450</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(twoway<span class="sc">::</span><span class="fu">twoway</span>(pop1988,<span class="at">method=</span><span class="st">"median"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>모든 자녀들이 부모님에 대한 부양을 분담해야 한다는 인식이 가장 높게 나타나고 그 다음은 장남이 책임져야 한다는 인식이 있는 것이 확인된다. 딸이 부모님 부양하는 것에 대한 인식은 낮은 편이다. 15~19 세 그룹에서 가장 부모님 부양에 대한 긍정적 인식을 보이고 있으며, 반면 60 세 이상 그룹에서는 부모님 부양에 대한 부정적 인식이 있는 것이 확인된다. 나이가 어릴수록 부모님 부양에 대해서 긍정적인 인식이 있는 것이 확인 되어진다.</p>
<ul>
<li>1988년도 coded plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>standard<span class="ot">=</span><span class="fu">as.vector</span>(resid_1988)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(standard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.475  -2.775   0.000   1.500  24.575</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>Hspread_1988<span class="ot">=</span><span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>inner_1988<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_1988,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_1988)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>outer_1988<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>Hspread_1988,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>Hspread_1988)</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>Hspread_1988; inner_1988; outer_1988</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.275</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7.9125 -9.1875</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  14.325 -15.600</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>resid_1988<span class="ot">=</span><span class="fu">as.data.frame</span>(resid_1988)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 교과서 기준과 동일하게 "M" - Far outside low, "="- below low inner fence(outise), "-" - Below lower hinge but within inner fence</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># "." - Between Hinges , "+"- Above upper hinge, "#" - Above High inner fence (outside), "F" - Far outside high</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>resid_1988_coded<span class="ot">=</span><span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span> outer_1988[<span class="dv">1</span>], <span class="st">"F"</span>,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span> inner_1988[<span class="dv">1</span>], <span class="st">"#"</span>,</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span> <span class="fu">fivenum</span>(standard)[<span class="dv">4</span>],<span class="st">"+"</span>,</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>] ,<span class="st">"."</span>,</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span> inner_1988[<span class="dv">2</span>],<span class="st">"-"</span>,</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">ifelse</span>(resid_1988 <span class="sc">&gt;=</span> outer_1988[<span class="dv">2</span>],<span class="st">"="</span>,<span class="st">"M"</span>))))))</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>resid_1988</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           장남 아들모두     딸 아들딸모두   자립 사회및기타
15~19세  -8.375   -4.225 -0.175      8.875  0.175      1.325
20~29세  -7.625   -2.075 -0.225      8.325  0.225      1.075
30~39세  -4.875   -0.725 -0.175      3.775  1.675      0.325
40~49세   4.875    0.725  0.175     -3.775 -0.175     -0.325
50~59세  12.975    3.625  0.475     -8.775 -3.475     -0.325
60세이상 24.575    2.725  0.675    -14.475 -7.875     -0.525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_1988_coded=</span><span class="fu">as.data.frame</span>(resid_1988_coded))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         장남 아들모두 딸 아들딸모두 자립 사회및기타
15~19세     -        -  .          #    .          .
20~29세     -        .  .          #    .          .
30~39세     -        .  .          +    +          .
40~49세     +        .  .          -    .          .
50~59세     #        +  .          -    -          .
60세이상    F        +  .          =    -          .</code></pre>
</div>
</div>
<p>60 세 이상 집단에서는 자립을 강조하고 정부나 사회에 의존하는 것에 대한 부정적인 인식이 확인되어진다. 반면 10 대나 20 대의 경우 모든 자녀들이 부모님 부양에 대한 부담을 분담해야 한다고 보고 있는 것으로 보인다. 30~50 대에서는 부모님 부양에 대한 책임을 가족 정부 사회가 분담해야 한다고 보고 있다. 이러한 이유를 부모님 부양에 대한 부담을 느끼기 때문으로 보고 있다.</p>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">2018</h3>
<ul>
<li>2018년도 Two way plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>fit_2018<span class="ot">=</span>pop2018_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop2018_polished<span class="sc">$</span>row,pop2018_polished<span class="sc">$</span>col, <span class="st">"+"</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>fit_2018<span class="ot">=</span>fit_2018[<span class="fu">c</span>(<span class="fu">order</span>(fit_2018[,<span class="dv">1</span>],<span class="at">decreasing=</span>T)),]</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>fit_2018<span class="ot">=</span>fit_2018[,<span class="fu">c</span>(<span class="fu">order</span>(fit_2018[<span class="dv">1</span>,],<span class="at">decreasing=</span>T))]</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_2018=</span>pop2018_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             자립     장남 아들모두       딸 모든_자녀     능력 가족정부사회
13∼19세  0.06562 -0.06875  0.79688  0.56250   8.21250 -0.35312     -4.40313
20∼29세  1.40312 -0.43125 -0.06562  0.10000   2.45000  0.08438     -1.06563
30∼39세 -0.49687 -0.23125  0.13438  0.00000   0.55000 -0.01562      1.83437
40∼49세 -0.89688  0.06875  0.03438  0.00000  -0.55000 -0.21562      2.53437
50∼59세 -0.06562  0.20000 -0.03438 -0.06875  -1.01875  0.01562      1.06563
60세이상  6.09063  0.75625 -0.27812 -0.91250  -2.26250  0.27187    -12.87813
         정부사회
13∼19세 -0.53750
20∼29세 -1.10000
30∼39세 -0.40000
40∼49세  0.40000
50∼59세  0.73125
60세이상  1.68750</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(<span class="fu">as.vector</span>(resid_2018)) <span class="co"># hinge 밖에 있는 값들은 Residual로 표현 안함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -12.878130  -0.415625   0.000000   0.556250   8.212500</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>twoway<span class="sc">::</span><span class="fu">twoway</span>(pop2018,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median polish decomposition (Dataset: "pop2018"; Response: Value)
Residuals bordered by row effects, column effects, and overall

           자립      장남      아들모두  딸        모든_자녀 능력     
         + --------- --------- --------- --------- --------- ---------
13∼19세 |   0.06562  -0.06875   0.79688   0.56250   8.21250  -0.35312
20∼29세 |   1.40312  -0.43125  -0.06562   0.10000   2.45000   0.08438
30∼39세 |  -0.49687  -0.23125   0.13438   0.00000   0.55000  -0.01562
40∼49세 |  -0.89688   0.06875   0.03438   0.00000  -0.55000  -0.21562
50∼59세 |  -0.06562   0.20000  -0.03438  -0.06875  -1.01875   0.01562
60세이상 |   6.09063   0.75625  -0.27812  -0.91250  -2.26250   0.27187
         + ......... ......... ......... ......... ......... .........
coleff   |  12.94688  -3.81875  -4.08438  -4.65000  13.70000  -0.23438
         가족정부사회 정부사회    roweff   
         ---------    --------- + ---------
13∼19세  -4.40313     -0.53750 :  -0.36250
20∼29세  -1.06563     -1.10000 :   0.00000
30∼39세   1.83437     -0.40000 :   0.00000
40∼49세   2.53437      0.40000 :   0.00000
50∼59세   1.06563      0.73125 :   0.06875
60세이상 -12.87813      1.68750 :   1.11250
         .........    ......... + .........
coleff    45.71562      0.25000 :   4.85000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(twoway<span class="sc">::</span><span class="fu">twoway</span>(pop2018,<span class="at">method=</span><span class="st">"median"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>가족 정부 사회가 협력하여 부모님 부양을 담당해야 한다는 인식이 높은 것으로 보인다. 특이하게, 가족이 배제된 부모님 부양에 대한 인식은 부정적인 것으로 보인다. 60 세 이상에서 88 년도와는 다르게 부모님 부양에 대해 인식이 개선됨 (BUT 88 년도와 20 년도의 Column 항목들이 다르기 때문에 단순히 전반적 인식이 개선되었다라고 보기에는 한계가 있음) 60 세 이상,65 세 이상 집단에서 부모님 부양에 대한 인식이 높은 것으로 보이며 30 대,40 대,50 대가 서로 비슷한 수준의 부모님 부양에 대한 인식을 가지고 있는 것으로 보인다.</p>
<ul>
<li>2018년도 coded plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>resid_2018<span class="ot">=</span>pop2018_polished<span class="sc">$</span>residuals</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>standard<span class="ot">=</span><span class="fu">as.vector</span>(resid_2018)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(standard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -12.878130  -0.415625   0.000000   0.556250   8.212500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>Hspread_2018<span class="ot">=</span><span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>inner_2018<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_2018,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_2018)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>outer_2018<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>Hspread_2018,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>Hspread_2018)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>Hspread_2018; inner_2018; outer_2018</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.971875</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2.014063 -1.873438</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3.471875 -3.331250</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>resid_2018<span class="ot">=</span><span class="fu">as.data.frame</span>(resid_2018)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 교과서 기준과 동일하게 "M" - Far outside low, "="- below low inner fence(outise), "-" - Below lower hinge but within inner fence</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co"># "." - Between Hinges , "+"- Above upper hinge, "#" - Above High inner fence (outside), "F" - Far outside high</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>resid_2018_coded<span class="ot">=</span><span class="fu">ifelse</span>(resid_2018 <span class="sc">&gt;=</span> outer_2018[<span class="dv">1</span>], <span class="st">"F"</span>,</span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ifelse</span>(resid_2018 <span class="sc">&gt;=</span> inner_2018[<span class="dv">1</span>], <span class="st">"#"</span>,</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(resid_2018 <span class="sc">&gt;=</span> <span class="fu">fivenum</span>(standard)[<span class="dv">4</span>],<span class="st">"+"</span>,</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(resid_2018 <span class="sc">&gt;=</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>] ,<span class="st">"."</span>,</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(resid_2018<span class="sc">&gt;=</span> inner_2018[<span class="dv">2</span>],<span class="st">"-"</span>,</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(resid_2018 <span class="sc">&gt;=</span> outer_2018[<span class="dv">2</span>],<span class="st">"="</span>,<span class="st">"M"</span>))))))</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>resid_2018</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             자립     장남 아들모두       딸 모든_자녀     능력 가족정부사회
13∼19세  0.06562 -0.06875  0.79688  0.56250   8.21250 -0.35312     -4.40313
20∼29세  1.40312 -0.43125 -0.06562  0.10000   2.45000  0.08438     -1.06563
30∼39세 -0.49687 -0.23125  0.13438  0.00000   0.55000 -0.01562      1.83437
40∼49세 -0.89688  0.06875  0.03438  0.00000  -0.55000 -0.21562      2.53437
50∼59세 -0.06562  0.20000 -0.03438 -0.06875  -1.01875  0.01562      1.06563
60세이상  6.09063  0.75625 -0.27812 -0.91250  -2.26250  0.27187    -12.87813
         정부사회
13∼19세 -0.53750
20∼29세 -1.10000
30∼39세 -0.40000
40∼49세  0.40000
50∼59세  0.73125
60세이상  1.68750</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_2018_coded=</span><span class="fu">as.data.frame</span>(resid_2018_coded))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         자립 장남 아들모두 딸 모든_자녀 능력 가족정부사회 정부사회
13∼19세    .    .        +  +         F    .            M        -
20∼29세    +    -        .  .         #    .            -        -
30∼39세    -    .        .  .         .    .            +        .
40∼49세    -    .        .  .         -    .            #        .
50∼59세    .    .        .  .         -    .            +        +
60세이상    F    +        .  -         =    .            M        +</code></pre>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">2020</h3>
<ul>
<li>2020년도 Two way plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">=</span>pop2020_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(pop2020_polished<span class="sc">$</span>row,pop2020_polished<span class="sc">$</span>col, <span class="st">"+"</span>)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>f<span class="ot">=</span>f[<span class="fu">c</span>(<span class="fu">order</span>(f[,<span class="dv">1</span>],<span class="at">decreasing=</span>T)),]</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>f<span class="ot">=</span>f[,<span class="fu">c</span>(<span class="fu">order</span>(f[<span class="dv">1</span>,],<span class="at">decreasing=</span>T))]</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_2020=</span>pop2020_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
15∼19세        -0.6  5.3                -4.6       0.4  0.0
20∼29세         0.0  0.0                 1.0       0.0  0.0
30∼39세         2.5 -2.7                 0.0       0.0 -0.3
40∼49세        -0.6 -2.4                 3.1       0.9  0.0
50∼59세        -0.9 -2.6                 3.1       1.4  0.0
60세이상         1.4  1.2               -13.6       0.0 -3.0
65세이상         1.8  1.9               -17.1       0.0 -3.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(<span class="fu">as.vector</span>(resid_2020)) <span class="co"># hinge 밖에 있는 값들은 Residual로 표현 안함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -17.10  -0.75   0.00   1.10   5.30</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>twoway<span class="sc">::</span><span class="fu">twoway</span>(pop2020,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median polish decomposition (Dataset: "pop2020"; Response: Value)
Residuals bordered by row effects, column effects, and overall

           부모_스스로 가족  가족정부사회가_함께 정부_사회 기타    roweff
         + -----       ----- -----               -----     ----- + ----- 
15∼19세 |  -0.6         5.3  -4.6                 0.4       0.0 :   0.0 
20∼29세 |   0.0         0.0   1.0                 0.0       0.0 :  -0.1 
30∼39세 |   2.5        -2.7   0.0                 0.0      -0.3 :   0.2 
40∼49세 |  -0.6        -2.4   3.1                 0.9       0.0 :  -0.1 
50∼59세 |  -0.9        -2.6   3.1                 1.4       0.0 :  -0.1 
60세이상 |   1.4         1.2 -13.6                 0.0      -3.0 :   2.9 
65세이상 |   1.8         1.9 -17.1                 0.0      -3.6 :   3.5 
         + .....       ..... .....               .....     ..... + ..... 
coleff   |   0.0        10.2  51.8                -9.4     -11.6 :  11.7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(twoway<span class="sc">::</span><span class="fu">twoway</span>(pop2020,<span class="at">method=</span><span class="st">"median"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제5_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>가족 정부 사회가 협력하여 부모님 부양을 담당해야 한다는 인식이 높은 것으로 보인다. 특이하게, 가족이 배제된 부모님 부양에 대한 인식은 부정적인 것으로 보인다. 60 세 이상에서 88 년도와는 다르게 부모님 부양에 대해 인식이 개선됨 (BUT 88 년도와 20 년도의 Column 항목들이 다르기 때문에 단순히 전반적 인식이 개선되었다라고 보기에는 한계가 있음) 60 세 이상,65 세 이상 집단에서 부모님 부양에 대한 인식이 높은 것으로 보이며 30 대,40 대,50 대가 서로 비슷한 수준의 부모님 부양에 대한 인식을 가지고 있는 것으로 보인다.</p>
<ul>
<li>2020년도 coded plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>resid_2020<span class="ot">=</span>pop2020_polished<span class="sc">$</span>residuals</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>standard<span class="ot">=</span><span class="fu">as.vector</span>(resid_2020)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(standard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -17.10  -0.75   0.00   1.10   5.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>Hspread_2020<span class="ot">=</span><span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>inner_2020<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_2020,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>Hspread_2020)</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>outer_2020<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>Hspread_2020,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>Hspread_2020)</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>Hspread_2020; inner_2020; outer_2020</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.85</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3.875 -3.525</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6.65 -6.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>resid_2020<span class="ot">=</span><span class="fu">as.data.frame</span>(resid_2020)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 교과서 기준과 동일하게 "M" - Far outside low, "="- below low inner fence(outise), "-" - Below lower hinge but within inner fence</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="co"># "." - Between Hinges , "+"- Above upper hinge, "#" - Above High inner fence (outside), "F" - Far outside high</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>resid_2020_coded<span class="ot">=</span><span class="fu">ifelse</span>(resid_2020 <span class="sc">&gt;=</span> outer_2020[<span class="dv">1</span>], <span class="st">"F"</span>,</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ifelse</span>(resid_2020 <span class="sc">&gt;=</span> inner_2020[<span class="dv">1</span>], <span class="st">"#"</span>,</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(resid_2020 <span class="sc">&gt;=</span> <span class="fu">fivenum</span>(standard)[<span class="dv">4</span>],<span class="st">"+"</span>,</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(resid_2020 <span class="sc">&gt;=</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>] ,<span class="st">"."</span>,</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(resid_2020<span class="sc">&gt;=</span> inner_2020[<span class="dv">2</span>],<span class="st">"-"</span>,</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(resid_2020 <span class="sc">&gt;=</span> outer_2020[<span class="dv">2</span>],<span class="st">"="</span>,<span class="st">"M"</span>))))))</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>resid_2020</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
15∼19세        -0.6  5.3                -4.6       0.4  0.0
20∼29세         0.0  0.0                 1.0       0.0  0.0
30∼39세         2.5 -2.7                 0.0       0.0 -0.3
40∼49세        -0.6 -2.4                 3.1       0.9  0.0
50∼59세        -0.9 -2.6                 3.1       1.4  0.0
60세이상         1.4  1.2               -13.6       0.0 -3.0
65세이상         1.8  1.9               -17.1       0.0 -3.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">resid_2020_coded=</span><span class="fu">as.data.frame</span>(resid_2020_coded))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         부모_스스로 가족 가족정부사회가_함께 정부_사회 기타
15∼19세           .    #                   =         .    .
20∼29세           .    .                   .         .    .
30∼39세           +    -                   .         .    .
40∼49세           .    -                   +         .    .
50∼59세           -    -                   +         +    .
60세이상           +    +                   M         .    -
65세이상           +    +                   M         .    =</code></pre>
</div>
</div>
<p>60 세 이상집단에서 외부의 도움보다는 가족 혹은 본인이 부모님 부양을 담당해야 한다고 생각하는 것으로 보인다. 이러한 이유는 나이가 많은 집단에서 외부의 도움을 별로 좋아하지 않기 때문이라고 보인다. 88 년도 자료에서와 엄밀한 비교는 어렵지만 정부나 사회에 도움을 받는 것을 꺼려하는 60 대 이상 계층들의 태도는 일관적일 것으로 보인다. 반면, 40 대 50 대 집단에서는 가족정부사회가 함께 부모님 부양을 담당해야 한다는 인식이 있는데 실제로 40 대~50 대가 부모님 부양을 담당하면서 부담을 느끼기 때문이라고 추측할 수 있다.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>