<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangwon Ju, Yonsei Public Administration">
<meta name="dcterms.date" content="2021-05-26">

<title>Sangwon Ju - EDA Assignment 6: Chapter 8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Sangwon Ju</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">About Me</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">Research</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../../research_interests.html">
 <span class="dropdown-text">Research Interests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../publication.html">
 <span class="dropdown-text">Publications / Working Papers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../data_analytics.html">Data Analytics</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html">CV (as of January 2023)</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#번" id="toc-번" class="nav-link active" data-scroll-target="#번">1번</a></li>
  <li><a href="#정리" id="toc-정리" class="nav-link" data-scroll-target="#정리">정리</a></li>
  <li><a href="#번-1" id="toc-번-1" class="nav-link" data-scroll-target="#번-1">3번</a>
  <ul class="collapse">
  <li><a href="#정리-1" id="toc-정리-1" class="nav-link" data-scroll-target="#정리-1">정리</a></li>
  <li><a href="#rs3r-twice" id="toc-rs3r-twice" class="nav-link" data-scroll-target="#rs3r-twice">3RS3R Twice</a></li>
  <li><a href="#rssh-twice" id="toc-rssh-twice" class="nav-link" data-scroll-target="#rssh-twice">3RSSH Twice</a></li>
  <li><a href="#h-twice" id="toc-h-twice" class="nav-link" data-scroll-target="#h-twice">4253H Twice</a></li>
  </ul></li>
  <li><a href="#번-2" id="toc-번-2" class="nav-link" data-scroll-target="#번-2">4번</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">EDA Assignment 6: Chapter 8</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Exploratory Data Analysis (2021 Spring) [in Korean]</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangwon Ju, Yonsei Public Administration </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 26, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>8장. 시계열 자료의 탐색</p>
<section id="번" class="level2">
<h2 class="anchored" data-anchor-id="번">1번</h2>
<p>FRIDAY.DAT 자료는 영국에서 1986년 금요일에 발생한 자동차 사고 사망자 수이다. 첫 열은 하루를 24시간으로 표시한 것이고, 두 번째 열은 사망자 수이다. 시간에 따른 사망자 수를 평활하고 시간과 사망자 수의 관계를 서술하여라.</p>
<p>데이터를 불러오고,첫번째 줄에 있는 데이터를 0시부터 23시로 변경하여 Time-series Plot을 그릴 때 보다 가독성을 좋게 만들고자 하였다. Time은 시작시간을 기준으로 한시간의 데이터를 포함하며 시작시간은 당일 0시부터 끝나는 시간은 익일 0시까지이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"haven"</span>,<span class="st">"sleekts"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>friday<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">V1 =</span> <span class="fu">c</span>(<span class="st">"0-1"</span>,<span class="st">"1-2"</span>,<span class="st">"2-3"</span>,<span class="st">"3-4"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"4-5"</span>,<span class="st">"5-6"</span>,<span class="st">"6-7"</span>,<span class="st">"7-8"</span>,<span class="st">"8-9"</span>,<span class="st">"9-10"</span>,<span class="st">"10-11"</span>,<span class="st">"11-12"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"12-13"</span>,<span class="st">"13-14"</span>,<span class="st">"14-15"</span>,<span class="st">"15-16"</span>,<span class="st">"16-17"</span>,<span class="st">"17-18"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"18-19"</span>,<span class="st">"19-20"</span>,<span class="st">"20-21"</span>,<span class="st">"21-22"</span>,<span class="st">"22-23"</span>,<span class="st">"23-0"</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">V2 =</span> <span class="fu">c</span>(938L,621L,455L,207L,138L,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                       215L,526L,1933L,3377L,2045L,2078L,2351L,3015L,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                       2966L,2912L,4305L,4923L,4427L,3164L,2950L,2601L,2420L,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                       2557L,4319L)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(friday)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Time"</span>, <span class="st">"Deaths"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>friday<span class="sc">$</span>Time<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">23</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>friday</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Time Deaths
1     0    938
2     1    621
3     2    455
4     3    207
5     4    138
6     5    215
7     6    526
8     7   1933
9     8   3377
10    9   2045
11   10   2078
12   11   2351
13   12   3015
14   13   2966
15   14   2912
16   15   4305
17   16   4923
18   17   4427
19   18   3164
20   19   2950
21   20   2601
22   21   2420
23   22   2557
24   23   4319</code></pre>
</div>
</div>
<p>결측치를 확인하고 Box plot을 활용해서 Outlier가 존재하는지를 확인한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(friday)) <span class="co"># 0 결측치는 존재하지 않음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(friday<span class="sc">$</span>Deaths,<span class="at">main=</span> <span class="st">"Checking Outlier of Deaths Data"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#outlier는 존재하지 않는 것이 확인되어진다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Boxplot을 통해 확인 할 경우 outlier는 확인되어지지는 않으나 Whisker의 길이가 길게 뻗어 있는 것이 확인되어 진다. Whisker의 길이와 median의 위치를 고려해볼 때, 자료가 완벽하게 대칭적이지는 않은 것으로 확인되어 진다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(friday<span class="sc">$</span>Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 3 digit(s) to the right of the |

  0 | 1225569
  1 | 9
  2 | 0144669
  3 | 00024
  4 | 3349</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(friday<span class="sc">$</span>Deaths,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 3 digit(s) to the right of the |

  0 | 122
  0 | 5569
  1 | 
  1 | 9
  2 | 0144
  2 | 669
  3 | 00024
  3 | 
  4 | 334
  4 | 9</code></pre>
</div>
</div>
<p>Stem and Leaf Plot을 통해 데이터를 분석할 경우 데이터의 특성을 분석하려고 하였으나 어떠한 특징을 보이고 있는 것으로 보이지는 않는다. 다만, Stem Plot의 Scale을 약간 조정할 경우 Gap이 있는 것으로 보이는데 세개의 그룹으로 나누어지는 것 처럼 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  hl<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">2</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  median<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">3</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  hu<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">4</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>((hu<span class="sc">-</span>median)<span class="sc">-</span>(median<span class="sc">-</span>hl))<span class="sc">/</span>((hu<span class="sc">-</span>median)<span class="sc">+</span>(median<span class="sc">-</span>hl))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(friday<span class="sc">$</span>Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.4796537</code></pre>
</div>
</div>
<p>데이터의 Skewness를 고려해 볼 떄 Box plot에서 확인되였던 것 처럼, 해당 데이터는 Skewed to the left되어 있다는 사실을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">log</span>(friday<span class="sc">$</span>Deaths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6903753</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">sqrt</span>(friday<span class="sc">$</span>Deaths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5900806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(friday<span class="sc">$</span>Deaths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8456372</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(friday<span class="sc">$</span>Deaths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7763614</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 변환을 하면 오히려 skewness가 더 커지고 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd=</span><span class="fu">lsum</span>(friday<span class="sc">$</span>Deaths,<span class="dv">6</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth  lower     mid  upper spread
1      M  12.5 2488.5 2488.50 2488.5    0.0
2      H   6.5  779.5 1934.50 3089.5 2310.0
3      E   3.5  335.0 2323.50 4312.0 3977.0
4      D   2.0  207.0 2317.00 4427.0 4220.0
5      C   1.5  172.5 2423.75 4675.0 4502.5
6      B   1.0  138.0 2530.50 4923.0 4785.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>(lvd[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd[<span class="dv">2</span>,<span class="dv">3</span>]) <span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01664502</code></pre>
</div>
</div>
<ul>
<li>데이터의 Five Numbers와 요약 지표</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(friday<span class="sc">$</span>Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  138.0  779.5 2488.5 3089.5 4923.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(friday<span class="sc">$</span>Deaths)<span class="co"># Median, Mean이 큰 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  138.0   858.8  2488.5  2310.1  3052.2  4923.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">summary</span>(friday<span class="sc">$</span>Deaths)[<span class="dv">6</span>]<span class="sc">-</span><span class="fu">summary</span>(friday<span class="sc">$</span>Deaths)[<span class="dv">1</span>]) <span class="co"># 최고점과 최저점 사이의 차이는 4785</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4785</code></pre>
</div>
</div>
<p>최고값의 경우 4923회의 사고 / 최소값의 경우 138회의 사고 / 평균적으로 2370회의 사고가 발생하였다.</p>
<p>정규성을 따르는가?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(friday<span class="sc">$</span>Deaths, <span class="at">ylab=</span><span class="st">"Death quantiles"</span>);<span class="fu">qqline</span>(friday<span class="sc">$</span>Deaths, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fiv<span class="ot">=</span><span class="fu">fivenum</span>(friday<span class="sc">$</span>Deaths)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma =</span> (fiv[<span class="dv">4</span>]<span class="sc">-</span>fiv[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1723.881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(friday<span class="sc">$</span>Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1447.733</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(friday<span class="sc">$</span>Deaths, <span class="at">ylab=</span><span class="st">"Death quantiles"</span>);<span class="fu">qqline</span>(friday<span class="sc">$</span>Deaths, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv[<span class="dv">3</span>],pseudosigma,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">sub=</span><span class="st">"intercept=2488.5 (median); slope=1723.9 (pseudo-sigma) blue line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>pseudo-sigma와 sigma가 큰 차이가 없고 자료들이 어느정도 직선을 따르고 있는 것을 보인다. (완벽히 직선을 이루는 것은 아니나 - 중간에 곡선형태를 보임 - 직선위에 있는 것처럼 ) 다만 위에서 Stem-Leaf Plot을 그리면서 언급하였던 것 처럼 세개의 cluster가 나타나고 있는 것이 확인되어 진다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>friday2<span class="ot">=</span>friday</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>((friday2<span class="sc">$</span>Deaths)<span class="sc">/</span><span class="fu">sum</span>(friday2<span class="sc">$</span>Deaths))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.6918276 1.1200693 0.8206627 0.3733564 0.2489043 0.3877857 0.9487221
 [8] 3.4864636 6.0909402 3.6884728 3.7479934 4.2403910 5.4380174 5.3496384
[15] 5.2522410 7.7647313 8.8793896 7.9847772 5.7067619 5.3207799 4.6913046
[22] 4.3648432 4.6119438 7.7899825</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(friday,<span class="fu">aes</span>(<span class="at">x=</span>Deaths))<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(count) <span class="sc">/</span> <span class="fu">sum</span>(count)),<span class="at">binwidth=</span><span class="dv">400</span>, <span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">colour =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of deaths in friday"</span>, <span class="at">x =</span><span class="st">"# of Deaths"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)<span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)<span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Cluster를 재확인 할 수 있음. # K-means Clustering 사용하여 세개의 군집분류</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kmeans</span>(friday<span class="sc">$</span>Deaths, <span class="dv">3</span>) <span class="co"># 13개, 4개, 7개</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 13, 7, 4

Cluster means:
       [,1]
1 2643.7692
2  442.8571
3 4493.5000

Clustering vector:
 [1] 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 3 3 3 1 1 1 1 1 3

Within cluster sum of squares by cluster:
[1] 2544594.3  484446.9  254875.0
 (between_SS / total_SS =  93.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>군집분류를 할 경우 세개의 군집이 나타나는데 0시부터 ~ 6까지의 첫번째 Cluster는 심야시간대의 사고로 인한 사망이므로 수가 많지 않은 편이다. 반면, 두번째 Cluster는 일과시간대인 7시부터 15시, 퇴근시간 이후인 18시부터 23시의 경우 사망건수가 중간수준으로 나타나고, 15시부터 18시 사이와 23시부터 24시 사이의 3번째 Cluster에서 사망건수가 가장 많이 나타난다. 퇴근 시간대보다 일과시간대에서 사고가 더 많이 확인되는 것이 확인된다. 특이시간대는 23~24시 사이 구간인데, 음주를 하거나 모임을 가질 때 보통 23시 이후 집에 귀가를 많이 하는데 귀가 과정에서 음주운전 사고가 발생한 것으로 추측되어지지만 확실하지 않다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ts_cluster<span class="ot">=</span><span class="fu">cbind</span>(friday,<span class="fu">as.factor</span>(<span class="fu">kmeans</span>(friday<span class="sc">$</span>Deaths, <span class="dv">3</span>)<span class="sc">$</span>cluster))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ts_cluster)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Time"</span>,<span class="st">"Deaths"</span>,<span class="st">"Cluster"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ts_cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Time Deaths Cluster
1     0    938       3
2     1    621       3
3     2    455       3
4     3    207       3
5     4    138       3
6     5    215       3
7     6    526       3
8     7   1933       1
9     8   3377       1
10    9   2045       1
11   10   2078       1
12   11   2351       1
13   12   3015       1
14   13   2966       1
15   14   2912       1
16   15   4305       2
17   16   4923       2
18   17   4427       2
19   18   3164       1
20   19   2950       1
21   20   2601       1
22   21   2420       1
23   22   2557       1
24   23   4319       2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ts_cluster,<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Deaths, <span class="at">colour=</span>Cluster)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">19</span>, <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">label=</span>ts_cluster<span class="sc">$</span>Time,<span class="at">hjust=</span><span class="dv">0</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Scatter Plot of Deaths' K-means clusters"</span>)<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(friday,<span class="at">main=</span><span class="st">"Timeseries plot of deaths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>교통사고 사망자 수를 평활하기 위해서 수업시간에 교수님께서 Recommend 하신 3RSSH Twice방법과 4253H Twice방법을 활용하고자 한다.</p>
<p>Recommend 해주신 방법들을 사용하기에 앞서 3RSS방법과 3RS3R방법으로 평활을 진행해 보았다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(friday,<span class="at">main=</span><span class="st">"Default, 3RSS twice, 3RS3R twice"</span>,<span class="at">ylab=</span><span class="st">"Deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(friday<span class="sc">$</span>Deaths, <span class="at">kind=</span><span class="st">"3RSS"</span>,<span class="at">twiceit=</span>T)),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(friday<span class="sc">$</span>Deaths, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T)),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5000</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSS Twice"</span>,<span class="st">"3RS3R Twice"</span>), </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hanning을 적용하기 전 데이터이다. 23시부터 24시 구간의 이상치가 어느정도 완화된 것을 확인할 수 있다. (다만 그 정도가 커보이기 때문에 조정이 필요할 것으로 보인다.) 또한, 8시 부근의 뾰족한 지점이 어느정도 완화되었고, 다른 Cluster 3에 해당하던 값들의 크기도 다소 작아진 것이 확인되어진다. 다만, 평평한 부분이 연속적으로 존재하는 것이 확인되어지기에 Hanning의 적용이 필요할 것으로 보인다. (전반적으로 3RSS(split 두번)나 3RS3R(Repeated 3 두번)에서는 큰 차이가 나타나고 있지는 않은 것으로 보인다.)</p>
<p>다음으로는, 3RSSH, twice방식을 적용한 평활을 적용하였다.</p>
<p>다만, smoothing 함수에 3RSSH twice 방식의 평활을 지원하지 않기 때문에 함수를 만들어 smooting을 진행해야 할 것으로 보인다. https://blog.daum.net/wonil2480/13 의 방식을 참고하여 함수를 형성하였음.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>smooth_3RSSH<span class="ot">=</span><span class="cf">function</span>(data){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    smooth3RSS<span class="ot">=</span><span class="fu">smooth</span>(data, <span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">=</span><span class="fu">length</span>(data)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    smooth3RSSH<span class="ot">=</span>smooth3RSS</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {smooth3RSSH[i] <span class="ot">&lt;-</span> smooth3RSS[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    smooth3RSSH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS[<span class="dv">1</span>]; smooth3RSSH[n] <span class="ot">&lt;-</span> smooth3RSS[n]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    rough<span class="ot">=</span>data<span class="sc">-</span>smooth3RSSH</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    roughH<span class="ot">=</span>rough</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    smooth3RSS2<span class="ot">=</span><span class="fu">smooth</span>(rough,<span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) roughH[i] <span class="ot">&lt;-</span> smooth3RSS2[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS2[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS2[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    roughH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS2[<span class="dv">1</span>]; roughH[n] <span class="ot">&lt;-</span> smooth3RSS2[n]</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span>smooth3RSSH<span class="sc">+</span>roughH</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">as.vector</span>(out)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)}</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("LearnEDA")</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">#library(LearnEDA)</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="co">#smooth.3RSSH.twice=function(data)</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">#{</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="co">#SMOOTH=han(smooth(attend,kind=”3RSS”)) # 3RSSH smooth</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="co">#ROUGH=data-SMOOTH                      # computes the rough</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co">#SMOOTH+han(smooth(ROUGH,kind=”3RSS”)) </span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="co">#원래 있는 패키지를 활용한 방식과도 비교하였으나 차이가 없었다. </span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co">#(CRAN에서 현재 삭제되어 이전 패키지를 다운받아 사용하였음)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(friday,<span class="at">main=</span><span class="st">"Default, 3RSSH Twice"</span>,<span class="at">ylab=</span><span class="st">"Deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(friday<span class="sc">$</span>Deaths)),<span class="at">col=</span><span class="st">"goldenrod4"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5000</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>), </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"goldenrod4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>3RSS나 3RS3R와 전반적인 추세선은 크게 다르지 않은 것으로 보인다. 다만 Cluster 3 (15시부터 18시 사이와 23시부터 24시 사이)에 해당하는 크기가 큰 자료들이 3RSSH자료에서 조금 더 잘 드러나고 있다. 동일하게 8시부터 9시 부근에 형성된 뾰족한 Outlier로 보이는 자료는 Smoothing 된것으로 확인된다.</p>
<p>마지막으로 4253H, Twice 방식으로 평활한 데이터를 만들고자 한다. Sleekts 패키지의 sleek 활용하여 4253H, Twice 평활을 진행할 것이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("sleekts")</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sleekts)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sleek</span>(friday<span class="sc">$</span>Death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  902.6289  609.1992  462.4844  345.0000  268.0039  230.3789  454.5977
 [8]  974.8359 1599.0742 2027.2812 2178.5938 2281.4062 2448.0938 2668.3320
[15] 2987.7344 3400.8086 3741.2070 3926.9414 3626.9219 3201.0547 2775.1875
[22] 2649.3398 3092.6641 3092.6641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(friday,<span class="at">main=</span><span class="st">"Default, 4253H Twice"</span>,<span class="at">ylab=</span><span class="st">"Deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(friday<span class="sc">$</span>Death)),<span class="at">col=</span><span class="st">"cyan3"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5000</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"4253H Twice"</span>), </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cyan3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>4253H 방식의 평활은 다른 방식들에 비해서 곡선의 형태가 부드럽게 나타나는 것이 확인된다. 또한 각 Cluster들 별로 특성이 명확하게 드러나고 있다. Cluster 3 (15시부터 18시 사이와 23시부터 24시 사이)에 해당하는 값들이 부드럽게 시계열 그래프 안에서 표현되고 있는 것을 확인할 수 있다. Raw Data에 존재하지 않는 값을 활용해서 양끝값을 극단치에 영향을 최소화한 형태로 표현했고, Hanning을 통해서 평평한 지점들을 보다 부드러운 곡선 형태로 만들었다는 점에서 다른 평활법에 비해서 더 잘 표현되어 있다고 볼 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(friday,<span class="at">main=</span><span class="st">"ALL"</span>,<span class="at">ylab=</span><span class="st">"Deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(friday<span class="sc">$</span>Deaths, <span class="at">kind=</span><span class="st">"3RSS"</span>)),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(friday<span class="sc">$</span>Deaths, <span class="at">kind=</span><span class="st">"3RS3R"</span>)),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(friday<span class="sc">$</span>Deaths)),<span class="at">col=</span><span class="st">"goldenrod4"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(friday<span class="sc">$</span>Death)),<span class="at">col=</span><span class="st">"cyan3"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5000</span>, <span class="fu">c</span>(<span class="st">"Default"</span>,<span class="st">"3RSS Twice"</span>,<span class="st">"3RS3R Twice"</span>,<span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"goldenrod4"</span>,<span class="st">"cyan3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>모든 평활법을 비교할경우 다음과 같은 그래프를 그릴 수 있다. 앞에서 언급하였듯이 4253H, Twice 평활법이 가장 적절한 방법이라고 생각된다. 8시부터 9시 사이의 값, 16시 부터 17시 사이의 값 그리고 23시부터 24시 사이의 값이 변환전 자료에 비해 많이 감소되었다. 앞의 두 시간대는 출퇴근 시간이기 때문에 교통량이 많으므로 교통사고가 날 확률이 높아지고 사망사고가 발생할 확률도 다른 시간대에 비해서 높다고 볼 수 있다. 또한 23시부터 24시 시간대의 경우 앞에서 언급한 것과 같이 모든 평활법에서 실제 데이터보다 낮게 평활이 나타났는데, 전체적인 곡선을 고려할 때 이질적인 데이터이므로 그 원인에 대해서 심도있게 고민해볼 필요가 존재한다. Raw Data 기준으로 새벽시간대에는 교통량이 적어 사망사고건수도 적은 편에 비해서 일과시간대와 퇴근시간대에는 사망사고 건수가 많이 나타나고 있고 일과시간대에 퇴근시간대에 비해서 더 많은 사망사고가 발생한다는 것을 확인할 수 있다. 반면 평활된 데이터의 경우 퇴근시간대에 더 많은 사망사고가 발생하는 것으로 보여주고 있는데 평활된 데이터를 해석할 떄는 Raw Data를 유의해서 해석하는 것이 필요하다는 것을 확인할 수 있다.</p>
<p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2564438/ 한 보고서에 따르면 사고가 발생하는 원인을 세가지를 제시하였는데 A credible physiological explanation for the importance of good lighting for road safety is provided; low luminance, low contrast images are processed slowly by the visual apparatus, due mainly to the limited temporal characteristics of the rod photoreceptors.</p>
<p>the rod photoreceptors의 제한된 시간적 특성은 야간의 낮은 불빛, 낮은 이미지의 대비로 인해서 시신경의 피로를 불러 일으키고 그 결과 높은 사망사고율로 이어졌음을 제시하였다.</p>
<p>전날 심야시간대에 사망사고 발생건수가 낮은 것에 비해 토요일 0시에 사망사고 발생건수가 높아 진 것은 주말에 앞서 사람들이 밤 늦게 까지 돌아다녀서 그런 것으로 추측되어지기도 하다. 시계열데이터의 왼쪽과 오른쪽이 대칭적이지 않은 이유는 금요일 0시와 토요일 0시(금요일 24시)가 사람들의 시각에서 질적으로 다르기 때문이라고 생각한다. 띠라서 데이터를 더 잘 이해하기 위해서는 목요일과 토요일의 시계열 자료를 확인하는 것이 필요할 것으로 보인다. (요일적 요인의 고려)</p>
<p>#2번 R의 datasets에 있는 sunspot.year 자료를 평활하고 그 패턴을 기술하라. 주기가 있는지? 많아지는 “속도”와 줄어드는 “속도”도 주목하여라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>sunspot.year<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>time, <span class="sc">~</span>value,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    1700L,      <span class="dv">5</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    1701L,     <span class="dv">11</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    1702L,     <span class="dv">16</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    1703L,     <span class="dv">23</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    1704L,     <span class="dv">36</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    1705L,     <span class="dv">58</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    1706L,     <span class="dv">29</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    1707L,     <span class="dv">20</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    1708L,     <span class="dv">10</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    1709L,      <span class="dv">8</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    1710L,      <span class="dv">3</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    1711L,      <span class="dv">0</span>,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    1712L,      <span class="dv">0</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    1713L,      <span class="dv">2</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    1714L,     <span class="dv">11</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    1715L,     <span class="dv">27</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    1716L,     <span class="dv">47</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    1717L,     <span class="dv">63</span>,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    1718L,     <span class="dv">60</span>,</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    1719L,     <span class="dv">39</span>,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    1720L,     <span class="dv">28</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    1721L,     <span class="dv">26</span>,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    1722L,     <span class="dv">22</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    1723L,     <span class="dv">11</span>,</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    1724L,     <span class="dv">21</span>,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    1725L,     <span class="dv">40</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    1726L,     <span class="dv">78</span>,</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    1727L,    <span class="dv">122</span>,</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    1728L,    <span class="dv">103</span>,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    1729L,     <span class="dv">73</span>,</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    1730L,     <span class="dv">47</span>,</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    1731L,     <span class="dv">35</span>,</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    1732L,     <span class="dv">11</span>,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    1733L,      <span class="dv">5</span>,</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    1734L,     <span class="dv">16</span>,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    1735L,     <span class="dv">34</span>,</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    1736L,     <span class="dv">70</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    1737L,     <span class="dv">81</span>,</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    1738L,    <span class="dv">111</span>,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    1739L,    <span class="dv">101</span>,</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    1740L,     <span class="dv">73</span>,</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    1741L,     <span class="dv">40</span>,</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>    1742L,     <span class="dv">20</span>,</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>    1743L,     <span class="dv">16</span>,</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>    1744L,      <span class="dv">5</span>,</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>    1745L,     <span class="dv">11</span>,</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    1746L,     <span class="dv">22</span>,</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>    1747L,     <span class="dv">40</span>,</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>    1748L,     <span class="dv">60</span>,</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>    1749L,   <span class="fl">80.9</span>,</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    1750L,   <span class="fl">83.4</span>,</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    1751L,   <span class="fl">47.7</span>,</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>    1752L,   <span class="fl">47.8</span>,</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>    1753L,   <span class="fl">30.7</span>,</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>    1754L,   <span class="fl">12.2</span>,</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>    1755L,    <span class="fl">9.6</span>,</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>    1756L,   <span class="fl">10.2</span>,</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>    1757L,   <span class="fl">32.4</span>,</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>    1758L,   <span class="fl">47.6</span>,</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>    1759L,     <span class="dv">54</span>,</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>    1760L,   <span class="fl">62.9</span>,</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>    1761L,   <span class="fl">85.9</span>,</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>    1762L,   <span class="fl">61.2</span>,</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>    1763L,   <span class="fl">45.1</span>,</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>    1764L,   <span class="fl">36.4</span>,</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>    1765L,   <span class="fl">20.9</span>,</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>    1766L,   <span class="fl">11.4</span>,</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>    1767L,   <span class="fl">37.8</span>,</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>    1768L,   <span class="fl">69.8</span>,</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>    1769L,  <span class="fl">106.1</span>,</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>    1770L,  <span class="fl">100.8</span>,</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>    1771L,   <span class="fl">81.6</span>,</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>    1772L,   <span class="fl">66.5</span>,</span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>    1773L,   <span class="fl">34.8</span>,</span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a>    1774L,   <span class="fl">30.6</span>,</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>    1775L,      <span class="dv">7</span>,</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>    1776L,   <span class="fl">19.8</span>,</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>    1777L,   <span class="fl">92.5</span>,</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>    1778L,  <span class="fl">154.4</span>,</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>    1779L,  <span class="fl">125.9</span>,</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>    1780L,   <span class="fl">84.8</span>,</span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>    1781L,   <span class="fl">68.1</span>,</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>    1782L,   <span class="fl">38.5</span>,</span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a>    1783L,   <span class="fl">22.8</span>,</span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>    1784L,   <span class="fl">10.2</span>,</span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>    1785L,   <span class="fl">24.1</span>,</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>    1786L,   <span class="fl">82.9</span>,</span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>    1787L,    <span class="dv">132</span>,</span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>    1788L,  <span class="fl">130.9</span>,</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a>    1789L,  <span class="fl">118.1</span>,</span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>    1790L,   <span class="fl">89.9</span>,</span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>    1791L,   <span class="fl">66.6</span>,</span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a>    1792L,     <span class="dv">60</span>,</span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a>    1793L,   <span class="fl">46.9</span>,</span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a>    1794L,     <span class="dv">41</span>,</span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>    1795L,   <span class="fl">21.3</span>,</span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>    1796L,     <span class="dv">16</span>,</span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a>    1797L,    <span class="fl">6.4</span>,</span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a>    1798L,    <span class="fl">4.1</span>,</span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a>    1799L,    <span class="fl">6.8</span>,</span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a>    1800L,   <span class="fl">14.5</span>,</span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a>    1801L,     <span class="dv">34</span>,</span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a>    1802L,     <span class="dv">45</span>,</span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a>    1803L,   <span class="fl">43.1</span>,</span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a>    1804L,   <span class="fl">47.5</span>,</span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a>    1805L,   <span class="fl">42.2</span>,</span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>    1806L,   <span class="fl">28.1</span>,</span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a>    1807L,   <span class="fl">10.1</span>,</span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a>    1808L,    <span class="fl">8.1</span>,</span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a>    1809L,    <span class="fl">2.5</span>,</span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a>    1810L,      <span class="dv">0</span>,</span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a>    1811L,    <span class="fl">1.4</span>,</span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a>    1812L,      <span class="dv">5</span>,</span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a>    1813L,   <span class="fl">12.2</span>,</span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a>    1814L,   <span class="fl">13.9</span>,</span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a>    1815L,   <span class="fl">35.4</span>,</span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a>    1816L,   <span class="fl">45.8</span>,</span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a>    1817L,   <span class="fl">41.1</span>,</span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a>    1818L,   <span class="fl">30.1</span>,</span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a>    1819L,   <span class="fl">23.9</span>,</span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a>    1820L,   <span class="fl">15.6</span>,</span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a>    1821L,    <span class="fl">6.6</span>,</span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a>    1822L,      <span class="dv">4</span>,</span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>    1823L,    <span class="fl">1.8</span>,</span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a>    1824L,    <span class="fl">8.5</span>,</span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a>    1825L,   <span class="fl">16.6</span>,</span>
<span id="cb54-129"><a href="#cb54-129" aria-hidden="true" tabindex="-1"></a>    1826L,   <span class="fl">36.3</span>,</span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a>    1827L,   <span class="fl">49.6</span>,</span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a>    1828L,   <span class="fl">64.2</span>,</span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a>    1829L,     <span class="dv">67</span>,</span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a>    1830L,   <span class="fl">70.9</span>,</span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a>    1831L,   <span class="fl">47.8</span>,</span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a>    1832L,   <span class="fl">27.5</span>,</span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a>    1833L,    <span class="fl">8.5</span>,</span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a>    1834L,   <span class="fl">13.2</span>,</span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a>    1835L,   <span class="fl">56.9</span>,</span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a>    1836L,  <span class="fl">121.5</span>,</span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a>    1837L,  <span class="fl">138.3</span>,</span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a>    1838L,  <span class="fl">103.2</span>,</span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a>    1839L,   <span class="fl">85.7</span>,</span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a>    1840L,   <span class="fl">64.6</span>,</span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a>    1841L,   <span class="fl">36.7</span>,</span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a>    1842L,   <span class="fl">24.2</span>,</span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a>    1843L,   <span class="fl">10.7</span>,</span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a>    1844L,     <span class="dv">15</span>,</span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a>    1845L,   <span class="fl">40.1</span>,</span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a>    1846L,   <span class="fl">61.5</span>,</span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>    1847L,   <span class="fl">98.5</span>,</span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a>    1848L,  <span class="fl">124.7</span>,</span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a>    1849L,   <span class="fl">96.3</span>,</span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a>    1850L,   <span class="fl">66.6</span>,</span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a>    1851L,   <span class="fl">64.5</span>,</span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a>    1852L,   <span class="fl">54.1</span>,</span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a>    1853L,     <span class="dv">39</span>,</span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a>    1854L,   <span class="fl">20.6</span>,</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a>    1855L,    <span class="fl">6.7</span>,</span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>    1856L,    <span class="fl">4.3</span>,</span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a>    1857L,   <span class="fl">22.7</span>,</span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a>    1858L,   <span class="fl">54.8</span>,</span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a>    1859L,   <span class="fl">93.8</span>,</span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a>    1860L,   <span class="fl">95.8</span>,</span>
<span id="cb54-164"><a href="#cb54-164" aria-hidden="true" tabindex="-1"></a>    1861L,   <span class="fl">77.2</span>,</span>
<span id="cb54-165"><a href="#cb54-165" aria-hidden="true" tabindex="-1"></a>    1862L,   <span class="fl">59.1</span>,</span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a>    1863L,     <span class="dv">44</span>,</span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>    1864L,     <span class="dv">47</span>,</span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a>    1865L,   <span class="fl">30.5</span>,</span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a>    1866L,   <span class="fl">16.3</span>,</span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a>    1867L,    <span class="fl">7.3</span>,</span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a>    1868L,   <span class="fl">37.6</span>,</span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a>    1869L,     <span class="dv">74</span>,</span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a>    1870L,    <span class="dv">139</span>,</span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a>    1871L,  <span class="fl">111.2</span>,</span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a>    1872L,  <span class="fl">101.6</span>,</span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a>    1873L,   <span class="fl">66.2</span>,</span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a>    1874L,   <span class="fl">44.7</span>,</span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a>    1875L,     <span class="dv">17</span>,</span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a>    1876L,   <span class="fl">11.3</span>,</span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a>    1877L,   <span class="fl">12.4</span>,</span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a>    1878L,    <span class="fl">3.4</span>,</span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a>    1879L,      <span class="dv">6</span>,</span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>    1880L,   <span class="fl">32.3</span>,</span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a>    1881L,   <span class="fl">54.3</span>,</span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a>    1882L,   <span class="fl">59.7</span>,</span>
<span id="cb54-186"><a href="#cb54-186" aria-hidden="true" tabindex="-1"></a>    1883L,   <span class="fl">63.7</span>,</span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a>    1884L,   <span class="fl">63.5</span>,</span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>    1885L,   <span class="fl">52.2</span>,</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a>    1886L,   <span class="fl">25.4</span>,</span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a>    1887L,   <span class="fl">13.1</span>,</span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>    1888L,    <span class="fl">6.8</span>,</span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a>    1889L,    <span class="fl">6.3</span>,</span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a>    1890L,    <span class="fl">7.1</span>,</span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a>    1891L,   <span class="fl">35.6</span>,</span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a>    1892L,     <span class="dv">73</span>,</span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a>    1893L,   <span class="fl">85.1</span>,</span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>    1894L,     <span class="dv">78</span>,</span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>    1895L,     <span class="dv">64</span>,</span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a>    1896L,   <span class="fl">41.8</span>,</span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a>    1897L,   <span class="fl">26.2</span>,</span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a>    1898L,   <span class="fl">26.7</span>,</span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a>    1899L,   <span class="fl">12.1</span>,</span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a>    1900L,    <span class="fl">9.5</span>,</span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a>    1901L,    <span class="fl">2.7</span>,</span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a>    1902L,      <span class="dv">5</span>,</span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a>    1903L,   <span class="fl">24.4</span>,</span>
<span id="cb54-207"><a href="#cb54-207" aria-hidden="true" tabindex="-1"></a>    1904L,     <span class="dv">42</span>,</span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a>    1905L,   <span class="fl">63.5</span>,</span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a>    1906L,   <span class="fl">53.8</span>,</span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a>    1907L,     <span class="dv">62</span>,</span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a>    1908L,   <span class="fl">48.5</span>,</span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a>    1909L,   <span class="fl">43.9</span>,</span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>    1910L,   <span class="fl">18.6</span>,</span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a>    1911L,    <span class="fl">5.7</span>,</span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a>    1912L,    <span class="fl">3.6</span>,</span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a>    1913L,    <span class="fl">1.4</span>,</span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a>    1914L,    <span class="fl">9.6</span>,</span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a>    1915L,   <span class="fl">47.4</span>,</span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a>    1916L,   <span class="fl">57.1</span>,</span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a>    1917L,  <span class="fl">103.9</span>,</span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a>    1918L,   <span class="fl">80.6</span>,</span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a>    1919L,   <span class="fl">63.6</span>,</span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a>    1920L,   <span class="fl">37.6</span>,</span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a>    1921L,   <span class="fl">26.1</span>,</span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a>    1922L,   <span class="fl">14.2</span>,</span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a>    1923L,    <span class="fl">5.8</span>,</span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a>    1924L,   <span class="fl">16.7</span>,</span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a>    1925L,   <span class="fl">44.3</span>,</span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a>    1926L,   <span class="fl">63.9</span>,</span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a>    1927L,     <span class="dv">69</span>,</span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a>    1928L,   <span class="fl">77.8</span>,</span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a>    1929L,   <span class="fl">64.9</span>,</span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a>    1930L,   <span class="fl">35.7</span>,</span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a>    1931L,   <span class="fl">21.2</span>,</span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a>    1932L,   <span class="fl">11.1</span>,</span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a>    1933L,    <span class="fl">5.7</span>,</span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a>    1934L,    <span class="fl">8.7</span>,</span>
<span id="cb54-238"><a href="#cb54-238" aria-hidden="true" tabindex="-1"></a>    1935L,   <span class="fl">36.1</span>,</span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a>    1936L,   <span class="fl">79.7</span>,</span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a>    1937L,  <span class="fl">114.4</span>,</span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a>    1938L,  <span class="fl">109.6</span>,</span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a>    1939L,   <span class="fl">88.8</span>,</span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a>    1940L,   <span class="fl">67.8</span>,</span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a>    1941L,   <span class="fl">47.5</span>,</span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a>    1942L,   <span class="fl">30.6</span>,</span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a>    1943L,   <span class="fl">16.3</span>,</span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>    1944L,    <span class="fl">9.6</span>,</span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a>    1945L,   <span class="fl">33.2</span>,</span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a>    1946L,   <span class="fl">92.6</span>,</span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a>    1947L,  <span class="fl">151.6</span>,</span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a>    1948L,  <span class="fl">136.3</span>,</span>
<span id="cb54-252"><a href="#cb54-252" aria-hidden="true" tabindex="-1"></a>    1949L,  <span class="fl">134.7</span>,</span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a>    1950L,   <span class="fl">83.9</span>,</span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a>    1951L,   <span class="fl">69.4</span>,</span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a>    1952L,   <span class="fl">31.5</span>,</span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a>    1953L,   <span class="fl">13.9</span>,</span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a>    1954L,    <span class="fl">4.4</span>,</span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a>    1955L,     <span class="dv">38</span>,</span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a>    1956L,  <span class="fl">141.7</span>,</span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a>    1957L,  <span class="fl">190.2</span>,</span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a>    1958L,  <span class="fl">184.8</span>,</span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a>    1959L,    <span class="dv">159</span>,</span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a>    1960L,  <span class="fl">112.3</span>,</span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a>    1961L,   <span class="fl">53.9</span>,</span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a>    1962L,   <span class="fl">37.5</span>,</span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a>    1963L,   <span class="fl">27.9</span>,</span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a>    1964L,   <span class="fl">10.2</span>,</span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a>    1965L,   <span class="fl">15.1</span>,</span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a>    1966L,     <span class="dv">47</span>,</span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a>    1967L,   <span class="fl">93.8</span>,</span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a>    1968L,  <span class="fl">105.9</span>,</span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a>    1969L,  <span class="fl">105.5</span>,</span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a>    1970L,  <span class="fl">104.5</span>,</span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a>    1971L,   <span class="fl">66.6</span>,</span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a>    1972L,   <span class="fl">68.9</span>,</span>
<span id="cb54-276"><a href="#cb54-276" aria-hidden="true" tabindex="-1"></a>    1973L,     <span class="dv">38</span>,</span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a>    1974L,   <span class="fl">34.5</span>,</span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a>    1975L,   <span class="fl">15.5</span>,</span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>    1976L,   <span class="fl">12.6</span>,</span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a>    1977L,   <span class="fl">27.5</span>,</span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a>    1978L,   <span class="fl">92.5</span>,</span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a>    1979L,  <span class="fl">155.4</span>,</span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>    1980L,  <span class="fl">154.7</span>,</span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a>    1981L,  <span class="fl">140.5</span>,</span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a>    1982L,  <span class="fl">115.9</span>,</span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a>    1983L,   <span class="fl">66.6</span>,</span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>    1984L,   <span class="fl">45.9</span>,</span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a>    1985L,   <span class="fl">17.9</span>,</span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a>    1986L,   <span class="fl">13.4</span>,</span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a>    1987L,   <span class="fl">29.2</span>,</span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a>    1988L,  <span class="fl">100.2</span></span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sunspot.year)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Time"</span>, <span class="st">"Value"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sunspot.year,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
   Time Value
  &lt;int&gt; &lt;dbl&gt;
1  1700     5
2  1701    11
3  1702    16
4  1703    23
5  1704    36</code></pre>
</div>
</div>
<p>Boxplot을 그려서 Outlier 존재 여부를 확인하고, 결측치의 존재여부를 확인한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(sunspot.year<span class="sc">$</span>Value) <span class="co"># Outer Fence 밖의 값들이 다수 존재하는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(sunspot.year<span class="sc">$</span>Value)) <span class="co"># 0이라 결측치가 존재하지 않는다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">boxplot</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$stats
      [,1]
[1,]   0.0
[2,]  15.6
[3,]  39.0
[4,]  68.9
[5,] 141.7

$n
[1] 289

$conf
         [,1]
[1,] 34.04624
[2,] 43.95376

$out
[1] 154.4 151.6 190.2 184.8 159.0 155.4 154.7

$group
[1] 1 1 1 1 1 1 1

$names
[1] "1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>((<span class="fu">boxplot</span>(sunspot.year<span class="sc">$</span>Value))<span class="sc">$</span>out) <span class="co"># 총 7개의 Outlier가 존재한다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upper outer fence의 값은 141.7이다.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(sunspot.year,sunspot.year<span class="sc">$</span>Value<span class="sc">&gt;</span><span class="fl">141.7</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
   Time Value
  &lt;int&gt; &lt;dbl&gt;
1  1778  154.
2  1947  152.
3  1957  190.
4  1958  185.
5  1959  159 
6  1979  155.
7  1980  155.</code></pre>
</div>
</div>
<p>1778년, 1947년, 1957년, 1958년, 1959년, 1979년, 1980년 데이터가 outer fence 밖에서 발견되며 1950년대 후반에 3년 연속으로, 1979~1980년 2년 연속 outlier를 보였다는 점을 염두에 두고 데이터 분석을 진행해야 할 것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(sunspot.year<span class="sc">$</span>Value,<span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

   0 | 000112233334444455555666666777777788999
   1 | 000000000111111111222233334445556666666677789
   2 | 000111112233344445666778888899
   3 | 0111122234455556666667888888999
   4 | 0000112223444555667777778888889
   5 | 024444457789
   6 | 0000122334444444555677777788999
   7 | 00133347888
   8 | 0111233455669
   9 | 033344669
  10 | 01123345666
  11 | 0112468
  12 | 2256
  13 | 125689
  14 | 12
  15 | 24559
  16 | 
  17 | 
  18 | 5
  19 | 0</code></pre>
</div>
</div>
<p>앞에서 언급하엿었던 것 처럼 총 7개의 outlier를 확인할 수 있고, 전반적으로 skewed되어있는 데이터인 것으로 확인된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  hl<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">2</span>]</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  median<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">3</span>]</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  hu<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">4</span>]</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>((hu<span class="sc">-</span>median)<span class="sc">-</span>(median<span class="sc">-</span>hl))<span class="sc">/</span>((hu<span class="sc">-</span>median)<span class="sc">+</span>(median<span class="sc">-</span>hl))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(sunspot.year<span class="sc">$</span>Value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1219512</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">log</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2337415</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">sqrt</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.05509413</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5512195</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.4023891</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sqrt 변환을 skewness가 최소화 되는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>skewness를 계산할 경우 자료가 정규분포에 비해 skewed to the right 라는 사실을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(<span class="fu">sqrt</span>(sunspot.year<span class="sc">$</span>Value)) <span class="co"># 자료의 비대칭성이 다소 개선 된 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is at the |

   0 | 000
   1 | 223466789
   2 | 001122222444455666667788999
   3 | 1111222223333333445555566777889999
   4 | 0000001112345556666778889999
   5 | 0111222233344555556778889999
   6 | 0000001111122222333344555666777788899999999999
   7 | 0023334445667777788999
   8 | 0000000001122222223333444555688889
   9 | 000011222334566677889
  10 | 000112223335556789
  11 | 002245678899
  12 | 34456
  13 | 68</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd2=</span><span class="fu">lsum</span>(sunspot.year<span class="sc">$</span>Value,<span class="dv">9</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid  upper spread
1      M 145.0  39.0 39.000  39.00   0.00
2      H  73.0  15.6 42.250  68.90  53.30
3      E  37.0   8.5 54.350 100.20  91.70
4      D  19.0   5.0 63.250 121.50 116.50
5      C  10.0   3.0 71.000 139.00 136.00
6      B   5.5   1.6 78.075 154.55 152.95
7      A   3.0   0.0 79.500 159.00 159.00
8      Z   2.0   0.0 92.400 184.80 184.80
9      Y   1.5   0.0 93.750 187.50 187.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread )- 1.705</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>(lvd2[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd2[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd2[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd2[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01545028</code></pre>
</div>
</div>
<p>데이터의 Five Numbers와 요약 지표</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(sunspot.year<span class="sc">$</span>Value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   0.0  15.6  39.0  68.9 190.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sunspot.year<span class="sc">$</span>Value)<span class="co"># Median, Mean이 큰 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   15.60   39.00   48.61   68.90  190.20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">summary</span>(sunspot.year<span class="sc">$</span>Value)[<span class="dv">6</span>]<span class="sc">-</span><span class="fu">summary</span>(sunspot.year<span class="sc">$</span>Value)[<span class="dv">1</span>]) <span class="co"># 최고점과 최저점 사이의 차이는 190.20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 190.2</code></pre>
</div>
</div>
<p>데이터의 최고점과 최저점 사이의 차이는 190.2정도인 것으로 확인된다. Median과 Mean값 사이의 차이가 꽤 크다는 점에서 skewed to the right 되었다는 사실을 어느정도 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(sunspot.year<span class="sc">$</span>Value, <span class="at">ylab=</span><span class="st">"Sunspots quantiles"</span>);<span class="fu">qqline</span>(sunspot.year<span class="sc">$</span>Value, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>fiv<span class="ot">=</span><span class="fu">fivenum</span>(sunspot.year<span class="sc">$</span>Value)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma =</span> (fiv[<span class="dv">4</span>]<span class="sc">-</span>fiv[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.77612</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(sunspot.year<span class="sc">$</span>Value) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.4741</code></pre>
</div>
</div>
<p>psudosigma와 실제 표준편차 사이에 큰 차이가 없는 것이 확인된다. 다만 qqplot에서 데이터가 직선을 따르기 보다는 Convex한 곡선을 따르고 있는 것처럼 보인다. (정규분포는 아니다)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(sunspot.year<span class="sc">$</span>Value, <span class="at">ylab=</span><span class="st">"Sunspots quantiles"</span>);<span class="fu">qqline</span>(sunspot.year<span class="sc">$</span>Value, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv[<span class="dv">3</span>],pseudosigma,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">sub=</span><span class="st">"intercept=39.00(median); slope=39.776 (pseudo-sigma) blue line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">sqrt</span>(sunspot.year<span class="sc">$</span>Value), <span class="at">ylab=</span><span class="st">"Sqrt Sunspots quantiles"</span>);<span class="fu">qqline</span>(<span class="fu">sqrt</span>(sunspot.year<span class="sc">$</span>Value), <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 변환 이전의 데이터에 비해서 정규분포를 상대적으로 잘 따르고 있는 것으로 보인다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터가 감마분포를 따르는가?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>Sunspot.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(sunspot.year<span class="sc">$</span>Value)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>(n.Sunspot<span class="ot">&lt;-</span> <span class="fu">length</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n.Sunspot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(mean.Sunspot <span class="ot">&lt;-</span> <span class="fu">mean</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.61349</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(var.Sunspot <span class="ot">&lt;-</span> <span class="fu">var</span>(sunspot.year<span class="sc">$</span>Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1558.205</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(shape.Sunspot <span class="ot">&lt;-</span> mean.Sunspot<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>var.Sunspot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.516663</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(scale.Sunspot <span class="ot">&lt;-</span> mean.Sunspot<span class="sc">/</span>var.Sunspot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0311984</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>q.gamma.Sunspot <span class="ot">&lt;-</span> <span class="fu">qgamma</span>((i<span class="fl">-0.5</span>)<span class="sc">/</span>n.Sunspot, shape.Sunspot, scale.Sunspot)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.gamma.Sunspot, Sunspot.sort, <span class="at">main=</span><span class="st">"Gamma prob plot"</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.gamma.Sunspot, Sunspot.sort)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] -4.149998  1.111070</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="sc">-</span><span class="fl">4.14999766208764</span>,<span class="at">b=</span><span class="fl">1.11107022976103</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># 위에서 7개의 Outlier들을 제외하면 대부분의 데이터들이 직선 위에 존재하고 있는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>데이터들이 Outlier들을 제외하면 감마분포를 잘 따르고 있는 것으로 보인다. 다만 데이터들이 0 근처에 Dense하게 몰려있는 것으로 보아 3승근 변환을 통해서 그러한 경향성을 완화하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.gamma.Sunspot<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), Sunspot.sort<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">main=</span><span class="st">"Gamma prob plot"</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.gamma.Sunspot<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), Sunspot.sort<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] -0.5476324  1.1517409</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="sc">-</span><span class="fl">0.547632367221911</span>,<span class="at">b=</span><span class="fl">1.15174089923436</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>삼승근 변환 후의 데이터들이 직선위에 잘 모여있는 것으로 보아 시계열 데이터들이 감마분포를 잘 다르고 있다고 볼 수 있다.</p>
</section>
<section id="정리" class="level2">
<h2 class="anchored" data-anchor-id="정리">정리</h2>
<p>데이터가 현재 정규분포가 아닌 감마분포를 따르고 있는 것으로 보인다. 데이터의 정규성을 확보하기 위해서, sqrt 변환이나 Box Cox Transformation을 활용해 분석을 추가로 진행하고자 한다.</p>
<p>평활을 진행하기 전 데이터가 어떤 경향을 가지고 있는지 Raw data와 차분 데이터에 대한 Plot을 그려 확인한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("forecast")</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>sunspot.year<span class="ot">=</span><span class="fu">ts</span>(sunspot.year<span class="sc">$</span>Value,<span class="at">start=</span><span class="dv">1700</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year, <span class="at">main =</span> <span class="st">"Sunspot.year Time-Series Plot"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox.lambda</span>(sunspot.year<span class="fl">+1e-07</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>sunspot.year_new <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox</span>(sunspot.year, lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sunspot.year_new, <span class="at">main =</span> <span class="st">"Box-Cox : Sunspot.year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(sunspot.year_new), <span class="at">main =</span> <span class="st">"Difference &amp; Box-Cox : sunspot.year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Box-Cox Transformation을 통해서 데이터를 변환하였다. 다만, 0인 값이 있어 매우 작은 수를 더해 경향성 만을 확인할 수 있도록 변환하였다. (변환을 적용하기 적합하지 않음)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox.lambda</span>(sunspot.year<span class="fl">+1e-07</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>sunspot.year_new <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox</span>(sunspot.year, lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year_new, <span class="at">main =</span> <span class="st">"Box-Cox : Sunspot.year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>변환전 그래프와 변환 후 그래프를 비교할 경우 차분된 데이터를 확인하면 원자료에서는 분산이 증가하는 경향성이 있었는데 두 변환을 사용할 경우 그 경향성이 다소 완화된 것이 확인되어 진다. 순서대로 원자료에 대한 평활 / Box-Cox Transforamtion에 대한 평활 / Sqrt 변환에 대한 평활을 진행하고자 한다. (3RSSH Twice,4253H Twice)</p>
<p>원자료 3RSSH Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>smooth_3RSSH<span class="ot">=</span><span class="cf">function</span>(data){</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    smooth3RSS<span class="ot">=</span><span class="fu">smooth</span>(data, <span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">=</span><span class="fu">length</span>(data)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    smooth3RSSH<span class="ot">=</span>smooth3RSS</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {smooth3RSSH[i] <span class="ot">&lt;-</span> smooth3RSS[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    smooth3RSSH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS[<span class="dv">1</span>]; smooth3RSSH[n] <span class="ot">&lt;-</span> smooth3RSS[n]</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    rough<span class="ot">=</span>data<span class="sc">-</span>smooth3RSSH</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    roughH<span class="ot">=</span>rough</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    smooth3RSS2<span class="ot">=</span><span class="fu">smooth</span>(rough,<span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) roughH[i] <span class="ot">&lt;-</span> smooth3RSS2[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS2[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS2[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>    roughH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS2[<span class="dv">1</span>]; roughH[n] <span class="ot">&lt;-</span> smooth3RSS2[n]</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span>smooth3RSSH<span class="sc">+</span>roughH</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">as.vector</span>(out)</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year,<span class="at">main=</span><span class="st">"Raw Data: Default, 3RSSH Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(sunspot.year),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">190</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>), </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>원자료 4253H Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year,<span class="at">main=</span><span class="st">"Raw Data: Default, 4253H Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(sunspot.year),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">190</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"4253H Twice"</span>), </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Boxcox 3RSSH Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year_new,<span class="at">main=</span><span class="st">"Box-Cox Transformed Data: Default, 3RSSH Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(sunspot.year_new),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1850</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>), </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Boxcox 4253H Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year_new,<span class="at">main=</span><span class="st">"Box-Cox Transformed Data: Default, 4253H Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(sunspot.year_new),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1850</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"4253H Twice"</span>), </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sqrt 3RSSH Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">sqrt</span>(sunspot.year),<span class="at">main=</span><span class="st">"Sqrt Transformed Data: Default, 3RSSH Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(<span class="fu">sqrt</span>(sunspot.year)),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>), </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sqrt 4253H Twice</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">sqrt</span>(sunspot.year),<span class="at">main=</span><span class="st">"Sqrt Transformed Data: Default, 4253H Twice"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(<span class="fu">sqrt</span>(sunspot.year)),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"4253H Twice"</span>), </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>평활된 자료를 비교하기</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year,<span class="at">main=</span><span class="st">"Raw Data:All"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(sunspot.year),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(sunspot.year),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(sunspot.year, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"darkgreen"</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">190</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>,<span class="st">"3RS3R Twice"</span>), </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>총 289년간 26번의 Fluctuation이 있는 것으로 보아 대략 11년마다 주기가 반복되어지는 것이 확인된다.</li>
<li>각 주기별 Fluctuation에서 늘어나는 속도와 줄어드는 속도는 대체로 대칭적인 것으로 확인되어 진다.</li>
<li>3RSSH twice 기법에 비해 4253H twice에서의 시계열 데이터가 조금 더 이 Fluctuation의 크기가 줄어든 것이 확인되어 진다.</li>
<li>3RSSH Twice,4253H Twice 두 기법 모두 Hanning을 사용하여 3RS3R Twice 기법에 비해 평평한 지접이 나타나지 않는다.</li>
<li>3RS3R Twice –&gt; 3RSSH Twice –&gt; 4253H Twice 순으로 극단값에 민감 한 것으로 보인다. 다만, 앞에서 언급하였던 1778년, 1947년, 1957년, 1958년, 1959년, 1979년, 1980년 자료들의 값들을 4253H Twice 기법이 다른 Smoothing 기법에 비해서 많이 깎아냈기 때문에 해석에 유의가 필요할 것으로 보인다.</li>
<li>평활법을 사용하면 양 끝값을 실제 데이터를 활용하지 않고 인접 데이터들을 활용해 계산하기 때문에 실제 데이터에 비해서 덜 늘어나는 경향이 있다. 1988년도 실제 데이터는 더 늘어나고 있다는 점을 유의하여 해석해야 할 것이다.</li>
<li>1950년대후반~1960년대초반에 Fluctuaition의 크기가 가장 큰 것으로 확인되고 1800년대 초반의 Fluctuation의 크기가 상대적으로 작은 것으로 보인다.</li>
<li>봉우리의 Cycle은 앞에서 언급하였던 것 처럼 11년 정도이고 이 봉우리의 크기 또한 Fluctuate하는데 약 50년~60년 정도 마다 늘어나고 줄어드는 속도 또한 늘어나고 줄어드는 것으로 보인다. (ex, 1800s년대 초반 3주기 까지는 봉우리의 크기가 작다가 1840년이후의 3~4주기 정도는 봉우리의 크기가 늘어나고 그 이후 3주기 정도는 다시 그 크기가 줄어들고 있다.) (각 봉우리들의 크기 또한 주기성에 따라 움직이고 있는 것이 확인되어 진다.)</li>
<li>이 분석에서는 주기성에 의미를 부여하기 위해서 3RSSH Twice Smoothing 기법이 다른 기법들에 비해서 해석에 도움이 될 것으로 보인다. 4253H Twice 기법을 사용할 경우 봉우리들의 크기 변화를 포착하기 어렵기 때문이다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(sunspot.year_new,<span class="at">main=</span><span class="st">"Box-Cox Transformed Data:All"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(sunspot.year_new),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(sunspot.year_new),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">1880</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">sqrt</span>(sunspot.year),<span class="at">main=</span><span class="st">"Sqrt Transformed Data:All"</span>,<span class="at">ylab=</span><span class="st">"Spots"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1700</span>,<span class="dv">2000</span>))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(<span class="fu">sqrt</span>(sunspot.year)),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(<span class="fu">sqrt</span>(sunspot.year)),<span class="at">start=</span><span class="dv">1700</span>,<span class="at">end=</span><span class="dv">1988</span>),<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>자료를 변환하고 Smoothing을 적용할 경우 각 봉우리들의 변화 크기가 정규화 되는 장점은 있으나 각 봉우리들의 크기 변화를 포착하기 어려워 지는 단점이 있다.</li>
<li>흑점의 수가 0인 지접이 있는데, 0일 경우에 Box-Cox Transformation을 사용하는 것은 부적절한 변환 방법이다. 따라서 주기성에 집중하기 위해서는 다른 변환 방법을 사용해야 할 것이다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(sunspot.year, <span class="at">nlag =</span> <span class="cn">NULL</span>, <span class="at">output =</span> <span class="cn">TRUE</span>) <span class="co"># p-value&lt;=0.01 귀무가설을 기각하여 정상시계열</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Augmented Dickey-Fuller Test 
alternative: stationary 
 
Type 1: no drift no trend 
     lag   ADF p.value
[1,]   0 -3.07  0.0100
[2,]   1 -6.03  0.0100
[3,]   2 -4.82  0.0100
[4,]   3 -3.41  0.0100
[5,]   4 -2.80  0.0100
[6,]   5 -1.92  0.0546
Type 2: with drift no trend 
     lag    ADF p.value
[1,]   0  -5.32    0.01
[2,]   1 -11.57    0.01
[3,]   2 -10.62    0.01
[4,]   3  -8.40    0.01
[5,]   4  -7.57    0.01
[6,]   5  -5.61    0.01
Type 3: with drift and trend 
     lag    ADF p.value
[1,]   0  -5.44    0.01
[2,]   1 -12.04    0.01
[3,]   2 -11.22    0.01
[4,]   3  -9.00    0.01
[5,]   4  -8.25    0.01
[6,]   5  -6.22    0.01
---- 
Note: in fact, p.value = 0.01 means p.value &lt;= 0.01 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(<span class="fu">arima</span>(sunspot.year,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Point Forecast      Lo 80     Hi 80      Lo 95     Hi 95
1989      140.83009 121.740253 159.91992 111.634707 170.02546
1990      155.71030 126.109440 185.31116 110.439691 200.98091
1991      142.43541 107.370583 177.50023  88.808386 196.06243
1992      113.77752  77.425429 150.12961  58.181795 169.37324
1993       77.79994  41.309958 114.28993  21.993327 133.60656
1994       44.01103   7.475744  80.54632 -11.864870  99.88694
1995       20.34908 -16.382092  57.08025 -35.826399  76.52455
1996       11.45779 -25.473329  48.38891 -45.023484  67.93907
1997       27.81698  -9.226678  64.86064 -28.836406  84.47036
1998       60.68808  23.577875  97.79829   3.932919 117.44325</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(<span class="fu">arima</span>(sunspot.year,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span><span class="dv">10</span>)) <span class="co"># Arima를 통해 미래 데이터가 어떻게 변할지 예측</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 실제 2014년까지의 흑점 데이터와 예측된 데이터의 추이를 비교할 경우 </span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>new<span class="ot">=</span><span class="fu">ts</span>(<span class="fu">read.table</span>(<span class="st">"https://raw.githubusercontent.com/SangwonJu/data/main/solar.txt"</span>)<span class="sc">$</span>V2,<span class="at">start=</span><span class="dv">1988</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(<span class="fu">arima</span>(sunspot.year,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">0</span>)),<span class="at">h=</span><span class="dv">26</span>))</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">220</span>, <span class="fu">c</span>(<span class="st">"Forecasted Data"</span>, <span class="st">"Actual Data"</span>), </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#2297E6"</span>,<span class="st">"red"</span>),<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>2000년대 초반까지의 흑점수의 변화는 거의 정확하게 예측된 것으로 보인다. 그 이후의 데이터는 다소 차이를 보이나 전반적인 추세는 유사한 것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(<span class="fu">auto.arima</span>(sunspot.year),<span class="at">h=</span><span class="dv">26</span>))</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(new,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1700</span>, <span class="at">y =</span> <span class="dv">220</span>, <span class="fu">c</span>(<span class="st">"Forecasted Data"</span>, <span class="st">"Actual Data"</span>), </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#2297E6"</span>,<span class="st">"red"</span>),<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="번-1" class="level1">
<h1>3번</h1>
<p>R의 fdeaths 자료를 평활하고 분석하여라</p>
<p>Monthly Deaths from Lung Diseases in the UK Three time series giving the monthly deaths from bronchitis, emphysema and asthma in the UK, 1974–1979, both sexes (ldeaths), males (mdeaths) and females (fdeaths).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>yr <span class="ot">&lt;-</span> <span class="fu">floor</span>(tt <span class="ot">&lt;-</span> <span class="fu">time</span>(mdeaths))</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mdeaths, fdeaths,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xy.labels =</span> <span class="fu">paste</span>(month.abb[<span class="dv">12</span><span class="sc">*</span>(tt <span class="sc">-</span> yr)], yr<span class="dv">-1900</span>, <span class="at">sep =</span> <span class="st">"'"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>fdeaths_ts<span class="ot">=</span><span class="fu">ts</span>(fdeaths,<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>))</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>fdeaths_ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec
1974  901  689  827  677  522  406  441  393  387  582  578  666
1975  830  752  785  664  467  438  421  412  343  440  531  771
1976  767 1141  896  532  447  420  376  330  357  445  546  764
1977  862  660  663  643  502  392  411  348  387  385  411  638
1978  796  853  737  546  530  446  431  362  387  430  425  679
1979  821  785  727  612  478  429  405  379  393  411  487  574</code></pre>
</div>
</div>
<p>결측치와 outlier의 존재여부를 체크하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fdeaths_ts, <span class="at">main=</span><span class="st">"Number of Female Deaths"</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">boxplot</span>(fdeaths_ts, <span class="at">main=</span><span class="st">"Number of Female Deaths"</span>)) <span class="co"># Outlier는 한개 존재한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$stats
     [,1]
[1,]  330
[2,]  411
[3,]  512
[4,]  684
[5,]  901

$n
[1] 72

$conf
         [,1]
[1,] 461.1661
[2,] 562.8339

$out
[1] 1141

$group
[1] 1

$names
[1] ""</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(fdeaths,fdeaths<span class="sc">&gt;</span><span class="dv">901</span>) <span class="co"># 1976년 2월 자료가 Fence 밖의 Outlier 인 것으로 확인된다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(fdeaths_ts)) <span class="co">#결측치는 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Stem and Leaf Plot을 활용해 자료의 분포를 예측해보자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(fdeaths_ts,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 2 digit(s) to the right of the |

   3 | 34566889999999
   4 | 111111223333444555789
   5 | 0233355788
   6 | 1446667889
   7 | 34567799
   8 | 023356
   9 | 00
  10 | 
  11 | 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(fdeaths_ts,<span class="dv">2</span>) <span class="co"># Skewd to the right 된 자료 인 것으로 보인다. 위에서 Boxplot을 통해 확인했던 Outlier를 재확인 할 수 있었다. Stem 4를 축으로 해서 데이터들이 잘 Cluster 되어 있는 것이 확인되어 진다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 2 digit(s) to the right of the |

   3 | 34
   3 | 566889999999
   4 | 111111223333444
   4 | 555789
   5 | 02333
   5 | 55788
   6 | 144
   6 | 6667889
   7 | 34
   7 | 567799
   8 | 0233
   8 | 56
   9 | 00
   9 | 
  10 | 
  10 | 
  11 | 4</code></pre>
</div>
</div>
<p>Skewness와 Kurtosis의 분석</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  hl<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">2</span>]</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  median<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">3</span>]</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  hu<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">4</span>]</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>((hu<span class="sc">-</span>median)<span class="sc">-</span>(median<span class="sc">-</span>hl))<span class="sc">/</span>((hu<span class="sc">-</span>median)<span class="sc">+</span>(median<span class="sc">-</span>hl))</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(fdeaths_ts) <span class="co">#Skewed to the Right 되어 있는 것을 확인할 수 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2600733</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">log</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1379373</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">sqrt</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1996023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(fdeaths_ts)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01295976</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07555799</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minus Inverse 변환에서 Skewness가 최소화 되는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>skewness를 계산할 경우 자료가 정규분포에 비해 skewed to the right 라는 사실을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(<span class="fu">log</span>(fdeaths_ts))  <span class="co"># 자료의 비대칭성이 다소 개선 된 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  56 | 
  58 | 04589345666777
  60 | 012222445667899000579
  62 | 2677800567
  64 | 26790002249
  66 | 0244577812256
  68 | 00
  70 | 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(fdeaths_ts))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 4 digit(s) to the left of the |

  -30 | 3
  -28 | 270
  -26 | 6640
  -24 | 888544763333
  -22 | 885332877544
  -20 | 495
  -18 | 9298833
  -16 | 4323
  -14 | 762110875
  -12 | 863100776210
  -10 | 7621
   -8 | 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단봉 분포가 아니라 쌍봉분포 인 것으로 보인다. stem (-24,-22)와 stem -12를 중심으로 하는 두개의 Cluster가 있는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd3=</span><span class="fu">lsum</span>(fdeaths_ts,<span class="dv">9</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid  upper spread
1      M  36.5 512.0 512.00  512.0    0.0
2      H  18.5 411.0 547.50  684.0  273.0
3      E   9.5 387.0 588.75  790.5  403.5
4      D   5.0 362.0 607.50  853.0  491.0
5      C   3.0 348.0 622.00  896.0  548.0
6      B   2.0 343.0 622.00  901.0  558.0
7      A   1.5 336.5 678.75 1021.0  684.5
8      Z   1.0 330.0 735.50 1141.0  811.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread) / (H-spread) - 1.705</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>(lvd3[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd3[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd3[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd3[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># flatter than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.226978</code></pre>
</div>
</div>
<p>데이터의 Five Numbers와 요약 지표</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(fdeaths_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  330  411  512  684 1141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fdeaths_ts)<span class="co"># Median, Mean이 큰 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  330.0   411.0   512.0   560.7   681.5  1141.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">summary</span>(fdeaths_ts)[<span class="dv">6</span>]<span class="sc">-</span><span class="fu">summary</span>(fdeaths_ts)[<span class="dv">1</span>]) <span class="co"># 최고점과 최저점 사이의 차이는 811명</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 811</code></pre>
</div>
</div>
<p>데이터의 최고점과 최저점 사이의 차이는 811 정도인 것으로 확인된다. Median과 Mean값 사이의 차이가 50명 내외로 나타나고 있는 것이 확인되어 진다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fdeaths_ts, <span class="at">ylab=</span><span class="st">"Sunspots quantiles"</span>);<span class="fu">qqline</span>(fdeaths_ts, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>fiv<span class="ot">=</span><span class="fu">fivenum</span>(fdeaths_ts)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma =</span> (fiv[<span class="dv">4</span>]<span class="sc">-</span>fiv[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203.7313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(fdeaths_ts) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 179.72</code></pre>
</div>
</div>
<p>psudosigma와 실제 표준편차 사이에 30정도의 차이가 확인된다. 그러나 qqplot에서 데이터가 직선을 따르기 보다는 역S자의 곡선을 이루고 있는 것으로 보인다. (Sample 분포가 정규분포는 아니다)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fdeaths_ts, <span class="at">ylab=</span><span class="st">"Female Deaths quantiles"</span>);<span class="fu">qqline</span>(fdeaths_ts, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv[<span class="dv">3</span>],pseudosigma,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">sub=</span><span class="st">"intercept=512(median); slope=203.7313 (pseudo-sigma) blue line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>fdeaths_ts, <span class="at">ylab=</span><span class="st">"Minus Inverse Sunspots quantiles"</span>);<span class="fu">qqline</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>fdeaths_ts, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(fdeaths_ts), <span class="at">ylab=</span><span class="st">"Log Sunspots quantiles"</span>);<span class="fu">qqline</span>(<span class="fu">log</span>(fdeaths_ts), <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 변환을 적용하더라도 qqplot에서 데이터의 역S자적 경향은 완화되지 않는다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터가 감마분포를 따르는가?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fdeaths.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(fdeaths_ts)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>(n.fdeaths<span class="ot">&lt;-</span> <span class="fu">length</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n.fdeaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>(mean.fdeaths <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 560.6806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>(var.fdeaths <span class="ot">&lt;-</span> <span class="fu">var</span>(fdeaths_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32299.29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>(shape.fdeaths <span class="ot">&lt;-</span> mean.fdeaths<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>var.fdeaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.732805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>(scale.fdeaths <span class="ot">&lt;-</span> mean.fdeaths<span class="sc">/</span>var.fdeaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01735891</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>q.gamma.fdeaths <span class="ot">&lt;-</span> <span class="fu">qgamma</span>((i<span class="fl">-0.5</span>)<span class="sc">/</span>n.fdeaths, shape.fdeaths, scale.fdeaths)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.gamma.fdeaths, fdeaths.sort, <span class="at">main=</span><span class="st">"Gamma prob plot"</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.gamma.fdeaths, fdeaths.sort)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] -57.897347   1.101421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="sc">-</span><span class="fl">4.14999766208764</span>,<span class="at">b=</span><span class="fl">1.11107022976103</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lwd=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 Probability Plot에서 역 S자적 성질이 사라지지 않고 있기 때문에 데이터는 혼합 분포에서 추출 된 것으로 추측된다. Minus Inverse 변환을 통해서 예측하였던 것이 재 확인되고 있다.</p>
<section id="정리-1" class="level2">
<h2 class="anchored" data-anchor-id="정리-1">정리</h2>
<p>해당 데이터는 정규분포를 따르고 있지 않다. (정규성x)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths_ts, <span class="at">main =</span> <span class="st">"Female Deaths from Lung Diseases Time-Series Plot"</span>) <span class="co">#시계열 자료의 계절성을 확인할 수 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1976년을 제외하면 데이터의 Fluctuation이 일정하게 유지되고 있다.</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(fdeaths_ts), <span class="at">main =</span> <span class="st">"Difference : Female Deaths from Lung Diseases"</span>) <span class="co"># 차분데이터를 확인할 경우 동일하게 1976년 자료를 제외하면 분산의 증가 없이 일정하게 변동성이 유지 되는 것으로 볼 수 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-68-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Box-Cox Transformation을 통해서 데이터를 변환하였다. (계절변동을 확인하기 위해서 데이터의 정규성을 개선하기 위해)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox.lambda</span>(fdeaths_ts)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>fdeaths_ts_new <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox</span>(fdeaths_ts, lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdeaths_ts_new, <span class="at">main =</span> <span class="st">"Box-Cox : Female Deaths from lung diseases"</span>) <span class="co"># 1976년의 데이터의 이질성이 다소 완화되었다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(fdeaths_ts_new), <span class="at">main =</span> <span class="st">"Difference &amp; Box-Cox : Female Deaths from lung diseases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>fdeaths 데이터 - 분해 시계열</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절요인 분해시계열</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>fdeaths.decompose <span class="ot">&lt;-</span> <span class="fu">decompose</span>(fdeaths)       <span class="co"># 데이터에서 4가지 요인을 분해</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>fdeaths.decompose<span class="sc">$</span>seasonal                     <span class="co"># 계절요인으로 분해된 부분이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Jan        Feb        Mar        Apr        May        Jun
1974  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
1975  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
1976  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
1977  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
1978  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
1979  253.30417  276.72083  200.18750   39.36250  -73.05417 -131.32917
            Jul        Aug        Sep        Oct        Nov        Dec
1974 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583
1975 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583
1976 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583
1977 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583
1978 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583
1979 -148.36250 -195.49583 -192.26250 -106.68750  -63.97917  141.59583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdeaths.decompose)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths.decompose<span class="sc">$</span>seasonal,<span class="at">main=</span><span class="st">"The Plot of Seasoal Decomposition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-71-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>계절 요인을 제외한 나머지 변화 확인</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절요인 제외시키기</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>fdeaths.decompose_new <span class="ot">&lt;-</span> fdeaths <span class="sc">-</span> fdeaths.decompose<span class="sc">$</span>seasonal</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths.decompose_new, <span class="at">main=</span><span class="st">"Time-Series without Seasonal Effect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>계절성을 제외한 나머지 요인들을 분석할 경우 1976년도의 Random한 요인에 의해서 데이터가 늘어난 것을 확인 할 수 있다. 1977년도 초반의 Random한 요인 또한 시계열에서 1~2월 데이터를 각 년도 동기에 비해서 다소 낮은 수준으로 유지하게 만들었다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>fdeaths_1974<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>fdeaths_1975<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>fdeaths_1976<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">25</span><span class="sc">:</span><span class="dv">36</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>fdeaths_1977<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">37</span><span class="sc">:</span><span class="dv">48</span>],<span class="at">start=</span><span class="dv">1</span>)  </span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>fdeaths_1978<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">49</span><span class="sc">:</span><span class="dv">60</span>],<span class="at">start=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>fdeaths_1979<span class="ot">=</span><span class="fu">ts</span>(fdeaths_ts[<span class="dv">61</span><span class="sc">:</span><span class="dv">72</span>],<span class="at">start=</span><span class="dv">1</span>)  </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>yr<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"fdeaths"</span>,<span class="st">"_"</span>,<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>xat<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> yr) {<span class="fu">ts.plot</span>(<span class="fu">as.name</span>(i),<span class="at">main=</span>i,<span class="at">ylab=</span><span class="st">"Female Deaths by lung cancer"</span>)</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>각 년도별 계절성을 비교하기 위해서 이런식으로 그래프를 연도별로 쪼개서 그렸다. 연도별로 그러한 경향성이 비슷하게 드러나고 있는 것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ghibli")</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ghibli"</span>)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>pal<span class="ot">=</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>,<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#A6A0A0FF" "#ADB7C0FF" "#94C5CCFF" "#F4ADB3FF" "#EEBCB1FF" "#ECD89DFF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths_1974,<span class="at">main=</span><span class="st">"Female Deaths by lung diseases in UK"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span><span class="st">"#A6A0A0FF"</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1200</span>))</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1975,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#ADB7C0FF"</span>)</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1976,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#94C5CCFF"</span>)</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1977,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#F4ADB3FF"</span>)</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1978,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#EEBCB1FF"</span>)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1979,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#ECD89DFF"</span>)</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1200</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>전체데이터와 월별데이터에 평활을 진행하고자 한다. 평활법은 교수님께서 추천하셨던 3RSSH Twice, 4253H Twice에 더해 Hanning이 이루어지기 전 평활법인 3RS3R Twice를 추가하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sleekts)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>pal2<span class="ot">=</span><span class="fu">as.vector</span>(<span class="fu">ghibli_palette</span>(<span class="st">"MononokeMedium"</span>)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)])</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths_ts,<span class="at">main=</span><span class="st">"Raw Data:All"</span>,<span class="at">ylab=</span><span class="st">"# of Female deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span>pal2[<span class="dv">1</span>])</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_ts, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_ts),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_ts),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">4</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span><span class="fl">1978.7</span>, <span class="at">y =</span> <span class="dv">1100</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RS3R Twice"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> pal2,<span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>평활법을 적용하여 확인할 경우 원 자료에 비해 최댓값과 최솟값의 폭이 많이 줄어들었음을 확인할 수 있다. 작은 값에서는 크게 변화가 없지만 값이 큰 자료들의 경우 많이 깎여나갔다. 시계열을 확인하는데 있어서 그 계절성을 확인하기 좋은 형태로 평활이 된 것은 사실이지만, 위에서 언급한 1976년도의 특이값이 사라지게 되었고 그 특이값을 해석하는데 있어서 주의를 기울여야 할 것으로 보인다. 3RS3R Twice 기법의 경우 Hanning이 진행되지 않았기 때문에 다소 각진 부분이 남아있지만, 전반적으로 계절성이 나타나는 형태로 데이터를 변화시켰다. 나머지 Hanning을 사용한 2가지 평활법의 차이를 분석하면 4253H방법에서 큰 값들의 감소폭이 크게 나타나고 있다. 3가지 평활법의 양 끝자료의 경우 실제 존재하는 데이터를 가지고 만든 것이 아니기 때문에 그 추세를 해석하는데 있어서 용이하지만 실제 데이터와 차이가 있으므로 해석에 유의해야 할 것이다.</p>
<p>앞에서 시계열 Decompose를 통해서 그렸던 계절성 그래프의 모양과 4253H Twice의 그래프가 상당히 유사한 것으로 보인다. 1년을 주기로 폐질환 사망자수가 Fluctuate 하고 있는데 겨울철에 전반적으로 증가하고 여름철에 감소하는 경향성을 가지는 것이 확인된다. 각 주기는 거의 대칭적으로 증감을 반복하고 있으며 1976, 1977년도를 제외하면 사망건수는 거의 비슷하게 유지 되는 것을 확인할 수 있다. 따라서 시계열 자료를 해석할 때 1976년도와 1977년도 자료는 유의해서 해석해야 할 것으로 보인다.</p>
<p>https://premium.weatherweb.net/weather-in-history-1975-to-1999-ad/ For England and Wales (using the Met Office EWR/EWP series), it was one of the six DRIEST winters in the previous 100 years, and the third consecutive season with less rain than usual: summer and autumn 1975 were also dry. Winter 1975/76 had around 61% of average rainfall over England and Wales. It was this persistence of low precipitation, particularly throughout the winter ‘re-charge’ season, that led to the severe DROUGHT problems encountered in 1976 (q.v.) 1976년도의 특이 값에 대한 원인을 분석할 때 해당 년도의 겨울이 100년중 6번째로 건조한 겨울이었다는 점을 고려해야 할 것으로 보인다. 가뭄 문제를 걱정할 정도로 겨울이 건조하였다는 사실은 해당 년도에 사람들이 호흡기 질환을 걸릴 가능성이 상당히 높았음을 예측할 수 있다.</p>
<p>##Raw Data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(fdeaths_1974,<span class="at">main=</span><span class="st">"Female Deaths by lung diseases in UK"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span><span class="st">"#A6A0A0FF"</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1200</span>))</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1975,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#ADB7C0FF"</span>)</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1976,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#94C5CCFF"</span>)</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1977,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#F4ADB3FF"</span>)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1978,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#EEBCB1FF"</span>)</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fdeaths_1979,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"#ECD89DFF"</span>)</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1200</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rs3r-twice" class="level2">
<h2 class="anchored" data-anchor-id="rs3r-twice">3RS3R Twice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1974, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"3RS3R Twice: Female Deaths by lung diseases in UK"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1200</span>))</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1975, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1976, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1977, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1978, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(fdeaths_1979, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1200</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rssh-twice" class="level2">
<h2 class="anchored" data-anchor-id="rssh-twice">3RSSH Twice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1974),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"3RSSH Twice: Female Deaths by lung diseases in UK"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1200</span>))</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1975),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1976),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1977),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1978),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(fdeaths_1979),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1200</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="h-twice" class="level2">
<h2 class="anchored" data-anchor-id="h-twice">4253H Twice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1974),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"4253H Twice: Female Deaths by lung diseases in UK"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1200</span>))</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1975),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1976),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1977),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1978),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(fdeaths_1979),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1200</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>원자료 –&gt; 3RS3R Twice –&gt; 3RSSH Twice–&gt; 4253H Twice순으로 시계열의 추세가 유사해지고 있는것을 확인할 수 있다. Hanning을 사용하여 3RSSH Twice, 4253H Twice는 평평한 구간 없이 부드럽게 넘어가고 있으며 1976년도 평활법을 통해서 최대값이 줄어들어 다른 년도와 유사한 계절성을 확인할 수 있게 되었다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(fdeaths, <span class="at">nlag =</span> <span class="cn">NULL</span>, <span class="at">output =</span> <span class="cn">TRUE</span>) <span class="co"># p-value&lt;=0.01 귀무가설을 기각하여 정상시계열</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Augmented Dickey-Fuller Test 
alternative: stationary 
 
Type 1: no drift no trend 
     lag   ADF p.value
[1,]   0 -1.29   0.214
[2,]   1 -1.14   0.269
[3,]   2 -1.42   0.169
[4,]   3 -1.13   0.273
Type 2: with drift no trend 
     lag   ADF p.value
[1,]   0 -3.48  0.0131
[2,]   1 -4.34  0.0100
[3,]   2 -5.73  0.0100
[4,]   3 -6.61  0.0100
Type 3: with drift and trend 
     lag   ADF p.value
[1,]   0 -3.40  0.0628
[2,]   1 -4.36  0.0100
[3,]   2 -5.69  0.0100
[4,]   3 -6.68  0.0100
---- 
Note: in fact, p.value = 0.01 means p.value &lt;= 0.01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fdeaths)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(fit, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">95</span>), <span class="at">h=</span><span class="dv">12</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다음 1년간의 변화를 예측할 경우 이전의 자료들과 비슷한 추세를 가지고 있는 것이 확인되어 진다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="번-2" class="level1">
<h1>4번</h1>
<p>R의 lynx 자료를 평활하고 분석하여라.</p>
<p>Annual numbers of lynx trappings for 1821–1934 in Canada. Taken from Brockwell &amp; Davis (1991), this appears to be the series considered by Campbell &amp; Walker (1977).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lynx)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lynx,<span class="at">main=</span><span class="st">"Boxplot of lynx data"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Boxplot을 통해서 확인했더니 총 4개의 Outlier가 확인되어 진다. Median이 Box 안의 밑에 위치하고 있는 것으로 보아 Skewed to the Right 한 자료일 가능성이 높다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lynx)<span class="sc">$</span>stats[<span class="dv">5</span>,] <span class="co"># upper fence의 값은 4950이고</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4950</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lynx)<span class="sc">$</span>out <span class="co">#5943, 6721, 6991, 6313 4개의 자료가 Fence의 밖에 존재한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5943 6721 6991 6313</code></pre>
</div>
</div>
<p>Stem and leaf plot을 통해서 해당 데이터의 분포를 추측해본다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(lynx) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 3 digit(s) to the right of the |

  0 | 0001111111122222222222333333344444444444
  0 | 55555566677777788889
  1 | 00013344
  1 | 556666788
  2 | 011334
  2 | 55677778899
  3 | 01344
  3 | 5568889
  4 | 034
  4 | 
  5 | 0
  5 | 9
  6 | 3
  6 | 7
  7 | 0</code></pre>
</div>
</div>
<p>Box plot을 통해서 확인하였던 5개의 Outlier를 확인하였다. 0 stem들에 자료들이 많이 몰려있고 점차 줄어드는 것을 확인할 수 있다. Skewed to the right 되어 있는 분포를 따르고 있는 것으로 추측되어진다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  hl<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">2</span>]</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  median<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">3</span>]</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  hu<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">4</span>]</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>((hu<span class="sc">-</span>median)<span class="sc">-</span>(median<span class="sc">-</span>hl))<span class="sc">/</span>((hu<span class="sc">-</span>median)<span class="sc">+</span>(median<span class="sc">-</span>hl))</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(lynx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6182796</code></pre>
</div>
</div>
<p>데이터의 Skewness를 고려해 볼 떄 Box plot에서 확인되였던 것 처럼, 해당 데이터는 Skewed to the right되어 있다는 사실을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">log</span>(lynx))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2003311</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">sqrt</span>(lynx))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4289078</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(lynx))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2755733</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(lynx)) <span class="co"># Minus inverse sqrt 변환이 Skewness를 가장 줄여 주는 것이 확인되어진다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.04397301</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd=</span><span class="fu">lsum</span>(lynx,<span class="dv">8</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid  upper spread
1      M  57.5 771.0  771.0  771.0      0
2      H  29.0 345.0 1461.0 2577.0   2232
3      E  15.0 188.0 1826.5 3465.0   3277
4      D   8.0  81.0 2056.0 4031.0   3950
5      C   4.5  63.5 2755.0 5446.5   5383
6      B   2.5  47.0 3282.0 6517.0   6470
7      A   1.5  42.0 3449.0 6856.0   6814
8      Z   1.0  39.0 3515.0 6991.0   6952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>(lvd[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd[<span class="dv">2</span>,<span class="dv">3</span>]) <span class="sc">-</span><span class="fl">1.705</span> <span class="co"># flatter than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.23681</code></pre>
</div>
</div>
<ul>
<li>데이터의 Five Numbers와 요약 지표</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(lynx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   39  345  771 2577 6991</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lynx)<span class="co"># Median, Mean이 차이가 크다 (767): skewed 되어있는 정도가 크다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   39.0   348.2   771.0  1538.0  2566.8  6991.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">summary</span>(lynx)[<span class="dv">6</span>]<span class="sc">-</span><span class="fu">summary</span>(lynx)[<span class="dv">1</span>]) <span class="co"># 최고점과 최저점 사이의 차이는 6952</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6952</code></pre>
</div>
</div>
<p>최고값의 경우 6991마리 / 최소값의 경우 39마리 / 평균적으로 1538마리가 잡혔다.</p>
<p>정규성을 따르는가?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lynx, <span class="at">ylab=</span><span class="st">"Lynx quantiles"</span>); <span class="fu">qqline</span>(lynx, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>fiv<span class="ot">=</span><span class="fu">fivenum</span>(lynx)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma =</span> (fiv[<span class="dv">4</span>]<span class="sc">-</span>fiv[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1665.672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(lynx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1585.844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lynx, <span class="at">ylab=</span><span class="st">"Lynx quantiles"</span>);<span class="fu">qqline</span>(lynx, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv[<span class="dv">3</span>],pseudosigma,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">sub=</span><span class="st">"intercept=771 (median); slope=1665.672 (pseudo-sigma) blue line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>pseudo-sigma와 sigma가 차이가 80 정도로 다소 있다. 또한 Sample 자료들이 qqplot 상에서 직선을 따르고 있지 않은 것으로 보인다. 위의 문제에서 처럼 자료들이 역 S자 곡선을 그리고 있는 것으로 보인다.</p>
<p>데이터가 지수분포를 따르는가?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(lynx)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>lynx.sort<span class="ot">=</span>(<span class="fu">sort</span>(lynx))</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>q.exp.lynx <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(i<span class="fl">-0.5</span>)<span class="sc">/</span>n) <span class="co"># exponential quantile</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.exp.lynx , lynx.sort, <span class="at">main=</span><span class="st">"Exponential prob plot"</span>) </span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.exp.lynx , lynx.sort)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] -141.5597 1744.9693</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">line</span>(q.exp.lynx , lynx.sort)[<span class="dv">2</span>],<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Outlier을 제외하면 직선을 잘 따르고 있는 것으로 보이나 왼쪽에 데이터가 몰려있는 것으로 보여 삼승근 변환을 통해 데이터를 분산시켜보고자 한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.exp.lynx<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) , lynx.sort<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">main=</span><span class="st">"Exponential prob plot"</span>)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.exp.lynx<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) , lynx.sort<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] -1.379257 12.915730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">line</span>(q.exp.lynx<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) , lynx.sort<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))[<span class="dv">2</span>],<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 직선을 잘 따르고 있는 것으로 보이나, 데이터들이 곡선을 따르고 있는 것 처럼 보이기도 하다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 와이블 분포</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>q.weibull.lynx <span class="ot">&lt;-</span> <span class="fu">log</span>(q.exp.lynx)</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q.weibull.lynx, <span class="fu">log</span>(lynx.sort), <span class="at">main=</span><span class="st">"Weibull prob plot"</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="fu">line</span>(q.weibull.lynx, <span class="fu">log</span>(lynx.sort))[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
[1] 7.301571 1.131025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">line</span>(q.weibull.lynx, <span class="fu">log</span>(lynx.sort))[<span class="dv">2</span>],<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>두 Plot을 비교할 경우 지수 분포에 더 적합한 것으로 보인다. (lynx data는 정규성이 확보되지는 못한 것으로 볼 수 있다.)</p>
<p>잡힌 Lynx 수를 평활하기 위해서 수업시간에 교수님께서 Recommend 하신 3RSSH Twice방법과 4253H Twice방법에 더해 3RS3R Twice 활용하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lynx,<span class="at">main=</span><span class="st">"Time series plot of lynx caught"</span>,<span class="at">ylab=</span> <span class="st">"# of Caught"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1820</span>,<span class="dv">1940</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 자료의 주기성을 확인할 수 있다.</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1828년, 1866년, 1904년을 중심으로 하는 봉우리 주기들이 다른 주기들에 비해서 그 늘어나는 강도가 더 큰 것으로 확인되어 진다. 반면 1875년을 중심으로 하는 주기의 경우 다른 봉우리들에 비해서 그 늘어나는 강도가 부족 한 것으로 보인다.</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 111년동안 12번의 봉우리 주기가 돌아왔으므로 9~10년 주기로 늘어났다가 줄어들었다를 반복하는 것을 확인할 수 있다. Lynx가 늘어나는 속도와 줄어드는 속도는 일치하는 것으로 확인되어 진다. </span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">diff</span>(lynx),<span class="at">main=</span><span class="st">"Difference :  lynx caught"</span>,<span class="at">ylab=</span> <span class="st">"# of Caught"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1820</span>,<span class="dv">1940</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-93-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 차분데이터를 확인할 경우 위에서 언급한 특이점들을 제외하면 분산의 증가 없이 일정하게 변동성이 유지 되는 것으로 볼 수 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Box-Cox Transformation을 통해서 데이터를 변환하였다. (데이터의 정규성을 개선하기 위해)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="fu">BoxCox.lambda</span>(lynx)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>lynx_new <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(lynx, lambda2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lynx_new, <span class="at">main=</span><span class="st">"Box Cox: Time series plot of lynx caught"</span>,<span class="at">ylab=</span> <span class="st">"# of Caught"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1820</span>,<span class="dv">1940</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(lynx_new), <span class="at">main =</span> <span class="st">"Difference &amp; Box-Cox : Time series plot of lynx caught"</span>,<span class="at">ylab=</span> <span class="st">"# of Caught"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1820</span>,<span class="dv">1940</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-95-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggpmisc")</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpp'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    annotate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> F) <span class="sc">+</span> </span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_peaks</span>(<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_valleys</span>(<span class="at">colour =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_peaks</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">x.label.fmt =</span> <span class="st">"%Y"</span>) <span class="sc">+</span></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_valleys</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">x.label.fmt =</span> <span class="st">"%Y"</span>)<span class="sc">+</span></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">8000</span>))<span class="sc">+</span></span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Lynx Caught Data"</span>)<span class="sc">+</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"year"</span>)<span class="sc">+</span></span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"# of Lynx caught"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>전체데이터와 월별데이터에 평활을 진행하고자 한다. 평활법은 교수님께서 추천하셨던 3RSSH Twice, 4253H Twice에 더해 Hanning이 이루어지기 전 평활법인 3RS3R Twice를 추가하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sleekts)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>pal3<span class="ot">=</span><span class="fu">as.vector</span>(<span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">7</span>)])</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lynx,<span class="at">main=</span><span class="st">"Raw Data:All"</span>,<span class="at">ylab=</span> <span class="st">"# of Caught"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1820</span>,<span class="dv">1940</span>),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span>pal3[<span class="dv">1</span>])</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lynx, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1821</span>,<span class="at">end=</span><span class="dv">1934</span>),<span class="at">col=</span>pal3[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lynx),<span class="at">start=</span><span class="dv">1821</span>,<span class="at">end=</span><span class="dv">1934</span>),<span class="at">col=</span>pal3[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lynx),<span class="at">start=</span><span class="dv">1821</span>,<span class="at">end=</span><span class="dv">1934</span>),<span class="at">col=</span>pal3[<span class="dv">4</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span><span class="dv">1910</span>, <span class="at">y =</span> <span class="dv">6800</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RS3R Twice"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> pal3,<span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lynx의 포획 수는 약 10년마다 증가하고 감소하는 패턴을 확인할 수 있다. 덫에 걸리는 Lynx들의 수는 자연의 Lynx 개체수와 비례한다고 볼 때, 10년 주기로 총 개체수가 줄어들고 늘어난다고 볼 수 있다. (단, 설치된 Trap의 수가 매 시기별로 어느정도 동일하다는 조건이 붙어야 한다.)</p>
<p>평활법 적용으로 인해 원 자료에 비해 최댓값과 최솟값의 폭이 많이 줄어들었다. 작은 값에서는 크게 변화가 없지만 값이 큰 자료들이 많이 줄어들었다.</p>
<p>앞에서 언급하였던, 1828년, 1866년, 1904년의 특이 봉우리 들이 평활 이후에는 상당히 낮아졌다. 1866년 봉우리의 경우 3가지 평활법에서 모두 거의 절반 가량을 깎아냈다. 또한 1913년, 1916년의 경우 봉우리가 연속적으로 존재하였는데 평활 이후에는 이러한 봉우리가 하나의 봉우리로 합쳐지게 되었다. 평활로 인해 깎아진 봉우리들을 적절하게 해석하기 위해서는 원 데이터들을 반드시 고려해야 할 것이다. (원 데이터에 발생한 특이값들이 특정한 요인에 의해서 발생했다면 그 요인을 정확히 파악하는 것이 시계열 데이터의 올바른 이해를 위해서 필요할 것이라고 보인다.)</p>
<p>3가지 평활법 모두 양 끝자료를 실재하는 자료가 아닌 대체된 자료를 활용하였음에도 불구하고 실제 자료랑 큰 차이지 보이지 않고 있다. 4253H Twice 기법이 다른 두 기법에 비해서 큰 값들을 많이 깎아내는데 이를 해석하는데 있어서 상당히 유의해야 할 것으로 보인다.</p>
<p>Lynx 개체수의 10년의 주기성을 확인하기 위해서는 4253H Twice 기법을 사용하는 것이 적절해 보이고, 각 Local 봉우리별 크기의 변화에 집중하기 위해서는 3RSSH Twice를 사용하는 것이 적절해 보인다.</p>
<ul>
<li>1866년, 1904년의 봉우리 다음 봉우리들은 상당히 Peak의 높이가 낮아졌는데 그 원인을 이전 봉우리에서 생성된 많은 개체들이 서식지를 파괴한 것이 아닐까 라고 추측해볼 수 있으나 확실하지 않다.</li>
</ul>
<p>##미래에 Lynx의 숫자는 어떻게 변할까?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(lynx, <span class="at">nlag =</span> <span class="cn">NULL</span>, <span class="at">output =</span> <span class="cn">TRUE</span>) <span class="co"># p-value&lt;=0.01 귀무가설을 기각하여 정상시계열</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Augmented Dickey-Fuller Test 
alternative: stationary 
 
Type 1: no drift no trend 
     lag   ADF p.value
[1,]   0 -2.75  0.0100
[2,]   1 -4.63  0.0100
[3,]   2 -3.33  0.0100
[4,]   3 -3.17  0.0100
[5,]   4 -2.48  0.0148
Type 2: with drift no trend 
     lag   ADF p.value
[1,]   0 -4.22    0.01
[2,]   1 -7.86    0.01
[3,]   2 -6.40    0.01
[4,]   3 -7.05    0.01
[5,]   4 -6.31    0.01
Type 3: with drift and trend 
     lag   ADF p.value
[1,]   0 -4.22    0.01
[2,]   1 -7.85    0.01
[3,]   2 -6.39    0.01
[4,]   3 -7.04    0.01
[5,]   4 -6.31    0.01
---- 
Note: in fact, p.value = 0.01 means p.value &lt;= 0.01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lynx)</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(fit, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">95</span>), <span class="at">h=</span><span class="dv">10</span>))  <span class="co">#미래 데이터가 어떻게 이동할지 예측</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="과제6_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>