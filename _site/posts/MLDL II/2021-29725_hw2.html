<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.624">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangwon Ju, SNU GSPA">
<meta name="dcterms.date" content="2022-11-06">

<title>Sangwon Ju’s Personal Page - Assignment 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <img src="../.././logo/policy.png" alt="">
    <span class="navbar-title">Sangwon Ju’s Personal Page</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">About Me</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">Research</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../../research_interests.html">
 <span class="dropdown-text">Research Interests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../publication.html">
 <span class="dropdown-text">Publications / Working Papers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../data_analytics.html">Data Analytics</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../CV.html">CV (as of July 2022)</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#준비" id="toc-준비" class="nav-link active" data-scroll-target="#준비">0. 준비</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1.</a>
  <ul class="collapse">
  <li><a href="#loading-dataset" id="toc-loading-dataset" class="nav-link" data-scroll-target="#loading-dataset">Loading Dataset</a></li>
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">(a)</a>
  <ul class="collapse">
  <li><a href="#multinomial-logistic-regression" id="toc-multinomial-logistic-regression" class="nav-link" data-scroll-target="#multinomial-logistic-regression">1) multinomial logistic regression</a></li>
  <li><a href="#support-vector-machine" id="toc-support-vector-machine" class="nav-link" data-scroll-target="#support-vector-machine">2) Support vector machine</a></li>
  <li><a href="#sgd-classifier" id="toc-sgd-classifier" class="nav-link" data-scroll-target="#sgd-classifier">3) SGD Classifier</a></li>
  <li><a href="#nearest-neighbors-knn" id="toc-nearest-neighbors-knn" class="nav-link" data-scroll-target="#nearest-neighbors-knn">4) Nearest neighbors (knn)</a></li>
  <li><a href="#random-forests" id="toc-random-forests" class="nav-link" data-scroll-target="#random-forests">5) Random Forests</a></li>
  <li><a href="#gradient-boosted-tree" id="toc-gradient-boosted-tree" class="nav-link" data-scroll-target="#gradient-boosted-tree">6) (Gradient Boosted) Tree</a></li>
  <li><a href="#xgboost" id="toc-xgboost" class="nav-link" data-scroll-target="#xgboost">7) Xgboost</a></li>
  <li><a href="#linear-discriminant-analysis" id="toc-linear-discriminant-analysis" class="nav-link" data-scroll-target="#linear-discriminant-analysis">8) linear discriminant analysis</a></li>
  <li><a href="#quadratic-discriminant-analysis" id="toc-quadratic-discriminant-analysis" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis">9) quadratic discriminant analysis</a></li>
  </ul></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">(b)</a>
  <ul class="collapse">
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">1) PCA</a></li>
  <li><a href="#l1-based-feature-selection-tree-based-feature-selection" id="toc-l1-based-feature-selection-tree-based-feature-selection" class="nav-link" data-scroll-target="#l1-based-feature-selection-tree-based-feature-selection">2) L1-based feature selection / Tree-based feature selection</a></li>
  <li><a href="#re-estimation-with-selected-features" id="toc-re-estimation-with-selected-features" class="nav-link" data-scroll-target="#re-estimation-with-selected-features">3) Re-estimation with selected features</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2.</a>
  <ul class="collapse">
  <li><a href="#a-1" id="toc-a-1" class="nav-link" data-scroll-target="#a-1">(a)</a></li>
  <li><a href="#b-1" id="toc-b-1" class="nav-link" data-scroll-target="#b-1">(b)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 2</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Machine Learning &amp; Deep Learning for Data Science (2022 Fall)</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangwon Ju, SNU GSPA </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>LDA, QDA ~ Unsupervised Learning</p>
<h3 align="center" class="anchored">
Machine Learning &amp; Deep Learning for Data Science <br> Assignment 2
</h3>
<h5 align="right" class="anchored">
행정대학원 정책학전공 2021-29725 주상원
</h5>
<section id="준비" class="level1">
<h1>0. 준비</h1>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> time</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Math, Latex</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.linear_model <span class="im">as</span> skl_lm</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> pearsonr</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster <span class="im">import</span> hierarchy</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RepeatedStratifiedKFold</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, RandomizedSearchCV</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> RidgeCV</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LassoCV</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils.fixes <span class="im">import</span> loguniform</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Reference Repositiory: https://github.com/JWarmenhoven/ISLR-python</p>
</section>
<section id="section" class="level1">
<h1>1.</h1>
<p>In this problem, you will use the OnlineAd training data set attached in the assignment (OnlineAd X train.csv and OnlineAd Y train.csv). The feature matrix OnlineAd X train.csv contains 1452 observations, where each row represents a different user with 251 features that summarize the user characteristics and previous browsing history. These 251 features have been anonymized and normalized. Hence, each feature’s interpretation is hidden for analysis. (i.e., you don’t have to worry about the meaning of each feature.) There are two online advertisements, A and B, with which this experiment was performed. In each observation, a user clicks either A or B, or she may not click anything. She cannot click on two ads at the same time. This click response is recorded in OnlineAd Y train.csv, where each row contains information on which ad was clicked (or whether a user clicked nothing). A no click response is recorded as 1 in the first column in OnlineAd Y train.csv, a click on A is 1 in the second column, and likewise for a click on B is 1 in the third column. Note that 0 means non-chosen options by the user. Hence, each row sum of OnlineAd Y train.csv is exactly 1. Each row of OnlineAd Y train.csv is the click response for the corresponding user in the corresponding row of OnlineAd X train.csv</p>
<section id="loading-dataset" class="level2">
<h2 class="anchored" data-anchor-id="loading-dataset">Loading Dataset</h2>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Work Directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Before Directory: </span><span class="sc">%s</span><span class="st">"</span><span class="op">%</span>os.getcwd())</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">"E:/OneDrive - SNU/r"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"After Directory: </span><span class="sc">%s</span><span class="st">"</span><span class="op">%</span>os.getcwd())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Before Directory: e:\OneDrive - SNU\(B) 대학원\수업\2022 2학기\데이터사이언스를위한머신러닝과딥러닝\과제2
After Directory: E:\OneDrive - SNU\r</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read Dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>y_train<span class="op">=</span>pd.read_csv(<span class="st">"OnlineAd_Y_train.csv"</span>,header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x_train<span class="op">=</span>pd.read_csv(<span class="st">"OnlineAd_X_train.csv"</span>,header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x_test<span class="op">=</span>pd.read_csv(<span class="st">"OnlineAd_X_test.csv"</span>,header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if there is missing value</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total missing variable: "</span>,x_test.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()) <span class="co"># no missing value</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total missing variable: "</span>,x_train.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()) <span class="co"># no missing value</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total missing variable: "</span>,y_train.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()) <span class="co"># no missing value</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimension</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"xdim: "</span>, x_train.shape)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ydim: "</span>, y_train.shape)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"xtestdim: "</span>, x_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total missing variable:  0
Total missing variable:  0
Total missing variable:  0
xdim:  (1452, 251)
ydim:  (1452, 3)
xtestdim:  (300, 251)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x_colname<span class="op">=</span>[]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">251</span>):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    x_colname.append(<span class="ss">f"x_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x_train.columns<span class="op">=</span>x_colname</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>y_colname<span class="op">=</span>[<span class="st">"No"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>y_train.columns<span class="op">=</span>y_colname</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># no click response: No, second columnn: A, third column: B</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make array for the x_train</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>x_train2<span class="op">=</span>x_train.to_numpy()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>display(x_train2[:<span class="dv">10</span>])</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make array for the y_train</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>y_train2<span class="op">=</span>np.array(np.where(y_train[<span class="st">"No"</span>] <span class="op">==</span> <span class="dv">1</span>, <span class="dv">0</span>, np.where(y_train[<span class="st">"A"</span>] <span class="op">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>display(y_train2[:<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[ 9.6870e-01, -3.9480e-01, -5.4670e-01, ...,  5.1620e-01,
        -3.3300e-01,  4.6600e-02],
       [-4.6690e-01,  5.2220e-01,  6.9560e-01, ..., -7.5100e-02,
        -1.6022e+00,  4.1810e-01],
       [-1.1187e+00,  2.3400e-01, -5.5800e-02, ...,  2.4260e-01,
        -1.4561e+00,  3.0000e-03],
       ...,
       [ 6.9000e-03,  2.6000e-03, -1.2000e-03, ..., -1.0200e-02,
        -3.7000e-03, -1.8400e-02],
       [ 4.0000e-02,  5.2400e-02,  5.3200e-02, ...,  3.9400e-02,
        -7.8000e-03,  7.9500e-02],
       [-5.8900e-01, -1.6920e-01, -7.9870e-01, ..., -4.2110e-01,
        -8.0060e-01,  2.2250e-01]])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([0, 2, 0, 0, 0, 1, 0, 2, 0, 2])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>display(y_train.value_counts())</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>display(Counter(y_train2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>No   A    B  
1.0  0.0  0.0    822
0.0  0.0  1.0    353
     1.0  0.0    277
dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Counter({0: 822, 2: 353, 1: 277})</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CV</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>cv_5 <span class="op">=</span> RepeatedStratifiedKFold(n_splits<span class="op">=</span><span class="dv">5</span>, n_repeats<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid Search: Utility function to report best scores</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> report(results, n_top<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_top <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        candidates <span class="op">=</span> np.flatnonzero(results[<span class="st">"rank_test_score"</span>] <span class="op">==</span> i)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> candidate <span class="kw">in</span> candidates:</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Model with rank: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(i))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean validation score: </span><span class="sc">{0:.3f}</span><span class="st"> (std: </span><span class="sc">{1:.3f}</span><span class="st">)"</span>.<span class="bu">format</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                    results[<span class="st">"mean_test_score"</span>][candidate],</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                    results[<span class="st">"std_test_score"</span>][candidate],</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Parameters: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(results[<span class="st">"params"</span>][candidate]))</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Citation: https://scikit-learn.org/stable/auto_examples/model_selection/plot_randomized_search.html</p>
</section>
<section id="a" class="level2">
<h2 class="anchored" data-anchor-id="a">(a)</h2>
<p>[40 pts] Using OnlineAd X train.csv and OnlineAd Y train.csv, train multiple models that you learned in class. You may try a model which is modified from the models we covered in the first half of the course. You are allowed to use the existing packages, but make sure to clearly explain what models are used. Report the training results. What metric did you use? How do different models perform on the training data?</p>
<section id="multinomial-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="multinomial-logistic-regression">1) multinomial logistic regression</h3>
<p>citation: https://machinelearningmastery.com/multinomial-logistic-regression-with-python/</p>
<div class="cell" data-execution_count="148">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multinomial logistic regression</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model_mlogit_l <span class="op">=</span> LogisticRegression(multi_class<span class="op">=</span><span class="st">'multinomial'</span>, solver<span class="op">=</span><span class="st">'lbfgs'</span>,max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>model_mlogit_s <span class="op">=</span> LogisticRegression(multi_class<span class="op">=</span><span class="st">'multinomial'</span>, solver<span class="op">=</span><span class="st">'saga'</span>,max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  ‘sag’ and ‘saga’ fast convergence is only guaranteed on features with approximately the same scale. (already scaled)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>accuracy_mlogit_s <span class="op">=</span> cross_val_score(model_mlogit_l, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>f1w_mlogit_s <span class="op">=</span> cross_val_score(model_mlogit_l, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>accuracy_mlogit_l <span class="op">=</span> cross_val_score(model_mlogit_s, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>f1w_mlogit_l<span class="op">=</span> cross_val_score(model_mlogit_l, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy_saga: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_mlogit_s), np.std(accuracy_mlogit_s)))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1 weighted saga: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_mlogit_s), np.std(f1w_mlogit_s)))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy_lbfgs: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_mlogit_l), np.std(accuracy_mlogit_l)))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1 weighted_lbfgs: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_mlogit_l), np.std(f1w_mlogit_l)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Accuracy_saga: 0.548 (0.023)
Mean f1 weighted saga: 0.542 (0.022)
Mean Accuracy_lbfgs: 0.549 (0.024)
Mean f1 weighted_lbfgs: 0.542 (0.022)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="159">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_mlogit_l.fit(x_train2, y_train2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y_pred_mlogit <span class="op">=</span> model_mlogit_l.predict(x_train2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_mlogit, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_mlogit),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.72
Training result (accuracy):  0.73</code></pre>
</div>
</div>
</section>
<section id="support-vector-machine" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine">2) Support vector machine</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM: linear</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>model_svm_l_g <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'linear'</span>,random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.0001</span>, <span class="fl">0.001</span>,<span class="fl">0.01</span>, <span class="fl">0.1</span>]}</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Best Parameter C</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>model_svm_l <span class="op">=</span> GridSearchCV(model_svm_l_g, param_grid <span class="op">=</span> parameters, cv <span class="op">=</span> cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>model_svm_l.fit(x_train2, y_train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=RepeatedStratifiedKFold(n_repeats=5, n_splits=5, random_state=2022),
             estimator=SVC(kernel='linear', random_state=2020), n_jobs=-1,
             param_grid={'C': [0.0001, 0.001, 0.01, 0.1]},
             scoring='f1_weighted')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=RepeatedStratifiedKFold(n_repeats=5, n_splits=5, random_state=2022),
             estimator=SVC(kernel='linear', random_state=2020), n_jobs=-1,
             param_grid={'C': [0.0001, 0.001, 0.01, 0.1]},
             scoring='f1_weighted')</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: SVC</label><div class="sk-toggleable__content"><pre>SVC(kernel='linear', random_state=2020)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(kernel='linear', random_state=2020)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_svm_l_result <span class="op">=</span> pd.DataFrame(model_svm_l.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_svm_l_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_svm_l.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>model_svm_l_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_svm_l.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>display(model_svm_l_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>C</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.0100</td>
      <td>0.561710</td>
      <td>0.020828</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0010</td>
      <td>0.554006</td>
      <td>0.019123</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1000</td>
      <td>0.550008</td>
      <td>0.021432</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0001</td>
      <td>0.464239</td>
      <td>0.016612</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="161">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_svm_linear <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'linear'</span>,C<span class="op">=</span><span class="fl">0.01</span>,random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>accuracy_svm_linear <span class="op">=</span> cross_val_score(model_svm_linear, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>f1w_svm_linear <span class="op">=</span> cross_val_score(model_svm_linear, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_svm_linear), np.std(f1w_svm_linear)))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_svm_linear), np.std(accuracy_svm_linear)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.562 (0.021)
Mean Accuracy: 0.645 (0.018)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="162">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>model_svm_linear.fit(x_train2, y_train2)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y_pred_svml <span class="op">=</span> model_svm_linear.predict(x_train2)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_svml, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_svml),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.57
Training result (accuracy):  0.66</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM: rbf</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_svm_r_g <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>,random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C'</span>: [ <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>,<span class="dv">100</span>, <span class="dv">500</span>,<span class="dv">1000</span>], <span class="st">'gamma'</span>: [<span class="fl">0.00001</span>, <span class="fl">0.00005</span>, <span class="fl">0.0001</span>, <span class="fl">0.0025</span>, <span class="fl">0.0005</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>model_svm_r <span class="op">=</span> GridSearchCV(model_svm_r_g, param_grid <span class="op">=</span> parameters, cv <span class="op">=</span> cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>,scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>model_svm_r.fit(x_train2, y_train2)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_svm_r.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>report(model_svm_r.cv_results_)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Best Parameter C and gamma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GridSearchCV took 34.72 seconds for 42 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.579 (std: 0.024)
Parameters: {'C': 10, 'gamma': 0.01}

Model with rank: 2
Mean validation score: 0.574 (std: 0.022)
Parameters: {'C': 1, 'gamma': 0.01}

Model with rank: 3
Mean validation score: 0.562 (std: 0.021)
Parameters: {'C': 500, 'gamma': 1e-05}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_svm_r_result <span class="op">=</span> pd.DataFrame(model_svm_r.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model_svm_r_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_svm_r.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>model_svm_r_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_svm_r.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>display(model_svm_r_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>C</th>
      <th>gamma</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>10.0</td>
      <td>0.01000</td>
      <td>0.579045</td>
      <td>0.023799</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.0</td>
      <td>0.01000</td>
      <td>0.573532</td>
      <td>0.022499</td>
    </tr>
    <tr>
      <th>28</th>
      <td>500.0</td>
      <td>0.00001</td>
      <td>0.561827</td>
      <td>0.020969</td>
    </tr>
    <tr>
      <th>22</th>
      <td>100.0</td>
      <td>0.00005</td>
      <td>0.561588</td>
      <td>0.021113</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10.0</td>
      <td>0.00050</td>
      <td>0.561335</td>
      <td>0.020375</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="164">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>model_svm_rbf <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>,C<span class="op">=</span><span class="dv">10</span>,gamma<span class="op">=</span><span class="fl">0.01</span>,random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>accuracy_svm_rbf<span class="op">=</span> cross_val_score(model_svm_rbf, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>f1w_svm_rbf<span class="op">=</span> cross_val_score(model_svm_rbf, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_svm_rbf), np.std(f1w_svm_rbf)))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_svm_rbf), np.std(accuracy_svm_rbf)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.579 (0.024)
Mean Accuracy: 0.612 (0.023)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="165">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>model_svm_rbf.fit(x_train2, y_train2)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>y_pred_svmq <span class="op">=</span> model_svm_rbf.predict(x_train2)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_svmq, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_svmq),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.87
Training result (accuracy):  0.87</code></pre>
</div>
</div>
</section>
<section id="sgd-classifier" class="level3">
<h3 class="anchored" data-anchor-id="sgd-classifier">3) SGD Classifier</h3>
<p>Citation: https://github.com/jiminAn/ML_Project/blob/main/jman/practice_code/sgd_classifier_ex.ipynb <br> Citation: https://scikit-learn.org/stable/auto_examples/model_selection/plot_randomized_search.html</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> SGDClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model_sgd_g <span class="op">=</span> SGDClassifier(fit_intercept<span class="op">=</span><span class="va">True</span>, max_iter<span class="op">=</span><span class="dv">30000</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"average"</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loss'</span>: [<span class="st">'hinge'</span>,<span class="st">'log_loss'</span>], </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'penalty'</span>: [<span class="st">'l2'</span>, <span class="st">'l1'</span>, <span class="st">'elasticnet'</span>],</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'l1_ratio'</span>: np.arange(<span class="fl">0.3</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span>: np.power(<span class="dv">10</span>, np.arange(<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">float</span>)),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>model_sgd <span class="op">=</span> GridSearchCV(model_sgd_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>model_sgd.fit(x_train2, y_train2)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_sgd.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>report(model_sgd.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 144 candidates, totalling 3600 fits
GridSearchCV took 37.57 seconds for 144 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.573 (std: 0.018)
Parameters: {'alpha': 0.01, 'average': True, 'l1_ratio': 0.3, 'loss': 'log_loss', 'penalty': 'l2'}

Model with rank: 2
Mean validation score: 0.572 (std: 0.018)
Parameters: {'alpha': 0.01, 'average': True, 'l1_ratio': 0.4, 'loss': 'log_loss', 'penalty': 'l2'}

Model with rank: 3
Mean validation score: 0.571 (std: 0.016)
Parameters: {'alpha': 0.01, 'average': True, 'l1_ratio': 0.6000000000000001, 'loss': 'log_loss', 'penalty': 'l2'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model_sgd_result <span class="op">=</span> pd.DataFrame(model_sgd.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>model_sgd_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_sgd.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>model_sgd_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_sgd.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>display(model_sgd_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>alpha</th>
      <th>average</th>
      <th>l1_ratio</th>
      <th>loss</th>
      <th>penalty</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>0.01</td>
      <td>True</td>
      <td>0.3</td>
      <td>log_loss</td>
      <td>l2</td>
      <td>0.573024</td>
      <td>0.018362</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.01</td>
      <td>True</td>
      <td>0.4</td>
      <td>log_loss</td>
      <td>l2</td>
      <td>0.572308</td>
      <td>0.017537</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.01</td>
      <td>True</td>
      <td>0.6</td>
      <td>log_loss</td>
      <td>l2</td>
      <td>0.570664</td>
      <td>0.016208</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.01</td>
      <td>True</td>
      <td>0.5</td>
      <td>log_loss</td>
      <td>l2</td>
      <td>0.569818</td>
      <td>0.017345</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.01</td>
      <td>False</td>
      <td>0.3</td>
      <td>log_loss</td>
      <td>l2</td>
      <td>0.568760</td>
      <td>0.018627</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="166">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model_sgd <span class="op">=</span> SGDClassifier(max_iter<span class="op">=</span><span class="dv">30000</span>, average<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.01</span>, l1_ratio<span class="op">=</span><span class="fl">0.3</span>, loss<span class="op">=</span><span class="st">'log_loss'</span>, penalty<span class="op">=</span><span class="st">'l2'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>accuracy_sgd<span class="op">=</span> cross_val_score(model_sgd, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>f1w_sgd<span class="op">=</span> cross_val_score(model_sgd, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_sgd), np.std(f1w_sgd)))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_sgd), np.std(accuracy_sgd)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.573 (0.016)
Mean Accuracy: 0.628 (0.017)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="167">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>model_sgd.fit(x_train2, y_train2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>y_pred_sgd <span class="op">=</span> model_sgd.predict(x_train2)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_sgd, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_sgd),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.64
Training result (accuracy):  0.69</code></pre>
</div>
</div>
</section>
<section id="nearest-neighbors-knn" class="level3">
<h3 class="anchored" data-anchor-id="nearest-neighbors-knn">4) Nearest neighbors (knn)</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>model_knn_g <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_neighbors'</span> : np.arange(<span class="dv">1</span>,<span class="dv">20</span>).tolist(),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'weights'</span> : [<span class="st">"uniform"</span>, <span class="st">"distance"</span>],</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'metric'</span> : [<span class="st">'euclidean'</span>, <span class="st">'manhattan'</span>, <span class="st">'minkowski'</span>]</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>model_knn <span class="op">=</span> GridSearchCV(model_knn_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>model_knn.fit(x_train2, y_train2)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_knn .cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>report(model_knn.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 114 candidates, totalling 2850 fits
GridSearchCV took 16.74 seconds for 114 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.572 (std: 0.027)
Parameters: {'metric': 'euclidean', 'n_neighbors': 6, 'weights': 'uniform'}

Model with rank: 1
Mean validation score: 0.572 (std: 0.027)
Parameters: {'metric': 'minkowski', 'n_neighbors': 6, 'weights': 'uniform'}

Model with rank: 3
Mean validation score: 0.567 (std: 0.023)
Parameters: {'metric': 'euclidean', 'n_neighbors': 5, 'weights': 'uniform'}

Model with rank: 3
Mean validation score: 0.567 (std: 0.023)
Parameters: {'metric': 'minkowski', 'n_neighbors': 5, 'weights': 'uniform'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model_knn_result <span class="op">=</span> pd.DataFrame(model_knn.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>model_knn_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_knn.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>model_knn_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_knn.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>display(model_knn_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>metric</th>
      <th>n_neighbors</th>
      <th>weights</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>86</th>
      <td>minkowski</td>
      <td>6</td>
      <td>uniform</td>
      <td>0.571810</td>
      <td>0.026588</td>
    </tr>
    <tr>
      <th>10</th>
      <td>euclidean</td>
      <td>6</td>
      <td>uniform</td>
      <td>0.571810</td>
      <td>0.026588</td>
    </tr>
    <tr>
      <th>8</th>
      <td>euclidean</td>
      <td>5</td>
      <td>uniform</td>
      <td>0.567070</td>
      <td>0.022849</td>
    </tr>
    <tr>
      <th>84</th>
      <td>minkowski</td>
      <td>5</td>
      <td>uniform</td>
      <td>0.567070</td>
      <td>0.022849</td>
    </tr>
    <tr>
      <th>85</th>
      <td>minkowski</td>
      <td>5</td>
      <td>distance</td>
      <td>0.566627</td>
      <td>0.025381</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="168">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>model_knn <span class="op">=</span> KNeighborsClassifier(metric<span class="op">=</span><span class="st">'euclidean'</span>,n_neighbors<span class="op">=</span><span class="dv">6</span>, weights<span class="op">=</span><span class="st">'uniform'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>accuracy_knn<span class="op">=</span> cross_val_score(model_knn, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>f1w_knn<span class="op">=</span> cross_val_score(model_knn, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_knn), np.std(f1w_knn)))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_knn), np.std(accuracy_knn)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.572 (0.027)
Mean Accuracy: 0.583 (0.024)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="170">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>model_knn.fit(x_train2, y_train2)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>y_pred_knn <span class="op">=</span> model_knn.predict(x_train2)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_knn, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_knn),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.69
Training result (accuracy):  0.7</code></pre>
</div>
</div>
</section>
<section id="random-forests" class="level3">
<h3 class="anchored" data-anchor-id="random-forests">5) Random Forests</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>model_rf_g <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">2020</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">700</span>],</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: [<span class="st">'sqrt'</span>, <span class="st">'log2'</span>],</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span> : [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>],</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'criterion'</span> :[<span class="st">'gini'</span>, <span class="st">'entropy'</span>, <span class="st">'log_loss'</span>]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>model_rf <span class="op">=</span> GridSearchCV(model_rf_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>model_rf.fit(x_train2, y_train2)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_rf.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>report(model_rf.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 126 candidates, totalling 3150 fits
GridSearchCV took 1417.48 seconds for 126 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.584 (std: 0.023)
Parameters: {'criterion': 'entropy', 'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 200}

Model with rank: 1
Mean validation score: 0.584 (std: 0.023)
Parameters: {'criterion': 'log_loss', 'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 200}

Model with rank: 3
Mean validation score: 0.580 (std: 0.024)
Parameters: {'criterion': 'gini', 'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 500}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>model_rf1 <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">2020</span>,criterion<span class="op">=</span><span class="st">'entropy'</span>, max_features<span class="op">=</span><span class="st">'sqrt'</span>, n_estimators<span class="op">=</span> <span class="dv">200</span>, max_depth<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>accuracy_rf1<span class="op">=</span> cross_val_score(model_rf1, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>f1w_rf1<span class="op">=</span> cross_val_score(model_rf1, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted rf1: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_rf1), np.std(f1w_rf1)))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy rf1: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_rf1), np.std(accuracy_rf1)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted rf1: 0.584 (0.023)
Mean Accuracy rf1: 0.639 (0.020)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="171">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>model_rf1.fit(x_train2, y_train2)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>y_pred_rf1 <span class="op">=</span> model_rf1.predict(x_train2)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_rf1, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_rf1),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  1.0
Training result (accuracy):  1.0</code></pre>
</div>
</div>
</section>
<section id="gradient-boosted-tree" class="level3">
<h3 class="anchored" data-anchor-id="gradient-boosted-tree">6) (Gradient Boosted) Tree</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>model_bt_g <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">2022</span>,loss<span class="op">=</span><span class="st">'log_loss'</span>, n_iter_no_change <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: np.arange(<span class="dv">25</span>,<span class="dv">175</span>,<span class="dv">50</span>).tolist(),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span> : [<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>],</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>],</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: [<span class="dv">5</span>,<span class="dv">10</span>]<span class="op">+</span>np.arange(<span class="dv">1</span>,<span class="dv">180</span>,<span class="dv">30</span>).tolist()</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>model_bt <span class="op">=</span> GridSearchCV(model_bt_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>,scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>model_bt.fit(x_train2, y_train2)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_bt.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>report(model_bt.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 288 candidates, totalling 7200 fits
GridSearchCV took 1935.11 seconds for 288 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.598 (std: 0.022)
Parameters: {'learning_rate': 0.1, 'max_depth': 1, 'max_features': 31, 'n_estimators': 75}

Model with rank: 2
Mean validation score: 0.597 (std: 0.022)
Parameters: {'learning_rate': 0.05, 'max_depth': 1, 'max_features': 31, 'n_estimators': 125}

Model with rank: 3
Mean validation score: 0.596 (std: 0.024)
Parameters: {'learning_rate': 0.05, 'max_depth': 1, 'max_features': 31, 'n_estimators': 75}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="173">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model_bt <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">2022</span>,loss<span class="op">=</span><span class="st">'log_loss'</span>, learning_rate<span class="op">=</span><span class="fl">0.1</span>, max_depth<span class="op">=</span><span class="dv">1</span>, max_features<span class="op">=</span><span class="dv">90</span>, n_estimators<span class="op">=</span><span class="dv">75</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>accuracy_bt<span class="op">=</span> cross_val_score(model_bt, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>f1w_bt<span class="op">=</span> cross_val_score(model_bt, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted bt: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_bt), np.std(f1w_bt)))</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy bt: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_bt), np.std(accuracy_bt)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted bt: 0.589 (0.023)
Mean Accuracy bt: 0.641 (0.021)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="174">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>model_bt.fit(x_train2, y_train2)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>y_pred_bt <span class="op">=</span> model_bt.predict(x_train2)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_bt, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_bt),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.64
Training result (accuracy):  0.68</code></pre>
</div>
</div>
</section>
<section id="xgboost" class="level3">
<h3 class="anchored" data-anchor-id="xgboost">7) Xgboost</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>model_xgb_g <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">2022</span>, objective<span class="op">=</span><span class="st">'multi:softmax'</span>,num_class<span class="op">=</span><span class="dv">3</span>, max_depth<span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span> : [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">125</span>], </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span> : [<span class="fl">0.01</span>,<span class="fl">0.05</span>],</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span> : np.arange(<span class="fl">0.01</span>,<span class="fl">0.02</span>,<span class="fl">0.005</span>).tolist(),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span> : np.arange(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>).tolist(),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lambda'</span> : np.arange(<span class="fl">0.01</span>,<span class="fl">0.02</span>,<span class="fl">0.005</span>).tolist()</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> GridSearchCV(model_xgb_g, verbose<span class="op">=</span> <span class="dv">3</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5,n_jobs<span class="op">=-</span><span class="dv">1</span>,scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>model_xgb.fit(x_train2, y_train2)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_xgb.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>report(model_xgb.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 576 candidates, totalling 14400 fits
GridSearchCV took 3349.99 seconds for 576 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.582 (std: 0.022)
Parameters: {'alpha': 0.9500000000000003, 'gamma': 0.01, 'lambda': 0.01, 'learning_rate': 0.05, 'n_estimators': 125}

Model with rank: 1
Mean validation score: 0.582 (std: 0.022)
Parameters: {'alpha': 0.9500000000000003, 'gamma': 0.01, 'lambda': 0.015, 'learning_rate': 0.05, 'n_estimators': 125}

Model with rank: 1
Mean validation score: 0.582 (std: 0.022)
Parameters: {'alpha': 0.9500000000000003, 'gamma': 0.015, 'lambda': 0.01, 'learning_rate': 0.05, 'n_estimators': 125}

Model with rank: 1
Mean validation score: 0.582 (std: 0.022)
Parameters: {'alpha': 0.9500000000000003, 'gamma': 0.015, 'lambda': 0.015, 'learning_rate': 0.05, 'n_estimators': 125}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="175">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">2022</span>, objective<span class="op">=</span><span class="st">'multi:softmax'</span>,num_class<span class="op">=</span><span class="dv">3</span>, booster<span class="op">=</span><span class="st">"gbtree"</span>, learning_rate<span class="op">=</span><span class="fl">0.05</span>, alpha<span class="op">=</span><span class="fl">0.95</span>, gamma<span class="op">=</span><span class="fl">0.01</span>, reg_lambda<span class="op">=</span><span class="fl">0.01</span>, n_estimators<span class="op">=</span><span class="dv">125</span>, max_depth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>accuracy_xgb<span class="op">=</span> cross_val_score(model_xgb, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>f1w_xgb<span class="op">=</span> cross_val_score(model_xgb, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted xgb: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_xgb), np.std(f1w_xgb)))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy xgb: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_xgb), np.std(accuracy_xgb)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted xgb: 0.582 (0.022)
Mean Accuracy xgb: 0.641 (0.018)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="176">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>model_xgb.fit(x_train2, y_train2)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>y_pred_xgb <span class="op">=</span> model_xgb.predict(x_train2)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_xgb, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_xgb),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.62
Training result (accuracy):  0.66</code></pre>
</div>
</div>
</section>
<section id="linear-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="linear-discriminant-analysis">8) linear discriminant analysis</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> LinearDiscriminantAnalysis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="177">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>model_lda_g <span class="op">=</span> LinearDiscriminantAnalysis()</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'solver'</span>: [<span class="st">'lsqr'</span>, <span class="st">'eigen'</span>], </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shrinkage'</span>: [<span class="st">'auto'</span>]<span class="op">+</span>np.arange(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>).tolist()</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>model_lda <span class="op">=</span> GridSearchCV(model_lda_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>parameters, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>model_lda.fit(x_train2, y_train2)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_lda.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>report(model_lda.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 18 candidates, totalling 450 fits
GridSearchCV took 3.53 seconds for 18 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.617 (std: 0.022)
Parameters: {'shrinkage': 0.5, 'solver': 'lsqr'}

Model with rank: 1
Mean validation score: 0.617 (std: 0.022)
Parameters: {'shrinkage': 0.5, 'solver': 'eigen'}

Model with rank: 3
Mean validation score: 0.616 (std: 0.024)
Parameters: {'shrinkage': 0.6, 'solver': 'lsqr'}

Model with rank: 3
Mean validation score: 0.616 (std: 0.024)
Parameters: {'shrinkage': 0.6, 'solver': 'eigen'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="179">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>model_lda <span class="op">=</span> LinearDiscriminantAnalysis(shrinkage<span class="op">=</span><span class="fl">0.5</span>,solver<span class="op">=</span><span class="st">'lsqr'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>accuracy_lda <span class="op">=</span> cross_val_score(model_lda, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>f1w_lda <span class="op">=</span> cross_val_score(model_lda, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted lda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_lda), np.std(f1w_lda)))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy lda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_lda), np.std(accuracy_lda)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted lda: 0.617 (0.022)
Mean Accuracy lda: 0.621 (0.024)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="180">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>model_lda.fit(x_train2, y_train2)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>y_pred_lda <span class="op">=</span> model_lda.predict(x_train2)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_lda, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_lda),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.65
Training result (accuracy):  0.65</code></pre>
</div>
</div>
</section>
<section id="quadratic-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-discriminant-analysis">9) quadratic discriminant analysis</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> QuadraticDiscriminantAnalysis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model_qda_g <span class="op">=</span> QuadraticDiscriminantAnalysis()</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'reg_param'</span>: np.arange(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>).tolist()}</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>model_qda <span class="op">=</span> GridSearchCV(model_qda_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>parameters, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>model_qda.fit(x_train2, y_train2)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_qda.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>report(model_qda.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="187">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>model_qda <span class="op">=</span> QuadraticDiscriminantAnalysis(reg_param<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>accuracy_qda <span class="op">=</span> cross_val_score(model_qda_f, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>f1w_qda <span class="op">=</span> cross_val_score(model_qda_f, x_train2, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted qda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_qda), np.std(f1w_qda)))</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy qda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_qda), np.std(accuracy_qda)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted qda: 0.543 (0.025)
Mean Accuracy qda: 0.525 (0.027)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="188">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training result</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>model_qda.fit(x_train2, y_train2)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>y_pred_qda <span class="op">=</span> model_qda.predict(x_train2)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (f1_weighted): "</span>, <span class="bu">round</span>(f1_score(y_train2, y_pred_qda, average<span class="op">=</span><span class="st">'weighted'</span>),<span class="dv">2</span>))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training result (accuracy): "</span>, <span class="bu">round</span>(accuracy_score(y_train2, y_pred_qda),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training result (f1_weighted):  0.62
Training result (accuracy):  0.62</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>c:\Users\jsw06\miniconda3\envs\koreait\lib\site-packages\sklearn\discriminant_analysis.py:887: UserWarning: Variables are collinear
  warnings.warn("Variables are collinear")</code></pre>
</div>
</div>
</section>
</section>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">(b)</h2>
<p>[20 pts] Do you think dimension reduction on features (or feature selection) is needed here? If so, provide analysis on which features may be important. If not, please justify your answer.</p>
<p>Dimension reduction on features or feature selection might provide better accuracy score, since models training with a subset of features (such as gradient boosting classifier, random forest etc.) showed better mean CV f1_weighted score (or accuracy score) compared to other models without feature selection. There might be a possibility of model specification issue on including non-informative or redundant predictors. Therefore, using dimension reduction on features or feature selection to improve prediction might be desirable.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>corr<span class="op">=</span>x_train.corr()</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>corr.values[corr.values<span class="op">==</span><span class="dv">1</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>corr2<span class="op">=</span>corr[(corr.values<span class="op">&gt;</span><span class="fl">0.5</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">&amp;</span>(corr.values<span class="op">&gt;</span><span class="fl">0.5</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="249">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(corr.values[corr.values<span class="op">&gt;</span><span class="fl">0.5</span>].tolist())<span class="op">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="249">
<pre><code>1753.0</code></pre>
</div>
</div>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">1) PCA</h3>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>model_pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">251</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>pca_full_array <span class="op">=</span> model_pca.fit_transform(x_train)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>pca_full_df <span class="op">=</span> pd.DataFrame(pca_full_array, index<span class="op">=</span>x_train.index,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                      columns<span class="op">=</span>[<span class="ss">f"pca</span><span class="sc">{</span>num<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(x_train.shape[<span class="dv">1</span>])])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><span class="math display">\[ proportion \: = specific\: component's\: proportion =  \frac{specific\: component's\: eigenvalue\: (주성분\:분산)} {sum\:of\:all\:eigenvalues (모든\:주성분\:분산의\:합)}\]</span></p>
<div class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>pca_table <span class="op">=</span> pd.DataFrame({<span class="st">'Eigenvalue'</span>:model_pca.explained_variance_, <span class="st">'Proportion'</span>:model_pca.explained_variance_ratio_},</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>            index<span class="op">=</span>np.array([<span class="ss">f"pca</span><span class="sc">{</span>num<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(x_train2.shape[<span class="dv">1</span>])]))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>pca_table[<span class="st">'Cumulative'</span>] <span class="op">=</span> pca_table[<span class="st">'Proportion'</span>].cumsum()</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>display(pca_table.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Eigenvalue</th>
      <th>Proportion</th>
      <th>Cumulative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pca1</th>
      <td>29.741754</td>
      <td>0.331111</td>
      <td>0.331111</td>
    </tr>
    <tr>
      <th>pca2</th>
      <td>12.455516</td>
      <td>0.138666</td>
      <td>0.469776</td>
    </tr>
    <tr>
      <th>pca3</th>
      <td>0.546720</td>
      <td>0.006087</td>
      <td>0.475863</td>
    </tr>
    <tr>
      <th>pca4</th>
      <td>0.535468</td>
      <td>0.005961</td>
      <td>0.481824</td>
    </tr>
    <tr>
      <th>pca5</th>
      <td>0.522446</td>
      <td>0.005816</td>
      <td>0.487640</td>
    </tr>
    <tr>
      <th>pca6</th>
      <td>0.507087</td>
      <td>0.005645</td>
      <td>0.493286</td>
    </tr>
    <tr>
      <th>pca7</th>
      <td>0.484598</td>
      <td>0.005395</td>
      <td>0.498681</td>
    </tr>
    <tr>
      <th>pca8</th>
      <td>0.473509</td>
      <td>0.005272</td>
      <td>0.503952</td>
    </tr>
    <tr>
      <th>pca9</th>
      <td>0.466847</td>
      <td>0.005197</td>
      <td>0.509150</td>
    </tr>
    <tr>
      <th>pca10</th>
      <td>0.446134</td>
      <td>0.004967</td>
      <td>0.514116</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="52">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> psynlig <span class="im">import</span> pca_scree</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'seaborn'</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>pca_scree(model_pca, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">16</span>, lw<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">16</span>})</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">0</span>, <span class="dv">30</span>])</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x550 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-29725_hw2_files/figure-html/cell-53-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>According to screeplot there is not much difference on eigenvalue after 3, therefore the number of components were set to three.</p>
<div class="cell" data-execution_count="256">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pca <span class="im">import</span> pca</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>model_pca <span class="op">=</span> pca(n_components<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>pca_reduced_array <span class="op">=</span> model_pca.fit_transform(x_train)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>pca_df <span class="op">=</span> pd.DataFrame(pca_reduced_array, index<span class="op">=</span>x_train.index,columns<span class="op">=</span>np.array([<span class="ss">f"pca</span><span class="sc">{</span>num<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>)]))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>result_pca <span class="op">=</span> model_pca.fit_transform(x_train)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> model_pca.biplot3d(n_feat<span class="op">=</span><span class="dv">3</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[pca] &gt;Processing dataframe..
[pca] &gt;The PCA reduction is performed on the [251] columns of the input dataframe.
[pca] &gt;Fit using PCA.
[pca] &gt;Compute loadings and PCs.
[pca] &gt;Compute explained variance.
[pca] &gt;Outlier detection using Hotelling T2 test with alpha=[0.05] and n_components=[3]
[pca] &gt;Outlier detection using SPE/DmodX with n_std=[2]
[pca] &gt;Cleaning previous fitted model results..
[pca] &gt;Processing dataframe..
[pca] &gt;The PCA reduction is performed on the [251] columns of the input dataframe.
[pca] &gt;Fit using PCA.
[pca] &gt;Compute loadings and PCs.
[pca] &gt;Compute explained variance.
[pca] &gt;Outlier detection using Hotelling T2 test with alpha=[0.05] and n_components=[3]
[pca] &gt;Outlier detection using SPE/DmodX with n_std=[2]
[pca] &gt;Plot PC1 vs PC2 vs PC3 with loadings.
[colourmap]&gt; Warning: Colormap [Set1] can not create [1452] unique colors! Available unique colors: [9].
[colourmap]&gt; Warning: Colormap [Set1] can not create [1452] unique colors! Available unique colors: [9].
[pca] &gt;Set parameter "label=None" to ignore the labels and significanly speed up the scatter plot.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x550 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-29725_hw2_files/figure-html/cell-54-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="57">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model_pca <span class="op">=</span> pca(n_components<span class="op">=</span><span class="fl">0.80</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>pca_reduced_array <span class="op">=</span> model_pca.fit_transform(x_train)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>pca_df <span class="op">=</span> pd.DataFrame(pca_reduced_array, index<span class="op">=</span>x_train.index,columns<span class="op">=</span>np.array([<span class="ss">f"pca</span><span class="sc">{</span>num<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>)]))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>result_pca <span class="op">=</span> model_pca.fit_transform(x_train)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> model_pca.biplot(n_feat<span class="op">=</span><span class="dv">2</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>plt.show( )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[pca] &gt;Processing dataframe..
[pca] &gt;The PCA reduction is performed to capture [80.0%] explained variance using the [251] columns of the input data.
[pca] &gt;Fit using PCA.
[pca] &gt;Compute loadings and PCs.
[pca] &gt;Compute explained variance.
[pca] &gt;Number of components is [98] that covers the [80.00%] explained variance.
[pca] &gt;The PCA reduction is performed on the [251] columns of the input dataframe.
[pca] &gt;Fit using PCA.
[pca] &gt;Compute loadings and PCs.
[pca] &gt;Outlier detection using Hotelling T2 test with alpha=[0.05] and n_components=[98]
[pca] &gt;Outlier detection using SPE/DmodX with n_std=[2]
[pca] &gt;Cleaning previous fitted model results..
[pca] &gt;Processing dataframe..
[pca] &gt;The PCA reduction is performed on the [251] columns of the input dataframe.
[pca] &gt;Fit using PCA.
[pca] &gt;Compute loadings and PCs.
[pca] &gt;Compute explained variance.
[pca] &gt;Outlier detection using Hotelling T2 test with alpha=[0.05] and n_components=[98]
[pca] &gt;Outlier detection using SPE/DmodX with n_std=[2]
[pca] &gt;Plot PC1 vs PC2 with loadings.
[colourmap]&gt; Warning: Colormap [Set1] can not create [1452] unique colors! Available unique colors: [9].
[colourmap]&gt; Warning: Colormap [Set1] can not create [1452] unique colors! Available unique colors: [9].
[pca] &gt;Set parameter "label=None" to ignore the labels and significanly speed up the scatter plot.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x550 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-29725_hw2_files/figure-html/cell-55-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x600 with 0 Axes&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="253">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>plt.show(model_pca.plot())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x550 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-29725_hw2_files/figure-html/cell-56-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 800x550 with 0 Axes&gt;</code></pre>
</div>
</div>
<p>However, 3 components can not be used since the variance explained by 3 components is only 48% of the total variance. If the variance explained by the components needs to be over 80%, then at least 98 components need to be used. This discrepancy between significant eigenvalues and very small variance explained by marginal components makes it difficult to use PCA in the analysis. Therefore, the PCA was not used in this analysis as a demension reduction technique.</p>
</section>
<section id="l1-based-feature-selection-tree-based-feature-selection" class="level3">
<h3 class="anchored" data-anchor-id="l1-based-feature-selection-tree-based-feature-selection">2) L1-based feature selection / Tree-based feature selection</h3>
<p>citation: https://scikit-learn.org/stable/modules/feature_selection.html</p>
<ul>
<li>first, l1-regularized linear SVM and logistic regression was used to select features. In order to minimize the possibility of model overfit, cross-validation was adopted to choose best lambdas for l1-regularization.</li>
</ul>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM: linear</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> LinearSVC</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>model_svm_l_g <span class="op">=</span> LinearSVC(penalty<span class="op">=</span><span class="st">"l1"</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>, max_iter<span class="op">=</span><span class="dv">20000</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]}</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Best Parameter C</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>model_svm_l <span class="op">=</span> GridSearchCV(model_svm_l_g, param_grid <span class="op">=</span> parameters, cv <span class="op">=</span> cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>model_svc_fs<span class="op">=</span> model_svm_l.fit(x_train2, y_train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model_svc_fs_result <span class="op">=</span> pd.DataFrame(model_svc_fs.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>model_svc_fs_result[<span class="st">'mean_accuracy_score'</span>] <span class="op">=</span> model_svc_fs.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>display(model_svc_fs_result.sort_values(by<span class="op">=</span><span class="st">'mean_accuracy_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>C</th>
      <th>mean_accuracy_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.010</td>
      <td>0.648080</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.100</td>
      <td>0.623004</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.001</td>
      <td>0.566114</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.000</td>
      <td>0.555101</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.000</td>
      <td>0.531134</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectFromModel</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>model_svc_l<span class="op">=</span>LinearSVC(C<span class="op">=</span> <span class="fl">0.01</span>, penalty<span class="op">=</span><span class="st">"l1"</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>, max_iter<span class="op">=</span><span class="dv">20000</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>model_svc_fs<span class="op">=</span> model_svc_l.fit(x_train2, y_train2)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>model_svc_final <span class="op">=</span> SelectFromModel(model_svc_fs, prefit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>x_train3<span class="op">=</span> model_svc_final.transform(x_train2)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"original dataset: "</span>, x_train2.shape,<span class="st">", feature selected: "</span>, x_train3.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>original dataset:  (1452, 251) , feature selected:  (1452, 26)</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>model_lr_g<span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">'l1'</span>, multi_class<span class="op">=</span><span class="st">'multinomial'</span>, solver<span class="op">=</span><span class="st">'saga'</span>, max_iter<span class="op">=</span><span class="dv">10000</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]}</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Best Parameter C</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>model_lr <span class="op">=</span> GridSearchCV(model_lr_g, param_grid <span class="op">=</span> parameters, cv <span class="op">=</span> cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>model_lr_fs<span class="op">=</span> model_lr.fit(x_train2, y_train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>model_lr_fs_result <span class="op">=</span> pd.DataFrame(model_lr_fs.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>model_lr_fs_result[<span class="st">'mean_accuracy_score'</span>] <span class="op">=</span> model_lr_fs.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>display(model_lr_fs_result.sort_values(by<span class="op">=</span><span class="st">'mean_accuracy_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>C</th>
      <th>mean_accuracy_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.100</td>
      <td>0.644903</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.010</td>
      <td>0.590767</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.000</td>
      <td>0.571637</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.001</td>
      <td>0.566114</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.000</td>
      <td>0.528654</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>model_lr<span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">'l1'</span>,C<span class="op">=</span><span class="fl">0.1</span>,multi_class<span class="op">=</span><span class="st">'multinomial'</span>, solver<span class="op">=</span><span class="st">'saga'</span>, max_iter<span class="op">=</span><span class="dv">10000</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>model_lr_fs<span class="op">=</span> model_lr.fit(x_train2, y_train2)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>model_lr_final <span class="op">=</span> SelectFromModel(model_lr_fs, prefit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>x_train4<span class="op">=</span> model_lr_final.transform(x_train2)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"original dataset: "</span>, x_train2.shape,<span class="st">", feature selected: "</span>, x_train4.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>original dataset:  (1452, 251) , feature selected:  (1452, 60)</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tree-based</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> ExtraTreesClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model_et_g<span class="op">=</span> ExtraTreesClassifier(n_estimators<span class="op">=</span><span class="dv">50</span>, max_features<span class="op">=</span><span class="st">'sqrt'</span>, random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'criterion'</span>: [<span class="st">'gini'</span>, <span class="st">'entropy'</span>],</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: np.arange(<span class="dv">25</span>,<span class="dv">175</span>,<span class="dv">50</span>).tolist(),</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span> : [<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>],</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: [<span class="dv">5</span>,<span class="dv">10</span>]<span class="op">+</span>np.arange(<span class="dv">1</span>,<span class="dv">180</span>,<span class="dv">30</span>).tolist()</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>model_et <span class="op">=</span> GridSearchCV(model_et_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>model_et.fit(x_train2, y_train2)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_et.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>report(model_et.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 192 candidates, totalling 4800 fits
GridSearchCV took 126.86 seconds for 192 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.644 (std: 0.017)
Parameters: {'criterion': 'entropy', 'max_depth': 3, 'max_features': 121, 'n_estimators': 125}

Model with rank: 2
Mean validation score: 0.644 (std: 0.016)
Parameters: {'criterion': 'gini', 'max_depth': 3, 'max_features': 121, 'n_estimators': 125}

Model with rank: 3
Mean validation score: 0.644 (std: 0.016)
Parameters: {'criterion': 'gini', 'max_depth': 3, 'max_features': 151, 'n_estimators': 25}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model_et<span class="op">=</span> ExtraTreesClassifier(criterion<span class="op">=</span> <span class="st">'entropy'</span>, max_features<span class="op">=</span><span class="dv">121</span>, n_estimators<span class="op">=</span> <span class="dv">125</span>, max_depth<span class="op">=</span><span class="dv">3</span> , random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model_et_fs<span class="op">=</span> model_et.fit(x_train2, y_train2)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>model_et_final <span class="op">=</span> SelectFromModel(model_et_fs, prefit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>x_train4<span class="op">=</span> model_et_final.transform(x_train2)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"original dataset: "</span>, x_train2.shape,<span class="st">", feature selected: "</span>, x_train4.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>original dataset:  (1452, 251) , feature selected:  (1452, 45)</code></pre>
</div>
</div>
<p>The features that are selected in at least two of the each selection methods were included in the final feature selection.</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> pd.DataFrame([model_lr_final.fit(x_train2,y_train2).get_support(), model_svc_final.fit(x_train2,y_train2).get_support(),model_et_final.fit(x_train2,y_train2).get_support()],</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                        index<span class="op">=</span>[<span class="st">"LR"</span>,<span class="st">"SVM"</span>,<span class="st">"ET"</span>]).T</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>features1<span class="op">=</span>pd.DataFrame(features[(features[<span class="st">"LR"</span>] <span class="op">==</span> <span class="va">True</span>)<span class="op">|</span>(features[<span class="st">"SVM"</span>] <span class="op">==</span> <span class="va">True</span>)<span class="op">|</span>(features[<span class="st">"ET"</span>] <span class="op">==</span> <span class="va">True</span>)].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">&gt;</span><span class="dv">1</span>, columns<span class="op">=</span>[<span class="st">"features"</span>])</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"features chosen: "</span>, features1[features1[<span class="st">"features"</span>]<span class="op">==</span><span class="va">True</span>].shape)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>features2<span class="op">=</span>features1[features1[<span class="st">"features"</span>]<span class="op">==</span><span class="va">True</span>]</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> np.printoptions(threshold<span class="op">=</span>np.inf):</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"selected features:"</span>,np.array(features2.index))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>features chosen:  (27, 1)
selected features: [  2  17  22  28  30  38  44  49  61  64  70  79  90 104 113 129 134 145
 169 172 177 190 193 207 228 231 246]</code></pre>
</div>
</div>
</section>
<section id="re-estimation-with-selected-features" class="level3">
<h3 class="anchored" data-anchor-id="re-estimation-with-selected-features">3) Re-estimation with selected features</h3>
<p>Using selected features, the crossvalidation accuracy and f1_scores for the models without feature selection was calculated again <br> (logistic, linear svm, quadratic svm, knn, random forest, gbm, xgboost, lda, qda )</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selection</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>x_train_fs<span class="op">=</span>x_train.iloc[:,features2.index]</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>x_train5<span class="op">=</span>x_train_fs.to_numpy()</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>x_train5.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(1452, 27)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>corr<span class="op">=</span>x_train_fs.corr()</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sns.color_palette(<span class="st">"Blues"</span>, as_cmap<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, mask<span class="op">=</span>mask, cmap<span class="op">=</span>cmap, vmax<span class="op">=</span><span class="fl">.3</span>, center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">.5</span>, cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">.5</span>})</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-29725_hw2_files/figure-html/cell-68-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="multinomial-logit" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-logit">- multinomial logit</h4>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multinomial logistic </span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>model_lr_f<span class="op">=</span> LogisticRegression(C<span class="op">=</span><span class="fl">0.01</span>,multi_class<span class="op">=</span><span class="st">'multinomial'</span>, max_iter<span class="op">=</span><span class="dv">10000</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>accuracy_lr_f <span class="op">=</span> cross_val_score(model_lr_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>f1w_lr_f<span class="op">=</span> cross_val_score(model_lr_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1 weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_lr_f), np.std(f1w_lr_f)))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_lr_f), np.std(accuracy_lr_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1 weighted: 0.568 (0.018)
Mean Accuracy: 0.647 (0.016)</code></pre>
</div>
</div>
</section>
<section id="linear-svm" class="level4">
<h4 class="anchored" data-anchor-id="linear-svm">- linear svm</h4>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear svm</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>model_svcl_f <span class="op">=</span> LinearSVC(C<span class="op">=</span> <span class="fl">0.01</span> , penalty<span class="op">=</span><span class="st">"l1"</span>, dual<span class="op">=</span><span class="va">False</span>, random_state<span class="op">=</span><span class="dv">2020</span>, max_iter<span class="op">=</span><span class="dv">20000</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>accuracy_svcl_f <span class="op">=</span> cross_val_score(model_svcl_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>f1w_svcl_f<span class="op">=</span> cross_val_score(model_svcl_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1 weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_svcl_f), np.std(f1w_svcl_f)))</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_svcl_f), np.std(accuracy_svcl_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1 weighted: 0.563 (0.018)
Mean Accuracy: 0.648 (0.015)</code></pre>
</div>
</div>
</section>
<section id="rbf-svm" class="level4">
<h4 class="anchored" data-anchor-id="rbf-svm">- rbf svm</h4>
<div class="cell" data-execution_count="66">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic svm</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>model_svcq_g <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>, random_state<span class="op">=</span><span class="dv">2022</span>, max_iter<span class="op">=</span><span class="dv">22000</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'C'</span>: [<span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">650</span>, <span class="dv">700</span>, <span class="dv">750</span>, <span class="dv">800</span>, <span class="dv">900</span>], <span class="st">'gamma'</span>: [<span class="fl">0.00004</span>,<span class="fl">0.00006</span>,<span class="fl">0.00008</span>, <span class="fl">0.0001</span>, <span class="fl">0.0002</span>, <span class="fl">0.0003</span>, <span class="fl">0.0004</span>, <span class="fl">0.0005</span>, <span class="fl">0.001</span>]}</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Best Parameter C and gamma</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>model_svcq_f <span class="op">=</span> GridSearchCV(model_svcq_g, verbose<span class="op">=</span><span class="dv">2</span>, param_grid <span class="op">=</span> parameters, cv <span class="op">=</span> cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>,scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>model_svcq_f.fit(x_train5, y_train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 63 candidates, totalling 1575 fits</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=RepeatedStratifiedKFold(n_repeats=5, n_splits=5, random_state=2022),
             estimator=SVC(max_iter=22000, random_state=2022), n_jobs=-1,
             param_grid={'C': [500, 600, 650, 700, 750, 800, 900],
                         'gamma': [4e-05, 6e-05, 8e-05, 0.0001, 0.0002, 0.0003,
                                   0.0004, 0.0005, 0.001]},
             scoring='f1_weighted', verbose=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=RepeatedStratifiedKFold(n_repeats=5, n_splits=5, random_state=2022),
             estimator=SVC(max_iter=22000, random_state=2022), n_jobs=-1,
             param_grid={'C': [500, 600, 650, 700, 750, 800, 900],
                         'gamma': [4e-05, 6e-05, 8e-05, 0.0001, 0.0002, 0.0003,
                                   0.0004, 0.0005, 0.001]},
             scoring='f1_weighted', verbose=2)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: SVC</label><div class="sk-toggleable__content"><pre>SVC(max_iter=22000, random_state=2022)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(max_iter=22000, random_state=2022)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="68">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>model_svcq_f_result <span class="op">=</span> pd.DataFrame(model_svcq_f.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>model_svcq_f_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_svcq_f.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>model_svcq_f_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_svcq_f.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>display(model_svcq_f_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>C</th>
      <th>gamma</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>600</td>
      <td>0.0004</td>
      <td>0.568534</td>
      <td>0.019032</td>
    </tr>
    <tr>
      <th>50</th>
      <td>800</td>
      <td>0.0003</td>
      <td>0.568374</td>
      <td>0.019318</td>
    </tr>
    <tr>
      <th>52</th>
      <td>800</td>
      <td>0.0005</td>
      <td>0.568364</td>
      <td>0.018764</td>
    </tr>
    <tr>
      <th>51</th>
      <td>800</td>
      <td>0.0004</td>
      <td>0.568262</td>
      <td>0.019490</td>
    </tr>
    <tr>
      <th>24</th>
      <td>650</td>
      <td>0.0004</td>
      <td>0.568231</td>
      <td>0.019152</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="71">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>model_svcq_f <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'rbf'</span>,C<span class="op">=</span><span class="dv">600</span>,gamma<span class="op">=</span><span class="fl">0.0004</span>, random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>accuracy_svcq_f<span class="op">=</span> cross_val_score(model_svcq_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>f1w_svcq_f<span class="op">=</span> cross_val_score(model_svcq_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_svcq_f), np.std(f1w_svcq_f)))</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_svcq_f), np.std(accuracy_svcq_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.569 (0.019)
Mean Accuracy: 0.651 (0.018)</code></pre>
</div>
</div>
</section>
<section id="knn" class="level4">
<h4 class="anchored" data-anchor-id="knn">- knn</h4>
<div class="cell" data-execution_count="74">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>model_knn_g <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_neighbors'</span> : np.arange(<span class="dv">1</span>,<span class="dv">30</span>).tolist(),</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'weights'</span> : [<span class="st">"uniform"</span>, <span class="st">"distance"</span>],</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'metric'</span> : [<span class="st">'euclidean'</span>, <span class="st">'manhattan'</span>, <span class="st">'minkowski'</span>]</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>model_knn <span class="op">=</span> GridSearchCV(model_knn_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>model_knn.fit(x_train5, y_train2)</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_knn.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>report(model_knn.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 174 candidates, totalling 4350 fits
GridSearchCV took 5.55 seconds for 174 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.605 (std: 0.024)
Parameters: {'metric': 'manhattan', 'n_neighbors': 20, 'weights': 'distance'}

Model with rank: 2
Mean validation score: 0.604 (std: 0.026)
Parameters: {'metric': 'manhattan', 'n_neighbors': 19, 'weights': 'distance'}

Model with rank: 3
Mean validation score: 0.604 (std: 0.021)
Parameters: {'metric': 'euclidean', 'n_neighbors': 19, 'weights': 'distance'}

Model with rank: 3
Mean validation score: 0.604 (std: 0.021)
Parameters: {'metric': 'minkowski', 'n_neighbors': 19, 'weights': 'distance'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="75">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>model_knn_f <span class="op">=</span> KNeighborsClassifier(metric<span class="op">=</span><span class="st">'manhattan'</span>, n_neighbors<span class="op">=</span><span class="dv">20</span>, weights<span class="op">=</span><span class="st">'distance'</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>accuracy_knn_f<span class="op">=</span> cross_val_score(model_knn_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>f1w_knn_f<span class="op">=</span> cross_val_score(model_knn_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_knn_f), np.std(f1w_knn_f)))</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_knn_f), np.std(accuracy_knn_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.605 (0.024)
Mean Accuracy: 0.635 (0.020)</code></pre>
</div>
</div>
</section>
<section id="sgd-classifier-1" class="level4">
<h4 class="anchored" data-anchor-id="sgd-classifier-1">- SGD classifier</h4>
<div class="cell" data-execution_count="76">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SGD classifier</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>model_sgd_g <span class="op">=</span> SGDClassifier(fit_intercept<span class="op">=</span><span class="va">True</span>, max_iter<span class="op">=</span><span class="dv">30000</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"average"</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loss'</span>: [<span class="st">'hinge'</span>,<span class="st">'log_loss'</span>,<span class="st">'modified_huber'</span>,<span class="st">'perceptron'</span>,<span class="st">'squared_hinge'</span>], </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'penalty'</span>: [<span class="st">'l2'</span>, <span class="st">'l1'</span>, <span class="st">'elasticnet'</span>],</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'l1_ratio'</span>: np.arange(<span class="fl">0.3</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>model_sgd <span class="op">=</span> GridSearchCV(model_sgd_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>model_sgd.fit(x_train5, y_train2)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_sgd.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>report(model_sgd.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 120 candidates, totalling 3000 fits
GridSearchCV took 802.35 seconds for 120 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.583 (std: 0.032)
Parameters: {'average': True, 'l1_ratio': 0.5, 'loss': 'squared_hinge', 'penalty': 'l2'}

Model with rank: 2
Mean validation score: 0.577 (std: 0.031)
Parameters: {'average': True, 'l1_ratio': 0.6000000000000001, 'loss': 'squared_hinge', 'penalty': 'l2'}

Model with rank: 3
Mean validation score: 0.576 (std: 0.019)
Parameters: {'average': True, 'l1_ratio': 0.3, 'loss': 'perceptron', 'penalty': 'l2'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="77">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>model_sgd_result <span class="op">=</span> pd.DataFrame(model_sgd.cv_results_[<span class="st">'params'</span>])</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>model_sgd_result[<span class="st">'mean_f1_weighted_score'</span>] <span class="op">=</span> model_sgd.cv_results_[<span class="st">'mean_test_score'</span>]</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>model_sgd_result[<span class="st">'std_f1_weighted_score'</span>] <span class="op">=</span> model_sgd.cv_results_[<span class="st">'std_test_score'</span>]</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>display(model_sgd_result.sort_values(by<span class="op">=</span><span class="st">'mean_f1_weighted_score'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>average</th>
      <th>l1_ratio</th>
      <th>loss</th>
      <th>penalty</th>
      <th>mean_f1_weighted_score</th>
      <th>std_f1_weighted_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>True</td>
      <td>0.5</td>
      <td>squared_hinge</td>
      <td>l2</td>
      <td>0.582982</td>
      <td>0.031619</td>
    </tr>
    <tr>
      <th>57</th>
      <td>True</td>
      <td>0.6</td>
      <td>squared_hinge</td>
      <td>l2</td>
      <td>0.577381</td>
      <td>0.031336</td>
    </tr>
    <tr>
      <th>9</th>
      <td>True</td>
      <td>0.3</td>
      <td>perceptron</td>
      <td>l2</td>
      <td>0.576001</td>
      <td>0.019470</td>
    </tr>
    <tr>
      <th>54</th>
      <td>True</td>
      <td>0.6</td>
      <td>perceptron</td>
      <td>l2</td>
      <td>0.575578</td>
      <td>0.017628</td>
    </tr>
    <tr>
      <th>24</th>
      <td>True</td>
      <td>0.4</td>
      <td>perceptron</td>
      <td>l2</td>
      <td>0.574806</td>
      <td>0.020559</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="79">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>model_sgd_f <span class="op">=</span> SGDClassifier(max_iter<span class="op">=</span><span class="dv">30000</span>, average<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, l1_ratio<span class="op">=</span><span class="fl">0.5</span>, loss<span class="op">=</span><span class="st">'perceptron'</span>, penalty<span class="op">=</span><span class="st">'l2'</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>accuracy_sgd_f <span class="op">=</span> cross_val_score(model_sgd_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>f1w_sgd_f <span class="op">=</span> cross_val_score(model_sgd_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_sgd_f), np.std(f1w_sgd_f)))</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_sgd_f), np.std(accuracy_sgd_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.572 (0.019)
Mean Accuracy: 0.644 (0.017)</code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level4">
<h4 class="anchored" data-anchor-id="random-forest">- random forest</h4>
<div class="cell" data-execution_count="81">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>model_rf_g <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">2022</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">200</span>, <span class="dv">500</span>],</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span> : [<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>],</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'criterion'</span> :[<span class="st">'gini'</span>, <span class="st">'entropy'</span>]</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>model_rf <span class="op">=</span> GridSearchCV(model_rf_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>model_rf.fit(x_train5, y_train2)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_rf.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>report(model_rf.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 20 candidates, totalling 500 fits
GridSearchCV took 85.33 seconds for 20 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.593 (std: 0.024)
Parameters: {'criterion': 'entropy', 'max_depth': 10, 'n_estimators': 200}

Model with rank: 2
Mean validation score: 0.593 (std: 0.023)
Parameters: {'criterion': 'gini', 'max_depth': 10, 'n_estimators': 200}

Model with rank: 3
Mean validation score: 0.592 (std: 0.023)
Parameters: {'criterion': 'entropy', 'max_depth': 8, 'n_estimators': 200}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="82">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model_rf_f <span class="op">=</span> RandomForestClassifier(criterion<span class="op">=</span><span class="st">"entropy"</span>, max_depth<span class="op">=</span><span class="dv">10</span>, n_estimators<span class="op">=</span><span class="dv">200</span>,random_state<span class="op">=</span><span class="dv">2020</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>accuracy_rf_f <span class="op">=</span> cross_val_score(model_rf_f , x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>f1w_rf_f <span class="op">=</span> cross_val_score(model_rf_f , x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_rf_f), np.std(f1w_rf_f)))</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_rf_f), np.std(accuracy_rf_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted: 0.594 (0.023)
Mean Accuracy: 0.640 (0.017)</code></pre>
</div>
</div>
</section>
<section id="gradient-boosting-tree" class="level4">
<h4 class="anchored" data-anchor-id="gradient-boosting-tree">- gradient boosting tree</h4>
<div class="cell" data-execution_count="83">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>model_bt_g <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">2022</span>,loss<span class="op">=</span><span class="st">'log_loss'</span>, n_iter_no_change <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: np.arange(<span class="dv">25</span>,<span class="dv">225</span>,<span class="dv">50</span>).tolist(),</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span> : [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>,<span class="fl">0.05</span>],</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: np.arange(<span class="dv">5</span>,<span class="dv">32</span>,<span class="dv">5</span>).tolist()</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>model_bt <span class="op">=</span> GridSearchCV(model_bt_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>model_bt.fit(x_train5, y_train2)</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_bt.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>report(model_bt.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 144 candidates, totalling 3600 fits
GridSearchCV took 412.38 seconds for 144 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.599 (std: 0.024)
Parameters: {'learning_rate': 0.05, 'max_depth': 2, 'max_features': 15, 'n_estimators': 175}

Model with rank: 2
Mean validation score: 0.599 (std: 0.025)
Parameters: {'learning_rate': 0.05, 'max_depth': 2, 'max_features': 15, 'n_estimators': 125}

Model with rank: 3
Mean validation score: 0.599 (std: 0.024)
Parameters: {'learning_rate': 0.05, 'max_depth': 2, 'max_features': 15, 'n_estimators': 75}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>model_bt_f <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">2022</span>,loss<span class="op">=</span><span class="st">'log_loss'</span>, learning_rate<span class="op">=</span><span class="fl">0.05</span>, max_depth<span class="op">=</span><span class="dv">2</span>, max_features<span class="op">=</span><span class="dv">15</span>, n_estimators<span class="op">=</span><span class="dv">175</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>accuracy_bt_f<span class="op">=</span> cross_val_score(model_bt_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>f1w_bt_f<span class="op">=</span> cross_val_score(model_bt_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted bt: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_bt_f), np.std(f1w_bt_f)))</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy bt: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_bt_f), np.std(accuracy_bt_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted bt: 0.602 (0.022)
Mean Accuracy bt: 0.642 (0.021)</code></pre>
</div>
</div>
</section>
<section id="xgboost-1" class="level4">
<h4 class="anchored" data-anchor-id="xgboost-1">- xgboost</h4>
<div class="cell" data-execution_count="95">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a classifier</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>model_xgb_g <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">2022</span>, objective<span class="op">=</span><span class="st">'multi:softmax'</span>,num_class<span class="op">=</span><span class="dv">3</span>, n_estimators<span class="op">=</span><span class="dv">25</span>, learning_rate<span class="op">=</span><span class="fl">0.1</span>, max_depth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a full grid over all parameters</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span> : np.arange(<span class="dv">0</span>,<span class="fl">1.2</span>,<span class="fl">0.1</span>).tolist(),</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span> : np.arange(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.1</span>).tolist(),</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lambda'</span> : np.arange(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.1</span>).tolist()</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> GridSearchCV(model_xgb_g, verbose<span class="op">=</span> <span class="dv">3</span>, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>cv_5,n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>model_xgb.fit(x_train5, y_train2)</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_xgb.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>report(model_xgb.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 1200 candidates, totalling 30000 fits
GridSearchCV took 913.40 seconds for 1200 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.601 (std: 0.024)
Parameters: {'alpha': 0.5, 'gamma': 0.30000000000000004, 'lambda': 0.6}

Model with rank: 2
Mean validation score: 0.601 (std: 0.025)
Parameters: {'alpha': 0.5, 'gamma': 0.2, 'lambda': 0.6}

Model with rank: 3
Mean validation score: 0.600 (std: 0.025)
Parameters: {'alpha': 0.5, 'gamma': 0.0, 'lambda': 0.6}

Model with rank: 3
Mean validation score: 0.600 (std: 0.025)
Parameters: {'alpha': 0.5, 'gamma': 0.1, 'lambda': 0.6}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="97">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>model_xgb_f <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">2022</span>, objective<span class="op">=</span><span class="st">'multi:softmax'</span>,num_class<span class="op">=</span><span class="dv">3</span>, n_estimators<span class="op">=</span><span class="dv">25</span>, learning_rate<span class="op">=</span><span class="fl">0.1</span>, max_depth<span class="op">=</span><span class="dv">3</span>,alpha<span class="op">=</span><span class="fl">0.5</span>, gamma<span class="op">=</span><span class="fl">0.3</span>, get_lambda<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>accuracy_xgb_f <span class="op">=</span> cross_val_score(model_xgb_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>f1w_xgb_f <span class="op">=</span> cross_val_score(model_xgb_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted xgb: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_xgb_f), np.std(f1w_xgb_f)))</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy xgb: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_xgb_f), np.std(accuracy_xgb_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted xgb: 0.597 (0.024)
Mean Accuracy xgb: 0.645 (0.018)</code></pre>
</div>
</div>
</section>
<section id="linear-discriminant-analysis-1" class="level4">
<h4 class="anchored" data-anchor-id="linear-discriminant-analysis-1">- linear discriminant analysis</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> LinearDiscriminantAnalysis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>model_lda_g <span class="op">=</span> LinearDiscriminantAnalysis()</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'solver'</span>: [<span class="st">'lsqr'</span>, <span class="st">'eigen'</span>], </span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shrinkage'</span>: [<span class="st">'auto'</span>]<span class="op">+</span>np.arange(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>).tolist()</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>model_lda <span class="op">=</span> GridSearchCV(model_lda_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>parameters, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">"f1_weighted"</span>)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>model_lda.fit(x_train5, y_train2)</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_lda.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>report(model_lda.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 18 candidates, totalling 450 fits
GridSearchCV took 0.53 seconds for 18 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.625 (std: 0.022)
Parameters: {'shrinkage': 0.5, 'solver': 'lsqr'}

Model with rank: 1
Mean validation score: 0.625 (std: 0.022)
Parameters: {'shrinkage': 0.5, 'solver': 'eigen'}

Model with rank: 3
Mean validation score: 0.624 (std: 0.020)
Parameters: {'shrinkage': 0.4, 'solver': 'lsqr'}

Model with rank: 3
Mean validation score: 0.624 (std: 0.020)
Parameters: {'shrinkage': 0.4, 'solver': 'eigen'}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>model_lda_f <span class="op">=</span> LinearDiscriminantAnalysis(shrinkage<span class="op">=</span><span class="fl">0.5</span>,solver<span class="op">=</span><span class="st">'lsqr'</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>accuracy_lda_f <span class="op">=</span> cross_val_score(model_lda_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>f1w_lda_f <span class="op">=</span> cross_val_score(model_lda_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted lda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_lda_f), np.std(f1w_lda_f)))</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy lda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_lda_f), np.std(accuracy_lda_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted lda: 0.625 (0.022)
Mean Accuracy lda: 0.633 (0.023)</code></pre>
</div>
</div>
</section>
<section id="quadratic-discriminant-analysis-1" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-discriminant-analysis-1">- quadratic discriminant analysis</h4>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> QuadraticDiscriminantAnalysis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="104">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>model_qda_g <span class="op">=</span> QuadraticDiscriminantAnalysis()</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>parameters<span class="op">=</span> {<span class="st">'reg_param'</span>: np.arange(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>).tolist()}</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run grid search</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>model_qda <span class="op">=</span> GridSearchCV(model_qda_g, verbose<span class="op">=</span> <span class="dv">1</span>, param_grid<span class="op">=</span>parameters, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time()</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>model_qda.fit(x_train5, y_train2)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GridSearchCV took </span><span class="sc">%.2f</span><span class="st"> seconds for </span><span class="sc">%d</span><span class="st"> candidate parameter settings."</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> (time() <span class="op">-</span> start, <span class="bu">len</span>(model_qda.cv_results_[<span class="st">"params"</span>]))</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>report(model_qda.cv_results_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 25 folds for each of 10 candidates, totalling 250 fits
GridSearchCV took 0.25 seconds for 10 candidate parameter settings.
Model with rank: 1
Mean validation score: 0.626 (std: 0.022)
Parameters: {'reg_param': 0.9}

Model with rank: 2
Mean validation score: 0.626 (std: 0.022)
Parameters: {'reg_param': 0.8}

Model with rank: 3
Mean validation score: 0.624 (std: 0.025)
Parameters: {'reg_param': 0.7000000000000001}
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="105">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>model_qda_f <span class="op">=</span> QuadraticDiscriminantAnalysis(reg_param<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model and collect the scores</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>accuracy_qda_f <span class="op">=</span> cross_val_score(model_qda_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'accuracy'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>f1w_qda_f <span class="op">=</span> cross_val_score(model_qda_f, x_train5, y_train2, scoring<span class="op">=</span><span class="st">'f1_weighted'</span>, cv<span class="op">=</span>cv_5, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model performance</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean f1_weighted qda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(f1w_qda_f), np.std(f1w_qda_f)))</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean Accuracy qda: </span><span class="sc">%.3f</span><span class="st"> (</span><span class="sc">%.3f</span><span class="st">)'</span> <span class="op">%</span> (np.mean(accuracy_qda_f), np.std(accuracy_qda_f)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1_weighted qda: 0.626 (0.022)
Mean Accuracy qda: 0.627 (0.023)</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="section-1" class="level1">
<h1>2.</h1>
<p>Based on your training results in Problem 1, you now pick your best model that would generalize well to unseen data. Using your best model, we are going to predict on the provided test dataset, OnlineAd X test.csv which contains 300 observations with 251 features. Here we do not have the corresponding responses for these test observations.</p>
<section id="a-1" class="level2">
<h2 class="anchored" data-anchor-id="a-1">(a)</h2>
<p>[20 pts] Report the estimated test performance for your best model. Provide a reason for your choice of a model among the models you considered.</p>
<div class="cell" data-execution_count="125">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>result<span class="op">=</span>pd.DataFrame({<span class="st">"multinomial logistic"</span>: [np.mean(f1w_lr_f),np.std(f1w_lr_f),np.mean(accuracy_lr_f),np.std(accuracy_lr_f)],</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">"linear svm"</span>:[np.mean(f1w_svcl_f), np.std(f1w_svcl_f),np.mean(accuracy_svcl_f), np.std(accuracy_svcl_f)],</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"rbf svm"</span>:[np.mean(f1w_svcq_f), np.std(f1w_svcq_f),np.mean(accuracy_svcq_f), np.std(accuracy_svcq_f)],</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"knn"</span>:[np.mean(f1w_knn_f), np.std(f1w_knn_f),np.mean(accuracy_knn_f), np.std(accuracy_knn_f)],</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"sgd classifier"</span>:[np.mean(f1w_sgd_f), np.std(f1w_sgd_f),np.mean(accuracy_sgd_f), np.std(accuracy_sgd_f)],</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ramdom forest"</span>:[np.mean(f1w_rf_f), np.std(f1w_rf_f),np.mean(accuracy_rf_f), np.std(accuracy_rf_f)],</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"gradient boosted tree"</span>: [np.mean(f1w_bt_f), np.std(f1w_bt_f),np.mean(accuracy_bt_f), np.std(accuracy_bt_f)],</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"xgboost"</span>: [np.mean(f1w_xgb_f), np.std(f1w_xgb_f),np.mean(accuracy_xgb_f), np.std(accuracy_xgb_f)],</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"linear discriminant analysis"</span>:[np.mean(f1w_lda_f), np.std(f1w_lda_f),np.mean(accuracy_lda_f), np.std(accuracy_lda_f)],</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"quadratic discriminant analysis"</span>:[np.mean(f1w_qda_f), np.std(f1w_qda_f),np.mean(accuracy_qda_f), np.std(accuracy_qda_f)] },</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"Mean F1 weighted"</span>, <span class="st">"Std F1 weighted"</span>,<span class="st">"Mean Accuracy Score"</span>,<span class="st">"Std Accuracy Score"</span>]).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>result.index.name<span class="op">=</span><span class="st">'5-fold CV / feature selected (n=27)'</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>result<span class="op">=</span>result.T</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>result[<span class="st">"mean"</span>] <span class="op">=</span> result.iloc[:, [<span class="dv">0</span>,<span class="dv">2</span>]].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>display(result.sort_values(by<span class="op">=</span><span class="st">'mean'</span>, ascending<span class="op">=</span><span class="va">False</span>).<span class="bu">round</span>(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>5-fold CV / feature selected (n=27)</th>
      <th>Mean F1 weighted</th>
      <th>Std F1 weighted</th>
      <th>Mean Accuracy Score</th>
      <th>Std Accuracy Score</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>linear discriminant analysis</th>
      <td>0.625</td>
      <td>0.022</td>
      <td>0.633</td>
      <td>0.023</td>
      <td>0.629</td>
    </tr>
    <tr>
      <th>quadratic discriminant analysis</th>
      <td>0.626</td>
      <td>0.022</td>
      <td>0.627</td>
      <td>0.023</td>
      <td>0.626</td>
    </tr>
    <tr>
      <th>gradient boosted tree</th>
      <td>0.602</td>
      <td>0.022</td>
      <td>0.642</td>
      <td>0.021</td>
      <td>0.622</td>
    </tr>
    <tr>
      <th>xgboost</th>
      <td>0.597</td>
      <td>0.024</td>
      <td>0.645</td>
      <td>0.018</td>
      <td>0.621</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>0.605</td>
      <td>0.024</td>
      <td>0.635</td>
      <td>0.020</td>
      <td>0.620</td>
    </tr>
    <tr>
      <th>ramdom forest</th>
      <td>0.594</td>
      <td>0.023</td>
      <td>0.640</td>
      <td>0.017</td>
      <td>0.617</td>
    </tr>
    <tr>
      <th>rbf svm</th>
      <td>0.569</td>
      <td>0.019</td>
      <td>0.651</td>
      <td>0.018</td>
      <td>0.610</td>
    </tr>
    <tr>
      <th>sgd classifier</th>
      <td>0.572</td>
      <td>0.019</td>
      <td>0.644</td>
      <td>0.017</td>
      <td>0.608</td>
    </tr>
    <tr>
      <th>multinomial logistic</th>
      <td>0.568</td>
      <td>0.018</td>
      <td>0.647</td>
      <td>0.016</td>
      <td>0.607</td>
    </tr>
    <tr>
      <th>linear svm</th>
      <td>0.563</td>
      <td>0.018</td>
      <td>0.648</td>
      <td>0.015</td>
      <td>0.605</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="b-1" class="level2">
<h2 class="anchored" data-anchor-id="b-1">(b)</h2>
<p>[20 pts] Predict on the provided test dataset, OnlineAd_X_test.csv, and save those predictions as a CSV file named [your-student-ID] pred.csv. The CSV file should only contain the array of dimension [300, 3] in the same format as the OnlineAd_Y_train.csv except the number of rows, since there are only 300 observations in the test data, i.e., the first column corresponds to no click, the second column corresponds to the ad A, and the third column corresponds to the ad B. A violation of this format guideline will result in 10 point penalty.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>x_test2 <span class="op">=</span> x_test.iloc[:,features2.index].to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choosed gradient boosted tree</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>model_lda_f.fit(x_train5, y_train2)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> model_lda_f.predict(x_test2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Counter(y_train2))</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Counter(prediction))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Counter({0: 822, 2: 353, 1: 277})
Counter({0: 188, 2: 65, 1: 47})</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>prediction_comp<span class="op">=</span>pd.DataFrame({<span class="dv">0</span>: [<span class="dv">822</span>,<span class="dv">188</span>], <span class="dv">1</span>: [<span class="dv">277</span>,<span class="dv">47</span>], <span class="dv">2</span>: [<span class="dv">353</span>,<span class="dv">65</span>]})</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>prediction_comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>822</td>
      <td>277</td>
      <td>353</td>
    </tr>
    <tr>
      <th>1</th>
      <td>188</td>
      <td>47</td>
      <td>65</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>chi, p, dof, expected <span class="op">=</span> chi2_contingency(prediction_comp.to_numpy())</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"chi-squared: </span><span class="sc">{</span>chi<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"p-value (0.05): </span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"degree of freedom: </span><span class="sc">{</span>dof<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"expectation: </span><span class="ch">\n</span><span class="sc">{</span>pd<span class="sc">.</span>DataFrame(expected)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co"># It cannot be rejected that real clicks and the classifications are from different distributions (only if the tested data is randomly selected from the same distribution of training data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>chi-squared: 3.8738967610162973 p-value (0.05): 0.1441431493460496 degree of freedom: 2 expectation: 
            0           1           2
0  837.054795  268.520548  346.424658
1  172.945205   55.479452   71.575342</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>prediction_df<span class="op">=</span>pd.DataFrame({<span class="dv">0</span>:np.where(prediction<span class="op">==</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dv">1</span>:np.where(prediction<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dv">2</span>:np.where(prediction<span class="op">==</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)})</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>prediction_df.to_csv(<span class="st">"E:/OneDrive - SNU/(B) 대학원/수업/2022 2학기/데이터사이언스를위한머신러닝과딥러닝/과제2/OnlineAd_Y_test.csv"</span>,index<span class="op">=</span><span class="va">False</span>, header<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>