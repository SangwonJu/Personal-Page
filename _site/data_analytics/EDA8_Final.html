<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.649">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="연세대학교 행정학과 2015128003 주상원">
<meta name="dcterms.date" content="2021-06-15">

<title>Sangwon Ju’s Personal Page - EDA Assignment 8: Final Exam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src=".././logo/policy.png" alt="">
    <span class="navbar-title">Sangwon Ju’s Personal Page</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">About Me</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">Research</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../research_interests.html">
 <span class="dropdown-text">Research Interests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication.html">
 <span class="dropdown-text">Publications / Working Papers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-analytics-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data Analytics Projects</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-analytics-projects">    
        <li class="dropdown-header">Data Analytics for Public Data (2021 Fall)</li>
        <li>
    <a class="dropdown-item" href="../data_analytics/employees.html">
 <span class="dropdown-text">Analysis 1: Number of local government employees</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/unemployment_index.html">
 <span class="dropdown-text">Analysis 2: Seasonal disparities in unemployment index</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/FWA.html">
 <span class="dropdown-text">Analysis 3: Analysis of the FWA in public sector organizations using data mining techniques</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exploratory Data Analysis (2021 Spring) [in Korean]</li>
        <li>
    <a class="dropdown-item" href="../data_analytics/EDA7.html">
 <span class="dropdown-text">EDA Assignment 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/EDA8_Final.html">
 <span class="dropdown-text">EDA Assignment 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../cv.html">CV (as of July 2022)</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">EDA Assignment 8: Final Exam</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Data Analytics for Public Data (2021 Fall)</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/employees.html" class="sidebar-item-text sidebar-link">Analysis 1: Number of local government employees</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/unemployment_index.html" class="sidebar-item-text sidebar-link">Analysis 2: Seasonal disparities in unemployment index</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/FWA.html" class="sidebar-item-text sidebar-link">Analysis 3: Analysis of the FWA in public sector organizations using data mining techniques</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exploratory Data Analysis (2021 Spring) [in Korean]</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/EDA7.html" class="sidebar-item-text sidebar-link">EDA Assignment 7</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/EDA8_Final.html" class="sidebar-item-text sidebar-link active">EDA Assignment 8</a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section">1.</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2.</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3.</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4.</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5.</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6.</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">7.</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">8.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">EDA Assignment 8: Final Exam</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>연세대학교 행정학과 2015128003 주상원 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>EDA 방법 이외의 회귀분석, 다변량, 실험계획 등에서 배운 다른 방법도 사용할 수 있으나 EDA 방법이 기본이 되어야 한다. 같은 자료를 여러 가지 방법으로 분석할 수 있다. 한 가지 방법으로 끝내지 말고 다른 방법은 없는지 생각하여 보아라. 자료파일은 ASCII 형태로 되어 있다. [보조프로그램]의 [메모장]으로 파일을 열어 그 형식을 확인한 후 엑셀을 통하거나 R에서 직접 읽어 들여라. 아래한글에서도 열 수 있으나 &lt;문자코드&gt;를 잘 선택하여야 한다.</p>
<p>작업한 부분은 기한 이내에 제출하여야 그 부분만이라도 감점없이 점수를 받을 수 있다.</p>
<section id="section" class="level1">
<h1>1.</h1>
<p>다음 자료는 사춘기 여성의 신경성 식욕 감퇴증에 대하여 일정 기간 동안 세 가지 방법으로 치료한 결과이다. 어느 방법이 가장 큰 효과를 보았나? [ANOREXIA.DAT]</p>
<p>I Cognitive behavioral treatment</p>
<p>II Control; standard treatment</p>
<p>III Family therapy</p>
<p>Weights in Kg</p>
<p>전처리 후 정리</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weights </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I Cognitive behavioral treatment </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>cbt<span class="ot">=</span><span class="fu">read.delim</span>(<span class="at">file=</span><span class="st">"C://r/ANOREXIA.DAT"</span>,<span class="at">header=</span>F)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cbt)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"before"</span>,<span class="st">"after"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cbt,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  before after
1   80.5  82.2
2   84.9  85.6
3   81.5  81.4
4   82.6  81.9
5   79.9  76.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cbt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># II Control; standard treatment</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>control<span class="ot">=</span><span class="fu">read.delim</span>(<span class="at">file=</span><span class="st">"C://r/ANOREXIA.DAT"</span>,<span class="at">header=</span>F)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>),]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(control)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"before"</span>,<span class="st">"after"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(control,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  before after
1   80.7  80.2
2   89.4  80.1
3   91.8  86.4
4   74.0  86.3
5   78.1  76.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># III Family therapy</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>family<span class="ot">=</span><span class="fu">read.delim</span>(<span class="at">file=</span><span class="st">"C://r/ANOREXIA.DAT"</span>,<span class="at">header=</span>F)[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>)][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>),]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(family)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"before"</span>,<span class="st">"after"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(family,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  before after
1   83.8  95.2
2   83.3  94.3
3   86.0  91.5
4   82.5  91.9
5   86.7 100.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  2</code></pre>
</div>
</div>
<p>항목의 수가 Cognitive behavioral treatment: 29 Control group: 26 Family Therapy: 17로 서로 다르다. 따라서 결측치를 처리하여 각각을 나누어서 표현하였다.</p>
<p>Treatment별로 기술통계량을 제시하고 시각화 한 후 자료의 특성을 확인하고 각 Sample에 대한 paired t-Test를 진행할 예정이다.</p>
<p>먼저, Cognitive behavioral treatment의 분석이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cbt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     before          after      
 Min.   :70.00   Min.   : 71.3  
 1st Qu.:80.40   1st Qu.: 81.9  
 Median :82.60   Median : 83.9  
 Mean   :82.69   Mean   : 85.7  
 3rd Qu.:85.00   3rd Qu.: 90.9  
 Max.   :94.90   Max.   :103.6  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fl">85.7-82.69</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fl">83.9-82.60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cognitive behavioral treatment를 시행하기 이전 집단과 이후집단의 평균은 약 3kg정도 차이나고, median값은 1.3kg정도 차이나는 것으로 보인다.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 성장기의 식용 감퇴증이 다소 완화되어진 것을 확인할 수 있다.</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(cbt<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70.0 80.4 82.6 85.0 94.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(cbt<span class="sc">$</span>after)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  71.3  81.9  83.9  90.9 103.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 treament 이전 집단의 경우 stem 8*을 기준으로 leaf들이 어느정도 종모양의 대칭적 분포를 이루고 있는데, 반면 treatment 이후 집단의 경우 stem 8*이 중심이 되어지는 것은 맞지만 다소 퍼지게 된 것을 확인할 수 있다. </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aplpack)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(cbt<span class="sc">$</span>before,cbt<span class="sc">$</span>after,<span class="at">rule.line =</span> <span class="st">"Sturges"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_____________________________________________________
  1 | 2: represents 12, leaf unit: 1 
             cbt$before       cbt$after          
_____________________________________________________
    1                 0|  7* |123                3   
    6             99666|  7. |56                 5   
  (15)  444333211100000|  8* |11122222334      (11)  
    8           9877765|  8. |55569             13   
    1                 4|  9* |03                 8   
                       |  9. |5668               6   
                       | 10* |03                 2   
_____________________________________________________
n:                   29       29                 
_____________________________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(cbt,<span class="at">main=</span><span class="st">"Boxplot of before and after Cognitive behavioral treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(cbt)<span class="sc">$</span>out <span class="co">#처리 이전 집단의 총 두개의 Outlier: lower fence인 76.3 밖의 값과 outer fence인 89.2 밖의 두개의 값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94.9 70.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(cbt)<span class="sc">$</span>stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]
[1,] 76.3  71.3
[2,] 80.4  81.9
[3,] 82.6  83.9
[4,] 85.0  90.9
[5,] 89.2 103.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  hl<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">2</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  median<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">3</span>]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  hu<span class="ot">=</span><span class="fu">fivenum</span>(x)[<span class="dv">4</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>((hu<span class="sc">-</span>median)<span class="sc">-</span>(median<span class="sc">-</span>hl))<span class="sc">/</span>((hu<span class="sc">-</span>median)<span class="sc">+</span>(median<span class="sc">-</span>hl))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(cbt<span class="sc">$</span>before) <span class="co"># 거의 Skewed 되어지지 않음 (매우 미세하게 skewed to the right)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04347826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(cbt<span class="sc">$</span>after) <span class="co"># Boxplot에서 확인하였듯이 Skewed to the right 되어 있음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5555556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Letter Value Display</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>lvd1<span class="ot">=</span>(<span class="fu">lsum</span>(cbt<span class="sc">$</span>before,<span class="dv">6</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>lvd2<span class="ot">=</span>(<span class="fu">lsum</span>(cbt<span class="sc">$</span>after,<span class="dv">6</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>lvd1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M  15.0 82.60 82.600 82.60   0.00
2      H   8.0 80.40 82.700 85.00   4.60
3      E   4.5 78.10 82.925 87.75   9.65
4      D   2.5 76.40 82.675 88.95  12.55
5      C   1.5 73.15 82.600 92.05  18.90
6      B   1.0 70.00 82.450 94.90  24.90</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lvd2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid  upper spread
1      M  15.0 83.90 83.900  83.90   0.00
2      H   8.0 81.90 86.400  90.90   9.00
3      E   4.5 76.05 86.250  96.45  20.40
4      D   2.5 72.95 86.175  99.40  26.45
5      C   1.5 71.90 86.950 102.00  30.10
6      B   1.0 71.30 87.450 103.60  32.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lsum</span>(cbt<span class="sc">$</span>before)[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span><span class="fu">lsum</span>(cbt<span class="sc">$</span>before)[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsum</span>(cbt<span class="sc">$</span>after)[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span><span class="fu">lsum</span>(cbt<span class="sc">$</span>after)[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#더 넓게 퍼져있는 것을 확인할 수 있음. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>(lvd1[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd1[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd1[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd1[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3928261</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(lvd2[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd2[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd2[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd2[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal (Kurtosis값도 더 크게 나타남)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5616667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규성</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cbt<span class="sc">$</span>before, <span class="at">ylab=</span><span class="st">"before quantiles"</span>,<span class="at">main=</span><span class="st">"before"</span>);<span class="fu">qqline</span>(cbt<span class="sc">$</span>before, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#위에서 언급했던 두개의 Outlier들만 제외하면 대부분 정규분포를 잘 따르고 있는 것이 확인되어지고 있다. </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>fiv1<span class="ot">=</span><span class="fu">fivenum</span>(cbt<span class="sc">$</span>before)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma1 =</span> (fiv1[<span class="dv">4</span>]<span class="sc">-</span>fiv1[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.432836</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(cbt<span class="sc">$</span>before) <span class="co"># 약 1.4정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.845495</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv1[<span class="dv">3</span>],pseudosigma1,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">92</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 거의 일치중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cbt<span class="sc">$</span>after, <span class="at">ylab=</span><span class="st">"after quantiles"</span>, <span class="at">main=</span><span class="st">"after"</span>);<span class="fu">qqline</span>(cbt<span class="sc">$</span>after, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#정규분포를 따른다고 보기 어려운 이유가 값들이 직선을 따르기 보다는 곡선의 형태를 띄고 있음을 확인할 수 있다.  </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>fiv2<span class="ot">=</span><span class="fu">fivenum</span>(cbt<span class="sc">$</span>after)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma2 =</span> (fiv2[<span class="dv">4</span>]<span class="sc">-</span>fiv2[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.716418</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(cbt<span class="sc">$</span>after) <span class="co"># 약 1.6정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.351924</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv2[<span class="dv">3</span>],pseudosigma2,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 약간차이를 보임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired T-test</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: cbt$after-cbt$before=0  H1: cbt$after-cbt$before&gt;0 </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>cbt_test<span class="ot">&lt;-</span><span class="fu">t.test</span>(cbt<span class="sc">$</span>after,cbt<span class="sc">$</span>before, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">"greater"</span>,<span class="at">conf.level=</span><span class="fl">0.05</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>cbt_test <span class="co"># reject null hypothesis, the weight of after treatment is heavier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  cbt$after and cbt$before
t = 2.2156, df = 28, p-value = 0.01751
alternative hypothesis: true mean difference is greater than 0
5 percent confidence interval:
 5.315595      Inf
sample estimates:
mean difference 
       3.006897 </code></pre>
</div>
</div>
<p>다음으로는 통제집단의 분석이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     before          after      
 Min.   :70.50   Min.   :73.00  
 1st Qu.:77.72   1st Qu.:77.58  
 Median :80.65   Median :80.70  
 Mean   :81.56   Mean   :81.11  
 3rd Qu.:85.88   3rd Qu.:84.67  
 Max.   :91.80   Max.   :89.60  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(control<span class="sc">$</span>after)<span class="sc">-</span><span class="fu">mean</span>(control<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(control<span class="sc">$</span>after)<span class="sc">-</span><span class="fu">median</span>(control<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 통제집단의 경우 실험 시행하기 이전 집단과 실험 이후 집단의 평균은 0.45kg정도 차이를 보이며 중위값은 큰 차이가 없다.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cognitive behavioral treatment에서 보였던 차이보다 적은 차이를 보이고 있는 것을 확인할 수 있다.</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(control<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70.50 77.60 80.65 86.00 91.80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(control<span class="sc">$</span>after)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73.0 77.4 80.7 84.7 89.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 처치 이전 집단의 경우 stem 7. stem 8. 두개의 축을 기준으로 Cluster를 가지고 있는데 비해 처치 이후의 집단의 경우 stem 7., stem8*두개의 stem을 기준으로 어느정도 대칭적으로 종모양을 보이고 있는 것이 확인된다.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(control<span class="sc">$</span>before,control<span class="sc">$</span>after,<span class="at">rule.line =</span> <span class="st">"Sturge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_______________________________________
  1 | 2: represents 12, leaf unit: 1 
    control$before       control$after
_______________________________________
   3         420|  7* |33          2   
  12   998887775|  7. |556778899  11   
  (5)      44100|  8* |001111444  (9)  
   9    99887655|  8. |666889      6   
   1           1|  9* |                
                |  9. |                
                | 10* |                
_______________________________________
n:            26       26          
_______________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(control,<span class="at">main=</span><span class="st">"Boxplot of before and after standard treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(control)<span class="sc">$</span>out <span class="co">#처리 이전 이후 둘다 outlier는 없는 것으로 보인다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(control)<span class="sc">$</span>stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2]
[1,] 70.50 73.0
[2,] 77.60 77.4
[3,] 80.65 80.7
[4,] 86.00 84.7
[5,] 91.80 89.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(control<span class="sc">$</span>before) <span class="co"># skewed to the right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2738095</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(control<span class="sc">$</span>after) <span class="co"># 거의 Skewed 되어지지 않음 (매우 미세하게 skewed to the right)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09589041</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Letter Value Display</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>lvd3<span class="ot">=</span>(<span class="fu">lsum</span>(control<span class="sc">$</span>before,<span class="dv">6</span>))</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>lvd4<span class="ot">=</span>(<span class="fu">lsum</span>(control<span class="sc">$</span>after,<span class="dv">6</span>))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>lvd3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M  13.5 80.65 80.650 80.65   0.00
2      H   7.0 77.60 81.800 86.00   8.40
3      E   4.0 75.10 81.900 88.70  13.60
4      D   2.5 73.15 81.175 89.20  16.05
5      C   1.5 71.40 81.000 90.60  19.20
6      B   1.0 70.50 81.150 91.80  21.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>lvd4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M  13.5 80.70 80.700 80.70   0.00
2      H   7.0 77.40 81.050 84.70   7.30
3      E   4.0 75.40 81.050 86.70  11.30
4      D   2.5 74.30 81.275 88.25  13.95
5      C   1.5 73.25 81.100 88.95  15.70
6      B   1.0 73.00 81.300 89.60  16.60</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lsum</span>(control<span class="sc">$</span>before)[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span><span class="fu">lsum</span>(control<span class="sc">$</span>before)[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsum</span>(control<span class="sc">$</span>after)[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span><span class="fu">lsum</span>(control<span class="sc">$</span>after)[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co"># 처치 이후 spread의 크기가 더 줄어들었음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>(lvd3[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd3[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd3[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd3[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.08595238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(lvd4[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd4[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd4[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd4[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal (Kurtosis값은 after집단에서 더 작게 나타남)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1570548</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규성</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(control<span class="sc">$</span>before, <span class="at">ylab=</span><span class="st">"before quantiles"</span>,<span class="at">main=</span><span class="st">"before"</span>);<span class="fu">qqline</span>(control<span class="sc">$</span>before, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 점들이 완벽히 qqline을 따르기 보다는 곡선의 형태를 이루고 있는 것을 확인할 수 있다.</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>fiv3<span class="ot">=</span><span class="fu">fivenum</span>(control<span class="sc">$</span>before)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma3 =</span> (fiv3[<span class="dv">4</span>]<span class="sc">-</span>fiv3[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.268657</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(control<span class="sc">$</span>before) <span class="co"># 약 0.5정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.70706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv3[<span class="dv">3</span>],pseudosigma3,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">92</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 약간차이를 보임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(control<span class="sc">$</span>after, <span class="at">ylab=</span><span class="st">"after quantiles"</span>, <span class="at">main=</span><span class="st">"after"</span>);<span class="fu">qqline</span>(control<span class="sc">$</span>after, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 처치 이전에 비해서 처치 이후의 데이터들이 직선을 따르기 때문에 정규분포를 조금 더 따르고 있다.  </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>fiv4<span class="ot">=</span><span class="fu">fivenum</span>(control<span class="sc">$</span>after)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma4 =</span> (fiv4[<span class="dv">4</span>]<span class="sc">-</span>fiv4[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.447761</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(control<span class="sc">$</span>after) <span class="co"># 약 0.7정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.744253</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv4[<span class="dv">3</span>],pseudosigma4,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">88</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 거의 차이가 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired T-test</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: 처지 이전의 집단과 처치 이후의 집단의 몸무게 차이는 없다. H1: 처치 이후의 집단의 몸무게가 처지 이전의 집단보다 더 무겁다.</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>control_test<span class="ot">&lt;-</span><span class="fu">t.test</span>(control<span class="sc">$</span>after,control<span class="sc">$</span>before, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">"greater"</span>,<span class="at">conf.level=</span><span class="fl">0.05</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>control_test <span class="co"># do not reject null hypothesis.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  control$after and control$before
t = -0.28723, df = 25, p-value = 0.6118
alternative hypothesis: true mean difference is greater than 0
5 percent confidence interval:
 2.226168      Inf
sample estimates:
mean difference 
          -0.45 </code></pre>
</div>
</div>
<p>마지막으로 Family therapy에 대한 분석이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     before          after       
 Min.   :73.40   Min.   : 75.20  
 1st Qu.:80.50   1st Qu.: 90.70  
 Median :83.30   Median : 92.50  
 Mean   :83.23   Mean   : 90.49  
 3rd Qu.:86.00   3rd Qu.: 95.20  
 Max.   :94.20   Max.   :101.60  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(family<span class="sc">$</span>after)<span class="sc">-</span><span class="fu">mean</span>(family<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.264706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(family<span class="sc">$</span>after)<span class="sc">-</span><span class="fu">median</span>(family<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Family Therapy의 경우 실험 시행하기 이전 집단과 실험 이후 집단의 평균은 7.2kg정도 차이를 보이며 중위값은 9.2kg정도 차이가 나타난다.</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cognitive behavioral treatment에서 보였던 차이보다 적은 차이를 보이고 있는 것을 확인할 수 있다.</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(family<span class="sc">$</span>before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73.4 80.5 83.3 86.0 94.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(family<span class="sc">$</span>after)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  75.2  90.7  92.5  95.2 101.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 처치 이전 집단의 경우  stem 8*을 기준으로 대칭적인 종모양을 보이는데 비해 처치 이후의 집단의 경우 stem 9*이 가장 많고 대칭적이지 않으며 중간에 빈 부분이 보인다.</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(family<span class="sc">$</span>before,family<span class="sc">$</span>after,<span class="at">rule.line =</span> <span class="st">"Sturge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_____________________________________
  1 | 2: represents 12, leaf unit: 1 
    family$before       family$after
_____________________________________
   1          3|  7* |               
   4        976|  7. |5667       4   
  (7)   3332210|  8* |               
   6      97666|  8. |               
   1          4|  9* |01112344  (8)  
               |  9. |558        5   
               | 10* |01         2   
               | 10. |               
               | 11* |               
_____________________________________
n:           17       17         
_____________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(family,<span class="at">main=</span><span class="st">"Boxplot of before and after family treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(family)<span class="sc">$</span>out <span class="co">#처리 이후의 집단에서 4개의 outlier 확인됨. (아까 Stem and leaf에서 확인 한 부분 재확인)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.7 76.8 75.2 77.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(family)<span class="sc">$</span>stats <span class="co"># lower fence=lower hinge</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]
[1,] 73.4  90.7
[2,] 80.5  90.7
[3,] 83.3  92.5
[4,] 86.0  95.2
[5,] 94.2 101.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(family<span class="sc">$</span>before) <span class="co"># skewed to the left (but 매우 미세함)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01818182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(family<span class="sc">$</span>after) <span class="co"># skewed to the right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Letter Value Display</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>lvd5<span class="ot">=</span>(<span class="fu">lsum</span>(family<span class="sc">$</span>before,<span class="dv">6</span>))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>lvd6<span class="ot">=</span>(<span class="fu">lsum</span>(family<span class="sc">$</span>after,<span class="dv">6</span>))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>lvd5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower   mid upper spread
1      M   9.0 83.30 83.30 83.30    0.0
2      H   5.0 80.50 83.25 86.00    5.5
3      E   3.0 77.60 82.45 87.30    9.7
4      D   2.0 76.90 83.40 89.90   13.0
5      C   1.5 75.15 83.60 92.05   16.9
6      B   1.0 73.40 83.80 94.20   20.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>lvd6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower   mid  upper spread
1      M   9.0 92.50 92.50  92.50    0.0
2      H   5.0 90.70 92.95  95.20    4.5
3      E   3.0 76.80 87.40  98.00   21.2
4      D   2.0 76.70 88.50 100.30   23.6
5      C   1.5 75.95 88.45 100.95   25.0
6      B   1.0 75.20 88.40 101.60   26.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>lvd5[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd5[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lvd6[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd6[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co"># 처치 이전이후의 차이가 1정도로 크지 않음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>(lvd5[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd5[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd5[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd5[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># 정규분포와 거의 차이가 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05863636</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>(lvd6[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd6[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd6[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd6[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal (Kurtosis값은 after집단에서 더 작게 나타남) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.006111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다만 after집단의 분포가 17개의 자료중 4개의 outlier로 인해서 왜곡되었을 가능성이 있다.</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규성</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(family<span class="sc">$</span>before, <span class="at">ylab=</span><span class="st">"before quantiles"</span>,<span class="at">main=</span><span class="st">"before"</span>);<span class="fu">qqline</span>(family<span class="sc">$</span>before, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 점들이 직선을 잘 따르고 있는 것으로 보인다. </span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>fiv5<span class="ot">=</span><span class="fu">fivenum</span>(family<span class="sc">$</span>before)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma5 =</span> (fiv5[<span class="dv">4</span>]<span class="sc">-</span>fiv5[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.104478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(family<span class="sc">$</span>before) <span class="co"># 약 0.9정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.016693</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv5[<span class="dv">3</span>],pseudosigma5,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">y =</span> <span class="dv">92</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 거의 차이가 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(family<span class="sc">$</span>after, <span class="at">ylab=</span><span class="st">"after quantiles"</span>, <span class="at">main=</span><span class="st">"after"</span>);<span class="fu">qqline</span>(family<span class="sc">$</span>after, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 이상치 4개를 제외하면 나머지들이 직선을 잘 따르는 것으로 보이나 표본이 작아 신뢰성이 낮다.   </span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>fiv6<span class="ot">=</span><span class="fu">fivenum</span>(family<span class="sc">$</span>after)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma6 =</span> (fiv6[<span class="dv">4</span>]<span class="sc">-</span>fiv6[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.358209</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(family<span class="sc">$</span>after) <span class="co"># 약 5 정도의 차이 - 매우 큼</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.475072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv6[<span class="dv">3</span>],pseudosigma6,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">y =</span> <span class="dv">99</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 거의 차이가 없음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired T-test</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: family$after-family$before=0 H1:family$after-family$before&gt;0</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>family_test<span class="ot">&lt;-</span><span class="fu">t.test</span>(family<span class="sc">$</span>after,family<span class="sc">$</span>before, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">"greater"</span>,<span class="at">conf.level=</span><span class="fl">0.05</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>family_test <span class="co"># Reject Null Hypothesis. The weight of treated group is larger than the group without treatment.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  family$after and family$before
t = 4.1849, df = 16, p-value = 0.0003501
alternative hypothesis: true mean difference is greater than 0
5 percent confidence interval:
 10.29544      Inf
sample estimates:
mean difference 
       7.264706 </code></pre>
</div>
</div>
<p>세집단의 차이에 대해 일원분산분석을 진행하고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>cbt_diff<span class="ot">=</span>cbt<span class="sc">$</span>after<span class="sc">-</span>cbt<span class="sc">$</span>before</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>con_diff<span class="ot">=</span>control<span class="sc">$</span>after<span class="sc">-</span>control<span class="sc">$</span>before</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>fam_diff<span class="ot">=</span>family<span class="sc">$</span>after<span class="sc">-</span>family<span class="sc">$</span>before</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(cbt_diff,con_diff,fam_diff,<span class="at">names=</span><span class="fu">c</span>(<span class="st">"Cognitive"</span>,<span class="st">"Control"</span>,<span class="st">"Family"</span>))<span class="sc">$</span>out <span class="co">#Cognitive Behavior Treament 7개의 outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.9 17.1 11.7 20.9 -9.1 12.6 15.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>naming<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"cbt"</span>,<span class="fu">length</span>(cbt_diff)),<span class="fu">rep</span>(<span class="st">"control"</span>,<span class="fu">length</span>(con_diff)),<span class="fu">rep</span>(<span class="st">"family"</span>,<span class="fu">length</span>(fam_diff)))</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>value<span class="ot">=</span><span class="fu">c</span>(cbt_diff,con_diff,fam_diff)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>diffs<span class="ot">=</span><span class="fu">data.frame</span>(naming,value)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>aov1<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>naming,<span class="at">data=</span>diffs)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)   
naming       2    615  307.32   5.422 0.0065 **
Residuals   69   3911   56.68                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#H0: 각 집단간 평균은 차이가 없다. #H1: 각 집단간 평균은 차이가 없지 않다.</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Reject Null Hypothesis. 신뢰수준 95% 수준에서 사춘기 여성의 신경성 식욕 감퇴증의 각 치료 방법(Cognitive behavior, control, family treatment)을 적용할 경우 각 집단간 몸무게에서 차이를 보인다. </span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(value<span class="sc">~</span>naming, <span class="at">data =</span> diffs) <span class="co">#H0: 오차의 등분산성, 유의수준 10%에서 Select Null Hypothesis. (오차의 등분산성 만족)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  value by naming
Bartlett's K-squared = 0.30428, df = 2, p-value = 0.8589</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(value,naming,mean)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      cbt   control    family 
 3.006897 -0.450000  7.264706 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov1) <span class="co"># Tukey multiple comparisons of means 95% family-wise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = value ~ naming, data = diffs)

$naming
                    diff       lwr       upr     p adj
control-cbt    -3.456897 -8.327276  1.413483 0.2124428
family-cbt      4.257809 -1.250554  9.766173 0.1607461
family-control  7.714706  2.090124 13.339288 0.0045127</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("agricolae")</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'agricolae'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked _by_ '.GlobalEnv':

    skewness</code></pre>
</div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov1, <span class="st">"naming"</span>, <span class="at">group=</span><span class="cn">TRUE</span>,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov1 ~ "naming"

HSD Test for value 

Mean Square Error:  56.67743 

naming,  means

            value      std  r   Min  Max
cbt      3.006897 7.308504 29  -9.1 20.9
control -0.450000 7.988705 26 -12.2 15.9
family   7.264706 7.157421 17  -5.3 21.5

Alpha: 0.05 ; DF Error: 69 
Critical Value of Studentized Range: 3.387483 

Groups according to probability of means differences and alpha level( 0.05 )

Treatments with the same letter are not significantly different.

            value groups
family   7.264706      a
cbt      3.006897     ab
control -0.450000      b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(aov1, <span class="st">"naming"</span>, <span class="at">group=</span><span class="cn">TRUE</span>,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov1 ~ "naming"

LSD t Test for value 

Mean Square Error:  56.67743 

naming,  means and individual ( 95 %) CI

            value      std  r       LCL       UCL   Min  Max
cbt      3.006897 7.308504 29  0.217970  5.795823  -9.1 20.9
control -0.450000 7.988705 26 -3.395435  2.495435 -12.2 15.9
family   7.264706 7.157421 17  3.622105 10.907307  -5.3 21.5

Alpha: 0.05 ; DF Error: 69
Critical Value of t: 1.994945 

Groups according to probability of means differences and alpha level( 0.05 )

Treatments with the same letter are not significantly different.

            value groups
family   7.264706      a
cbt      3.006897     ab
control -0.450000      b</code></pre>
</div>
</div>
<p>통제집단에 비해서 cognitive behavior treatemnt는 3.46kg정도 높음. cognitive behavior treatment 집단에 비해서 family treatemnt 집단의 경우 4.26kg 정도 높음. 따라서 가장 효과가 좋은 순서대로 family treatment, cognitive behavior treatment, control 순이다.</p>
<p>그러나 cognitive behavior treatment집단이 다른 집단에 비해서 크거나 작다라고 보기에는 HSD, LSD test를 통해서 확인할 경우 신뢰구간이 겹쳐 다소 모호한 부분이 있다. 실제 Boxplot을 통해 확인할 경우 outlier들이 넓게 퍼져있어서 cognitive behavior treatment집단의 몸무게가 유의수준 5%수준에서 두 집단의 몸무게와 완전히 다르다고 보기 어렵다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 이원분산분석 </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>control2<span class="ot">=</span><span class="fu">melt</span>(control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>control2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">"control"</span>,<span class="fu">dim</span>(control2)[<span class="dv">1</span>]),control2)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(control2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"treatment"</span>,<span class="st">"ba"</span>,<span class="st">"value"</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>cbt2<span class="ot">=</span><span class="fu">melt</span>(cbt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>cbt2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">"cognitive"</span>,<span class="fu">dim</span>(cbt2)[<span class="dv">1</span>]),cbt2)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cbt2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"treatment"</span>,<span class="st">"ba"</span>,<span class="st">"value"</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>family2<span class="ot">=</span><span class="fu">melt</span>(family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>family2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">"family"</span>,<span class="fu">dim</span>(family2)[<span class="dv">1</span>]),family2)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(family2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"treatment"</span>,<span class="st">"ba"</span>,<span class="st">"value"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>family2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   treatment     ba value
1     family before  83.8
2     family before  83.3
3     family before  86.0
4     family before  82.5
5     family before  86.7
6     family before  79.6
7     family before  76.9
8     family before  94.2
9     family before  73.4
10    family before  80.5
11    family before  81.6
12    family before  82.1
13    family before  77.6
14    family before  83.5
15    family before  89.9
16    family before  86.0
17    family before  87.3
18    family  after  95.2
19    family  after  94.3
20    family  after  91.5
21    family  after  91.9
22    family  after 100.3
23    family  after  76.7
24    family  after  76.8
25    family  after 101.6
26    family  after  94.9
27    family  after  75.2
28    family  after  77.8
29    family  after  95.5
30    family  after  90.7
31    family  after  92.5
32    family  after  93.8
33    family  after  91.7
34    family  after  98.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>aov2<span class="ot">=</span><span class="fu">rbind</span>(control2,cbt2,family2)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>aov3<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>treatment<span class="sc">+</span>ba,<span class="at">data=</span>aov2) </span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment     2    644   322.1   7.713 0.000664 ***
ba            1    275   275.0   6.585 0.011335 *  
Residuals   140   5847    41.8                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span> treatment, <span class="at">data=</span>aov2, <span class="at">FUN =</span> <span class="fu">c</span>(mean, sd, min, max))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  treatment value.mean value.sd value.min value.max
1 cognitive   84.19310 6.935337      70.0     103.6
2   control   81.33269 5.201045      70.5      91.8
3    family   86.86176 7.785963      73.4     101.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov3, <span class="st">"treatment"</span>, <span class="at">group=</span><span class="cn">TRUE</span>,<span class="at">console=</span><span class="cn">TRUE</span>) <span class="co"># family cognitive standard 순이지만 cognitive behavior treatment는 a그룹 b그룹 모두에 속하므로 해석에 유의해야 한다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov3 ~ "treatment"

HSD Test for value 

Mean Square Error:  41.76232 

treatment,  means

             value      std  r  Min   Max
cognitive 84.19310 6.935337 58 70.0 103.6
control   81.33269 5.201045 52 70.5  91.8
family    86.86176 7.785963 34 73.4 101.6

Alpha: 0.05 ; DF Error: 140 
Critical Value of Studentized Range: 3.350136 

Groups according to probability of means differences and alpha level( 0.05 )

Treatments with the same letter are not significantly different.

             value groups
family    86.86176      a
cognitive 84.19310     ab
control   81.33269      b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov3, <span class="st">"ba"</span>, <span class="at">group=</span><span class="cn">TRUE</span>,<span class="at">console=</span><span class="cn">TRUE</span>) <span class="co"># 전반적으로 더 높다 treatment 취한 그룹에서 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov3 ~ "ba"

HSD Test for value 

Mean Square Error:  41.76232 

ba,  means

          value      std  r  Min   Max
after  85.17222 8.035173 72 71.3 103.6
before 82.40833 5.182466 72 70.0  94.9

Alpha: 0.05 ; DF Error: 140 
Critical Value of Studentized Range: 2.795976 

Minimun Significant Difference: 2.129411 

Treatments with the same letter are not significantly different.

          value groups
after  85.17222      a
before 82.40833      b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction Plot</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>id<span class="ot">=</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(aov2)[<span class="dv">1</span>])</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>aov2<span class="ot">=</span><span class="fu">cbind</span>(id,aov2)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>aov2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id treatment     ba value
1     1   control before  80.7
2     2   control before  89.4
3     3   control before  91.8
4     4   control before  74.0
5     5   control before  78.1
6     6   control before  88.3
7     7   control before  87.3
8     8   control before  75.1
9     9   control before  80.6
10   10   control before  78.4
11   11   control before  77.6
12   12   control before  88.7
13   13   control before  81.3
14   14   control before  78.1
15   15   control before  70.5
16   16   control before  77.3
17   17   control before  85.2
18   18   control before  86.0
19   19   control before  84.1
20   20   control before  79.7
21   21   control before  85.5
22   22   control before  84.4
23   23   control before  79.6
24   24   control before  77.5
25   25   control before  72.3
26   26   control before  89.0
27   27   control  after  80.2
28   28   control  after  80.1
29   29   control  after  86.4
30   30   control  after  86.3
31   31   control  after  76.1
32   32   control  after  78.1
33   33   control  after  75.1
34   34   control  after  86.7
35   35   control  after  73.5
36   36   control  after  84.6
37   37   control  after  77.4
38   38   control  after  79.5
39   39   control  after  89.6
40   40   control  after  81.4
41   41   control  after  81.8
42   42   control  after  77.3
43   43   control  after  84.2
44   44   control  after  75.4
45   45   control  after  79.5
46   46   control  after  73.0
47   47   control  after  88.3
48   48   control  after  84.7
49   49   control  after  81.4
50   50   control  after  81.2
51   51   control  after  88.2
52   52   control  after  78.8
53   53 cognitive before  80.5
54   54 cognitive before  84.9
55   55 cognitive before  81.5
56   56 cognitive before  82.6
57   57 cognitive before  79.9
58   58 cognitive before  88.7
59   59 cognitive before  94.9
60   60 cognitive before  76.3
61   61 cognitive before  81.0
62   62 cognitive before  80.5
63   63 cognitive before  85.0
64   64 cognitive before  89.2
65   65 cognitive before  81.3
66   66 cognitive before  76.5
67   67 cognitive before  70.0
68   68 cognitive before  80.4
69   69 cognitive before  83.3
70   70 cognitive before  83.0
71   71 cognitive before  87.7
72   72 cognitive before  84.2
73   73 cognitive before  86.4
74   74 cognitive before  76.5
75   75 cognitive before  80.2
76   76 cognitive before  87.8
77   77 cognitive before  83.3
78   78 cognitive before  79.7
79   79 cognitive before  84.5
80   80 cognitive before  80.8
81   81 cognitive before  87.4
82   82 cognitive  after  82.2
83   83 cognitive  after  85.6
84   84 cognitive  after  81.4
85   85 cognitive  after  81.9
86   86 cognitive  after  76.4
87   87 cognitive  after 103.6
88   88 cognitive  after  98.4
89   89 cognitive  after  93.4
90   90 cognitive  after  73.4
91   91 cognitive  after  82.1
92   92 cognitive  after  96.7
93   93 cognitive  after  95.3
94   94 cognitive  after  82.4
95   95 cognitive  after  72.5
96   96 cognitive  after  90.9
97   97 cognitive  after  71.3
98   98 cognitive  after  85.4
99   99 cognitive  after  81.6
100 100 cognitive  after  89.1
101 101 cognitive  after  83.9
102 102 cognitive  after  82.7
103 103 cognitive  after  75.7
104 104 cognitive  after  82.6
105 105 cognitive  after 100.4
106 106 cognitive  after  85.2
107 107 cognitive  after  83.6
108 108 cognitive  after  84.6
109 109 cognitive  after  96.2
110 110 cognitive  after  86.7
111 111    family before  83.8
112 112    family before  83.3
113 113    family before  86.0
114 114    family before  82.5
115 115    family before  86.7
116 116    family before  79.6
117 117    family before  76.9
118 118    family before  94.2
119 119    family before  73.4
120 120    family before  80.5
121 121    family before  81.6
122 122    family before  82.1
123 123    family before  77.6
124 124    family before  83.5
125 125    family before  89.9
126 126    family before  86.0
127 127    family before  87.3
128 128    family  after  95.2
129 129    family  after  94.3
130 130    family  after  91.5
131 131    family  after  91.9
132 132    family  after 100.3
133 133    family  after  76.7
134 134    family  after  76.8
135 135    family  after 101.6
136 136    family  after  94.9
137 137    family  after  75.2
138 138    family  after  77.8
139 139    family  after  95.5
140 140    family  after  90.7
141 141    family  after  92.5
142 142    family  after  93.8
143 143    family  after  91.7
144 144    family  after  98.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>aov2<span class="sc">$</span>treatment<span class="ot">=</span><span class="fu">as.factor</span>(aov2<span class="sc">$</span>treatment)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>aov2<span class="sc">$</span>ba<span class="ot">=</span><span class="fu">as.factor</span>(aov2<span class="sc">$</span>ba)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>aov2<span class="sc">$</span>id<span class="ot">=</span><span class="fu">as.factor</span>(aov2<span class="sc">$</span>id)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aov2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   144 obs. of  4 variables:
 $ id       : Factor w/ 144 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ treatment: Factor w/ 3 levels "cognitive","control",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ ba       : Factor w/ 2 levels "before","after": 1 1 1 1 1 1 1 1 1 1 ...
 $ value    : num  80.7 89.4 91.8 74 78.1 88.3 87.3 75.1 80.6 78.4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>aov4<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>treatment<span class="sc">*</span>ba,<span class="at">data=</span>aov2)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment      2    644   322.1   8.025 0.000505 ***
ba             1    275   275.0   6.851 0.009847 ** 
treatment:ba   2    307   153.7   3.828 0.024097 *  
Residuals    138   5539    40.1                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(aov2<span class="sc">$</span>ba, aov2<span class="sc">$</span>treatment, aov2<span class="sc">$</span>value,<span class="at">main=</span><span class="st">"Interaction plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov4, <span class="st">"treatment"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov4 ~ "treatment"

HSD Test for value 

Mean Square Error:  40.1406 

treatment,  means

             value      std  r  Min   Max
cognitive 84.19310 6.935337 58 70.0 103.6
control   81.33269 5.201045 52 70.5  91.8
family    86.86176 7.785963 34 73.4 101.6

Alpha: 0.05 ; DF Error: 138 
Critical Value of Studentized Range: 3.350657 

Groups according to probability of means differences and alpha level( 0.05 )

Treatments with the same letter are not significantly different.

             value groups
family    86.86176      a
cognitive 84.19310     ab
control   81.33269      b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov4, <span class="st">"ba"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov4 ~ "ba"

HSD Test for value 

Mean Square Error:  40.1406 

ba,  means

          value      std  r  Min   Max
after  85.17222 8.035173 72 71.3 103.6
before 82.40833 5.182466 72 70.0  94.9

Alpha: 0.05 ; DF Error: 138 
Critical Value of Studentized Range: 2.796329 

Minimun Significant Difference: 2.087921 

Treatments with the same letter are not significantly different.

          value groups
after  85.17222      a
before 82.40833      b</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level1">
<h1>2.</h1>
<p>근육 피로도의 지표로 쓰이는 혈중젖산농도의 참값과 계측기에서의 값의 자료이다. 계측기가 정확하다면 두 자료의 직선식은 원점을 지나는 45도 직선이어야 한다. 분석하여라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>true_val<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="dv">15</span>,<span class="dv">4</span>))</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>est_val<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1.1</span>,<span class="fl">0.7</span>,<span class="fl">1.8</span>,<span class="fl">0.4</span>,<span class="fl">3.0</span>,<span class="fl">1.4</span>,<span class="fl">4.9</span>,<span class="fl">4.4</span>,<span class="fl">4.5</span>,<span class="fl">7.3</span>,<span class="fl">8.2</span>,<span class="fl">6.2</span>,<span class="dv">12</span>,<span class="fl">13.1</span>,<span class="fl">12.6</span>,<span class="fl">13.2</span>,<span class="fl">18.7</span>,<span class="fl">19.7</span>,<span class="fl">17.4</span>,<span class="fl">17.1</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>lactic<span class="ot">=</span><span class="fu">data.frame</span>(true_val,est_val)</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>lactic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   true_val est_val
1         1     1.1
2         1     0.7
3         1     1.8
4         1     0.4
5         3     3.0
6         3     1.4
7         3     4.9
8         3     4.4
9         3     4.5
10        5     7.3
11        5     8.2
12        5     6.2
13       10    12.0
14       10    13.1
15       10    12.6
16       10    13.2
17       15    18.7
18       15    19.7
19       15    17.4
20       15    17.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(lactic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lactic) <span class="co">#평균 실제 젖산값은 6.7, 평균 측정 젖산값은 8.385로 실제 값에 비해서 높게 측정되었다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    true_val       est_val      
 Min.   : 1.0   Min.   : 0.400  
 1st Qu.: 3.0   1st Qu.: 2.700  
 Median : 5.0   Median : 6.750  
 Mean   : 6.7   Mean   : 8.385  
 3rd Qu.:10.0   3rd Qu.:13.125  
 Max.   :15.0   Max.   :19.700  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>medtrue <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="dv">3</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>medest <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="dv">3</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>medtrue[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>true_val[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]); medest[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>est_val[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>medtrue[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>true_val[<span class="dv">7</span><span class="sc">:</span><span class="dv">14</span>]); medest[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>est_val[<span class="dv">7</span><span class="sc">:</span><span class="dv">14</span>])</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>medtrue[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>true_val[<span class="dv">15</span><span class="sc">:</span><span class="dv">20</span>]); medest[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(lactic<span class="sc">$</span>est_val[<span class="dv">15</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medest<span class="sc">~</span>medtrue, <span class="at">type=</span><span class="st">"b"</span>,<span class="at">main=</span><span class="st">"True value와 Estimation Value 사이의 관계"</span>)   <span class="co"># 다소 Concave 한 관계인 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lactic<span class="sc">$</span>est_val<span class="sc">~</span>lactic<span class="sc">$</span>true_val,<span class="at">main=</span><span class="st">"relationship of truevalue and estimatedvalue"</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">line</span>(<span class="at">x=</span>lactic<span class="sc">$</span>true_val,<span class="at">y=</span>lactic<span class="sc">$</span>est_val))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
line(x = lactic$true_val, y = lactic$est_val)

Coefficients:
[1]  -0.9026   1.4053</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(z))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.59736842  0.19736842  1.29736842 -0.10263158 -0.31315789 -1.91315789
 [7]  1.58684211  1.08684211  1.18684211  1.17631579  2.07631579  0.07631579
[13] -1.15000000 -0.05000000 -0.55000000  0.05000000 -1.47631579 -0.47631579
[19] -2.77631579 -3.07631579</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>z.ls <span class="ot">&lt;-</span> <span class="fu">lm</span>(lactic<span class="sc">$</span>est_val <span class="sc">~</span> lactic<span class="sc">$</span>true_val)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(z.ls<span class="sc">$</span>coef, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">18</span>, <span class="fu">c</span>(<span class="st">"R - Line"</span>, <span class="st">"Regression"</span>), </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>),<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차제곱합</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(z))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.552632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(z)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37.86429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(lactic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked _by_ .GlobalEnv:

    est_val, true_val</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 자료가 같은 분포에서 온게 맞을까?</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(true_val,est_val,<span class="at">main=</span><span class="st">"qqplot"</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">line</span>(<span class="fu">qqplot</span>(true_val,est_val,<span class="at">main=</span><span class="st">"qqplot"</span>))<span class="sc">$</span>coef) <span class="co"># 전반적으로 Tukey's robust line estimation 직선위에 잘 존재하는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 분포 예측하기</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aplpack)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(true_val,est_val,<span class="at">rule.line=</span><span class="st">"Sturges"</span>) <span class="co"># 두 자료 모두 정규분포보다는 Skewed to the right 되어 있는 것을 어느정도 예측할 수 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>______________________________________
  1 | 2: represents 12, leaf unit: 1 
        true_val      est_val     
______________________________________
   9   333331111| 0* |001113444   9   
  (3)        555| 0. |678        (3)  
   8        0000| 1* |2233        8   
   4        5555| 1. |7789        4   
                | 2* |                
______________________________________
n:            20      20          
______________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(true_val) <span class="co"># skewed to the right </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4285714</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(est_val) <span class="co"># 실제 자료에 비해서 덜 skewed 되어있다 (skewed to the right)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1906977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Letter Value Display</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>lvd7<span class="ot">=</span>(<span class="fu">lsum</span>(true_val,<span class="dv">6</span>))</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>lvd8<span class="ot">=</span>(<span class="fu">lsum</span>(est_val,<span class="dv">6</span>))</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>lvd7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower mid upper spread
1      M  10.5     5 5.0     5      0
2      H   5.5     3 6.5    10      7
3      E   3.0     1 8.0    15     14
4      D   2.0     1 8.0    15     14
5      C   1.5     1 8.0    15     14
6      B   1.0     1 8.0    15     14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>lvd8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M  10.5  6.75  6.750  6.75   0.00
2      H   5.5  2.40  7.775 13.15  10.75
3      E   3.0  1.10  9.250 17.40  16.30
4      D   2.0  0.70  9.700 18.70  18.00
5      C   1.5  0.55  9.875 19.20  18.65
6      B   1.0  0.40 10.050 19.70  19.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>lvd7[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd7[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>lvd8[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd8[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co"># H Spread의 경우 예측값에서 더 길게 나타나고 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>(lvd7[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd7[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd7[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd7[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.295</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>(lvd8[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd8[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd8[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd8[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1887209</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 데이터를 합치고 해당 데이터들이 동일한 분포를 따르고 있는지 확인하기 </span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>lactic2<span class="ot">=</span><span class="fu">c</span>(true_val,est_val)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>lactic2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.0  1.0  1.0  1.0  3.0  3.0  3.0  3.0  3.0  5.0  5.0  5.0 10.0 10.0 10.0
[16] 10.0 15.0 15.0 15.0 15.0  1.1  0.7  1.8  0.4  3.0  1.4  4.9  4.4  4.5  7.3
[31]  8.2  6.2 12.0 13.1 12.6 13.2 18.7 19.7 17.4 17.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lactic2);<span class="fu">qqline</span>(lactic2,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co">#점들이 Tukey's robust line estimation위를 따르기 보다는 역s자 형태의 곡선의 형태를 띄고 있는 것을 확인할 수 있다.</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co">#허명회교수님의 책 113pg에 보면 혼합정규분포에서의 모의생성자료가 역 S자 형태를 띄고 있는데 현재 Plot도 그러한 것으로 보아 실제 데이터와 측정치 데이터가 서로 다른 분포를 따르고 있지 않을까 추측할 수 있다.</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co">#또한, 꼬리가 짧은 분포일때의 형태와 비슷하게 왼쪽 끝 자료들이 직선을 벗어나있다. </span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 데이터는 서로 다른 분포에서 왔다고 추정할 수 있다. 그러나 눈대중으로 판단하는 것은 한계가 있기 때문에 이 판단을 재확인하기 위해서는 Tuckey의 Mean-Difference Plot을 활용해야한다. </span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="at">x=</span>true_val,<span class="at">y=</span>est_val,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(true_val,est_val),<span class="fu">max</span>(true_val,est_val)),</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(true_val,est_val),<span class="fu">max</span>(true_val,est_val))</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main=</span><span class="st">"QQ_plot of true value and estimated value"</span>)</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"darkgreen"</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#초반의 일부 데이터를 제외하면 대부분이 주대각선 위에 존재하고 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서 두 Estimation의 평균은 같다고 보기 힘들다.</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>qq.x <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(<span class="at">x=</span>true_val,<span class="at">y=</span>est_val)<span class="sc">$</span>x</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>qq.y <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(<span class="at">x=</span>true_val,<span class="at">y=</span>est_val)<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((qq.x<span class="sc">+</span>qq.y)<span class="sc">/</span><span class="dv">2</span>, qq.y<span class="sc">-</span>qq.x, <span class="at">main=</span><span class="st">"Tukey mean difference plot"</span>, </span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"est_val - true_val"</span>, <span class="at">xlab=</span><span class="st">"mean"</span>)</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean difference plot을 통해서 확인하더라도 몇몇자료를 제외하면 대부분의 자료가 x축보다 위에 존재하는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>qqplot을 통해서 처음 확인하였을 때 자료들이 전부 직선위에 존재하는 것 처럼 보였으나 실제로 자료들을 합쳐서 qqplot을 그릴경우 역s자 형태로 나타나서 동일한 분포에서 나온 데이터가 아닐 수도 있음을 확인할 수 있었고 mean-difference plot을 통해서 이를 재 확인할 수 있었다. 따라서 어떤 자료를 측정하는 경우 계측기가 정확하다면 두 자료는 동일한 분포를 따르는 것이 맞겠지만, 계측기가 정확하지 않기 때문에 두 자료들이 서로 다른 분포를 따르고 있다는 것을 확인할 수 있었다. 시각적으로 예측해보는 것은 항상 정확하지 않기 때문에 지금처럼 검증이 필요하다고 생각한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(lactic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked _by_ .GlobalEnv:

    est_val, true_val</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from lactic (pos = 3):

    est_val, true_val</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(true_val,est_val) <span class="co">#매우 높은 상관관계가 존재함.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  true_val and est_val
t = 26.107, df = 18, p-value = 9.278e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9668337 0.9949756
sample estimates:
      cor 
0.9870507 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(est_val<span class="sc">~</span>true_val)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">line</span>(<span class="at">x=</span>true_val,<span class="at">y=</span>est_val))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
line(x = true_val, y = est_val)

Coefficients:
[1]  -0.9026   1.4053</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(z),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(z) <span class="sc">~</span> <span class="fu">fitted</span>(z), <span class="at">main =</span> <span class="st">"Residual plot by rline"</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># 잔차들이 우하향하는 듯하게 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sqrt</span>(est_val)<span class="sc">~</span>(true_val))</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>(z1 <span class="ot">&lt;-</span> <span class="fu">line</span>(<span class="at">x=</span>(true_val),<span class="at">y=</span><span class="fu">sqrt</span>(est_val)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
line(x = (true_val), y = sqrt(est_val))

Coefficients:
[1]  0.9012  0.2676</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(z1),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(z1) <span class="sc">~</span> <span class="fu">fitted</span>(z1), <span class="at">main =</span> <span class="st">"Residual plot by rline"</span>)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co">#다소 완화되었다 그러나 자료들이 곡선의 경향성을 보여준다는 점에서 변환은 부적절하다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(lactic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>상관관계가 매우 높게 나타나서, r-line을 활용해 두 자료를 적합시키려고 하였는데 변환을 진행하기전 자료가 더 적합해보인다.</p>
</section>
<section id="section-2" class="level1">
<h1>3.</h1>
<p>취학아동의 정신 장애 상태와 부모의 사회경제적 지위(1=낮음, 6=높음)에 대한 표이다. 분석하여라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ordered</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6
Levels: 1 &lt; 2 &lt; 3 &lt; 4 &lt; 5 &lt; 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>soseco<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">64</span>,<span class="dv">57</span>,<span class="dv">57</span>,<span class="dv">72</span>,<span class="dv">36</span>,<span class="dv">21</span>,<span class="dv">94</span>,<span class="dv">94</span>,<span class="dv">105</span>,<span class="dv">141</span>,<span class="dv">97</span>,<span class="dv">71</span>,<span class="dv">58</span>,<span class="dv">54</span>,<span class="dv">65</span>,<span class="dv">77</span>,<span class="dv">54</span>,<span class="dv">54</span>,<span class="dv">46</span>,<span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">94</span>,<span class="dv">78</span>,<span class="dv">71</span>),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">6</span>,<span class="at">byrow=</span>T))</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(soseco)<span class="ot">=</span><span class="fu">ordered</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(soseco)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Well"</span>,<span class="st">"Mild"</span>,<span class="st">"Moderate"</span>,<span class="st">"Impaired"</span>)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="co"># median polish</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>soseco_polished<span class="ot">=</span><span class="fu">medpolish</span>(soseco)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 219
2: 202.75
3: 200
Final: 200</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maxiter를 설정하지 않고 분석한 결과 maxiter=3에서 결과 값이 나오는 것을 확인하였다.</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>soseco_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "soseco")

Overall: 56.375

Row Effects:
    Well     Mild Moderate Impaired 
 -11.875   39.375   -0.625    0.625 

Column Effects:
      1       2       3       4       5       6 
  0.250  -1.750   9.250  32.250  -0.250 -12.625 

Residuals:
              1      2     3      4     5       6
Well      19.25  14.25  3.25  -4.75 -8.25 -10.875
Mild      -2.00   0.00  0.00  13.00  1.50 -12.125
Moderate   2.00   0.00  0.00 -11.00 -1.50  10.875
Impaired -11.25 -15.25 -6.25   4.75 21.25  26.625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(soseco_polished)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x축과 y축위에 데이터가 많이 있는 것으로 보인다. outlier로 보이는 4개의 점을 제외하면 전반적으로 residual들이 안정적이다.</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(soseco_polished)</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#나름 점들이 경향성을 가지고 있는 것으로 보인다.</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>z7<span class="ot">=</span><span class="fu">lm</span>(<span class="fu">as.vector</span>(soseco_polished<span class="sc">$</span>residuals) <span class="sc">~</span> </span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.vector</span>(<span class="fu">outer</span>(soseco_polished<span class="sc">$</span>row,soseco_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>soseco_polished<span class="sc">$</span>overall))[<span class="dv">1</span>]</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(z7,<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기울기가 0.5665495이므로 1과는 다르므로 log변환의 필요성이 떨어져 보인다.</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 직선을 그리기 어렵고 의미있는 패턴이 보이지 않기 때문에 변환이 요구되어보이지는 않는다. </span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(soseco_polished<span class="sc">$</span>residuals) <span class="co"># Boxplot그릴경우 Outlier가 확인되어지지는 않는다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 행 효과 크기 순으로 재정렬한 잔차표</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(soseco_polished<span class="sc">$</span>residuals[<span class="fu">order</span>(soseco_polished<span class="sc">$</span>row),],<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             1     2    3     4    5     6
Well      19.2  14.2  3.2  -4.8 -8.2 -10.9
Moderate   2.0   0.0  0.0 -11.0 -1.5  10.9
Impaired -11.2 -15.2 -6.2   4.8 21.2  26.6
Mild      -2.0   0.0  0.0  13.0  1.5 -12.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Decomposition</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>decomposed<span class="ot">=</span>(soseco_polished<span class="sc">$</span>overall <span class="sc">+</span> <span class="fu">outer</span>(soseco_polished<span class="sc">$</span>row,soseco_polished<span class="sc">$</span>col, <span class="st">"+"</span>) <span class="sc">+</span> soseco_polished<span class="sc">$</span>residuals)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>decomposed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1  2   3   4  5  6
Well     64 57  57  72 36 21
Mild     94 94 105 141 97 71
Moderate 58 54  65  77 54 54
Impaired 46 40  60  94 78 71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(decomposed<span class="sc">==</span>soseco) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가법성 모형이 확인되어지고 있다.</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison Values</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">outer</span>(soseco_polished<span class="sc">$</span>row,soseco_polished<span class="sc">$</span>col, <span class="st">"*"</span>)<span class="sc">/</span>soseco_polished<span class="sc">$</span>overall,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             1     2     3     4     5     6
Well     -0.05  0.37 -1.95 -6.79  0.05  2.66
Mild      0.17 -1.22  6.46 22.52 -0.17 -8.82
Moderate  0.00  0.02 -0.10 -0.36  0.00  0.14
Impaired  0.00 -0.02  0.10  0.36  0.00 -0.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison value 기준으로 0값이 총 4개 확인됨. 그런데 더 많은 값들이 Additivity Plot의 x축과 y축 근처에 존재하는 것으로 보아 몇몇 피팅에서 벗어난 값을 제외하면 대부분 0근처에서 존재하고 있는 것이 확인된다. </span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co">#stem and leaf plot</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(soseco_polished<span class="sc">$</span>residuals) <span class="co"># stem 0이 가장 높음 (낮은 잔차인 stem -1의 잔차들이 다소 많이 나타나고 있음)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

  -1 | 52111
  -0 | 86522
   0 | 00002235
   1 | 1349
   2 | 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect </span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(soseco_polished<span class="sc">$</span>row,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">40</span>), <span class="at">main=</span><span class="st">"정신상태의 효과"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>soseco_polished<span class="sc">$</span>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Well     Mild Moderate Impaired 
 -11.875   39.375   -0.625    0.625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Effect에 대해서 먼저 분석을 진행해 보았다. 정신상태가 Mild인 경우 부모님의 사회경제적 지위가 가장 높아졌고, Well인경우 부모님의 사회경제적 지위가 낮은 것으로 보인다. </span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(soseco_polished<span class="sc">$</span>col, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>) , <span class="at">main=</span><span class="st">"부모님 사회경제적 지위의 효과"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>soseco_polished<span class="sc">$</span>col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1       2       3       4       5       6 
  0.250  -1.750   9.250  32.250  -0.250 -12.625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Effect에 대해서 분석을 진행해 보았다. 부모님의 사회경제적 지위가 4인 경우에 정신상태가 나빠질 가능성이 많은 편이다. 부모님의 사회경제적 지위가 6인경우 정신상태가 다른 집단들에 비해서 긍정적으로 나타나는 것이 확인되어진다. </span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {<span class="fu">barplot</span>(soseco_polished<span class="sc">$</span>residuals[i,],<span class="at">main=</span><span class="fu">rownames</span>(soseco)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정신상태가 Well과 Impaired 된 집단을 기준으로 볼 경우 부모님의 사회경제적 지위가 높을수록 정신상태가 나쁜 Case가 많고, 낮을수록 정신상태가 좋은 Case가 많다. </span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {<span class="fu">barplot</span>(soseco_polished<span class="sc">$</span>residuals[,i],<span class="at">main=</span><span class="fu">names</span>(soseco)[i])}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 부모님의 사회경제적 지위가 높을 수록 정신상태가 나쁜 경향성을 보이고, 사회 경제적 지위가 낮을 때 정신상태가 좋게 나타나고 있다.</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co"># twoway plot</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"twoway"</span>)</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="fu">twoway</span>(soseco, <span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median polish decomposition (Dataset: "soseco"; Response: Value)
Residuals bordered by row effects, column effects, and overall

           1       2       3       4       5       6         roweff 
         + ------- ------- ------- ------- ------- ------- + -------
Well     |  19.250  14.250   3.250  -4.750  -8.250 -10.875 : -11.875
Mild     |  -2.000   0.000   0.000  13.000   1.500 -12.125 :  39.375
Moderate |   2.000   0.000   0.000 -11.000  -1.500  10.875 :  -0.625
Impaired | -11.250 -15.250  -6.250   4.750  21.250  26.625 :   0.625
         + ....... ....... ....... ....... ....... ....... + .......
coleff   |   0.250  -1.750   9.250  32.250  -0.250 -12.625 :  56.375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">twoway</span>(soseco, <span class="at">method=</span><span class="st">"median"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaic plot</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ghibli)</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>pal<span class="ot">=</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>,<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>pal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(soseco,<span class="at">color=</span>pal,<span class="at">main=</span><span class="st">"mosaic plot of sosioeconomic data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-9-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#부모님의 사회 경제적 위치가 높을수록 정신 상태가 안 좋은 사람들의 비율이 올라가는 듯한 경향성이 보이는 듯 하다. </span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="co"># coded plot</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">=</span>soseco_polished<span class="sc">$</span>residuals</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>standard<span class="ot">=</span><span class="fu">as.vector</span>(resid)</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(standard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -15.2500  -7.2500   0.0000   7.8125  26.6250</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>Hspread<span class="ot">=</span><span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>inner<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span>Hspread,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>Hspread)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>outer<span class="ot">=</span><span class="fu">c</span>(<span class="fu">fivenum</span>(standard)[<span class="dv">4</span>]<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>Hspread,<span class="fu">fivenum</span>(standard)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>Hspread)</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">=</span><span class="fu">as.data.frame</span>(resid)</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 교과서 기준과 동일하게 "M" - Far outside low, "="- below low inner fence(outise), "-" - Below lower hinge but within inner fence</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="co"># "." - Between Hinges , "+"- Above upper hinge, "#" - Above High inner fence (outside), "F" - Far outside high</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>resid_coded<span class="ot">=</span><span class="fu">ifelse</span>(resid <span class="sc">&gt;=</span> outer[<span class="dv">1</span>], <span class="st">"F"</span>,</span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(resid<span class="sc">&gt;=</span> inner[<span class="dv">1</span>], <span class="st">"#"</span>,</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(resid <span class="sc">&gt;=</span> <span class="fu">fivenum</span>(standard)[<span class="dv">4</span>],<span class="st">"+"</span>,</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(resid <span class="sc">&gt;=</span><span class="fu">fivenum</span>(standard)[<span class="dv">2</span>] ,<span class="st">"."</span>,</span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(resid<span class="sc">&gt;=</span> inner[<span class="dv">2</span>],<span class="st">"-"</span>,</span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">ifelse</span>(resid <span class="sc">&gt;=</span> outer[<span class="dv">2</span>],<span class="st">"="</span>,<span class="st">"M"</span>))))))</span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a>resid_coded<span class="ot">=</span><span class="fu">as.data.frame</span>(resid_coded)</span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a>resid_coded <span class="co">#위에서 확인하였던 경향성이 다시한번 확인된다 (부모의 사회경제적 위치가 올라갈수록 정신질환을 가지는 경우가 높아짐)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1 2 3 4 5 6
Well     + + . . - -
Mild     . . . + . -
Moderate . . . - . +
Impaired - - . . + +</code></pre>
</div>
</div>
</section>
<section id="section-3" class="level1">
<h1>4.</h1>
<p>자료는 정상적인 쥐, 알록산(alloxan)에 의해 당뇨병이 유발된 쥐, 당뇨병이 유발된 후 인슐린으로 치료한 쥐에서의 알부민양이다. 세 자료의 분포가 같은 지 분석하여라. 자료를 재표현하여 대칭형으로 만들고 분포가 같은 지 다시 분석하여라. [DIABETIC.DAT]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>diabetes<span class="ot">=</span><span class="fu">read.delim</span>(<span class="st">"C:/r/DIABETIC.DAT"</span>,<span class="at">header=</span>F)</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(diabetes)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"normal"</span>,<span class="st">"alloxan"</span>,<span class="st">"insulin"</span>)</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20  3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     normal         alloxan          insulin     
 Min.   : 14.0   Min.   : 13.00   Min.   : 18.0  
 1st Qu.:104.0   1st Qu.: 76.25   1st Qu.: 45.0  
 Median :124.5   Median :139.50   Median : 82.0  
 Mean   :186.1   Mean   :181.83   Mean   :112.9  
 3rd Qu.:260.2   3rd Qu.:251.00   3rd Qu.:132.0  
 Max.   :655.0   Max.   :499.00   Max.   :465.0  
                 NA's   :2        NA's   :1      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치의 확인 </span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(diabetes)) <span class="co"># alloxan에서 2개 insulin에서 1개</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> normal alloxan insulin 
      0       2       1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stem and leaf를 활용하여 각 집단의 분포를 비교</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(diabetes)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aplpack)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(normal,alloxan,<span class="at">rule.line=</span><span class="st">"Sturges"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_____________________________________
  1 | 2: represents 120, leaf unit: 10 
          normal     alloxan     
_____________________________________
   5       86221| 0 |145678      6   
  (9)  954222111| 1 |0234677    (7)  
   6         985| 2 |77          5   
   3           4| 3 |9           3   
   2           5| 4 |69          2   
                | 5 |                
_____________________________________
HI: 655                              
n:            20     20          
NAs:           0     2           
_____________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal data와 alloxan data모두 skewed to the right 되어 있는 자료로 stem 1에서 가장 많은 데이터를 보인다.</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(normal,insulin,<span class="at">rule.line=</span><span class="st">"Sturges"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>__________________________________
  1 | 2: represents 120, leaf unit: 10 
        normal      insulin   
__________________________________
   3       221| 0* |123444    6   
   5        86| 0. |67789    (5)  
  (7)  4222111| 1* |0033      8   
   8        95| 1. |5         4   
              | 2* |24        3   
   6       985| 2. |              
   3         4| 3* |              
__________________________________
HI: 455 655         HI: 465       
n:          20      20        
NAs:         0      1         
__________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal data의 경우 stem 1*을 중심으로 하고 있으며 stem 2*의 경우 중간에 비어 있는 모습을 확인할 수 있다. (Outlier의 가능성)</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="co"># insulin data의 경우 stem 0*에서 가장 많은 자료가 있고 해당 자료도 skewed to the right 되어 있는 것을 확인할 수 있다.</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stem.leaf.backback</span>(alloxan,insulin,<span class="at">rule.line=</span><span class="st">"Sturges"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________
  1 | 2: represents 120, leaf unit: 10 
      alloxan      insulin  
________________________________
   2       41| 0* |123444   6   
   6     8765| 0. |67789   (5)  
  (4)    4320| 1* |0033     8   
   8      776| 1. |5        4   
             | 2* |24       3   
   5       77| 2. |             
             | 3* |             
________________________________
HI: 391 469        HI: 465      
499                             
n:         20      20       
NAs:        2      1        
________________________________</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 첫번째 stem and leaf에서는 alloxan data가 종모양을 이루고 있지 않은 것으로 보였으나 조금더 확대하였더니 어느정도 종모양을 띄고 있는 것이 확인된다.</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(normal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  14.0  98.0 124.5 267.5 655.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(alloxan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  13.0  73.0 139.5 276.0 499.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(insulin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  18  45  82 132 465</code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(diabetes,<span class="at">main=</span><span class="st">"Comparison of groups"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(diabetes)<span class="sc">$</span>out <span class="co">#2개의 outlier 확인됨. (아까 Stem and leaf에서 확인 한 부분 재확인)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 655 465</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal data에서 655의 outlier, insulin 투여 쥐에서 465의 outlier 확인</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(diabetes)<span class="sc">$</span>stats </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2] [,3]
[1,]  14.0  13.0   18
[2,]  98.0  73.0   45
[3,] 124.5 139.5   82
[4,] 267.5 276.0  132
[5,] 455.0 499.0  243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(normal) <span class="co"># skewed to the right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6873156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(alloxan) <span class="co"># skewed to the right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3448276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(insulin) <span class="co"># skewed to the right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1494253</code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Letter Value Display</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>lvd9<span class="ot">=</span>(<span class="fu">lsum</span>(normal,<span class="dv">6</span>))</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>lvd10<span class="ot">=</span>(<span class="fu">lsum</span>(alloxan,<span class="dv">6</span>))</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>lvd11<span class="ot">=</span>(<span class="fu">lsum</span>(insulin,<span class="dv">6</span>))</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>lvd9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M  10.5 124.5 124.50 124.5    0.0
2      H   5.5  98.0 182.75 267.5  169.5
3      E   3.0  29.0 189.00 349.0  320.0
4      D   2.0  26.0 240.50 455.0  429.0
5      C   1.5  20.0 287.50 555.0  535.0
6      B   1.0  14.0 334.50 655.0  641.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>lvd10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower    mid upper spread
1      M   9.5 139.5 139.50 139.5    0.0
2      H   5.0  73.0 174.50 276.0  203.0
3      E   3.0  50.0 220.50 391.0  341.0
4      D   2.0  46.0 257.50 469.0  423.0
5      C   1.5  29.5 256.75 484.0  454.5
6      B   1.0  13.0 256.00 499.0  486.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>lvd11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower   mid upper spread
1      M  10.0    82  82.0    82      0
2      H   5.5    45  88.5   132     87
3      E   3.0    34 131.0   228    194
4      D   2.0    20 131.5   243    223
5      C   1.5    19 186.5   354    335
6      B   1.0    18 241.5   465    447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>lvd9[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd9[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 169.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>lvd10[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd10[<span class="dv">2</span>,<span class="dv">3</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>lvd11[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd11[<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alloxan 집단에서 spread가 가장 크게 나타나며, normal 집단이 그다음, insulin 투여 집단의 분포는 좁게 나타나고 있다.</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread / H-spread - 1.705)</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>(lvd9[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd9[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd9[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd9[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1829056</code></pre>
</div>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>(lvd10[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd10[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd10[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd10[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.02519704</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>(lvd11[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd11[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd11[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd11[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5248851</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규성</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(normal, <span class="at">ylab=</span><span class="st">"normal group quantiles"</span>,<span class="at">main=</span><span class="st">"normal group"</span>);<span class="fu">qqline</span>(normal, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 점들이 직선을 잘 따르고 있지 않다. 앞에서 언급했던 outlier을 재확인하였으며, 점들이 convex한 곡선을 띄고 있는 것을 확인할 있다. </span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>fiv9<span class="ot">=</span><span class="fu">fivenum</span>(normal)</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma9 =</span> (fiv9[<span class="dv">4</span>]<span class="sc">-</span>fiv9[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 126.4925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(normal) <span class="co"># 약 32정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 158.8349</code></pre>
</div>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv9[<span class="dv">3</span>],pseudosigma9,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">y =</span> <span class="dv">600</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 차이 존재</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(alloxan, <span class="at">ylab=</span><span class="st">"alloxan group quantiles"</span>,<span class="at">main=</span><span class="st">"alloxan group"</span>);<span class="fu">qqline</span>(alloxan, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 점들이 직선을 잘 따르고 있지 않다. 점들이 곡선을 띄고 있는 것을 확인할 있다. </span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>fiv10<span class="ot">=</span><span class="fu">fivenum</span>(alloxan)</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma10 =</span> (fiv10[<span class="dv">4</span>]<span class="sc">-</span>fiv10[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 151.4925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(alloxan,<span class="at">na.rm=</span>T) <span class="co"># 약 7정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 144.8493</code></pre>
</div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv10[<span class="dv">3</span>],pseudosigma10,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">y =</span> <span class="dv">500</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 차이 존재</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(insulin, <span class="at">ylab=</span><span class="st">"insulin group quantiles"</span>,<span class="at">main=</span><span class="st">"insulin group"</span>);<span class="fu">qqline</span>(insulin, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="co"># oulier와 몇몇 2~3개의 점을 제외하면 점들이 직선을 잘 따르고 있는 것으로 보인다. </span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>fiv11<span class="ot">=</span><span class="fu">fivenum</span>(insulin)</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">pseudosigma11 =</span> (fiv11[<span class="dv">4</span>]<span class="sc">-</span>fiv11[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">1.34</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.92537</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(insulin,<span class="at">na.rm=</span>T) <span class="co"># 약 41정도의 차이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105.7896</code></pre>
</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fiv11[<span class="dv">3</span>],pseudosigma11,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">y =</span> <span class="dv">450</span>, <span class="fu">c</span>(<span class="st">"qqline"</span>, <span class="st">"robustline"</span>), </span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>)) <span class="co"># 거의 비슷함.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co">#전반적으로 자료들이 skewed to the right되어있고 정규분포를 잘 따르지 않는 것으로 보인다. </span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 데이터를 합치고 해당 데이터들이 동일한 분포를 따르고 있는지 확인하기 </span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>diabetes2<span class="ot">=</span><span class="fu">c</span>(normal,alloxan,insulin)</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>diabetes2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 156 282 197 297 116 127 119  29 253 122 349 110 143  64  26  86 122 455 655
[20]  14 391  46 469  86 174 133  13 499 168  62 127 276 176 146 108 276  50  73
[39]  NA  NA  82 100  98 150 243  68 228 131  73  18  20 100  72 133 465  40  46
[58]  34  44  NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diabetes2);<span class="fu">qqline</span>(diabetes2,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co">#자료들이 Convex한 곡선의 형태를 띄고 있다 따라서 변환을 통해서 동일한 분포를 따르고 있는지 재확인해야 한다.</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co">#큰 값쪽으로 긴 꼬리를 뻗은 기울어진 분포</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료의 재표현 - 일반적으로 많이 사용하는 재표현 방식의 사용</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(diabetes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">sqrt</span>(diabetes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(diabetes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(diabetes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spread-versus-level Plot</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>diabetes_spread<span class="ot">=</span><span class="fu">c</span>(lvd9[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd9[<span class="dv">2</span>,<span class="dv">3</span>],lvd10[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd10[<span class="dv">2</span>,<span class="dv">3</span>],lvd11[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd11[<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>diabetes_med<span class="ot">=</span><span class="fu">c</span>(<span class="fu">median</span>(normal),<span class="fu">median</span>(alloxan,<span class="at">na.rm=</span>T),<span class="fu">median</span>(insulin,<span class="at">na.rm=</span>T))</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(diabetes_med), <span class="fu">log</span>(diabetes_spread), <span class="at">main=</span><span class="st">"Spread vs. Level plot"</span>)</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>logspread<span class="ot">=</span><span class="fu">log</span>(diabetes_spread)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>logmed<span class="ot">=</span><span class="fu">log</span>(diabetes_med)</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>(RegrLine <span class="ot">&lt;-</span> <span class="fu">lm</span>(logspread<span class="sc">~</span>logmed))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = logspread ~ logmed)

Coefficients:
(Intercept)       logmed  
     -2.564        1.595  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(RegrLine))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">coef</span>(RegrLine)[<span class="dv">2</span>] <span class="co">#-0.5853975 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    logmed 
-0.5953067 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -0.5에 가까움</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="sc">-</span>(diabetes)<span class="sc">^-</span><span class="fl">0.5</span>,<span class="at">main=</span><span class="st">"-0.5 transformation"</span>)</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="sc">-</span>(diabetes)<span class="sc">^-</span><span class="fl">0.5</span>,<span class="at">main=</span><span class="st">"-0.5 transformation"</span>)<span class="sc">$</span>out <span class="co"># 총 4개의 outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1856953 -0.1961161 -0.2672612 -0.2773501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>skewness_transformed1<span class="ot">=</span><span class="fu">c</span>(<span class="fu">skewness</span>((<span class="sc">-</span>(diabetes)<span class="sc">^-</span><span class="fl">0.5</span>)[,<span class="dv">1</span>]), <span class="fu">skewness</span>((<span class="sc">-</span>(diabetes)<span class="sc">^-</span><span class="fl">0.5</span>)[,<span class="dv">2</span>]), <span class="fu">skewness</span>((<span class="sc">-</span>(diabetes)<span class="sc">^-</span><span class="fl">0.5</span>)[,<span class="dv">3</span>]))</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>skewness_transformed1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.4079370 -0.1365476 -0.2461638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(skewness_transformed1) <span class="co"># skewness가 가장적음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008408507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(diabetes),<span class="at">main=</span><span class="st">"log transformation"</span>)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(diabetes),<span class="at">main=</span><span class="st">"log transformation"</span>)<span class="sc">$</span>out <span class="co"># 총 3개의 outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.639057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>skewness_transformed2<span class="ot">=</span><span class="fu">c</span>(<span class="fu">skewness</span>(<span class="fu">log</span>(diabetes)[,<span class="dv">1</span>]), <span class="fu">skewness</span>(<span class="fu">log</span>(diabetes)[,<span class="dv">2</span>]), <span class="fu">skewness</span>(<span class="fu">log</span>(diabetes)[,<span class="dv">3</span>]))</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>skewness_transformed2     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.51161785  0.02774901 -0.11543537</code></pre>
</div>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(skewness_transformed2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1413105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>diabetes3<span class="ot">=</span><span class="sc">-</span>(<span class="fu">c</span>(normal,alloxan,insulin))<span class="sc">^-</span><span class="fl">0.5</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diabetes3,<span class="at">main=</span><span class="st">"minus sqrt inverse qqplot"</span>);<span class="fu">qqline</span>(diabetes3,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-14.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>diabetes4<span class="ot">=</span><span class="fu">log</span>(<span class="fu">c</span>(normal,alloxan,insulin))</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diabetes4,<span class="at">main=</span><span class="st">"log qqplot"</span>);<span class="fu">qqline</span>(diabetes4,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-15.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>diabetes5<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">c</span>(normal,alloxan,insulin))</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diabetes5,<span class="at">main=</span><span class="st">"sqrt qqplot"</span>);<span class="fu">qqline</span>(diabetes5,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-16.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>diabetes6<span class="ot">=</span><span class="sc">-</span>(<span class="fu">c</span>(normal,alloxan,insulin))<span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diabetes6,<span class="at">main=</span><span class="st">"minus inverseqqplot"</span>);<span class="fu">qqline</span>(diabetes6,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-17.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전반적으로 log 나 sqrt변환 이후 자료들이 직선을 더 잘 따르고 있는 것을 확인할 수 있다. </span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QQplot 하에서 양 극단의 일부 데이터를 제외한 나머지 데이터들은 전부 qqline위에 있다는 점에서 변환이후 데이터들은 동일한 정규분포에서 나타난 것을 확인할 수 있다.</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 가장 정규분포를 잘 따르고 있는 것으로 보이는 log변환을 활용해 Tuckey_Mean_Difference_Plot</span></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>nor_log<span class="ot">=</span><span class="fu">log</span>(diabetes)[,<span class="dv">1</span>];alo_log<span class="ot">=</span><span class="fu">log</span>(diabetes)[,<span class="dv">2</span>];ins_log<span class="ot">=</span><span class="fu">log</span>(diabetes)[,<span class="dv">3</span>]</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>alo_log<span class="ot">=</span>alo_log[<span class="sc">!</span><span class="fu">is.na</span>(alo_log)]</span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>ins_log<span class="ot">=</span>ins_log[<span class="sc">!</span><span class="fu">is.na</span>(ins_log)]</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(nor_log,alo_log,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(nor_log,alo_log),<span class="fu">max</span>(nor_log,alo_log)),</span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(nor_log,alo_log),<span class="fu">max</span>(nor_log,alo_log))</span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main=</span><span class="st">"QQ_plot of logged normal group and alloxan group"</span>)</span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"darkgreen"</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># 대부분의 자료들이 주대각선을 따르는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-18.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(nor_log,ins_log,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(nor_log,ins_log),<span class="fu">max</span>(nor_log,ins_log)),</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(nor_log,ins_log),<span class="fu">max</span>(nor_log,ins_log))</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main=</span><span class="st">"QQ_plot of logged normal group and insulin group"</span>)</span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"darkgreen"</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># 대부분의 자료들이 주대각선 밑에 있는 것으로 보인다. 따라서 같은 분포에서 나오지 않았을 가능성이 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-19.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(alo_log,ins_log,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(alo_log,ins_log),<span class="fu">max</span>(alo_log,ins_log)),</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(alo_log,ins_log),<span class="fu">max</span>(alo_log,ins_log))</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main=</span><span class="st">"QQ_plot of logged alloxan group and insulin group"</span>)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"darkgreen"</span>,<span class="at">lwd=</span><span class="dv">2</span>)  <span class="co"># 대부분의 자료들이 주대각선 밑에 있는 것으로 보인다. 따라서 같은 분포에서 나오지 않았을 가능성이 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-20.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co">#정리하면 Normal Group과 Alloxan Group의 경우는 같은 분포에서 나왔을 가능성이 높지만, insulin 투여 그룹은 다른 분포를 따르고 있을 가능성이 높다. </span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>qq.x1 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(nor_log,alo_log)<span class="sc">$</span>x</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>qq.y1 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(nor_log,alo_log)<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-21.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((qq.x1<span class="sc">+</span>qq.y1)<span class="sc">/</span><span class="dv">2</span>, qq.y1<span class="sc">-</span>qq.x1, <span class="at">main=</span><span class="st">"Tukey mean difference plot"</span>, </span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"alo_log-nor_log"</span>, <span class="at">xlab=</span><span class="st">"mean"</span>)</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-22.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>qq.x2 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(nor_log,ins_log)<span class="sc">$</span>x</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>qq.y2 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(nor_log,ins_log)<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-23.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((qq.x2<span class="sc">+</span>qq.y2)<span class="sc">/</span><span class="dv">2</span>, qq.y2<span class="sc">-</span>qq.x2, <span class="at">main=</span><span class="st">"Tukey mean difference plot"</span>, </span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"ins_log-nor_log"</span>, <span class="at">xlab=</span><span class="st">"mean"</span>)</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># 대부분의 자료들이 X축의 밑에 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-24.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>qq.x3 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(alo_log,ins_log)<span class="sc">$</span>x</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>qq.y3 <span class="ot">&lt;-</span> <span class="fu">qqplot</span>(alo_log,ins_log)<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-25.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((qq.x3<span class="sc">+</span>qq.y3)<span class="sc">/</span><span class="dv">2</span>, qq.y3<span class="sc">-</span>qq.x3, <span class="at">main=</span><span class="st">"Tukey mean difference plot"</span>, </span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"ins_log-alo_log"</span>, <span class="at">xlab=</span><span class="st">"mean"</span>)</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># 대부분의 자료들이 X축의 밑에 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-26.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 변환 이후 각 자료는 정규분포를 따르는가?</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(nor_log);<span class="fu">qqline</span>(nor_log,<span class="at">col=</span><span class="st">"red"</span>) <span class="co"># outlier들을 제외하면 정규분포를 잘 따르는 것으로 보인다. (곡선의 흔적이 있으나 완화됨)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-27.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(alo_log);<span class="fu">qqline</span>(alo_log,<span class="at">col=</span><span class="st">"red"</span>) <span class="co"># 한두개의 점을 제외하면 정규분포를 잘 따르는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-28.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(ins_log);<span class="fu">qqline</span>(ins_log,<span class="at">col=</span><span class="st">"red"</span>) <span class="co"># 가장 정규분포를 잘 따른다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-10-29.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결론: 변환이후 각 자료들은 정규분포를 따르고 있는 것으로 보이나 그 각각의 평균은 다른 것으로 보이기에 서로 다른 분포를 따르고 있다고 보는 것이 타당하다. </span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 집단별 평균차이를 확인하기 위해서 일원분산분석을 진행하고자 한다.</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>dia_melt<span class="ot">=</span><span class="fu">melt</span>(diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>dia_melt<span class="ot">=</span>dia_melt[<span class="sc">!</span><span class="fu">is.na</span>(dia_melt<span class="sc">$</span>value),]</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>aov4<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>variable,<span class="at">data=</span>dia_melt)</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov4) <span class="co">#H0: 각 집단간 평균차이는 없다. H1: 각 집단간 평균차이는 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq Mean Sq F value Pr(&gt;F)
variable     2   64357   32178   1.675  0.197
Residuals   54 1037470   19212               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do not reject null hypothesis</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span> variable, <span class="at">data=</span>dia_melt, <span class="at">FUN =</span> <span class="fu">c</span>(mean, sd, min, max))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  variable value.mean value.sd value.min value.max
1   normal   186.1000 158.8349        14       655
2  alloxan   181.8333 144.8493        13       499
3  insulin   112.8947 105.7896        18       465</code></pre>
</div>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov4, <span class="st">"variable"</span>, <span class="at">group=</span><span class="cn">TRUE</span>,<span class="at">console=</span><span class="cn">TRUE</span>) <span class="co"># 각집단간 차이가 명확하게 드러나지 않는다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov4 ~ "variable"

HSD Test for value 

Mean Square Error:  19212.41 

variable,  means

           value      std  r Min Max
alloxan 181.8333 144.8493 18  13 499
insulin 112.8947 105.7896 19  18 465
normal  186.1000 158.8349 20  14 655

Alpha: 0.05 ; DF Error: 54 
Critical Value of Studentized Range: 3.408232 

Groups according to probability of means differences and alpha level( 0.05 )

Treatments with the same letter are not significantly different.

           value groups
normal  186.1000      a
alloxan 181.8333      a
insulin 112.8947      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>dia_melt2<span class="ot">=</span>dia_melt</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>dia_melt2<span class="sc">$</span>value<span class="ot">=</span><span class="fu">log</span>(dia_melt<span class="sc">$</span>value)</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>aov5<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>variable,<span class="at">data=</span>dia_melt2)</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
variable     2   2.75  1.3751   1.665  0.199
Residuals   54  44.61  0.8261               </code></pre>
</div>
</div>
</section>
<section id="section-4" class="level1">
<h1>5.</h1>
<p>1974년부터 1979년 까지 영국에서 기관지염, 폐기종, 천식의 폐 질환에 의한 월별 사망자 수이다. 분석하라. [MONTHLY.DAT]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>lung<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">read.delim</span>(<span class="st">"C:/r/MONTHLY.DAT"</span>,<span class="at">header=</span>F,)[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>)])</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>lung</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       V2   V3   V4   V5   V6   V7   V8   V9  V10  V11  V12  V13
[1,] 3035 2552 2704 2554 2014 1655 1721 1524 1596 2074 2199 2512
[2,] 2933 2889 2938 2497 1870 1726 1607 1545 1396 1787 2076 2837
[3,] 2787 3891 3179 2011 1636 1580 1489 1300 1356 1653 2013 2823
[4,] 2996 2523 2540 2520 1994 1641 1691 1479 1596 1877 2032 2484
[5,] 2899 2990 2890 2379 1933 1734 1617 1495 1440 1777 1970 2745
[6,] 2841 3535 3010 2091 1667 1589 1518 1349 1392 1619 1954 2633</code></pre>
</div>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>lung2<span class="ot">=</span><span class="fu">as.vector</span>(<span class="fu">c</span>(lung[<span class="dv">1</span>,],lung[<span class="dv">2</span>,],lung[<span class="dv">3</span>,],lung[<span class="dv">4</span>,],lung[<span class="dv">5</span>,],lung[<span class="dv">6</span>,]))</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>lung_ts<span class="ot">=</span><span class="fu">ts</span>(lung2,<span class="at">frequency=</span><span class="dv">12</span>,<span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>))</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lung_ts) <span class="co">#최소값은 1300, 최대값은 3891, 평균은 2002이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1300    1618    2002    2144    2651    3891 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치와 outlier의 존재여부를 체크하고자 한다.</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lung_ts, <span class="at">main=</span><span class="st">"Lung Disease Deaths"</span>)  <span class="co"># Outlier는 없다. Upper Whisker의 길이가 및의 Whisker에 비해서 길게 나타나진다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(lung_ts)) <span class="co"># 결측치 없음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Steam and leaf plot을 활용해서 자료의 분포를 예측해보고자 했다.</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(lung_ts,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 3 digit(s) to the right of the |

  1 | 334444
  1 | 555555666666666777777788999
  2 | 000000011124
  2 | 55555566677888899999
  3 | 00002
  3 | 59</code></pre>
</div>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 쌍봉분포의 경향. 두개의 Cluster가 존재하는 것 처럼 보인다. </span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(lung_ts,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 2 digit(s) to the right of the |

  12 | 0569
  14 | 0489022589
  16 | 0012244567923389
  18 | 783579
  20 | 1113789
  22 | 08
  24 | 80122455
  26 | 3059
  28 | 244990349
  30 | 0148
  32 | 
  34 | 4
  36 | 
  38 | 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co">#자료들이 Skewed to the right 되어 있는 것으로 보인다. Stem 16에서 가장 높게 나타나고 있으며 대칭적으로 보이지는 않는다. </span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="co">#중간에 빈칸이 있어서 두개의 Outlier가 있을 것으로 예상되었지만 Boxplot을 통해 보았듯이 따로 Outlier는 나타나지 않는 것으로 보인다.</span></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="co">#skewness</span></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(lung_ts) <span class="co">#Skewed to the right되어 있음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2679676</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">log</span>(lung_ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1476176</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(lung_ts)) <span class="co"># log 변환을 하면 다소 완화됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd12=</span><span class="fu">lsum</span>(lung_ts,<span class="dv">9</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth  lower     mid  upper spread
1      M  36.5 2002.5 2002.50 2002.5    0.0
2      H  18.5 1618.0 2143.25 2668.5 1050.5
3      E   9.5 1506.5 2211.25 2916.0 1409.5
4      D   5.0 1396.0 2203.00 3010.0 1614.0
5      C   3.0 1356.0 2267.50 3179.0 1823.0
6      B   2.0 1349.0 2442.00 3535.0 2186.0
7      A   1.5 1324.5 2518.75 3713.0 2388.5
8      Z   1.0 1300.0 2595.50 3891.0 2591.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread) / (H-spread) - 1.705</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>(lvd12[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd12[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd12[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd12[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.363258</code></pre>
</div>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>Hspread<span class="ot">=</span><span class="fu">fivenum</span>(lung_ts)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">fivenum</span>(lung_ts)[<span class="dv">2</span>]</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>Hspread</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1050.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료들이 정규성 따르냐?</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lung_ts, <span class="at">ylab=</span><span class="st">"Lung Disease Deaths Quantiles"</span>);<span class="fu">qqline</span>(lung_ts, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#역 S자 모양</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(lung_ts), <span class="at">ylab=</span><span class="st">"Logged Lung Disease Deaths Quantiles"</span>);<span class="fu">qqline</span>(<span class="fu">log</span>(lung_ts), <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#역 S자 모양</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터들이 혼합 분포에서 나오지 않았을까하고 추측되어진다. (단일 정규분포를 따르지 않으므로 정규성은 X)</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_ts, <span class="at">main =</span> <span class="st">"Time-Series Plot: Lung Diseases Deaths"</span>) <span class="co">#1976년과 1979년의 봉우리에 두번의 특이값이 확인됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">diff</span>(lung_ts), <span class="at">main =</span> <span class="st">"Time-Series Plot: Lung Diseases Deaths"</span>) <span class="co">#차분데이터에 대해서 시계열자료는 다음과 같다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6년동안 6개의 봉우리가 있으므로 매년 이러한 계절성이 존재한다는 것을 확인할 수 있다. </span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Box-Cox Transformation을 통해서 데이터를 변환하였다. (계절변동을 확인하기 위해서, 데이터의 정규성을 개선하기 위해)</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox.lambda</span>(lung_ts)</span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>lung_ts_new <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">BoxCox</span>(lung_ts, lambda)</span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터가 0인 경우가 없기 때문에 Boxcox transforamtion을 진행해도 문제 없다.</span></span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lung_ts_new, <span class="at">main =</span> <span class="st">"Box-Cox : Lung Diseases Deaths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(lung_ts_new), <span class="at">main =</span> <span class="st">"Difference &amp; Box-Cox : Lung Diseases Deaths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절요인 분해시계열</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>lung_ts.decompose <span class="ot">&lt;-</span> <span class="fu">decompose</span>(lung_ts)       <span class="co"># 데이터에서 4가지 요인을 분해</span></span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a>lung_ts.decompose<span class="sc">$</span>seasonal                     <span class="co"># 계절요인으로 분해된 부분이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Jan       Feb       Mar       Apr       May       Jun       Jul
1974  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
1975  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
1976  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
1977  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
1978  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
1979  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278
           Aug       Sep       Oct       Nov       Dec
1974 -693.4028 -695.9444 -337.8361 -106.6861  518.9556
1975 -693.4028 -695.9444 -337.8361 -106.6861  518.9556
1976 -693.4028 -695.9444 -337.8361 -106.6861  518.9556
1977 -693.4028 -695.9444 -337.8361 -106.6861  518.9556
1978 -693.4028 -695.9444 -337.8361 -106.6861  518.9556
1979 -693.4028 -695.9444 -337.8361 -106.6861  518.9556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lung_ts.decompose)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_ts.decompose<span class="sc">$</span>seasonal,<span class="at">main=</span><span class="st">"The Plot of Seasoal Decomposition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절요인 제외시키기</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>lung_ts.decompose_new <span class="ot">&lt;-</span> lung_ts <span class="sc">-</span> lung_ts.decompose<span class="sc">$</span>seasonal</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_ts.decompose_new, <span class="at">main=</span><span class="st">"Time-Series without Seasonal Effect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절성을 제외한 나머지 요인들을 분석할 경우 1976,1979년도의 Random한 요인에 의해서 데이터가 늘어난 것을 확인 할 수 있다.</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 또한 1974년 1977년 두번의 Random한 요인에 의해서 데이터가 줄어듦</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>lung_1974<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>lung_1975<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a>lung_1976<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">25</span><span class="sc">:</span><span class="dv">36</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>lung_1977<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">37</span><span class="sc">:</span><span class="dv">48</span>],<span class="at">start=</span><span class="dv">1</span>)  </span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>lung_1978<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">49</span><span class="sc">:</span><span class="dv">60</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a>lung_1979<span class="ot">=</span><span class="fu">ts</span>(lung_ts[<span class="dv">61</span><span class="sc">:</span><span class="dv">72</span>],<span class="at">start=</span><span class="dv">1</span>)</span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a>yr<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"lung"</span>,<span class="st">"_"</span>,<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a>xat<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-13"><a href="#cb432-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb432-14"><a href="#cb432-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-15"><a href="#cb432-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> yr) {<span class="fu">ts.plot</span>(<span class="fu">as.name</span>(i),<span class="at">main=</span>i,<span class="at">ylab=</span><span class="st">"Deaths by lung diseases"</span>)</span>
<span id="cb432-16"><a href="#cb432-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co">#각 년도별 계절성을 비교하기 위해서 이런식으로 그래프를 연도별로 쪼개서 그렸다. 연도별로 그러한 경향성이 비슷하게 드러나고 있는 것으로 보인다.</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ghibli"</span>)</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>pal<span class="ot">=</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>,<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#4C413FFF" "#5A6F80FF" "#278B9AFF" "#E75B64FF" "#DE7862FF" "#D8AF39FF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_1974,<span class="at">main=</span><span class="st">"Deaths by lung diseases"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">4000</span>))</span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb435-6"><a href="#cb435-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1975,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb435-7"><a href="#cb435-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1976,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb435-8"><a href="#cb435-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1977,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb435-9"><a href="#cb435-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1978,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb435-10"><a href="#cb435-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1979,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb435-11"><a href="#cb435-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-12"><a href="#cb435-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">4000</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb435-13"><a href="#cb435-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체데이터와 월별데이터에 평활을 진행하고자 한다. 평활법은 교수님께서 추천하셨던 3RSSH Twice, 4253H Twice에 더해 Hanning이 이루어지기 전 평활법인 3RS3R Twice를 추가하고자 한다.</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3RSSH Twice</span></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>smooth_3RSSH<span class="ot">=</span><span class="cf">function</span>(data){</span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>  smooth3RSS<span class="ot">=</span><span class="fu">smooth</span>(data, <span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(data)</span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>  smooth3RSSH<span class="ot">=</span>smooth3RSS</span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {smooth3RSSH[i] <span class="ot">&lt;-</span> smooth3RSS[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a>  smooth3RSSH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS[<span class="dv">1</span>]; smooth3RSSH[n] <span class="ot">&lt;-</span> smooth3RSS[n]</span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a>  rough<span class="ot">=</span>data<span class="sc">-</span>smooth3RSSH</span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a>  roughH<span class="ot">=</span>rough</span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a>  smooth3RSS2<span class="ot">=</span><span class="fu">smooth</span>(rough,<span class="at">kind=</span><span class="st">"3RSS"</span>)</span>
<span id="cb436-17"><a href="#cb436-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb436-18"><a href="#cb436-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)) roughH[i] <span class="ot">&lt;-</span> smooth3RSS2[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> smooth3RSS2[i]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> smooth3RSS2[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb436-19"><a href="#cb436-19" aria-hidden="true" tabindex="-1"></a>  roughH[<span class="dv">1</span>] <span class="ot">&lt;-</span> smooth3RSS2[<span class="dv">1</span>]; roughH[n] <span class="ot">&lt;-</span> smooth3RSS2[n]</span>
<span id="cb436-20"><a href="#cb436-20" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span>smooth3RSSH<span class="sc">+</span>roughH</span>
<span id="cb436-21"><a href="#cb436-21" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">as.vector</span>(out)</span>
<span id="cb436-22"><a href="#cb436-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb436-23"><a href="#cb436-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb436-24"><a href="#cb436-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-25"><a href="#cb436-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sleekts)</span>
<span id="cb436-26"><a href="#cb436-26" aria-hidden="true" tabindex="-1"></a>pal2<span class="ot">=</span><span class="fu">as.vector</span>(<span class="fu">ghibli_palette</span>(<span class="st">"MononokeMedium"</span>)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span>
<span id="cb436-27"><a href="#cb436-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_ts,<span class="at">main=</span><span class="st">"Raw Data:All"</span>,<span class="at">ylab=</span><span class="st">"# of deaths"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span>pal2[<span class="dv">1</span>])</span>
<span id="cb436-28"><a href="#cb436-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_ts, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb436-29"><a href="#cb436-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_ts),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb436-30"><a href="#cb436-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_ts),<span class="at">frequency =</span> <span class="dv">12</span>,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1974</span>,<span class="dv">1</span>),<span class="at">end=</span><span class="fu">c</span>(<span class="dv">1979</span>,<span class="dv">12</span>)),<span class="at">col=</span>pal2[<span class="dv">4</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb436-31"><a href="#cb436-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-32"><a href="#cb436-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span><span class="dv">1974</span>, <span class="at">y =</span> <span class="dv">3900</span>, <span class="fu">c</span>(<span class="st">"Default"</span>, <span class="st">"3RS3R Twice"</span>, <span class="st">"3RSSH Twice"</span>,<span class="st">"4253H Twice"</span>), </span>
<span id="cb436-33"><a href="#cb436-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> pal2,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-14.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co">#평활법을 적용하여 확인할 경우 원 자료에 비해 최댓값과 최솟값의 폭이 많이 줄어들었음을 확인할 수 있다. 작은 값에서는 크게 변화가 없지만 값이 큰 자료들의 경우 많이 깎여나갔다.</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="co">#시계열을 확인하는데 있어서 그 계절성을 확인하기 좋은 형태로 평활이 된 것은 사실이지만, 위에서 언급한 1976, 1979년도의 특이값이 사라지게 되었고 그 특이값을 해석하는데 있어서 주의를 기울여야 할 것으로 보인다. 3RS3R Twice 기법의 경우 Hanning이 진행되지 않았기 때문에 다소 각진 부분이 남아있지만, 전반적으로 계절성이 나타나는 형태로 데이터를 변화시켰다. 나머지 Hanning을 사용한 2가지 평활법의 차이를 분석하면 4253H방법에서 큰 값들의 감소폭이 크게 나타나고 있다. 3가지 평활법의 양 끝자료의 경우 실제 존재하는 데이터를 가지고 만든 것이 아니기 때문에 그 추세를 해석하는데 있어서 용이하지만 실제 데이터와 차이가 있으므로 해석에 유의해야 할 것이다.</span></span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 앞에서 시계열 Decompose를 통해서 그렸던 계절성 그래프의 모양과 4253H Twice의 그래프가 상당히 유사한 것으로 보인다. 1년을 주기로 폐질환 사망자수가 Fluctuate 하고 있는데 겨울철에 전반적으로 증가하고 여름철에 감소하는 경향성을 가지는 것이 확인된다. 각 주기는 거의 대칭적으로 증감을 반복하고 있으며 1976, 1977년도를 제외하면 사망건수는 거의 비슷하게 유지 되는 것을 확인할 수 있다. 따라서 시계열 자료를 해석할 때 1976년도와 1977년도 자료는 유의해서 해석해야 할 것으로 보인다.</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw Data</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(lung_1974,<span class="at">main=</span><span class="st">"Deaths by lung diseases"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">4000</span>))</span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1975,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1976,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1977,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1978,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lung_1979,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb437-13"><a href="#cb437-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">4000</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb437-14"><a href="#cb437-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-15.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 3RS3R Twice</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1974, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"3RS3R TwicC: Deaths by lung diseases"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">4000</span>))</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1975, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1976, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1977, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1978, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth</span>(lung_1979, <span class="at">kind=</span><span class="st">"3RS3R"</span>,<span class="at">twiceit=</span>T),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">4000</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-16.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 3RSSH Twice</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1974),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"3RSSH TwicC: Deaths by lung diseases"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">4000</span>))</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1975),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1976),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1977),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1978),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">smooth_3RSSH</span>(lung_1979),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">4000</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-17.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 4253H Twice</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1974),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">main=</span><span class="st">"4253H TwicC: Deaths by lung diseases"</span>,<span class="at">xlab=</span><span class="st">"Month"</span>,<span class="at">ylab=</span><span class="st">"# of Deaths"</span>,<span class="at">col=</span>pal[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">4000</span>))</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>xat)</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1975),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">2</span>])</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1976),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">3</span>])</span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1977),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">4</span>])</span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1978),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">5</span>])</span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(<span class="fu">sleek</span>(lung_1979),<span class="at">start=</span><span class="dv">1</span>, <span class="at">end=</span><span class="dv">12</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>pal[<span class="dv">6</span>])</span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">4000</span>, <span class="fu">c</span>(<span class="dv">1974</span><span class="sc">:</span><span class="dv">1979</span>), </span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>)),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="fu">as.character</span>(pal)),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-18.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 원자료 --&gt; 3RS3R Twice --&gt; 3RSSH Twice--&gt; 4253H Twice순으로 시계열의 추세가 유사해지고 있는것을 확인할 수 있다.</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hanning을 사용하여 3RSSH Twice, 4253H Twice는 평평한 구간 없이 부드럽게 넘어가고 있으며 1976,1979년도 평활법을 통해서 최대값이 줄어들어 다른 년도와 유사한 계절성을 확인할 수 있게 되었다.</span></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 다만 4253H Twice 방법보다는 3RSSH Twice 방법이 더 적절한 것으로 보인다. 왜냐하면 11월~12월의 값이 서로 같게 나타나고 있기 때문이다. </span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(lung_ts, <span class="at">nlag =</span> <span class="cn">NULL</span>, <span class="at">output =</span> <span class="cn">TRUE</span>) <span class="co"># p-value&lt;=0.01 귀무가설을 기각하여 정상시계열</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Augmented Dickey-Fuller Test 
alternative: stationary 
 
Type 1: no drift no trend 
     lag    ADF p.value
[1,]   0 -0.922   0.347
[2,]   1 -0.938   0.341
[3,]   2 -1.067   0.295
[4,]   3 -0.926   0.345
Type 2: with drift no trend 
     lag   ADF p.value
[1,]   0 -3.12  0.0328
[2,]   1 -4.71  0.0100
[3,]   2 -5.93  0.0100
[4,]   3 -6.96  0.0100
Type 3: with drift and trend 
     lag   ADF p.value
[1,]   0 -3.02   0.159
[2,]   1 -4.67   0.010
[3,]   2 -5.85   0.010
[4,]   3 -6.89   0.010
---- 
Note: in fact, p.value = 0.01 means p.value &lt;= 0.01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lung_ts)</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(fit, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">95</span>), <span class="at">h=</span><span class="dv">12</span>),<span class="at">col=</span><span class="st">'black'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-11-19.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다음 1년간의 변화를 예측할 경우 이전의 자료들과 비슷한 추세를 가지고 있는 것이 확인되어 진다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-5" class="level1">
<h1>6.</h1>
<p>헬멧의 충돌 실험에서 충돌 이후 머리의 가속(g)과 시간의 경과(milliseconds)에 대한 자료이다. 자료를 평활하고 특징을 설명하여라. [HELMETS.DAT]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>helmet<span class="ot">=</span>(<span class="fu">read.delim</span>(<span class="st">"C:/r/HELMETS.DAT"</span>,<span class="at">header=</span>F,))</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>h1<span class="ot">=</span>helmet[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(h1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"imptime"</span>,<span class="st">"accel"</span>)</span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>h2<span class="ot">=</span>helmet[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(h2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"imptime"</span>,<span class="st">"accel"</span>)</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a>h3<span class="ot">=</span>helmet[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(h3)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"imptime"</span>,<span class="st">"accel"</span>)</span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a>helmet<span class="ot">=</span><span class="fu">rbind</span>(h1,h2,h3)</span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(helmet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 135   2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(helmet<span class="sc">$</span>accel<span class="sc">~</span>helmet<span class="sc">$</span>imptime,<span class="at">main=</span><span class="st">"scatter plot of impact time and head"</span>) <span class="co"># 두 좌표간의 관계를 보면 곡선의 관계를 띄고 있는 것을 확인할 수 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치와 outlier의 존재여부를 체크하고자 한다.</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(helmet, <span class="at">main=</span><span class="st">"Helmet"</span>)  <span class="co"># Outlier는 없다. 충돌 후 시간의 경우 median이 lower hinge쪽으로 기울어 있고, 머리의 가속의 경우 median이 upper hinge쪽으로 기울어 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(helmet)) <span class="co"># 결측치 각각 두개씩</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>imptime   accel 
      2       2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>helmet<span class="ot">=</span>helmet[<span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(helmet)[,<span class="dv">1</span>]<span class="sc">==</span>F<span class="sc">|!</span><span class="fu">is.na</span>(helmet)[,<span class="dv">2</span>]<span class="sc">==</span>F,F,T),]</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(helmet,<span class="dv">5</span>) <span class="co"># 결측치 제거 후 분석 시작</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  imptime accel
1     2.4   0.0
2     2.6  -1.3
3     3.2  -2.7
4     3.6   0.0
5     4.0  -2.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(helmet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 133   2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(helmet)</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imptime) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2.40   15.60   23.40   25.18   34.80   57.60 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(accel) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-134.00  -54.90  -13.30  -25.55    0.00   75.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Steam and leaf plot을 활용해서 자료의 분포를 예측해보고자 했다.</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(imptime,<span class="dv">1</span>) <span class="co"># stem 1을 기준으로 skewed 된 종모양</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

  0 | 23344
  0 | 6778899
  1 | 000111344
  1 | 5555555555566666666666777788888899999
  2 | 000112233444
  2 | 55555666667777888899
  3 | 011223344
  3 | 555566668899
  4 | 0022233344
  4 | 57889
  5 | 123
  5 | 5558</code></pre>
</div>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(accel,<span class="fl">0.5</span>) <span class="co"># stem -0을 기준으로 skewed 종모양</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the right of the |

  -12 | 49733333
  -10 | 83387422
   -8 | 9516620
   -6 | 8221642
   -4 | 9855441116430
   -2 | 882777433222222
   -0 | 76665533311955555533333333333333311111
    0 | 000000014580111111256
    2 | 3912568
    4 | 677785
    6 | 055</code></pre>
</div>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co">#skewness</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(imptime) <span class="co">#Skewed to the right되어 있음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(accel) <span class="co">#Skewed to the left되어 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5154827</code></pre>
</div>
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># letter value display</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://mgimond.github.io/ES218/es218.R"</span>)</span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd13=</span><span class="fu">lsum</span>(imptime,<span class="dv">9</span>)) <span class="co"># mid 값이 점차 커지는 중</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth lower  mid upper spread
1      M  67.0  23.4 23.4  23.4    0.0
2      H  34.0  15.6 25.2  34.8   19.2
3      E  17.5  11.2 26.9  42.6   31.4
4      D   9.0   7.8 27.8  47.8   40.0
5      C   5.0   4.0 28.6  53.2   49.2
6      B   3.0   3.2 29.1  55.0   51.8
7      A   2.0   2.6 29.0  55.4   52.8
8      Z   1.5   2.5 29.5  56.5   54.0
9      Y   1.0   2.4 30.0  57.6   55.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">lvd14=</span><span class="fu">lsum</span>(accel,<span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  letter depth   lower     mid  upper spread
1      M  67.0  -13.30 -13.300 -13.30   0.00
2      H  34.0  -54.90 -27.450   0.00  54.90
3      E  17.5  -97.10 -40.875  15.35 112.45
4      D   9.0 -117.90 -36.150  45.60 163.50
5      C   5.0 -123.10 -37.450  48.20 171.30
6      B   3.0 -127.20 -28.800  69.60 196.80
7      A   2.0 -128.50 -26.750  75.00 203.50
8      Z   1.5 -131.25 -28.125  75.00 206.25
9      Y   1.0 -134.00 -29.500  75.00 209.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kurtosis (E-spread) / (H-spread) - 1.705</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>(lvd13[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd13[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd13[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd13[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># less peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.06958333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>(lvd14[<span class="dv">3</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd14[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span>(lvd14[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd14[<span class="dv">2</span>,<span class="dv">3</span>])<span class="sc">-</span><span class="fl">1.705</span> <span class="co"># more peaked than normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3432696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H-Spread</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a>(lvd13[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd13[<span class="dv">2</span>,<span class="dv">3</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>(lvd14[<span class="dv">2</span>,<span class="dv">5</span>]<span class="sc">-</span>lvd14[<span class="dv">2</span>,<span class="dv">3</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료들이 정규성 따르냐?</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(imptime, <span class="at">ylab=</span><span class="st">"Impact Time Quantiles"</span>);<span class="fu">qqline</span>(imptime, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 자료들이 정규분포를 잘 따르고 있는 것으로 보인다. (꼬리부분에서 다소 벗어나 보이나)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(accel, <span class="at">ylab=</span><span class="st">"Head Acceleration Quantiles"</span>);<span class="fu">qqline</span>(accel, <span class="at">col=</span><span class="st">'red'</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># 자료들이 qqline을 잘 따르기 보다는 역s자 곡선의 형태를 띄고 있는 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 분석이 아니라 산점도 평활법을 적용해 분석을 진행해보고자 한다. </span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(helmet<span class="sc">$</span>accel<span class="sc">~</span>helmet<span class="sc">$</span>imptime,<span class="at">main=</span><span class="st">"scatter plot of impact time and head acceleration"</span>)</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(accel<span class="sc">~</span>imptime,<span class="at">f=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">col =</span> <span class="st">"Red"</span>)</span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(accel<span class="sc">~</span>imptime,<span class="at">f=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(accel<span class="sc">~</span>imptime,<span class="at">f=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">3</span>, <span class="dv">75</span>, <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"f = "</span>, <span class="fu">c</span>(<span class="st">"2/3"</span>, <span class="st">"1/2"</span>,<span class="st">"1/3"</span>))), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"darkgreen"</span>), <span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f=1/3일때 가장 이상적으로 보인다.</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals with the default span f = 2/3</span></span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> helmet<span class="sc">$</span>accel <span class="sc">-</span> <span class="fu">lowess</span>(helmet)<span class="sc">$</span>y</span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals <span class="sc">~</span> helmet<span class="sc">$</span>imptime, <span class="at">main =</span> <span class="st">"Residuals with f = 2/3"</span>)</span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(helmet<span class="sc">$</span>imptime, residuals, <span class="at">f=</span><span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co">#여전히 잔차들이 경향성을 가지는 것으로 보인다.</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals with span f = 1/2</span></span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> helmet<span class="sc">$</span>accel <span class="sc">-</span> <span class="fu">lowess</span>(helmet,<span class="at">f=</span><span class="fl">0.5</span>)<span class="sc">$</span>y</span>
<span id="cb483-6"><a href="#cb483-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals <span class="sc">~</span> helmet<span class="sc">$</span>imptime, <span class="at">main =</span> <span class="st">"Residuals with f = 1/2"</span>)</span>
<span id="cb483-7"><a href="#cb483-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(helmet<span class="sc">$</span>imptime, residuals, <span class="at">f=</span><span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co">#여전히 잔차들이 경향성을 가지는 것으로 보인다.</span></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals with span f = 1/3</span></span>
<span id="cb484-4"><a href="#cb484-4" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> helmet<span class="sc">$</span>accel <span class="sc">-</span> <span class="fu">lowess</span>(helmet,<span class="at">f=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">$</span>y</span>
<span id="cb484-5"><a href="#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals <span class="sc">~</span> helmet<span class="sc">$</span>imptime, <span class="at">main =</span> <span class="st">"Residuals with f = 1/3"</span>)</span>
<span id="cb484-6"><a href="#cb484-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(helmet<span class="sc">$</span>imptime, residuals, <span class="at">f=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차들의 경향성이 완화되었다.</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(helmet, <span class="at">main =</span> <span class="st">"loess(cars)"</span>)</span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a>helmet.lo <span class="ot">&lt;-</span> <span class="fu">loess</span>(accel <span class="sc">~</span> imptime, helmet)</span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a>helmet.lo.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(helmet.lo, <span class="fu">data.frame</span>(<span class="at">imptime=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="at">length=</span><span class="dv">133</span>)), <span class="at">se=</span><span class="cn">TRUE</span>)</span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(helmet.lo.pred<span class="sc">$</span>fit <span class="sc">~</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="at">length=</span><span class="dv">133</span>), <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-6" class="level1">
<h1>7.</h1>
<p>어린 아이들의 나이별 평균 사용 단어 수이다. 분석하여라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a>age<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">2.5</span>,<span class="fl">3.0</span>,<span class="fl">3.5</span>,<span class="fl">4.0</span>,<span class="fl">4.5</span>,<span class="fl">5.0</span>,<span class="fl">6.0</span>)</span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a>words<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">22</span>,<span class="dv">272</span>,<span class="dv">446</span>,<span class="dv">896</span>,<span class="dv">1222</span>,<span class="dv">1540</span>,<span class="dv">1870</span>,<span class="dv">2072</span>,<span class="dv">2562</span>)</span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(words) <span class="co">#총 10개의 자료</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.125   3.250   3.300   4.375   6.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    3.0   315.5  1059.0  1090.5  1787.5  2562.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(age,<span class="at">main=</span><span class="st">"age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(words,<span class="at">main=</span><span class="st">"words"</span>) <span class="co">#outlier는 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>medage <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="dv">3</span>)</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a>medwords <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="dv">3</span>)</span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a>medage[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(age[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">na.rm=</span>T); medwords[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(words[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">na.rm=</span>T)</span>
<span id="cb494-4"><a href="#cb494-4" aria-hidden="true" tabindex="-1"></a>medage[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(age[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">na.rm=</span>T); medwords[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(words[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">na.rm=</span>T)</span>
<span id="cb494-5"><a href="#cb494-5" aria-hidden="true" tabindex="-1"></a>medage[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(age[<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>],<span class="at">na.rm=</span>T); medwords[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">median</span>(words[<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>],<span class="at">na.rm=</span>T)</span>
<span id="cb494-6"><a href="#cb494-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medwords <span class="sc">~</span> medage, <span class="at">type=</span><span class="st">"b"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형 관계로 나타나는 것을 확인할 수 있다. </span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(words,age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  words and age
t = 23.134, df = 8, p-value = 1.294e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9678822 0.9983153
sample estimates:
      cor 
0.9926087 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>lmfit<span class="ot">=</span><span class="fu">lm</span>(words<span class="sc">~</span>age)</span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>lmfit2<span class="ot">=</span><span class="fu">lm</span>(words<span class="sc">~</span>age<span class="sc">+</span><span class="dv">0</span>)</span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit) <span class="co">#단순회귀에서는 상관계수/회귀값 모두 두 변수가 상관정도가 높게 나타나고 있다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = words ~ age)

Residuals:
     Min       1Q   Median       3Q      Max 
-194.959  -54.200   -3.404   48.670  204.931 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -763.86      88.25  -8.656 2.47e-05 ***
age           561.93      24.29  23.134 1.29e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 116.7 on 8 degrees of freedom
Multiple R-squared:  0.9853,    Adjusted R-squared:  0.9834 
F-statistic: 535.2 on 1 and 8 DF,  p-value: 1.294e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 나이가 한살 많아질수록 알고 있는 단어의 수는 561.93개로 나타남. </span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmfit2) <span class="co">#모르는 단어가 음수일 수는 없기 때문에 절편을 원점으로 고정하고 회귀분석을 진행할 경우 나이 한살이 많아질 수록 370.96개의 단어를 추가적으로 알 것이다라고 추론 할 수 있다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = words ~ age + 0)

Residuals:
   Min     1Q Median     3Q    Max 
-534.4 -444.4 -146.6  164.5  336.2 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
age   370.96      30.84   12.03 7.55e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 354.4 on 9 degrees of freedom
Multiple R-squared:  0.9414,    Adjusted R-squared:  0.9349 
F-statistic: 144.7 on 1 and 9 DF,  p-value: 7.551e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(words<span class="sc">~</span>age,<span class="at">main=</span><span class="st">"linearity of words ~ age"</span>)</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a>(z5<span class="ot">&lt;-</span><span class="fu">line</span>(<span class="at">x=</span>age,<span class="at">y=</span>words))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
line(x = age, y = words)

Coefficients:
[1]  -917   608</code></pre>
</div>
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(z5))</span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a>z5.ls <span class="ot">&lt;-</span> <span class="fu">lm</span>(words<span class="sc">~</span>age)</span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(z5.ls<span class="sc">$</span>coef, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">2300</span>, <span class="fu">c</span>(<span class="st">"R - Line"</span>, <span class="st">"Regression"</span>), </span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>),<span class="at">cex=</span><span class="fl">0.7</span>)       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(z5) <span class="sc">~</span> <span class="fu">fitted</span>(z5), <span class="at">main =</span> <span class="st">"Residual plot by rline"</span>) </span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1살에서의 단어의 수를 제외하면 대부분의 데이터들이 0 근처에 있는 것이 확인되어 진다.</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(z5))</span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(z5))<span class="sc">$</span>out <span class="co">#lower fence 밖의 oulier -169, upper fence 밖의 outlier 312</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  312 -169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(<span class="fu">residuals</span>(z5)) <span class="co"># Outlier 재확인 가능</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 2 digit(s) to the right of the |

  -1 | 76
  -0 | 531
   0 | 1335
   1 | 
   2 | 
   3 | 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(z5)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 158081</code></pre>
</div>
</div>
</section>
<section id="section-7" class="level1">
<h1>8.</h1>
<p>다음 자료는 권투선수 Mike Tyson과 Frank Bruno의 1989년 World Heavyweight Championship match의 자료이다. 타이슨이 이겼다. connected는 펀치를 정확히 맞힌 것이다. 누가 펀치를 많이 날렸는지? 누가 정확히 맞혔는지? 누가 잽(작은 펀치)을 많이 했는지? 누가 파워펀치를 많이 했는지? 등등을 분석하여 보아라.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>tyson<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">43</span>,<span class="dv">39</span>,<span class="dv">28</span>,<span class="dv">37</span>,<span class="dv">55</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">34</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">13</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">37</span>,<span class="dv">30</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">47</span>,<span class="dv">13</span>,<span class="dv">13</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">31</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">7</span>,<span class="at">byrow=</span>T))</span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tyson)<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tyson)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Total punches"</span>,<span class="st">"Punches connected"</span>,<span class="st">"Jabs thrown"</span>,<span class="st">"Jabs conneted"</span>,<span class="st">"Power punches"</span>,<span class="st">"Power connected"</span>,<span class="st">"Knockdowns"</span>)</span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a>tyson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   1  2  3  4  5
Total punches     43 39 28 37 55
Punches connected 13 14 13 15 34
Jabs thrown        6  9  5 13  8
Jabs conneted      0  1  1  3  3
Power punches     37 30 23 24 47
Power connected   13 13 12 12 31
Knockdowns         1  0  0  0  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>bruno<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">42</span>,<span class="dv">35</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">14</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">14</span>,<span class="dv">24</span>,<span class="dv">16</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">41</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">7</span>,<span class="at">byrow=</span>T))           </span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bruno)<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>              </span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bruno)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Total punches"</span>,<span class="st">"Punches connected"</span>,<span class="st">"Jabs thrown"</span>,<span class="st">"Jabs conneted"</span>,<span class="st">"Power punches"</span>,<span class="st">"Power connected"</span>,<span class="st">"Knockdowns"</span>)                   </span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a>bruno   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   1  2  3  4  5
Total punches     55 42 35 18 20
Punches connected 14  8  5  3  7
Jabs thrown       14 24 16  8  6
Jabs conneted      2  1  0  0  1
Power punches     41 18 19 10 14
Power connected   12  7  5  3  6
Knockdowns         0  0  0  0  0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ghibli)</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>pal<span class="ot">=</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>,<span class="dv">5</span>)</span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(tyson,<span class="at">col=</span>pal,<span class="at">main=</span><span class="st">"mosaic plot of tyson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(bruno,<span class="at">col=</span>pal,<span class="at">main=</span><span class="st">"mosaic plot of bruno"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Punch</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># connected는 펀치를 정확히 맞힌 것이다. </span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 펀치를 많이 했는지         </span></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a>totalpunch<span class="ot">=</span><span class="fu">rbind</span>(tyson[<span class="dv">1</span>,],bruno[<span class="dv">1</span>,])</span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(totalpunch)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>)</span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a>totalpunch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1  2  3  4  5
tyson 43 39 28 37 55
bruno 55 42 35 18 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(totalpunch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  totalpunch
X-squared = 22.67, df = 4, p-value = 0.0001473</code></pre>
</div>
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Null hypothesis (H0): the row and the column variables of the contingency table are independent.</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative hypothesis (H1): row and column variables are dependent</span></span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서, tyson의 round별 파워펀치 수와 bruno의 round별 파워펀치 수는 차이가 있다.</span></span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a>totalpunch_polished<span class="ot">=</span><span class="fu">medpolish</span>(totalpunch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 80
2: 73
Final: 73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>totalpunch_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "totalpunch")

Overall: 37.5

Row Effects:
tyson bruno 
 -1.5   1.5 

Column Effects:
    1     2     3     4     5 
 11.5   3.0  -6.0 -10.0   0.0 

Residuals:
         1 2  3   4   5
tyson -4.5 0 -2  11  19
bruno  4.5 0  2 -11 -19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpunch_polished<span class="sc">$</span>col) <span class="co"># 1라운드에서 펀치가 가장 많고 4라운드에서 펀치가 적다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpunch_polished<span class="sc">$</span>row) <span class="co"># Bruno가 Tyson에 비해 펀치를 많이 한 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpunch_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>totalpunch2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>),totalpunch)</span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>totalpunch2<span class="ot">=</span><span class="fu">melt</span>(totalpunch2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson", "bruno") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(totalpunch2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a>totalpunch2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   player round value
1   tyson     1    43
2   bruno     1    55
3   tyson     2    39
4   bruno     2    42
5   tyson     3    28
6   bruno     3    35
7   tyson     4    37
8   bruno     4    18
9   tyson     5    55
10  bruno     5    20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>player, <span class="at">data=</span>totalpunch2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#평균적으로 bruno가 펀치의 횟수가 많았다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  player value.mean value.sum value.min value.max
1  bruno       34.0       170        18        55
2  tyson       40.4       202        28        55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>round, <span class="at">data=</span>totalpunch2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#라운드별로 보았을 때에는 1라운드에서 펀치횟수가 가장 많고 4라운드에서 펀치횟수가 가장 적다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  round value.mean value.sum value.min value.max
1     1       49.0        98        43        55
2     2       40.5        81        39        42
3     3       31.5        63        28        35
4     4       27.5        55        18        37
5     5       37.5        75        20        55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalpunch2,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(round),<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">fill=</span><span class="fu">rep</span>(pal,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> player, <span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>value), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb536-6"><a href="#cb536-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb536-7"><a href="#cb536-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Punch Comparison"</span>)<span class="sc">+</span></span>
<span id="cb536-8"><a href="#cb536-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb536-9"><a href="#cb536-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalpunch2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> value),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Punch Comparison"</span>)<span class="sc">+</span></span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a>aov10<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>player<span class="sc">+</span>round,<span class="at">data=</span>totalpunch2)</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
player       1  102.4   102.4   0.517  0.512
round        4  553.6   138.4   0.699  0.631
Residuals    4  791.6   197.9               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov10, <span class="st">"round"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov10 ~ "round"

HSD Test for value 

Mean Square Error:  197.9 

round,  means

  value       std r Min Max
1  49.0  8.485281 2  43  55
2  40.5  2.121320 2  39  42
3  31.5  4.949747 2  28  35
4  27.5 13.435029 2  18  37
5  37.5 24.748737 2  20  55

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 6.287027 

Minimun Significant Difference: 62.53933 

Treatments with the same letter are not significantly different.

  value groups
1  49.0      a
2  40.5      a
5  37.5      a
3  31.5      a
4  27.5      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov10, <span class="st">"player"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov10 ~ "player"

HSD Test for value 

Mean Square Error:  197.9 

player,  means

      value       std r Min Max
bruno  34.0 15.475788 5  18  55
tyson  40.4  9.838699 5  28  55

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 3.926503 

Minimun Significant Difference: 24.70267 

Treatments with the same letter are not significantly different.

      value groups
tyson  40.4      a
bruno  34.0      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(twoway)</span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="fu">twoway</span>(totalpunch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean decomposition (Dataset: "totalpunch"; Response: Value)
Residuals bordered by row effects, column effects, and overall

         1     2     3     4     5       roweff
       + ----- ----- ----- ----- ----- + ----- 
tyson  |  -9.2  -4.7  -6.7   6.3  14.3 :   3.2 
bruno  |   9.2   4.7   6.7  -6.3 -14.3 :  -3.2 
       + ..... ..... ..... ..... ..... + ..... 
coleff |  11.8   3.3  -5.7  -9.7   0.3 :  37.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">twoway</span>(totalpunch))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 정확히 맞혔는지? </span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a>punch_accu<span class="ot">=</span><span class="fu">cbind</span>((tyson[<span class="dv">2</span>,]<span class="sc">/</span>tyson[<span class="dv">1</span>,]),<span class="fu">sum</span>(tyson[<span class="dv">2</span>,])<span class="sc">/</span><span class="fu">sum</span>(tyson[<span class="dv">1</span>,]))</span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(punch_accu)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb547-4"><a href="#cb547-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(punch_accu)<span class="ot">=</span><span class="st">"tyson_connect"</span></span>
<span id="cb547-5"><a href="#cb547-5" aria-hidden="true" tabindex="-1"></a>punch_accu<span class="ot">=</span><span class="fu">round</span>(punch_accu<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb547-6"><a href="#cb547-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-7"><a href="#cb547-7" aria-hidden="true" tabindex="-1"></a>punch_accu1<span class="ot">=</span><span class="fu">cbind</span>((bruno[<span class="dv">2</span>,]<span class="sc">/</span>bruno[<span class="dv">1</span>,]),<span class="fu">sum</span>(bruno[<span class="dv">2</span>,])<span class="sc">/</span><span class="fu">sum</span>(bruno[<span class="dv">1</span>,]))</span>
<span id="cb547-8"><a href="#cb547-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(punch_accu1)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb547-9"><a href="#cb547-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(punch_accu1)<span class="ot">=</span><span class="st">"bruno_connect"</span></span>
<span id="cb547-10"><a href="#cb547-10" aria-hidden="true" tabindex="-1"></a>punch_accu1<span class="ot">=</span><span class="fu">round</span>(punch_accu1<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb547-11"><a href="#cb547-11" aria-hidden="true" tabindex="-1"></a>punch_accu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1     2     3     4  5 total
bruno_connect 25.45 19.05 14.29 16.67 35 21.76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a>connect_prob<span class="ot">=</span><span class="fu">rbind</span>(punch_accu,punch_accu1)</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>connect_prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1     2     3     4     5 total
tyson_connect 30.23 35.90 46.43 40.54 61.82 44.06
bruno_connect 25.45 19.05 14.29 16.67 35.00 21.76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.</span></span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Punch가 Connected될 비율은 모든 라운드에서 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. </span></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>connect_prob<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson_connect"</span>,<span class="st">"bruno_connect"</span>),connect_prob)</span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a>connect_prob2<span class="ot">=</span><span class="fu">melt</span>(connect_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson_connect", "bruno_connect") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(connect_prob2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(connect_prob2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">"%2.1f"</span>, value),<span class="st">"%"</span>,<span class="at">sep=</span><span class="st">""</span>)),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Punch Connect Comparison"</span>)<span class="sc">+</span></span>
<span id="cb553-7"><a href="#cb553-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb553-8"><a href="#cb553-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value(prop(%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-16-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tyson이 bruno에 비해서 punch를 더 정확하게 하였다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Jab</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 잽(작은 펀치)을 많이 했는지? </span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a>totaljab<span class="ot">=</span><span class="fu">rbind</span>(tyson[<span class="dv">3</span>,],bruno[<span class="dv">3</span>,])</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(totaljab)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>)</span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a>totaljab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1  2  3  4 5
tyson  6  9  5 13 8
bruno 14 24 16  8 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(totaljab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  totaljab
X-squared = 11.259, df = 4, p-value = 0.0238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Null hypothesis (H0): the row and the column variables of the contingency table are independent.</span></span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative hypothesis (H1): row and column variables are dependent</span></span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서, tyson의 round별 jab수와 bruno의 round별 jab수는 차이가 있다.</span></span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true" tabindex="-1"></a>totaljab_polished<span class="ot">=</span><span class="fu">medpolish</span>(totaljab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 35
2: 33
Final: 33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>totaljab_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "totaljab")

Overall: 10.5

Row Effects:
tyson bruno 
   -4     4 

Column Effects:
   1    2    3    4    5 
-0.5  6.0  0.0  0.0 -3.5 

Residuals:
      1    2    3    4  5
tyson 0 -3.5 -1.5  6.5  5
bruno 0  3.5  1.5 -6.5 -5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totaljab_polished<span class="sc">$</span>col) <span class="co"># 2라운드에서 Jab이 가장 많고 5라운드에서 Jab이 적게 나타난다. (5라운드에서 punch가 많았던 것에 비교하면 약간의 차이를 보인다) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totaljab_polished<span class="sc">$</span>row) <span class="co"># Bruno가 Tyson에 비해 Jab을 많이 한 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totaljab_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>totaljab2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>),totaljab)</span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>totaljab2<span class="ot">=</span><span class="fu">melt</span>(totaljab2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson", "bruno") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(totaljab2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a>totaljab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   player round value
1   tyson     1     6
2   bruno     1    14
3   tyson     2     9
4   bruno     2    24
5   tyson     3     5
6   bruno     3    16
7   tyson     4    13
8   bruno     4     8
9   tyson     5     8
10  bruno     5     6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>player, <span class="at">data=</span>totaljab2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#평균적으로 Bruno가 잽을 많이 했다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  player value.mean value.sum value.min value.max
1  bruno       13.6        68         6        24
2  tyson        8.2        41         5        13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>round, <span class="at">data=</span>totaljab2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#라운드별로 보았을 때에는 2라운드에서 Jab이 가장 많고 5라운드에서 Jab이 가장 적다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  round value.mean value.sum value.min value.max
1     1       10.0        20         6        14
2     2       16.5        33         9        24
3     3       10.5        21         5        16
4     4       10.5        21         8        13
5     5        7.0        14         6         8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totaljab2,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(round),<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">fill=</span><span class="fu">rep</span>(pal,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> player, <span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb574-4"><a href="#cb574-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>value), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb574-5"><a href="#cb574-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb574-6"><a href="#cb574-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Jab Comparison"</span>)<span class="sc">+</span></span>
<span id="cb574-7"><a href="#cb574-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb574-8"><a href="#cb574-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totaljab2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> value),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Jab Comparison"</span>)<span class="sc">+</span></span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a>aov11<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>player<span class="sc">+</span>round,<span class="at">data=</span>totaljab2)</span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
player       1   72.9   72.90   1.989  0.231
round        4   95.4   23.85   0.651  0.656
Residuals    4  146.6   36.65               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov11, <span class="st">"round"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov11 ~ "round"

HSD Test for value 

Mean Square Error:  36.65 

round,  means

  value       std r Min Max
1  10.0  5.656854 2   6  14
2  16.5 10.606602 2   9  24
3  10.5  7.778175 2   5  16
4  10.5  3.535534 2   8  13
5   7.0  1.414214 2   6   8

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 6.287027 

Minimun Significant Difference: 26.91332 

Treatments with the same letter are not significantly different.

  value groups
2  16.5      a
3  10.5      a
4  10.5      a
1  10.0      a
5   7.0      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb580"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov11, <span class="st">"player"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov11 ~ "player"

HSD Test for value 

Mean Square Error:  36.65 

player,  means

      value      std r Min Max
bruno  13.6 7.127412 5   6  24
tyson   8.2 3.114482 5   5  13

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 3.926503 

Minimun Significant Difference: 10.6306 

Treatments with the same letter are not significantly different.

      value groups
bruno  13.6      a
tyson   8.2      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(twoway)</span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">twoway</span>(totaljab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean decomposition (Dataset: "totaljab"; Response: Value)
Residuals bordered by row effects, column effects, and overall

         1    2    3    4    5      roweff
       + ---- ---- ---- ---- ---- + ----  
tyson  | -1.3 -4.8 -2.8  5.2  3.7 : -2.7  
bruno  |  1.3  4.8  2.8 -5.2 -3.7 :  2.7  
       + .... .... .... .... .... + ....  
coleff | -0.9  5.6 -0.4 -0.4 -3.9 : 10.9  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">twoway</span>(totaljab))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 정확히 맞혔는지? </span></span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a>jab_accu<span class="ot">=</span><span class="fu">cbind</span>((tyson[<span class="dv">4</span>,]<span class="sc">/</span>tyson[<span class="dv">3</span>,]),<span class="fu">sum</span>(tyson[<span class="dv">4</span>,])<span class="sc">/</span><span class="fu">sum</span>(tyson[<span class="dv">3</span>,]))</span>
<span id="cb585-3"><a href="#cb585-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(jab_accu)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb585-4"><a href="#cb585-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(jab_accu)<span class="ot">=</span><span class="st">"tyson_connect"</span></span>
<span id="cb585-5"><a href="#cb585-5" aria-hidden="true" tabindex="-1"></a>jab_accu<span class="ot">=</span><span class="fu">round</span>(jab_accu<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb585-6"><a href="#cb585-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-7"><a href="#cb585-7" aria-hidden="true" tabindex="-1"></a>jab_accu1<span class="ot">=</span><span class="fu">cbind</span>((bruno[<span class="dv">4</span>,]<span class="sc">/</span>bruno[<span class="dv">3</span>,]),<span class="fu">sum</span>(bruno[<span class="dv">4</span>,])<span class="sc">/</span><span class="fu">sum</span>(bruno[<span class="dv">3</span>,]))</span>
<span id="cb585-8"><a href="#cb585-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(jab_accu1)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb585-9"><a href="#cb585-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(jab_accu1)<span class="ot">=</span><span class="st">"bruno_connect"</span></span>
<span id="cb585-10"><a href="#cb585-10" aria-hidden="true" tabindex="-1"></a>jab_accu1<span class="ot">=</span><span class="fu">round</span>(jab_accu1<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb585-11"><a href="#cb585-11" aria-hidden="true" tabindex="-1"></a>jab_accu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1    2 3 4     5 total
bruno_connect 14.29 4.17 0 0 16.67  5.88</code></pre>
</div>
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a>jconnect_prob<span class="ot">=</span><span class="fu">rbind</span>(jab_accu,jab_accu1)</span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a>jconnect_prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1     2  3     4     5 total
tyson_connect  0.00 11.11 20 23.08 37.50 19.51
bruno_connect 14.29  4.17  0  0.00 16.67  5.88</code></pre>
</div>
<div class="sourceCode cell-code" id="cb589"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.</span></span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Punch의 Connected될 비율은 1라운드를 제외하면 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. </span></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-4"><a href="#cb589-4" aria-hidden="true" tabindex="-1"></a>jconnect_prob<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson_connect"</span>,<span class="st">"bruno_connect"</span>),jconnect_prob)</span>
<span id="cb589-5"><a href="#cb589-5" aria-hidden="true" tabindex="-1"></a>jconnect_prob2<span class="ot">=</span><span class="fu">melt</span>(jconnect_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson_connect", "bruno_connect") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(jconnect_prob2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jconnect_prob2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">"%2.1f"</span>, value),<span class="st">"%"</span>,<span class="at">sep=</span><span class="st">""</span>)),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb591-6"><a href="#cb591-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Jab Punch Connect Comparison"</span>)<span class="sc">+</span></span>
<span id="cb591-7"><a href="#cb591-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb591-8"><a href="#cb591-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value(prop(%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-17-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tyson이 bruno에 비해서 더 정확한 Jab 펀치를 하였다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>power punch</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb593"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 파워펀치를 많이 했는지         </span></span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true" tabindex="-1"></a>totalpower<span class="ot">=</span><span class="fu">rbind</span>(tyson[<span class="dv">5</span>,],bruno[<span class="dv">5</span>,])</span>
<span id="cb593-3"><a href="#cb593-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(totalpower)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>)</span>
<span id="cb593-4"><a href="#cb593-4" aria-hidden="true" tabindex="-1"></a>totalpower</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1  2  3  4  5
tyson 37 30 23 24 47
bruno 41 18 19 10 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(totalpower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  totalpower
X-squared = 14.708, df = 4, p-value = 0.005348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb597"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Null hypothesis (H0): the row and the column variables of the contingency table are independent.</span></span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative hypothesis (H1): row and column variables are dependent</span></span>
<span id="cb597-3"><a href="#cb597-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서, tyson의 round별 파워펀치 수와 bruno의 round별 파워펀치 수는 차이가 있다.</span></span>
<span id="cb597-4"><a href="#cb597-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-5"><a href="#cb597-5" aria-hidden="true" tabindex="-1"></a>totalpower_polished<span class="ot">=</span><span class="fu">medpolish</span>(totalpower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1: 47
Final: 47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a>totalpower_polished</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Median Polish Results (Dataset: "totalpower")

Overall: 24

Row Effects:
tyson bruno 
    6    -6 

Column Effects:
   1    2    3    4    5 
15.0  0.0 -3.0 -7.0  6.5 

Residuals:
       1 2  3  4     5
tyson -8 0 -4  1  10.5
bruno  8 0  4 -1 -10.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb601"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpower_polished<span class="sc">$</span>col) <span class="co"># 1라운드에서 파워펀치가 가장 많고 점점 줄다가 5라운드에서 다시 늘어남 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpower_polished<span class="sc">$</span>row) <span class="co"># Tyson이 Bruno에 비해 파워펀치를 많이 한 것으로 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb603"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(totalpower_polished<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb604"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a>totalpower2<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson"</span>,<span class="st">"bruno"</span>),totalpower)</span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true" tabindex="-1"></a>totalpower2<span class="ot">=</span><span class="fu">melt</span>(totalpower2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson", "bruno") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(totalpower2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a>totalpower2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   player round value
1   tyson     1    37
2   bruno     1    41
3   tyson     2    30
4   bruno     2    18
5   tyson     3    23
6   bruno     3    19
7   tyson     4    24
8   bruno     4    10
9   tyson     5    47
10  bruno     5    14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>player, <span class="at">data=</span>totalpower2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#평균적으로 tyson이 파워펀치가 많았다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  player value.mean value.sum value.min value.max
1  bruno       20.4       102        10        41
2  tyson       32.2       161        23        47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryBy</span>(value <span class="sc">~</span>round, <span class="at">data=</span>totalpower2, <span class="at">FUN =</span> <span class="fu">c</span>(mean,sum,min,max)) <span class="co">#라운드별로 보았을 때에는 1라운드에서 파워펀치가 가장 많고 4라운드에서 파워펀치가 가장 적다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  round value.mean value.sum value.min value.max
1     1       39.0        78        37        41
2     2       24.0        48        18        30
3     3       21.0        42        19        23
4     4       17.0        34        10        24
5     5       30.5        61        14        47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalpower2,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(round),<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">fill=</span><span class="fu">rep</span>(pal,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> player, <span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>value), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb612-5"><a href="#cb612-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb612-6"><a href="#cb612-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Power Punch Comparison"</span>)<span class="sc">+</span></span>
<span id="cb612-7"><a href="#cb612-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb612-8"><a href="#cb612-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalpower2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> value),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Total Power Punch Comparison"</span>)<span class="sc">+</span></span>
<span id="cb613-6"><a href="#cb613-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb613-7"><a href="#cb613-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb614"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a>aov12<span class="ot">=</span><span class="fu">aov</span>(value<span class="sc">~</span>player<span class="sc">+</span>round,<span class="at">data=</span>totalpower2)</span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
player       1  348.1   348.1   3.641  0.129
round        4  597.6   149.4   1.563  0.338
Residuals    4  382.4    95.6               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov12, <span class="st">"round"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov12 ~ "round"

HSD Test for value 

Mean Square Error:  95.6 

round,  means

  value       std r Min Max
1  39.0  2.828427 2  37  41
2  24.0  8.485281 2  18  30
3  21.0  2.828427 2  19  23
4  17.0  9.899495 2  10  24
5  30.5 23.334524 2  14  47

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 6.287027 

Minimun Significant Difference: 43.46696 

Treatments with the same letter are not significantly different.

  value groups
1  39.0      a
5  30.5      a
2  24.0      a
3  21.0      a
4  17.0      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb618"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(aov12, <span class="st">"player"</span>, <span class="at">group=</span>T,<span class="at">console=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: aov12 ~ "player"

HSD Test for value 

Mean Square Error:  95.6 

player,  means

      value       std r Min Max
bruno  20.4 12.054045 5  10  41
tyson  32.2  9.984989 5  23  47

Alpha: 0.05 ; DF Error: 4 
Critical Value of Studentized Range: 3.926503 

Minimun Significant Difference: 17.16919 

Treatments with the same letter are not significantly different.

      value groups
tyson  32.2      a
bruno  20.4      a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb620"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(twoway)</span>
<span id="cb620-2"><a href="#cb620-2" aria-hidden="true" tabindex="-1"></a><span class="fu">twoway</span>(totalpower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean decomposition (Dataset: "totalpower"; Response: Value)
Residuals bordered by row effects, column effects, and overall

         1     2     3     4     5       roweff
       + ----- ----- ----- ----- ----- + ----- 
tyson  |  -7.9   0.1  -3.9   1.1  10.6 :   5.9 
bruno  |   7.9  -0.1   3.9  -1.1 -10.6 :  -5.9 
       + ..... ..... ..... ..... ..... + ..... 
coleff |  12.7  -2.3  -5.3  -9.3   4.2 :  26.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb622"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">twoway</span>(totalpower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 누가 정확히 맞혔는지? </span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>power_accu<span class="ot">=</span><span class="fu">cbind</span>((tyson[<span class="dv">6</span>,]<span class="sc">/</span>tyson[<span class="dv">5</span>,]),<span class="fu">sum</span>(tyson[<span class="dv">6</span>,])<span class="sc">/</span><span class="fu">sum</span>(tyson[<span class="dv">5</span>,]))</span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(power_accu)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(power_accu)<span class="ot">=</span><span class="st">"tyson_connect"</span></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true" tabindex="-1"></a>power_accu<span class="ot">=</span><span class="fu">round</span>(power_accu<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb623-6"><a href="#cb623-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-7"><a href="#cb623-7" aria-hidden="true" tabindex="-1"></a>power_accu1<span class="ot">=</span><span class="fu">cbind</span>((bruno[<span class="dv">6</span>,]<span class="sc">/</span>bruno[<span class="dv">5</span>,]),<span class="fu">sum</span>(bruno[<span class="dv">6</span>,])<span class="sc">/</span><span class="fu">sum</span>(bruno[<span class="dv">5</span>,]))</span>
<span id="cb623-8"><a href="#cb623-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(power_accu1)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">"total"</span>)</span>
<span id="cb623-9"><a href="#cb623-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(power_accu1)<span class="ot">=</span><span class="st">"bruno_connect"</span></span>
<span id="cb623-10"><a href="#cb623-10" aria-hidden="true" tabindex="-1"></a>power_accu1<span class="ot">=</span><span class="fu">round</span>(power_accu1<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb623-11"><a href="#cb623-11" aria-hidden="true" tabindex="-1"></a>power_accu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1     2     3  4     5 total
bruno_connect 29.27 38.89 26.32 30 42.86 32.35</code></pre>
</div>
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a>pconnect_prob<span class="ot">=</span><span class="fu">rbind</span>(power_accu,power_accu1)</span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>pconnect_prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1     2     3  4     5 total
tyson_connect 35.14 43.33 52.17 50 65.96 50.31
bruno_connect 29.27 38.89 26.32 30 42.86 32.35</code></pre>
</div>
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.</span></span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Punch의 Connected될 비율은 1라운드를 제외하면 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. </span></span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-4"><a href="#cb627-4" aria-hidden="true" tabindex="-1"></a>pconnect_prob<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">"tyson_connect"</span>,<span class="st">"bruno_connect"</span>),pconnect_prob)</span>
<span id="cb627-5"><a href="#cb627-5" aria-hidden="true" tabindex="-1"></a>pconnect_prob2<span class="ot">=</span><span class="fu">melt</span>(pconnect_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using c("tyson_connect", "bruno_connect") as id variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pconnect_prob2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"player"</span>,<span class="st">"round"</span>,<span class="st">"value"</span>)</span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pconnect_prob2, <span class="fu">aes</span>(round, value, <span class="at">fill=</span>player))<span class="sc">+</span></span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)<span class="sc">+</span></span>
<span id="cb629-4"><a href="#cb629-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">"%2.1f"</span>, value),<span class="st">"%"</span>,<span class="at">sep=</span><span class="st">""</span>)),<span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="dv">3</span>,<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb629-5"><a href="#cb629-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb629-6"><a href="#cb629-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bruno &amp; Tyson Power Punch Connect Comparison"</span>)<span class="sc">+</span></span>
<span id="cb629-7"><a href="#cb629-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb629-8"><a href="#cb629-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"value(prop(%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA8_Final_files/figure-html/unnamed-chunk-18-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tyson이 bruno에 비해서 power punch를 더 정확하게 하였다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>