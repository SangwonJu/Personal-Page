<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.624">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangwon Ju, SNU GSPA">
<meta name="dcterms.date" content="2022-08-06">

<title>Sangwon Ju’s Personal Page - Textmining on SDG VNRs of ROK, Germany, Finland</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src=".././logo/policy.png" alt="">
    <span class="navbar-title">Sangwon Ju’s Personal Page</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">About Me</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">Research</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../research_interests.html">
 <span class="dropdown-text">Research Interests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication.html">
 <span class="dropdown-text">Publications / Working Papers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-analytics-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data Analytics Projects</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-analytics-projects">    
        <li class="dropdown-header">Evidence-Based Research Lab-PPM Projects</li>
        <li>
    <a class="dropdown-item" href="../data_analytics/Vnr_analysis.html">
 <span class="dropdown-text">Analysis of Sustainable Development Goals: Text-mining on Voluntary National Reviews</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Data Analytics for Public Data (2021 Fall)</li>
        <li>
    <a class="dropdown-item" href="../data_analytics/employees.html">
 <span class="dropdown-text">Analysis 1: Number of local government employees</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/unemployment_index.html">
 <span class="dropdown-text">Analysis 2: Seasonal disparities in unemployment index</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/FWA.html">
 <span class="dropdown-text">Analysis 3: Analysis of the FWA in public sector organizations using data mining techniques</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exploratory Data Analysis (2021 Spring) [in Korean]</li>
        <li>
    <a class="dropdown-item" href="../data_analytics/EDA7.html">
 <span class="dropdown-text">EDA Assignment 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_analytics/EDA8_Final.html">
 <span class="dropdown-text">EDA Assignment 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../CV.html">CV (as of July 2022)</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto: sangwon.ju@snu.ac.kr"><i class="bi bi-mailbox2" role="img" aria-label="E-mail">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SangwonJu"><i class="bi bi-github" role="img" aria-label="Github">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sangwon-ju-37a6b0216/"><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Textmining on SDG VNRs of ROK, Germany, Finland</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Evidence-Based Research Lab-PPM Projects</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/Vnr_analysis.html" class="sidebar-item-text sidebar-link active">Analysis of Sustainable Development Goals: Text-mining on Voluntary National Reviews</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Data Analytics for Public Data (2021 Fall)</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/employees.html" class="sidebar-item-text sidebar-link">Analysis 1: Number of local government employees</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/unemployment_index.html" class="sidebar-item-text sidebar-link">Analysis 2: Seasonal disparities in unemployment index</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/FWA.html" class="sidebar-item-text sidebar-link">Analysis 3: Analysis of the FWA in public sector organizations using data mining techniques</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Exploratory Data Analysis (2021 Spring) [in Korean]</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/EDA7.html" class="sidebar-item-text sidebar-link">EDA Assignment 7</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_analytics/EDA8_Final.html" class="sidebar-item-text sidebar-link">EDA Assignment 8</a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-package" id="toc-loading-package" class="nav-link active" data-scroll-target="#loading-package">Loading Package</a></li>
  <li><a href="#setting-working-directory" id="toc-setting-working-directory" class="nav-link" data-scroll-target="#setting-working-directory">Setting Working Directory</a></li>
  <li><a href="#korea-vnr" id="toc-korea-vnr" class="nav-link" data-scroll-target="#korea-vnr">Korea VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess" id="toc-preprocess" class="nav-link" data-scroll-target="#preprocess">Preprocess</a></li>
  <li><a href="#tokenizing-words" id="toc-tokenizing-words" class="nav-link" data-scroll-target="#tokenizing-words">Tokenizing words</a></li>
  <li><a href="#n-grams" id="toc-n-grams" class="nav-link" data-scroll-target="#n-grams">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis" id="toc-remove-inadequate-words-for-analysis" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table" id="toc-frequency-table" class="nav-link" data-scroll-target="#frequency-table">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph" id="toc-tf-idf-per-paragraph" class="nav-link" data-scroll-target="#tf-idf-per-paragraph">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling" id="toc-topic-modeling" class="nav-link" data-scroll-target="#topic-modeling">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set" id="toc-using-perplexity-for-hold-out-set" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6" id="toc-cast-lda-k6" class="nav-link" data-scroll-target="#cast-lda-k6">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph" id="toc-network-graph" class="nav-link" data-scroll-target="#network-graph">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count" id="toc-pairwise-count" class="nav-link" data-scroll-target="#pairwise-count">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes" id="toc-building-links-and-nodes" class="nav-link" data-scroll-target="#building-links-and-nodes">Building links and nodes</a></li>
  <li><a href="#building-networks" id="toc-building-networks" class="nav-link" data-scroll-target="#building-networks">Building networks</a></li>
  <li><a href="#network-graph-1" id="toc-network-graph-1" class="nav-link" data-scroll-target="#network-graph-1">Network Graph</a></li>
  <li><a href="#network-graph-per-topic" id="toc-network-graph-per-topic" class="nav-link" data-scroll-target="#network-graph-per-topic">Network Graph per topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#germany-vnr" id="toc-germany-vnr" class="nav-link" data-scroll-target="#germany-vnr">Germany VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-1" id="toc-preprocess-1" class="nav-link" data-scroll-target="#preprocess-1">Preprocess</a></li>
  <li><a href="#tokenizing-words-1" id="toc-tokenizing-words-1" class="nav-link" data-scroll-target="#tokenizing-words-1">Tokenizing words</a></li>
  <li><a href="#n-grams-1" id="toc-n-grams-1" class="nav-link" data-scroll-target="#n-grams-1">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-1" id="toc-remove-inadequate-words-for-analysis-1" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-1">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-1" id="toc-frequency-table-1" class="nav-link" data-scroll-target="#frequency-table-1">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-1" id="toc-tf-idf-per-paragraph-1" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-1">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-1" id="toc-topic-modeling-1" class="nav-link" data-scroll-target="#topic-modeling-1">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-1" id="toc-using-perplexity-for-hold-out-set-1" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-1">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-1" id="toc-cast-lda-k6-1" class="nav-link" data-scroll-target="#cast-lda-k6-1">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-2" id="toc-network-graph-2" class="nav-link" data-scroll-target="#network-graph-2">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-1" id="toc-pairwise-count-1" class="nav-link" data-scroll-target="#pairwise-count-1">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-1" id="toc-building-links-and-nodes-1" class="nav-link" data-scroll-target="#building-links-and-nodes-1">Building links and nodes</a></li>
  <li><a href="#building-networks-1" id="toc-building-networks-1" class="nav-link" data-scroll-target="#building-networks-1">Building networks</a></li>
  <li><a href="#network-graph-3" id="toc-network-graph-3" class="nav-link" data-scroll-target="#network-graph-3">Network Graph</a></li>
  <li><a href="#network-graph-per-topic-1" id="toc-network-graph-per-topic-1" class="nav-link" data-scroll-target="#network-graph-per-topic-1">Network Graph per topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#finland-vnr" id="toc-finland-vnr" class="nav-link" data-scroll-target="#finland-vnr">Finland VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-2" id="toc-preprocess-2" class="nav-link" data-scroll-target="#preprocess-2">Preprocess</a></li>
  <li><a href="#tokenizing-words-2" id="toc-tokenizing-words-2" class="nav-link" data-scroll-target="#tokenizing-words-2">Tokenizing words</a></li>
  <li><a href="#n-grams-2" id="toc-n-grams-2" class="nav-link" data-scroll-target="#n-grams-2">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-2" id="toc-remove-inadequate-words-for-analysis-2" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-2">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-2" id="toc-frequency-table-2" class="nav-link" data-scroll-target="#frequency-table-2">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-2" id="toc-tf-idf-per-paragraph-2" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-2">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-2" id="toc-topic-modeling-2" class="nav-link" data-scroll-target="#topic-modeling-2">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-2" id="toc-using-perplexity-for-hold-out-set-2" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-2">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-2" id="toc-cast-lda-k6-2" class="nav-link" data-scroll-target="#cast-lda-k6-2">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-4" id="toc-network-graph-4" class="nav-link" data-scroll-target="#network-graph-4">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-2" id="toc-pairwise-count-2" class="nav-link" data-scroll-target="#pairwise-count-2">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-2" id="toc-building-links-and-nodes-2" class="nav-link" data-scroll-target="#building-links-and-nodes-2">Building links and nodes</a></li>
  <li><a href="#building-networks-2" id="toc-building-networks-2" class="nav-link" data-scroll-target="#building-networks-2">Building networks</a></li>
  <li><a href="#network-graph-5" id="toc-network-graph-5" class="nav-link" data-scroll-target="#network-graph-5">Network Graph</a></li>
  <li><a href="#network-graph-per-topic-2" id="toc-network-graph-per-topic-2" class="nav-link" data-scroll-target="#network-graph-per-topic-2">Network Graph per topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#japan-vnr" id="toc-japan-vnr" class="nav-link" data-scroll-target="#japan-vnr">Japan VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-3" id="toc-preprocess-3" class="nav-link" data-scroll-target="#preprocess-3">Preprocess</a></li>
  <li><a href="#tokenizing-words-3" id="toc-tokenizing-words-3" class="nav-link" data-scroll-target="#tokenizing-words-3">Tokenizing words</a></li>
  <li><a href="#n-grams-3" id="toc-n-grams-3" class="nav-link" data-scroll-target="#n-grams-3">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-3" id="toc-remove-inadequate-words-for-analysis-3" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-3">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-3" id="toc-frequency-table-3" class="nav-link" data-scroll-target="#frequency-table-3">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-3" id="toc-tf-idf-per-paragraph-3" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-3">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-3" id="toc-topic-modeling-3" class="nav-link" data-scroll-target="#topic-modeling-3">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-3" id="toc-using-perplexity-for-hold-out-set-3" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-3">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k10" id="toc-cast-lda-k10" class="nav-link" data-scroll-target="#cast-lda-k10">Cast LDA (k=10)</a></li>
  </ul></li>
  <li><a href="#network-graph-6" id="toc-network-graph-6" class="nav-link" data-scroll-target="#network-graph-6">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-3" id="toc-pairwise-count-3" class="nav-link" data-scroll-target="#pairwise-count-3">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-3" id="toc-building-links-and-nodes-3" class="nav-link" data-scroll-target="#building-links-and-nodes-3">Building links and nodes</a></li>
  <li><a href="#building-networks-3" id="toc-building-networks-3" class="nav-link" data-scroll-target="#building-networks-3">Building networks</a></li>
  <li><a href="#network-graph-7" id="toc-network-graph-7" class="nav-link" data-scroll-target="#network-graph-7">Network Graph</a></li>
  <li><a href="#network-graph-per-topic-3" id="toc-network-graph-per-topic-3" class="nav-link" data-scroll-target="#network-graph-per-topic-3">Network Graph per topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#uk-vnr" id="toc-uk-vnr" class="nav-link" data-scroll-target="#uk-vnr">UK VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-4" id="toc-preprocess-4" class="nav-link" data-scroll-target="#preprocess-4">Preprocess</a></li>
  <li><a href="#tokenizing-words-4" id="toc-tokenizing-words-4" class="nav-link" data-scroll-target="#tokenizing-words-4">Tokenizing words</a></li>
  <li><a href="#n-grams-4" id="toc-n-grams-4" class="nav-link" data-scroll-target="#n-grams-4">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-4" id="toc-remove-inadequate-words-for-analysis-4" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-4">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-4" id="toc-frequency-table-4" class="nav-link" data-scroll-target="#frequency-table-4">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-4" id="toc-tf-idf-per-paragraph-4" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-4">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-4" id="toc-topic-modeling-4" class="nav-link" data-scroll-target="#topic-modeling-4">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-4" id="toc-using-perplexity-for-hold-out-set-4" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-4">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-3" id="toc-cast-lda-k6-3" class="nav-link" data-scroll-target="#cast-lda-k6-3">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-8" id="toc-network-graph-8" class="nav-link" data-scroll-target="#network-graph-8">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-4" id="toc-pairwise-count-4" class="nav-link" data-scroll-target="#pairwise-count-4">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-4" id="toc-building-links-and-nodes-4" class="nav-link" data-scroll-target="#building-links-and-nodes-4">Building links and nodes</a></li>
  <li><a href="#building-networks-4" id="toc-building-networks-4" class="nav-link" data-scroll-target="#building-networks-4">Building networks</a></li>
  <li><a href="#network-graph-9" id="toc-network-graph-9" class="nav-link" data-scroll-target="#network-graph-9">Network Graph</a></li>
  <li><a href="#network-graph-per-topic-4" id="toc-network-graph-per-topic-4" class="nav-link" data-scroll-target="#network-graph-per-topic-4">Network Graph per topic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#austrailia-vnr" id="toc-austrailia-vnr" class="nav-link" data-scroll-target="#austrailia-vnr">Austrailia VNR</a>
  <ul class="collapse">
  <li><a href="#preprocess-5" id="toc-preprocess-5" class="nav-link" data-scroll-target="#preprocess-5">Preprocess</a></li>
  <li><a href="#tokenizing-words-5" id="toc-tokenizing-words-5" class="nav-link" data-scroll-target="#tokenizing-words-5">Tokenizing words</a></li>
  <li><a href="#n-grams-5" id="toc-n-grams-5" class="nav-link" data-scroll-target="#n-grams-5">n-grams</a></li>
  <li><a href="#remove-inadequate-words-for-analysis-5" id="toc-remove-inadequate-words-for-analysis-5" class="nav-link" data-scroll-target="#remove-inadequate-words-for-analysis-5">Remove inadequate words for analysis</a></li>
  <li><a href="#frequency-table-5" id="toc-frequency-table-5" class="nav-link" data-scroll-target="#frequency-table-5">Frequency table</a></li>
  <li><a href="#tf-idf-per-paragraph-5" id="toc-tf-idf-per-paragraph-5" class="nav-link" data-scroll-target="#tf-idf-per-paragraph-5">TF-IDF per paragraph</a></li>
  <li><a href="#topic-modeling-5" id="toc-topic-modeling-5" class="nav-link" data-scroll-target="#topic-modeling-5">Topic modeling</a>
  <ul class="collapse">
  <li><a href="#using-perplexity-for-hold-out-set-5" id="toc-using-perplexity-for-hold-out-set-5" class="nav-link" data-scroll-target="#using-perplexity-for-hold-out-set-5">Using perplexity for hold out set</a></li>
  <li><a href="#cast-lda-k6-4" id="toc-cast-lda-k6-4" class="nav-link" data-scroll-target="#cast-lda-k6-4">Cast LDA (k=6)</a></li>
  </ul></li>
  <li><a href="#network-graph-10" id="toc-network-graph-10" class="nav-link" data-scroll-target="#network-graph-10">Network Graph</a>
  <ul class="collapse">
  <li><a href="#pairwise-count-5" id="toc-pairwise-count-5" class="nav-link" data-scroll-target="#pairwise-count-5">Pairwise Count</a></li>
  <li><a href="#building-links-and-nodes-5" id="toc-building-links-and-nodes-5" class="nav-link" data-scroll-target="#building-links-and-nodes-5">Building links and nodes</a></li>
  <li><a href="#building-networks-5" id="toc-building-networks-5" class="nav-link" data-scroll-target="#building-networks-5">Building networks</a></li>
  <li><a href="#network-graph-11" id="toc-network-graph-11" class="nav-link" data-scroll-target="#network-graph-11">Network Graph</a></li>
  <li><a href="#network-graph-per-topic-5" id="toc-network-graph-per-topic-5" class="nav-link" data-scroll-target="#network-graph-per-topic-5">Network Graph per topic</a></li>
  <li><a href="#simplify" id="toc-simplify" class="nav-link" data-scroll-target="#simplify">simplify?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparing-six-countries" id="toc-comparing-six-countries" class="nav-link" data-scroll-target="#comparing-six-countries">Comparing Six countries</a>
  <ul class="collapse">
  <li><a href="#comparing-word-frequencies-of-six-countries" id="toc-comparing-word-frequencies-of-six-countries" class="nav-link" data-scroll-target="#comparing-word-frequencies-of-six-countries">Comparing Word Frequencies of Six Countries</a></li>
  <li><a href="#comparing-bigrams-of-six-countries" id="toc-comparing-bigrams-of-six-countries" class="nav-link" data-scroll-target="#comparing-bigrams-of-six-countries">Comparing bigrams of Six Countries</a></li>
  <li><a href="#comparing-tf-idf-of-six-countries" id="toc-comparing-tf-idf-of-six-countries" class="nav-link" data-scroll-target="#comparing-tf-idf-of-six-countries">Comparing Tf-idf of Six Countries</a></li>
  <li><a href="#comparing-the-word-frequencies" id="toc-comparing-the-word-frequencies" class="nav-link" data-scroll-target="#comparing-the-word-frequencies">Comparing the word frequencies</a></li>
  <li><a href="#correlation-of-words" id="toc-correlation-of-words" class="nav-link" data-scroll-target="#correlation-of-words">Correlation of words</a></li>
  <li><a href="#document-similarity" id="toc-document-similarity" class="nav-link" data-scroll-target="#document-similarity">Document Similarity</a>
  <ul class="collapse">
  <li><a href="#convert-data-from-r-objects" id="toc-convert-data-from-r-objects" class="nav-link" data-scroll-target="#convert-data-from-r-objects">Convert data from R objects</a></li>
  <li><a href="#tokenizer" id="toc-tokenizer" class="nav-link" data-scroll-target="#tokenizer">Tokenizer</a></li>
  <li><a href="#cosine-similarity" id="toc-cosine-similarity" class="nav-link" data-scroll-target="#cosine-similarity">Cosine Similarity</a></li>
  <li><a href="#시각화" id="toc-시각화" class="nav-link" data-scroll-target="#시각화">시각화</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Textmining on SDG VNRs of ROK, Germany, Finland</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangwon Ju, SNU GSPA </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 6, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<ol type="1">
<li>기술통계 분석</li>
</ol>
<ul>
<li><p>TF-IDF (Term Frequency - Inverse Document Frequency): 단어 빈도 - 역 문서 빈도 총 문서 수 대비 적게 등장한 단어가 중요한 단어 특정 문서 안에서 많이 등장한다고 해도 중요도가 올라가지는 않음</p></li>
<li><p>TF: 특정 문서 D에서 특정 단어 T의 등장 횟수</p></li>
<li><p>DF: 특정 단어 T가 등장한 문서의 수</p></li>
<li><p>IDF: DF에 반비례 하는 수. ln(총문서수/(DF))</p></li>
<li><p>TF-IDF: TF * IDF 희귀하면서도 특정 텍스트에서 자주 사용된 단어 (TF)는 그 텍스트에서 중요함</p></li>
</ul>
<ol start="2" type="1">
<li>단어간 혹은 기사간 상관관계</li>
</ol>
<ul>
<li>동시 출현(Co-Occurrence) 단어 분석 문장 혹은 기사에 함께 사용된 단어는 어떤 단어일지 분석하는 것. 단어의 “맥락”을 파악하기 위하여 어떤 단어들이 함께 쓰였는지를 알아야 함. 의미를 가진 단어(명사, 동사, 형용사)등을 추출하여 어떤 단어들이 함께 빈번하게 쓰였는지 분석해보는게 필요함.</li>
</ul>
<ol start="3" type="1">
<li>연관 규칙 분석 (Association Rules)</li>
</ol>
<ul>
<li>장바구니 분석 Apriori Algorithm(Agrawal et al., 1993): 어떤 단어가 다른 단어들과의 연관규칙을 가지는지를 추출 하는 방식</li>
</ul>
<ol start="4" type="1">
<li><strong>토픽 모델링</strong></li>
</ol>
<ul>
<li><p>토픽 모델링은 문서와 단어로 구성된 행렬(DTM)을 기반으로 문서에 잠재되어 (Latent)있다고 가정된 토픽의 등장확률을 추정하는 일련의 통계적 텍스트 처리기법을 일컫는다. (Blei, 2014; Blei and Lafferty, 2007;Blei, Ng and Jordan, 2003) DTM을 활용하여 주제-확률 분포, 단어-확률 분포를 구한뒤 잠재 주제를 찾는 LDA나 Singular Value Decomposition을 통해 차원 축소를 하는 방법이 있다.</p></li>
<li><p><strong>LDA(Latent Dirichlet Allocation):</strong></p>
<p><strong>이 문서에서는 어떤 주제들이 오가고 있을까?</strong></p>
<p>PLSA를 조건부 확률로 확장시킨 기법으로 잠재 주제의 확률적 분포에 대한 PLSA의 한계점을 보완한 모델이다. LDA모델은 무작위로 섞여있는 대량의 문서에서 단어들의 패턴을 추론하여 각 토픽의 특성을 도출하는데 용이하며, 텍스트 데이터의 의미구조를 파악하기에 적합한 방법 중 하나이다. 한 문서는 여러가지 토픽으로 이루어지고, 토픽은 여러 단어를 혼합하여 구성된다.</p></li>
<li><p>1개의 토픽은 여러 단어(서로 다른 확률을 가진)로 구성.</p></li>
<li><p>1개의 단어는 여러 토픽에서 서로 다른 확률을 가짐.</p></li>
<li><p>delta는 문장이 각 토픽에 등장할 확률, beta는 단어가 각 토픽에 등장할 확률</p></li>
</ul>
<section id="loading-package" class="level1">
<h1>Loading Package</h1>
<div class="cell" data-result="hide">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"reticulate"</span>,<span class="st">"tidyverse"</span>,<span class="st">"tidymodels"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tidytext"</span>,<span class="st">"lda"</span>,<span class="st">"readr"</span>,<span class="st">"igraph"</span>,<span class="st">"forcats"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"sna"</span>,<span class="st">"ergm"</span>,<span class="st">"network"</span>,<span class="st">"stringr"</span>,<span class="st">"magrittr"</span>,<span class="st">"showtext"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tokenizers"</span>,<span class="st">"janeaustenr"</span>,<span class="st">"forcats"</span>,<span class="st">"RColorBrewer"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"viridis"</span>,<span class="st">"stopwords"</span>,<span class="st">"purrr"</span>,<span class="st">"widyr"</span>,<span class="st">"textmineR"</span>,<span class="st">"stm"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ggraph"</span>,<span class="st">"tidygraph"</span>,<span class="st">"ggfortify"</span>,<span class="st">"ggthemes"</span>,<span class="st">"cowplot"</span>,<span class="st">"fs"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"knitr"</span>,<span class="st">"kableExtra"</span>,<span class="st">"ggrepel"</span>,<span class="st">"grid"</span>,<span class="st">"gridExtra"</span>,<span class="st">"topicmodels"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"scales"</span>,<span class="st">"ggpattern"</span>,<span class="st">"magick"</span>,<span class="st">"corrplot"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Font Setting</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name=</span><span class="st">"Nanum Gothic"</span>) <span class="co">#fonts.google.com에서 고르시면 됨</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="setting-working-directory" class="level1">
<h1>Setting Working Directory</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_folder <span class="ot">=</span> <span class="st">"e:/OneDrive - SNU/r/vnr"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ger_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"germany.txt"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fin_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"finland.txt"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>kor_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"korea.txt"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>jp_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"japan.txt"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>uk_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"uk.txt"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>astl_path <span class="ot">=</span> fs<span class="sc">::</span><span class="fu">path</span>(data_folder, <span class="st">"austrailia.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>표제어 추출을 통해 어근을 추출하고 토크나이징을 통해서 토픽 추출 용이하게 만들기.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sentence_word1<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span><span class="fu">tokenize_sentences</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">tibble</span>(<span class="at">words=</span>.),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentence=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(words))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>sentence_word2<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span>textstem<span class="sc">::</span><span class="fu">lemmatize_strings</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">tokenize_words</span>(<span class="at">stopwords =</span>  <span class="fu">as.vector</span>(stop_words<span class="sc">$</span>word),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">strip_numeric =</span> T) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">unlist</span>())</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>sentence_word3<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">words=</span>textstem<span class="sc">::</span><span class="fu">lemmatize_strings</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">tokenize_ngrams</span>(.,<span class="at">n =</span> <span class="dv">2</span>, <span class="at">n_min =</span> <span class="dv">2</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">stopwords =</span> <span class="fu">as.vector</span>(stop_words<span class="sc">$</span>word)) <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">unlist</span>())</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="korea-vnr" class="level1 page-columns page-full">
<h1>Korea VNR</h1>
<section id="preprocess" class="level2">
<h2 class="anchored" data-anchor-id="preprocess">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>korea <span class="ot">&lt;-</span>  <span class="fu">readLines</span>(kor_path) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words">Tokenizing words</h2>
<p>Break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="ot">&lt;-</span> korea <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams" class="level2">
<h2 class="anchored" data-anchor-id="n-grams">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>korea_ngram  <span class="ot">&lt;-</span>  korea <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="ot">&lt;-</span> korea_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"</span><span class="sc">\\</span><span class="st">d+[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[a-z]*</span><span class="sc">\\</span><span class="st">d+"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"kor[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rok[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>korea_ngram <span class="ot">&lt;-</span> korea_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"</span><span class="sc">\\</span><span class="st">d+[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[a-z]*</span><span class="sc">\\</span><span class="st">d+"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"kor[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rok[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>     <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(korea_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#CD313A'</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#0047A0'</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"대한민국"</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(korea_ngram <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#CD313A'</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#0047A0'</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"대한민국"</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> a1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>korea_tfidf <span class="ot">&lt;-</span> korea_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>korea_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> conflict </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1379310 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.4480599 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> governmental </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1538462 </td>
   <td style="text-align:right;"> 2.842970 </td>
   <td style="text-align:right;"> 0.4373799 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> institutional </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 2.437504 </td>
   <td style="text-align:right;"> 0.4062507 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> saemaul </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1219512 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.3961506 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> undong </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1219512 </td>
   <td style="text-align:right;"> 3.248435 </td>
   <td style="text-align:right;"> 0.3961506 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> disability </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0.1304348 </td>
   <td style="text-align:right;"> 3.025291 </td>
   <td style="text-align:right;"> 0.3946032 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> humanitarian </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1555556 </td>
   <td style="text-align:right;"> 2.437504 </td>
   <td style="text-align:right;"> 0.3791674 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 89 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.0961538 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.3789983 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mechanism </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 2.236834 </td>
   <td style="text-align:right;"> 0.3728056 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.0823529 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.3246009 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> indicator </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 0.1500000 </td>
   <td style="text-align:right;"> 2.069780 </td>
   <td style="text-align:right;"> 0.3104669 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> person </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1014493 </td>
   <td style="text-align:right;"> 3.025291 </td>
   <td style="text-align:right;"> 0.3069136 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> south </td>
   <td style="text-align:right;"> 91 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0645161 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2990148 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> indicator </td>
   <td style="text-align:right;"> 94 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 2.069780 </td>
   <td style="text-align:right;"> 0.2956828 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> oda </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 1.690290 </td>
   <td style="text-align:right;"> 0.2817150 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> principle </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1304348 </td>
   <td style="text-align:right;"> 2.149822 </td>
   <td style="text-align:right;"> 0.2804116 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> correspond </td>
   <td style="text-align:right;"> 33 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0689655 </td>
   <td style="text-align:right;"> 3.941582 </td>
   <td style="text-align:right;"> 0.2718332 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> discrimination </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.0579710 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2686799 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> administration </td>
   <td style="text-align:right;"> 89 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0576923 </td>
   <td style="text-align:right;"> 4.634729 </td>
   <td style="text-align:right;"> 0.2673882 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> age </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0937500 </td>
   <td style="text-align:right;"> 2.842970 </td>
   <td style="text-align:right;"> 0.2665284 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>korea_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_dtm.old</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>korea_dtm <span class="ot">&lt;-</span> korea_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>korea_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(korea_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>korea_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(korea_split)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>korea_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_train_dtm.old</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>korea_train_dtm <span class="ot">&lt;-</span> korea_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>korea_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(korea_split)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>korea_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> korea_valid_dtm.old</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(korea_valid_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>korea_valid_dtm <span class="ot">&lt;-</span> korea_valid_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(korea_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> korea_valid_dtm)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>korea_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>korea_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>korea_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="st">government, implementation, policy, international, establish, national, framework, ministry, stakeholder, oda, cooperation, humanitarian, assistance, project, strategy, saemual,  undong, partnership, global,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">disability, sector, service, increase, public, act, person, welfare, strengthen, promote, ensure,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">economic, social, plan, goal, target, integrate, environmental, society, relate,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">sustainable, development, create, environment, organization, civil, report,</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">girl, country, initiative, life, education, develop, health, quality, school, capacity"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>korea_topic_update <span class="ot">&lt;-</span> korea_topic <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>korea_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"정부 정책"</span>, <span class="st">"국제협력"</span>, <span class="st">"복지"</span>, <span class="st">"통합적 목표설정"</span>, <span class="st">"지속가능개발"</span>, <span class="st">"인권"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>korea_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(korea_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>korea_tp_6 <span class="ot">&lt;-</span> korea_lda <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(korea_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>korea_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(korea_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph">Network Graph</h2>
<section id="pairwise-count" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>korea_coocur <span class="ot">&lt;-</span> korea_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> korea_coocur <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>korea_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks" class="level3">
<h3 class="anchored" data-anchor-id="building-networks">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>korea_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>korea_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(korea_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-1">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>korea_g <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-per-topic" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>korea_g <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="germany-vnr" class="level1 page-columns page-full">
<h1>Germany VNR</h1>
<section id="preprocess-1" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-1">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>germany<span class="ot">&lt;-</span><span class="fu">readLines</span>(ger_path) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-1" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-1">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>germany_tokenized <span class="ot">&lt;-</span> germany <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-1" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-1">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>germany_ngram  <span class="ot">&lt;-</span>  germany <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-1">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>germany_tokenized <span class="ot">&lt;-</span> germany_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"germa[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>germany_ngram <span class="ot">&lt;-</span> germany_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"germa[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-1" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-1">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#FF0000'</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFCC00'</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"독일"</span>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(germany_ngram <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#FF0000'</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFCC00'</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"독일"</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> b1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-1" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-1">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>germany_tfidf <span class="ot">&lt;-</span> germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>germany_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> fracking </td>
   <td style="text-align:right;"> 141 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 3.961866 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> civil </td>
   <td style="text-align:right;"> 352 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 3.109586 </td>
   <td style="text-align:right;"> 2.073057 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> hospital </td>
   <td style="text-align:right;"> 81 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.980933 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> wood </td>
   <td style="text-align:right;"> 318 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 5.249652 </td>
   <td style="text-align:right;"> 1.749884 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> administration </td>
   <td style="text-align:right;"> 288 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.333361 </td>
   <td style="text-align:right;"> 1.733345 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> import </td>
   <td style="text-align:right;"> 363 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 4.844187 </td>
   <td style="text-align:right;"> 1.614729 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> urban </td>
   <td style="text-align:right;"> 252 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 3.052428 </td>
   <td style="text-align:right;"> 1.526214 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> norway </td>
   <td style="text-align:right;"> 327 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2857143 </td>
   <td style="text-align:right;"> 5.249652 </td>
   <td style="text-align:right;"> 1.499901 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> job </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.745575 </td>
   <td style="text-align:right;"> 1.498230 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> adaptation </td>
   <td style="text-align:right;"> 307 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.640214 </td>
   <td style="text-align:right;"> 1.456086 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> farm </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.544904 </td>
   <td style="text-align:right;"> 1.417962 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> criminal </td>
   <td style="text-align:right;"> 339 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 4.151040 </td>
   <td style="text-align:right;"> 1.383680 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> family </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.996889 </td>
   <td style="text-align:right;"> 1.332296 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> migration </td>
   <td style="text-align:right;"> 235 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2727273 </td>
   <td style="text-align:right;"> 4.844187 </td>
   <td style="text-align:right;"> 1.321142 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mint </td>
   <td style="text-align:right;"> 104 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> arctic </td>
   <td style="text-align:right;"> 305 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> profit </td>
   <td style="text-align:right;"> 365 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.942799 </td>
   <td style="text-align:right;"> 1.320622 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> disability </td>
   <td style="text-align:right;"> 233 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3000000 </td>
   <td style="text-align:right;"> 4.333361 </td>
   <td style="text-align:right;"> 1.300008 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> labour </td>
   <td style="text-align:right;"> 194 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.170211 </td>
   <td style="text-align:right;"> 1.268084 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> south </td>
   <td style="text-align:right;"> 369 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 3.170211 </td>
   <td style="text-align:right;"> 1.268084 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-1">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>germany_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_dtm.old</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>germany_dtm <span class="ot">&lt;-</span> germany_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-1" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-1">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>germany_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(germany_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>germany_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(germany_split)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>germany_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_train_dtm.old</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>germany_train_dtm <span class="ot">&lt;-</span> germany_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>germany_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(germany_split)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>germany_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> germany_test_dtm.old</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(germany_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>germany_test_dtm <span class="ot">&lt;-</span> germany_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(germany_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> germany_test_dtm)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>germany_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>germany_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-1">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>germany_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="st">action, indicator, policy, plan, goal, gas, basis. ministry, assign, provision, conflict, body,</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">sustainability, city, urban, supply, chain, national, human, local, adopt community,</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">woman, train, social, act, opportunity, child, labour, vocational, law,</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">food, quality, farm, land, agricultural, natural, population, organic,</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">consumption, transition, public, innovation, focus, transport, build, </span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="st">country, global, fund, world, financial, condition, covid, contribution"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>germany_topic_update <span class="ot">&lt;-</span> germany_topic <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>germany_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"정부 정책"</span>, <span class="st">"지역사회"</span>, <span class="st">"인권"</span>, <span class="st">"식량"</span>, <span class="st">"사회 혁신"</span>, <span class="st">"국제 협력"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>germany_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(germany_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>germany_tp_6 <span class="ot">&lt;-</span> germany_lda <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(germany_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>germany_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(germany_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-2">Network Graph</h2>
<section id="pairwise-count-1" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-1">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>germany_coocur <span class="ot">&lt;-</span> germany_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-1" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-1">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> germany_coocur <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>germany_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-1" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-1">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>germany_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>germany_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(germany_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-3">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>germany_g <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-per-topic-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic-1">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>germany_g <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="finland-vnr" class="level1 page-columns page-full">
<h1>Finland VNR</h1>
<section id="preprocess-2" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-2">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>finland <span class="ot">&lt;-</span>  <span class="fu">readLines</span>(fin_path) <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-2" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-2">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>finland_tokenized <span class="ot">&lt;-</span> finland <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-2" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-2">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>finland_ngram  <span class="ot">&lt;-</span>  finland <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-2">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>finland_tokenized <span class="ot">&lt;-</span>finland_tokenized  <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finl[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finn[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"million"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"line"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>finland_ngram <span class="ot">&lt;-</span> finland_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finl[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"finn[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"million"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"line"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-2" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-2">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#003580'</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"핀란드"</span>) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(finland_ngram <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#003580'</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"핀란드"</span>) <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> c1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-2" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-2">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>finland_tfidf <span class="ot">&lt;-</span> finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>finland_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> species </td>
   <td style="text-align:right;"> 549 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2941176 </td>
   <td style="text-align:right;"> 4.330733 </td>
   <td style="text-align:right;"> 1.2737451 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> preparation </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 3.392464 </td>
   <td style="text-align:right;"> 1.2721739 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> city </td>
   <td style="text-align:right;"> 97 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3000000 </td>
   <td style="text-align:right;"> 3.963009 </td>
   <td style="text-align:right;"> 1.1889026 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> loss </td>
   <td style="text-align:right;"> 564 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 4.448516 </td>
   <td style="text-align:right;"> 0.9885592 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> version </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.429346 </td>
   <td style="text-align:right;"> 0.9871538 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> audit </td>
   <td style="text-align:right;"> 330 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2352941 </td>
   <td style="text-align:right;"> 4.043051 </td>
   <td style="text-align:right;"> 0.9513062 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ministry </td>
   <td style="text-align:right;"> 123 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 2.814386 </td>
   <td style="text-align:right;"> 0.9381286 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> attitude </td>
   <td style="text-align:right;"> 245 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.141664 </td>
   <td style="text-align:right;"> 0.9348479 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> film </td>
   <td style="text-align:right;"> 114 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.9325654 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fishery </td>
   <td style="text-align:right;"> 204 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.9325654 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> annually </td>
   <td style="text-align:right;"> 657 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0.2127660 </td>
   <td style="text-align:right;"> 4.330733 </td>
   <td style="text-align:right;"> 0.9214326 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> minority </td>
   <td style="text-align:right;"> 244 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2142857 </td>
   <td style="text-align:right;"> 4.225373 </td>
   <td style="text-align:right;"> 0.9054370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> plastic </td>
   <td style="text-align:right;"> 514 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1666667 </td>
   <td style="text-align:right;"> 5.141664 </td>
   <td style="text-align:right;"> 0.8569439 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> waste </td>
   <td style="text-align:right;"> 517 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 3.819908 </td>
   <td style="text-align:right;"> 0.8488684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tax </td>
   <td style="text-align:right;"> 646 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2272727 </td>
   <td style="text-align:right;"> 3.694745 </td>
   <td style="text-align:right;"> 0.8397147 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> alien </td>
   <td style="text-align:right;"> 568 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 5.834811 </td>
   <td style="text-align:right;"> 0.8335444 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> invasive </td>
   <td style="text-align:right;"> 568 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 5.834811 </td>
   <td style="text-align:right;"> 0.8335444 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fish </td>
   <td style="text-align:right;"> 553 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2000000 </td>
   <td style="text-align:right;"> 4.130063 </td>
   <td style="text-align:right;"> 0.8260125 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> backlog </td>
   <td style="text-align:right;"> 479 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1250000 </td>
   <td style="text-align:right;"> 6.527958 </td>
   <td style="text-align:right;"> 0.8159947 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nordic </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.2058824 </td>
   <td style="text-align:right;"> 3.963009 </td>
   <td style="text-align:right;"> 0.8159135 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-2">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>finland_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> finland_dtm.old</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(finland_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>finland_dtm <span class="ot">&lt;-</span> finland_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-2" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-2">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
</section>
<section id="cast-lda-k6-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-2">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>finland_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="st">government, national, policy, report, implementation, plan, ministry, parliament, committee, commission,</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="st">innovation, development, sustainable, society, research, commitment, company, business, public, sector,</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="st">indicator, assessment, people, panel, union, organisation, participate, issue, include, act,</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="st">education, increase, social, health, service, equality, woman, population, child,</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="st">energy, water, carbon, food, emission, consumption, reduce, economy, forest,</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="st">country, global, climate, international, cooperation, develop, promote, change"</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>finland_topic_update <span class="ot">&lt;-</span> finland_topic <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>finland_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"정부 정책"</span>, <span class="st">"사회 혁신"</span>, <span class="st">"거버넌스"</span>, <span class="st">"인권"</span>, <span class="st">"자원 관리"</span>, <span class="st">"국제 협력"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>finland_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(finland_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>finland_tp_6 <span class="ot">&lt;-</span> finland_lda <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(finland_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>finland_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(finland_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph-4" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-4">Network Graph</h2>
<section id="pairwise-count-2" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-2">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>finland_coocur <span class="ot">&lt;-</span> finland_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-2" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-2">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> finland_coocur <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>finland_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-2" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-2">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>finland_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>finland_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(finland_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-5" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-5">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>finland_g <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-per-topic-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic-2">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>finland_g <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="japan-vnr" class="level1 page-columns page-full">
<h1>Japan VNR</h1>
<section id="preprocess-3" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-3">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>japan<span class="ot">&lt;-</span><span class="fu">readLines</span>(jp_path) <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-3" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-3">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>japan_tokenized <span class="ot">&lt;-</span> japan <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-3" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-3">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>japan_ngram  <span class="ot">&lt;-</span>  japan <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-3" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-3">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>japan_tokenized <span class="ot">&lt;-</span> japan_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"jap*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"asia[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>japan_ngram <span class="ot">&lt;-</span> japan_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"jap*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"asia[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-3" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-3">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(japan_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#BC002D'</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"일본"</span>) <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(japan_ngram <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#BC002D'</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"일본"</span>) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> d1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-3" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-3">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>japan_tfidf <span class="ot">&lt;-</span> japan_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>japan_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> smoke </td>
   <td style="text-align:right;"> 298 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.2083333 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 1.2508098 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mekong </td>
   <td style="text-align:right;"> 271 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.8576982 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 347 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0.2083333 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.7930547 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> expectancy </td>
   <td style="text-align:right;"> 128 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1351351 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.7176676 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 348 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 0.1803279 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.6864473 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> suicide </td>
   <td style="text-align:right;"> 299 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 0.1494253 </td>
   <td style="text-align:right;"> 4.394449 </td>
   <td style="text-align:right;"> 0.6566418 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> household </td>
   <td style="text-align:right;"> 284 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.1935484 </td>
   <td style="text-align:right;"> 3.364830 </td>
   <td style="text-align:right;"> 0.6512574 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> reliance </td>
   <td style="text-align:right;"> 286 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1176471 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.6247929 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> litter </td>
   <td style="text-align:right;"> 232 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1515152 </td>
   <td style="text-align:right;"> 4.057977 </td>
   <td style="text-align:right;"> 0.6148450 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> traffic </td>
   <td style="text-align:right;"> 176 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1129032 </td>
   <td style="text-align:right;"> 5.310740 </td>
   <td style="text-align:right;"> 0.5995997 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> city </td>
   <td style="text-align:right;"> 364 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2307692 </td>
   <td style="text-align:right;"> 2.477527 </td>
   <td style="text-align:right;"> 0.5717369 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> food </td>
   <td style="text-align:right;"> 335 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2105263 </td>
   <td style="text-align:right;"> 2.708050 </td>
   <td style="text-align:right;"> 0.5701158 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> relation </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1578947 </td>
   <td style="text-align:right;"> 3.605992 </td>
   <td style="text-align:right;"> 0.5693671 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forest </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.1458333 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.5551383 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> investment </td>
   <td style="text-align:right;"> 358 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1904762 </td>
   <td style="text-align:right;"> 2.912845 </td>
   <td style="text-align:right;"> 0.5548275 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> railway </td>
   <td style="text-align:right;"> 177 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.0909091 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.5458079 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> investor </td>
   <td style="text-align:right;"> 359 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1428571 </td>
   <td style="text-align:right;"> 3.806662 </td>
   <td style="text-align:right;"> 0.5438089 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> accident </td>
   <td style="text-align:right;"> 239 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.1086957 </td>
   <td style="text-align:right;"> 4.905275 </td>
   <td style="text-align:right;"> 0.5331820 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> approximately </td>
   <td style="text-align:right;"> 287 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1578947 </td>
   <td style="text-align:right;"> 3.364830 </td>
   <td style="text-align:right;"> 0.5312889 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> icon </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0869565 </td>
   <td style="text-align:right;"> 6.003887 </td>
   <td style="text-align:right;"> 0.5220771 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-3">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>japan_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_dtm.old</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>japan_dtm <span class="ot">&lt;-</span> japan_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-3" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-3">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>japan_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(japan_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>japan_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(japan_split)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>japan_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_train_dtm.old</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>japan_train_dtm <span class="ot">&lt;-</span> japan_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>japan_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(japan_split)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>japan_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> japan_test_dtm.old</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(japan_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>japan_test_dtm <span class="ot">&lt;-</span> japan_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(japan_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> japan_test_dtm)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>japan_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>japan_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k10" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k10">Cast LDA (k=10)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>japan_topic<span class="ot">=</span><span class="st">"covid, pandemic, system, poverty, life, population, age, service, people, local, government, city, promote, regional, aim, organization, private, public, initiative, disaster, increase, numb, water, reduction, survey, time, rate, worker, result, previous, compare, approximately, society, woman, gender, human, include, business, equality, activity, company, civil, child, education, school, national, awareness, raise, disability, center, student, generation, country, development, international, develop, cooperation, contribute, nation, provide, fund, peace,food, forest, resource, waste, marine, plastic, loss, management, fishery, biodiversity, change, economic, social, infrastructure, sustainable, quality, environment, technology, growth, innovation, energy, transportation, renewable, consumption, addition, emission, reduce, power, project, promotion, effort, plan, policy, action, achieve, target, goal, stakeholder"</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>japan_topic_update <span class="ot">&lt;-</span> japan_topic <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>japan_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> T,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">topic =</span> <span class="fu">c</span>(1L,2L,3L,4L,5L,6L,7L,8L,9L,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                                         10L),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"삶의 질"</span>,<span class="st">"정부 정책"</span>,<span class="st">"재난 관리"</span>,<span class="st">"인권"</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"교육"</span>,<span class="st">"국제 협력"</span>,<span class="st">"자연 자원"</span>,<span class="st">"혁신적 성장"</span>,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"재생 에너지"</span>,<span class="st">"목표 지향"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>japan_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(japan_dtm, <span class="at">k =</span> <span class="dv">10</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>japan_tp_10 <span class="ot">&lt;-</span> japan_lda <span class="sc">%&gt;%</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(japan_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>japan_tp_10 <span class="sc">%&gt;%</span> </span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(japan_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>)) <span class="sc">+</span> </span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>( <span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph-6" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-6">Network Graph</h2>
<section id="pairwise-count-3" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-3">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>japan_coocur <span class="ot">&lt;-</span> japan_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>item1<span class="sc">==</span><span class="st">"gender"</span><span class="sc">&amp;!</span>item2<span class="sc">==</span><span class="st">"gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-3" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-3">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> japan_coocur <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">150</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>japan_tp_10,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-3" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-3">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>japan_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>japan_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(japan_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-7" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-7">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>japan_g <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> topic) <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>)[<span class="sc">-</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-per-topic-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic-3">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>japan_g <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">colorRampPalette</span>(ghibli<span class="sc">::</span><span class="fu">ghibli_palette</span>(<span class="st">"PonyoLight"</span>))(<span class="dv">10</span>)[<span class="sc">-</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="uk-vnr" class="level1 page-columns page-full">
<h1>UK VNR</h1>
<section id="preprocess-4" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-4">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>uk <span class="ot">&lt;-</span><span class="fu">readLines</span>(uk_path) <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-4" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-4">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>uk_tokenized <span class="ot">&lt;-</span> uk <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-4" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-4">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>uk_ngram  <span class="ot">&lt;-</span>  uk <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-4" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-4">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>uk_tokenized <span class="ot">&lt;-</span> uk_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"uk[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wale*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"scot*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eng*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"irel*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wt*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rbmps*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inn*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"whilst*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"npt*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"britain*"</span>)) </span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>uk_ngram <span class="ot">&lt;-</span> uk_ngram  <span class="sc">%&gt;%</span> </span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"uk[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wale*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"scot*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eng*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"irel*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"wt*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"rbmps*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inn*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"whilst*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"npt*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"britain*"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-4" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-4">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>(uk_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00247D'</span>,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#CF142B'</span>,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"영국"</span>) <span class="sc">+</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(uk_ngram <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00247D'</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#CF142B'</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"영국"</span>) <span class="sc">+</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> e1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-4" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-4">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>uk_tfidf <span class="ot">&lt;-</span> uk_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>uk_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> bus </td>
   <td style="text-align:right;"> 705 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.7500000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 4.747291 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nihr </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 7.022868 </td>
   <td style="text-align:right;"> 4.681912 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> daily </td>
   <td style="text-align:right;"> 709 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.636574 </td>
   <td style="text-align:right;"> 3.757716 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> abortion </td>
   <td style="text-align:right;"> 201 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 3.487406 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> nhs </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.943427 </td>
   <td style="text-align:right;"> 3.295618 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> hour </td>
   <td style="text-align:right;"> 533 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.624973 </td>
   <td style="text-align:right;"> 3.083315 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> contact </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.636574 </td>
   <td style="text-align:right;"> 2.818287 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> victim </td>
   <td style="text-align:right;"> 997 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.189655 </td>
   <td style="text-align:right;"> 2.793103 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lgbt </td>
   <td style="text-align:right;"> 652 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 4.624973 </td>
   <td style="text-align:right;"> 2.774984 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> day </td>
   <td style="text-align:right;"> 429 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 4.132496 </td>
   <td style="text-align:right;"> 2.754998 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> birth </td>
   <td style="text-align:right;"> 1002 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.413430 </td>
   <td style="text-align:right;"> 2.706715 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cardiovascular </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 7.022868 </td>
   <td style="text-align:right;"> 2.633576 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> landfill </td>
   <td style="text-align:right;"> 769 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 2.615554 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> conviction </td>
   <td style="text-align:right;"> 334 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> participatory </td>
   <td style="text-align:right;"> 1014 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> paramilitarism </td>
   <td style="text-align:right;"> 1027 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 6.329721 </td>
   <td style="text-align:right;"> 2.531888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> road </td>
   <td style="text-align:right;"> 207 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.5555556 </td>
   <td style="text-align:right;"> 4.537961 </td>
   <td style="text-align:right;"> 2.521090 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> pupil </td>
   <td style="text-align:right;"> 312 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 4.189655 </td>
   <td style="text-align:right;"> 2.513793 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mobility </td>
   <td style="text-align:right;"> 670 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.4615385 </td>
   <td style="text-align:right;"> 5.231109 </td>
   <td style="text-align:right;"> 2.414358 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> product </td>
   <td style="text-align:right;"> 758 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6666667 </td>
   <td style="text-align:right;"> 3.557132 </td>
   <td style="text-align:right;"> 2.371421 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-4" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-4">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>uk_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_dtm.old</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>uk_dtm <span class="ot">&lt;-</span> uk_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-4" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-4">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>uk_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(uk_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>uk_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(uk_split)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>uk_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_train_dtm.old</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>uk_train_dtm <span class="ot">&lt;-</span> uk_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>uk_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(uk_split)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>uk_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> uk_test_dtm.old</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(uk_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>uk_test_dtm <span class="ot">&lt;-</span> uk_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(uk_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> uk_test_dtm)</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>uk_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>uk_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-3">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>uk_topic<span class="ot">=</span><span class="st">"</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="st">plastic, quality, population, land, significant, impact, priority, monitor, air,</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="st">child, school, fund, girl, disability, family, adult, additional,</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="st">goal, community, local, national, public, risk, act, approach, opportunity, authority,</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="st">plan, action, policy, publish, gap, launch, focus, fair, ambition,</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="st">global, country, commit, build, job, capacity, poor, africa, bank,</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="st">food, supply, transport, company, standard, city, productivity, aim, product"</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>uk_topic_update <span class="ot">&lt;-</span> uk_topic <span class="sc">%&gt;%</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>uk_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"환경"</span>, <span class="st">"인권"</span>, <span class="st">"거버넌스"</span>, <span class="st">"정부 정책"</span>, <span class="st">"국제 협력"</span>, <span class="st">"식량 안보"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>uk_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(uk_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>uk_tp_6 <span class="ot">&lt;-</span> uk_lda <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(uk_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>uk_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(uk_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph-8" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-8">Network Graph</h2>
<section id="pairwise-count-4" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-4">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>uk_coocur <span class="ot">&lt;-</span> uk_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item1<span class="sc">==</span><span class="st">"school"</span><span class="sc">&amp;</span>item2<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"school"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"family"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"child"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(item2<span class="sc">==</span><span class="st">"child"</span><span class="sc">&amp;</span>item1<span class="sc">==</span><span class="st">"family"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-4" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-4">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> uk_coocur <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>uk_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic) <span class="sc">%&gt;%</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(nodes <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"school"</span>,<span class="st">"child"</span>,<span class="st">"family"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-4" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-4">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>uk_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>uk_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(uk_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-9" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-9">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>uk_g <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>uk_coocur <span class="ot">&lt;-</span> uk_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> uk_coocur <span class="sc">%&gt;%</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>uk_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic) </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>uk_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>uk_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(uk_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-per-topic-4" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic-4">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>uk_g <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="austrailia-vnr" class="level1 page-columns page-full">
<h1>Austrailia VNR</h1>
<section id="preprocess-5" class="level2">
<h2 class="anchored" data-anchor-id="preprocess-5">Preprocess</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>austrailia<span class="ot">&lt;-</span><span class="fu">readLines</span>(astl_path) <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_flatten</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="at">pattern=</span><span class="st">"//"</span>, <span class="st">" // "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">"//"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove_all</span>(<span class="st">"ABC*</span><span class="sc">\\</span><span class="st">w*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">text=</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">trimws</span>(text) <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">paragraph=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">.before=</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizing-words-5" class="level2">
<h2 class="anchored" data-anchor-id="tokenizing-words-5">Tokenizing words</h2>
<p>break the text into individual tokens (a process called tokenization) and transform it to a tidy data structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>austrailia_tokenized <span class="ot">&lt;-</span> austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word2)) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="n-grams-5" class="level2">
<h2 class="anchored" data-anchor-id="n-grams-5">n-grams</h2>
<p>An n-gram (sometimes written “ngram”) is a term in linguistics for a contiguous sequence of<br>
n items from a given sequence of text or speech. The item can be phonemes, syllables, letters, or words depending on the application, but when most people talk about n-grams, they mean a group of<br>
n words.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>austrailia_ngram  <span class="ot">&lt;-</span>  austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(text, sentence_word1)) <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">transmute</span>(paragraph,sentence,words) <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">words=</span><span class="fu">map</span>(words, sentence_word3)) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(words) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-inadequate-words-for-analysis-5" class="level2">
<h2 class="anchored" data-anchor-id="remove-inadequate-words-for-analysis-5">Remove inadequate words for analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>austrailia_tokenized <span class="ot">&lt;-</span> austrailia_tokenized  <span class="sc">%&gt;%</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"austra*[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"torres*"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"cent"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>austrailia_ngram <span class="ot">&lt;-</span> austrailia_ngram <span class="sc">%&gt;%</span> </span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"[0-9]"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"austrail[a-z]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eur[a-z]*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"key"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"sdg*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"eu*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"billi*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"milli*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"inwh*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"agend*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"torres*"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"cent"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"datum*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"support*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(words,<span class="at">pattern=</span><span class="st">"progra*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="frequency-table-5" class="level2">
<h2 class="anchored" data-anchor-id="frequency-table-5">Frequency table</h2>
<p>The frequency of specific words and n-grams in each paragraphs.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(austrailia_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00008B'</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"호주"</span>) <span class="sc">+</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(austrailia_ngram <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(words) <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(words, n, <span class="at">.desc =</span> F)) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>word)) <span class="sc">+</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col_pattern</span>(</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">'gradient'</span>,</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill2 =</span> <span class="st">'#00008B'</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_fill =</span> <span class="st">'#FFFFFF'</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_orientation=</span><span class="st">'horizontal'</span>,</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern_alpha=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,<span class="at">size=</span><span class="dv">7</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>)<span class="sc">+</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"호주"</span>) <span class="sc">+</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span>  <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>)) <span class="ot">-&gt;</span> f1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-83-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tf-idf-per-paragraph-5" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-per-paragraph-5">TF-IDF per paragraph</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf <span class="ot">&lt;-</span> austrailia_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">id=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{paragraph}-{sentence}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(paragraph) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(paragraph,words) <span class="sc">%&gt;%</span> </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, paragraph, n) <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(words,<span class="at">.before=</span>paragraph) </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf <span class="sc">%&gt;%</span> </span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> words </th>
   <th style="text-align:right;"> paragraph </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tf </th>
   <th style="text-align:right;"> idf </th>
   <th style="text-align:right;"> tf_idf </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> broadband </td>
   <td style="text-align:right;"> 206 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.3076923 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.837311 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> scarcity </td>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.833987 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> park </td>
   <td style="text-align:right;"> 294 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.4000000 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.744730 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> fish </td>
   <td style="text-align:right;"> 305 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0.3888889 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.696265 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> child </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 2.926739 </td>
   <td style="text-align:right;"> 1.463370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> child </td>
   <td style="text-align:right;"> 111 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.5000000 </td>
   <td style="text-align:right;"> 2.926739 </td>
   <td style="text-align:right;"> 1.463370 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> carbon </td>
   <td style="text-align:right;"> 283 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.3750000 </td>
   <td style="text-align:right;"> 3.668677 </td>
   <td style="text-align:right;"> 1.375754 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lgbtiqa </td>
   <td style="text-align:right;"> 103 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2222222 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.326947 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> discrimination </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.774037 </td>
   <td style="text-align:right;"> 1.258012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> world </td>
   <td style="text-align:right;"> 293 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.6000000 </td>
   <td style="text-align:right;"> 1.963929 </td>
   <td style="text-align:right;"> 1.178357 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> profit </td>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2500000 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.146242 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> basin </td>
   <td style="text-align:right;"> 163 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.2727273 </td>
   <td style="text-align:right;"> 4.179502 </td>
   <td style="text-align:right;"> 1.139864 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> goal </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.406312 </td>
   <td style="text-align:right;"> 1.135438 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> collaboration </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.3333333 </td>
   <td style="text-align:right;"> 3.406312 </td>
   <td style="text-align:right;"> 1.135438 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> human </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.4545455 </td>
   <td style="text-align:right;"> 2.474754 </td>
   <td style="text-align:right;"> 1.124888 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> rubbish </td>
   <td style="text-align:right;"> 301 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1875000 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.119612 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> park </td>
   <td style="text-align:right;"> 303 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.2500000 </td>
   <td style="text-align:right;"> 4.361824 </td>
   <td style="text-align:right;"> 1.090456 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mhfa </td>
   <td style="text-align:right;"> 102 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.085684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> mikta </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1818182 </td>
   <td style="text-align:right;"> 5.971262 </td>
   <td style="text-align:right;"> 1.085684 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> wto </td>
   <td style="text-align:right;"> 371 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.2352941 </td>
   <td style="text-align:right;"> 4.584968 </td>
   <td style="text-align:right;"> 1.078816 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="topic-modeling-5" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topic-modeling-5">Topic modeling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>austrailia_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_dtm.old</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>austrailia_dtm <span class="ot">&lt;-</span> austrailia_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-perplexity-for-hold-out-set-5" class="level3">
<h3 class="anchored" data-anchor-id="using-perplexity-for-hold-out-set-5">Using perplexity for hold out set</h3>
<p>The perplexity is the geometric mean of word likelihood. In 5-fold CV, we first estimate the model, usually called training model, for a given number of topics using 4 folds of the data and then use the left one fold of the data to calculate the perplexity. In calculating the perplexity, we set the model in LDA or CTM to be the training model and not to estimate the beta parameters.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>austrailia_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(austrailia_tfidf, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>austrailia_split_train <span class="ot">&lt;-</span> <span class="fu">training</span>(austrailia_split)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>austrailia_split_train  <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_train_dtm.old</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_train_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>austrailia_train_dtm <span class="ot">&lt;-</span> austrailia_train_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>austrailia_split_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(austrailia_split)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>austrailia_split_test  <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cast_dtm</span>(paragraph, words, n) <span class="ot">-&gt;</span> austrailia_test_dtm.old</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>rowTotals <span class="ot">&lt;-</span> <span class="fu">apply</span>(austrailia_test_dtm.old, <span class="dv">1</span>, sum) <span class="co"># Find the sum of words in each Document</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>austrailia_test_dtm <span class="ot">&lt;-</span> austrailia_test_dtm.old[rowTotals<span class="sc">&gt;</span> <span class="dv">0</span>, ] <span class="co"># Remove all docs without words</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>loglik_v     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>perplexity_v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, <span class="dv">20</span>)</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"... "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>    tmp_mod  <span class="ot">&lt;-</span> <span class="fu">LDA</span>(austrailia_train_dtm, <span class="at">k=</span>i, <span class="at">method=</span><span class="st">"Gibbs"</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>    loglik_v[i] <span class="ot">&lt;-</span> <span class="fu">logLik</span>(tmp_mod)</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>    perplexity_v[i] <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(tmp_mod, <span class="at">newdata =</span> austrailia_test_dtm)}</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>austrailia_topic_k_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">loglik =</span> loglik_v,</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> perplexity_v)</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>austrailia_topic_k_df <span class="sc">%&gt;%</span></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic_k <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(metric, value, <span class="sc">-</span>topic_k) <span class="sc">%&gt;%</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>topic_k, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cast-lda-k6-4" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cast-lda-k6-4">Cast LDA (k=6)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>austrailia_topic<span class="ot">=</span><span class="st">" organisation, approach, policy, indicator, civil, social, financial, action,</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="st">food, supply, cost, world, agricultural, risk, aim, production,</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="st">woman, aboriginal, disability, child, school, participation, girl, family,</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="st">human, national, law, public, activity, institution, commit, land, discrimination,</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="st">city, plan, community, sustainability, build, growth, local, urban, opportunity, council,</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="st">pacific, country, fund, island, indo, capacity, asia, aid, major, bank, assist"</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>austrailia_topic_update <span class="ot">&lt;-</span> austrailia_topic <span class="sc">%&gt;%</span> </span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="at">pattern=</span><span class="st">", "</span>,<span class="at">simplify =</span>T) </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>austrailia_topic_names<span class="ot">=</span><span class="fu">data.frame</span>(</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic =</span> <span class="fu">c</span>(1L, 2L, 3L, 4L, 5L, 6L),</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">topic2=</span> <span class="fu">c</span>(<span class="st">"정부 정책"</span>, <span class="st">"식량 안보"</span>, <span class="st">"인권"</span>, <span class="st">"공공성"</span>, <span class="st">"거버넌스"</span>, <span class="st">"국제 협력"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>austrailia_lda <span class="ot">&lt;-</span>  <span class="fu">LDA</span>(austrailia_dtm, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"Gibbs"</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">iter=</span><span class="dv">1000</span>, <span class="at">seed=</span><span class="dv">2020</span>, <span class="at">thin=</span><span class="dv">3</span>))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>austrailia_tp_6 <span class="ot">&lt;-</span> austrailia_lda <span class="sc">%&gt;%</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(austrailia_topic_names,<span class="at">by=</span><span class="st">"topic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>topic) <span class="sc">%&gt;%</span> </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">topic=</span><span class="st">"topic2"</span>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>austrailia_tp_6 <span class="sc">%&gt;%</span> </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(beta,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">as.vector</span>(austrailia_topic_update)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(topic)  <span class="sc">%&gt;%</span> </span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(beta, term, <span class="at">fill =</span> topic)) <span class="sc">+</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_fill_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-graph-10" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="network-graph-10">Network Graph</h2>
<section id="pairwise-count-5" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-count-5">Pairwise Count</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>austrailia_coocur <span class="ot">&lt;-</span> austrailia_tfidf  <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">term=</span>words) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairwise_count</span>(term, paragraph, <span class="at">sort =</span> <span class="cn">TRUE</span>,<span class="at">upper =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-links-and-nodes-5" class="level3">
<h3 class="anchored" data-anchor-id="building-links-and-nodes-5">Building links and nodes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> austrailia_coocur <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">term=</span><span class="fu">union</span>(links<span class="sc">$</span>source,links<span class="sc">$</span>target)) <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>austrailia_tp_6,<span class="at">by=</span><span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">nodes=</span><span class="st">"term"</span>,topic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-networks-5" class="level3">
<h3 class="anchored" data-anchor-id="building-networks-5">Building networks</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>austrailia_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">vertices =</span> nodes, <span class="at">directed =</span> F)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(austrailia_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="network-graph-11" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-11">Network Graph</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">size=</span>degree),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-graph-per-topic-5" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="network-graph-per-topic-5">Network Graph per topic</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>austrailia_g <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">community =</span> <span class="fu">as.factor</span>(topic)) <span class="sc">%&gt;%</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'kk'</span>) <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight,<span class="at">width=</span>weight),</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community, <span class="at">size =</span> degree)) <span class="sc">+</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),<span class="at">size=</span><span class="dv">8</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>, <span class="at">size=</span><span class="dv">30</span>),</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Topic 명"</span>,</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_nodes</span>(<span class="sc">~</span> community, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simplify" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="simplify">simplify?</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>links<span class="ot">=</span>finland_coocur <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"item1"</span>,<span class="at">target=</span><span class="st">"item2"</span>,<span class="at">weight=</span><span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(finland_tp_6 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>beta,term) <span class="sc">%&gt;%</span> </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">transmute</span>(<span class="at">source=</span>term,<span class="at">topic1=</span>topic),<span class="at">by=</span><span class="st">"source"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(finland_tp_6 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>beta,term) <span class="sc">%&gt;%</span> </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">transmute</span>(<span class="at">target=</span>term,<span class="at">topic2=</span>topic),<span class="at">by=</span><span class="st">"target"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(topic1,topic2,weight) <span class="sc">%&gt;%</span> </span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">source=</span><span class="st">"topic1"</span>,<span class="at">target=</span><span class="st">"topic2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>finland_network <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> links, <span class="at">directed =</span> F)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>finland_g <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(<span class="fu">simplify</span>(finland_network))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>finland_g <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'stress'</span>) <span class="sc">+</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> weight), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree, <span class="at">colour=</span>name)) <span class="sc">+</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_graph</span>(<span class="at">base_family=</span><span class="st">"Nanum Gothic"</span>) <span class="sc">+</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size=</span><span class="st">"none"</span>,<span class="at">color=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>    ghibli<span class="sc">::</span><span class="fu">scale_color_ghibli_d</span>(<span class="st">"PonyoLight"</span>, <span class="at">direction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="comparing-six-countries" class="level1 page-columns page-full">
<h1>Comparing Six countries</h1>
<section id="comparing-word-frequencies-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-word-frequencies-of-six-countries">Comparing Word Frequencies of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>korea_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"대한민국"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(germany_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"독일"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(finland_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"핀란드"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(japan_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"일본"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(uk_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"영국"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(austrailia_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">key=</span><span class="st">"호주"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">key=</span><span class="fu">as_factor</span>(key)) <span class="ot">-&gt;</span> total_tokenized</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key,words) <span class="sc">%&gt;%</span> </span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(n, <span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">reorder_within</span>(words, n, key)) <span class="sc">%&gt;%</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>words)) <span class="sc">+</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>key),<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Comparing Word Frequencies of Six Countries"</span>) <span class="sc">+</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-bigrams-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-bigrams-of-six-countries">Comparing bigrams of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(a1,b1,c1,d1,e1,f1, <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Comparing Bigrams of Six Countries"</span>,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fontsize =</span> <span class="dv">40</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fontfamily=</span><span class="st">"Nanum Gothic"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-screen-inset-shaded">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-tf-idf-of-six-countries" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-tf-idf-of-six-countries">Comparing Tf-idf of Six Countries</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key,words) <span class="sc">%&gt;%</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_tf_idf</span>(words, key, n) <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(tf_idf, <span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">reorder_within</span>(words, tf_idf, key)) <span class="sc">%&gt;%</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tf_idf, <span class="at">y=</span>words)) <span class="sc">+</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>key),<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="st">"Comparing TF-IDF of Six Countries"</span>) <span class="sc">+</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))  <span class="sc">+</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-the-word-frequencies" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comparing-the-word-frequencies">Comparing the word frequencies</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>compare_six <span class="ot">&lt;-</span> total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key, words) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> key, <span class="at">values_from =</span> proportion) <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"key"</span>, <span class="at">values_to =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Words that are far from the line are words that are found more in one set of texts than another.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># expect a warning about rows with missing values being removed</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>compare_six <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> proportion, <span class="at">y =</span> 대한민국, <span class="at">color =</span> <span class="fu">abs</span>(대한민국 <span class="sc">-</span> proportion))) <span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> words), <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>), </span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">low =</span> <span class="st">"darkgreen"</span>, <span class="at">high =</span>  <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"대한민국"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">40</span>),</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-of-words" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="correlation-of-words">Correlation of words</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key, words) <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> key, <span class="at">values_from =</span> proportion) <span class="sc">%&gt;%</span> </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> words) <span class="ot">-&gt;</span> correlation_total  </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>testRes<span class="ot">=</span>corrplot<span class="sc">::</span><span class="fu">cor.mtest</span>(correlation_total, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>correlation_total <span class="sc">%&gt;%</span> </span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>    .[<span class="fu">order</span>(.[ , <span class="dv">1</span>],<span class="at">decreasing =</span> T), <span class="fu">order</span>(.[ <span class="dv">1</span>, ],<span class="at">decreasing =</span> T)] <span class="sc">%&gt;%</span> </span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">corrplot</span>(<span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">diag=</span>T, </span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">type=</span><span class="st">"lower"</span>,</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">method=</span><span class="st">"color"</span>,</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">cl.pos=</span><span class="st">"n"</span>,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">addCoef.col =</span> <span class="dv">1</span>,</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">number.cex =</span> <span class="dv">4</span>,</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">tl.cex =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>correlation_total <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">countries=</span><span class="fu">row.names</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    tibble <span class="sc">%&gt;%</span> </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(countries, 대한민국) <span class="sc">%&gt;%</span> </span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">key=</span><span class="st">"countries"</span>,<span class="at">corrr=</span><span class="st">"대한민국"</span>)<span class="ot">-&gt;</span> corr1</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>total_tokenized <span class="sc">%&gt;%</span> </span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(key,words) <span class="sc">%&gt;%</span> </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(n, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="at">y=</span>corr1,<span class="at">by=</span><span class="st">"key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">reorder_within</span>(words, n, key)) <span class="sc">%&gt;%</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>words)) <span class="sc">+</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>corrr),<span class="at">show.legend =</span> T) <span class="sc">+</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_reorder</span>(key,corrr,<span class="at">.desc=</span>T), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="st">'상관관계'</span>) <span class="sc">+</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">40</span>),</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">"Nanum Gothic"</span>,<span class="at">size=</span><span class="dv">40</span>),</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_center_title</span>()<span class="sc">+</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"grey"</span>, <span class="at">high =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-result="hide">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>cortrix <span class="ot">=</span> <span class="cf">function</span> (R, <span class="at">histogram =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"kendall"</span>, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"spearman"</span>), ...) </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">as.matrix</span>(R, <span class="at">method =</span> <span class="st">"matrix"</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(method)) </span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    method <span class="ot">=</span> method[<span class="dv">1</span>]</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  cormeth <span class="ot">&lt;-</span> method</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, </span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> cormeth, cex.cor, ...) {</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">use =</span> use, <span class="at">method =</span> method)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste</span>(prefix, txt, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(cex.cor)) </span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>      cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(x), <span class="fu">as.numeric</span>(y), <span class="at">method =</span> method)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>    Signif <span class="ot">&lt;-</span> <span class="fu">symnum</span>(test<span class="sc">$</span>p.value, <span class="at">corr =</span> <span class="cn">FALSE</span>, <span class="at">na =</span> <span class="cn">FALSE</span>, </span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">cutpoints =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">"***"</span>, </span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">"."</span>, <span class="st">" "</span>))</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex)</span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>, Signif, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(t, <span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd.xts</span>(x))</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>  dotargs <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>  dotargs<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(method)</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>  hist.panel <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">... =</span> <span class="cn">NULL</span>) {</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">"light blue"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="st">"FD"</span>)</span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rug</span>(x)</span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (histogram) </span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pairs</span>(x, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">lower.panel =</span> panel.smooth, <span class="at">upper.panel =</span> panel.cor, </span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">diag.panel =</span> hist.panel, ...)</span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">pairs</span>(x, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">lower.panel =</span> panel.smooth, <span class="at">upper.panel =</span> panel.cor, </span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a>    ...)</span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>correlation_total <span class="sc">%&gt;%</span> </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cortrix</span>(<span class="at">histogram=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" style="width:150.0%"></p>
</figure>
</div>
</div>
</div>
<p>***: 0 - 0.001</p>
</section>
<section id="document-similarity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="document-similarity">Document Similarity</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>korea_string <span class="ot">&lt;-</span> korea <span class="sc">%&gt;%</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>germany_string <span class="ot">&lt;-</span> germany <span class="sc">%&gt;%</span> </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>finland_string <span class="ot">&lt;-</span> finland <span class="sc">%&gt;%</span> </span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>japan_string <span class="ot">&lt;-</span> japan <span class="sc">%&gt;%</span> </span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>uk_string <span class="ot">&lt;-</span> uk <span class="sc">%&gt;%</span> </span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>austrailia_string <span class="ot">&lt;-</span> austrailia <span class="sc">%&gt;%</span> </span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(.,<span class="at">collapse =</span> <span class="st">" "</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>mpl.rc(<span class="st">'font'</span>, family<span class="op">=</span><span class="st">'NanumGothic'</span>) <span class="co"># 폰트 설정</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>mpl.rc(<span class="st">'axes'</span>, unicode_minus<span class="op">=</span><span class="va">False</span>) <span class="co"># 유니코드에서 음수 부호 설정</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 차트 스타일 설정</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font<span class="op">=</span><span class="st">"NanumGothic"</span>, rc<span class="op">=</span>{<span class="st">"axes.unicode_minus"</span>:<span class="va">False</span>}, style<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="convert-data-from-r-objects" class="level3">
<h3 class="anchored" data-anchor-id="convert-data-from-r-objects">Convert data from R objects</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>document_df <span class="op">=</span> pd.DataFrame.from_dict(</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'filename'</span>: [<span class="st">"Korea"</span>, <span class="st">"Germany"</span>, <span class="st">"Finland"</span>, <span class="st">"Japan"</span>, <span class="st">"UK"</span>, <span class="st">"Austrailia"</span>],</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'opinion_text'</span>:[r.korea_string, r.germany_string, r.finland_string, </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    r.japan_string, r.uk_string, r.austrailia_string]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenizer" class="level3">
<h3 class="anchored" data-anchor-id="tokenizer">Tokenizer</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단어 원형 추출 함수</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>lemmar <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LemTokens(tokens):</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [lemmar.lemmatize(token) <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 특수 문자 사전 생성: {33: None ...}</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ord(): 아스키 코드 생성</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>remove_punct_dict <span class="op">=</span> <span class="bu">dict</span>((<span class="bu">ord</span>(punct), <span class="va">None</span>) <span class="cf">for</span> punct <span class="kw">in</span> string.punctuation)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 특수 문자 제거 및 단어 원형 추출</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LemNormalize(text):</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>    text_new <span class="op">=</span> text.lower().translate(remove_punct_dict)</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>    word_tokens <span class="op">=</span> nltk.word_tokenize(text_new)</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> LemTokens(word_tokens)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('punkt')</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('wordnet')</span></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="co"># nltk.download('omw-1.4')</span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>tfidf_vect <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span><span class="st">'english'</span> , ngram_range<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>                             tokenizer <span class="op">=</span> LemNormalize, min_df<span class="op">=</span><span class="fl">0.05</span>, max_df<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>feature_vect <span class="op">=</span> tfidf_vect.fit_transform(document_df[<span class="st">'opinion_text'</span>])    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cosine-similarity" class="level3">
<h3 class="anchored" data-anchor-id="cosine-similarity">Cosine Similarity</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>similarity_pair <span class="op">=</span> cosine_similarity(feature_vect[<span class="dv">0</span>] , feature_vect)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>document_df[<span class="st">"similarity"</span>] <span class="op">=</span> similarity_pair.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="시각화" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="시각화">시각화</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>vis<span class="op">=</span>document_df.iloc[<span class="dv">1</span>:].sort_values(by<span class="op">=</span><span class="st">"similarity"</span>,ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"white"</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">"similarity"</span>, y<span class="op">=</span><span class="st">"filename"</span>, data<span class="op">=</span>vis)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Korea'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Vnr_analysis_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Sangwon Ju
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>