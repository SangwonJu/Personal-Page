{
  "hash": "b5c1a13bfd430ab92bc96f5ea8b15190",
  "result": {
    "markdown": "---\ntitle: \"Analysis 1: \\n Number of local government employees\"\nauthor: \"서울대학교 행정대학원 주상원\"\ndate: 'Dec/01/2021'\npage-layout: full\nformat: \n    html:\n        code-fold: true\n---\n\n\n# 0. Preparation\n\n-   Data retrieved from KOSIS (Korean Statistical Information Service).\n\n-   Agenda1: examining trend of the total local government employee number to find out the impact of \"The Transition of Fire Officals to National Position\".\n\n-   Agenda2: visualize the number of employees to separate the impact of transition from original fluctuation in number.\n\n## - Package Load\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\"jsonlite\",\n               \"tidyverse\",\n               \"forecast\",\n               \"ggfortify\",\n               \"forecast\",\n               \"httr\",\n               \"sleekts\",\n               \"lubridate\",\n               \"stats\",\n               \"smooth\",\n               \"ghibli\",\n               \"plyr\",\n               \"scales\",\n               \"formattable\",\n               \"knitr\",\n               \"showtext\",\n               \"kableExtra\",\n               \"IRdisplay\",\n               \"glue\",\n               \"echarts4r\",\n               \"plotly\")\n```\n:::\n\n\n## - Adding fonts for ggplot2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfont_add_google(name=\"Lato\")\nshowtext_auto()\n```\n:::\n\n\n# 1. Importing data and clensing\n\n## - Importing data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# auto inporting function\nkosis1 = function (a,b){\n    library(\"jsonlite\")\n    library(\"dplyr\")\n    i1=a\n    i2=b    \n    years=seq(i1+1,i2,1)\n    data= fromJSON(glue::glue(\"https://kosis.kr/openapi/statisticsData.do?method=getList&apiKey=YjNjZjJmNDI2NWE1N2U3NGRiZWE3ZmI3MmU4YjliNGU=&format=json&jsonVD=Y&userStatsId=jsw0641/101/DT_1YL2101E/2/1/20211111002533&prdSe=Y&startPrdDe={i1}&endPrdDe={i1}\"))\n    for(i in years) {\n        assign(paste(\"employee_\",i,sep=\"\"), \n               fromJSON(glue::glue(\"https://kosis.kr/openapi/statisticsData.do?method=getList&apiKey=YjNjZjJmNDI2NWE1N2U3NGRiZWE3ZmI3MmU4YjliNGU=&format=json&jsonVD=Y&userStatsId=jsw0641/101/DT_1YL2101E/2/1/20211111002533&prdSe=Y&startPrdDe={i}&endPrdDe={i}\")))\n        data %>% \n            full_join(get(paste(\"employee_\",i,sep=\"\"))) -> data\n        print(paste(\"employee_\",i,\" added\",sep=\"\"))\n    }\n    return(data)\n}\n\n# Importing Data\nemployee_data=kosis1(2008,2020)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nemployee_data %>% \n    glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 230\nColumns: 14\n$ TBL_NM      <chr> \"지방자치단체공무원 현원(시도)\", \"지방자치단체공무원 현원(…\n$ PRD_DE      <chr> \"2008\", \"2008\", \"2008\", \"2008\", \"2008\", \"2008\", \"2008\", \"2…\n$ TBL_ID      <chr> \"DT_1YL2101E\", \"DT_1YL2101E\", \"DT_1YL2101E\", \"DT_1YL2101E\"…\n$ ITM_NM      <chr> \"지방자치단체공무원 현원\", \"지방자치단체공무원 현원\", \"지…\n$ ITM_ID      <chr> \"16110T2009_036\", \"16110T2009_036\", \"16110T2009_036\", \"161…\n$ ORG_ID      <chr> \"101\", \"101\", \"101\", \"101\", \"101\", \"101\", \"101\", \"101\", \"1…\n$ UNIT_NM     <chr> \"명\", \"명\", \"명\", \"명\", \"명\", \"명\", \"명\", \"명\", \"명\", \"명\"…\n$ UNIT_NM_ENG <chr> \"In person\", \"In person\", \"In person\", \"In person\", \"In pe…\n$ C1_OBJ_NM   <chr> \"행정구역별\", \"행정구역별\", \"행정구역별\", \"행정구역별\", \"…\n$ DT          <chr> \"275231\", \"46270\", \"15752\", \"10799\", \"12964\", \"6473\", \"676…\n$ PRD_SE      <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\"…\n$ C1          <chr> \"15110SDB000\", \"15110SDB001\", \"15110SDB002\", \"15110SDB003\"…\n$ C1_NM       <chr> \"전국\", \"서울특별시\", \"부산광역시\", \"대구광역시\", \"인천광…\n$ C1_NM_ENG   <chr> \"Whole country\", \"Seoul\", \"Busan\", \"Daegu\", \"Incheon\", \"Gw…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selected Provinces \nemployee_data$C1_NM_ENG %>% \n    unique() -> level\nlevel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Whole country\"     \"Seoul\"             \"Busan\"            \n [4] \"Daegu\"             \"Incheon\"           \"Gwangju\"          \n [7] \"Daejeon\"           \"Ulsan\"             \"Gyeonggi-do\"      \n[10] \"Gangwon-do\"        \"Chungcheongbuk-do\" \"Chungcheongnam-do\"\n[13] \"Jeollabuk-do\"      \"Jeollanam-do\"      \"Gyeongsangbuk-do\" \n[16] \"Gyeongsangnam-do\"  \"Jeju\"              \"Sejong\"           \n```\n:::\n:::\n\n\nSouth Korea is made up of 17 first-tier administrative divisions: 6 metropolitan cities (*gwangyeoksi* 광역시/廣域市), 1 special city (*teukbyeolsi* 특별시/特別市), 1 special self-governing city (*teukbyeol-jachisi* 특별자치시/特別自治市), and 9 provinces (*do* 도/道), including one special self-governing province (*teukbyeol jachido* 특별자치도/特別自治道). (cited from [Wikipedia](https://en.wikipedia.org/wiki/Administrative_divisions_of_South_Korea))\n\n## - Clensing data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemployee_data$DT=as.numeric(employee_data$DT)\nemployee_data=employee_data%>%\n    dplyr::rename(ad_division=C1_NM_ENG) \n\n\nemployee_data %>% \n    filter(PRD_DE==2018) %>% \n    select(ad_division,DT) %>% \n    dplyr::rename(employee_2018=\"DT\") -> employee_2018\n\nemployee_data %>% \n    filter(PRD_DE==2019) %>% \n    select(ad_division,DT) %>% \n    dplyr::rename(employee_2019=\"DT\") -> employee_2019\n\nemployee_data %>% \n    filter(PRD_DE==2020) %>% \n    select(ad_division,DT) %>% \n    dplyr::rename(employee_2020=\"DT\") -> employee_2020\n```\n:::\n\n\n## - The decrease rate of the number of employees in 2020 compared to 2018\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemployee_2018 %>% \n    full_join(employee_2019) %>% \n    full_join(employee_2020) %>% \n    dplyr::rename(Local_Divisions=\"ad_division\") -> emp_num\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"ad_division\"\nJoining, by = \"ad_division\"\n```\n:::\n\n```{.r .cell-code}\nemp_num$Local_Divisions=factor(emp_num$Local_Divisions,levels=rev(level))\n\nknitr::kable(emp_num,format.args = list(big.mark = \",\"),\n            caption = \"The Number of local government employees (2018, 2019, 2020)\",\n            col.names = gsub(\"[_]\", \" \", names(emp_num))) %>% \n    kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>The Number of local government employees (2018, 2019, 2020)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Local Divisions </th>\n   <th style=\"text-align:right;\"> employee 2018 </th>\n   <th style=\"text-align:right;\"> employee 2019 </th>\n   <th style=\"text-align:right;\"> employee 2020 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Whole country </td>\n   <td style=\"text-align:right;\"> 322,862 </td>\n   <td style=\"text-align:right;\"> 337,084 </td>\n   <td style=\"text-align:right;\"> 292,182 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Seoul </td>\n   <td style=\"text-align:right;\"> 50,599 </td>\n   <td style=\"text-align:right;\"> 52,081 </td>\n   <td style=\"text-align:right;\"> 45,826 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Busan </td>\n   <td style=\"text-align:right;\"> 19,088 </td>\n   <td style=\"text-align:right;\"> 19,294 </td>\n   <td style=\"text-align:right;\"> 16,509 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Daegu </td>\n   <td style=\"text-align:right;\"> 12,912 </td>\n   <td style=\"text-align:right;\"> 13,321 </td>\n   <td style=\"text-align:right;\"> 10,975 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Incheon </td>\n   <td style=\"text-align:right;\"> 14,515 </td>\n   <td style=\"text-align:right;\"> 15,662 </td>\n   <td style=\"text-align:right;\"> 13,478 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gwangju </td>\n   <td style=\"text-align:right;\"> 7,956 </td>\n   <td style=\"text-align:right;\"> 8,409 </td>\n   <td style=\"text-align:right;\"> 7,377 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Daejeon </td>\n   <td style=\"text-align:right;\"> 7,704 </td>\n   <td style=\"text-align:right;\"> 7,981 </td>\n   <td style=\"text-align:right;\"> 6,704 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ulsan </td>\n   <td style=\"text-align:right;\"> 6,409 </td>\n   <td style=\"text-align:right;\"> 6,684 </td>\n   <td style=\"text-align:right;\"> 5,644 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sejong </td>\n   <td style=\"text-align:right;\"> 1,906 </td>\n   <td style=\"text-align:right;\"> 2,132 </td>\n   <td style=\"text-align:right;\"> 1,767 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeonggi-do </td>\n   <td style=\"text-align:right;\"> 54,864 </td>\n   <td style=\"text-align:right;\"> 58,293 </td>\n   <td style=\"text-align:right;\"> 51,147 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gangwon-do </td>\n   <td style=\"text-align:right;\"> 18,599 </td>\n   <td style=\"text-align:right;\"> 19,215 </td>\n   <td style=\"text-align:right;\"> 16,047 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Chungcheongbuk-do </td>\n   <td style=\"text-align:right;\"> 13,947 </td>\n   <td style=\"text-align:right;\"> 14,661 </td>\n   <td style=\"text-align:right;\"> 13,040 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Chungcheongnam-do </td>\n   <td style=\"text-align:right;\"> 18,180 </td>\n   <td style=\"text-align:right;\"> 19,313 </td>\n   <td style=\"text-align:right;\"> 16,522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeollabuk-do </td>\n   <td style=\"text-align:right;\"> 17,042 </td>\n   <td style=\"text-align:right;\"> 17,811 </td>\n   <td style=\"text-align:right;\"> 15,639 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeollanam-do </td>\n   <td style=\"text-align:right;\"> 21,698 </td>\n   <td style=\"text-align:right;\"> 22,685 </td>\n   <td style=\"text-align:right;\"> 20,247 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeongsangbuk-do </td>\n   <td style=\"text-align:right;\"> 26,745 </td>\n   <td style=\"text-align:right;\"> 27,829 </td>\n   <td style=\"text-align:right;\"> 24,047 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeongsangnam-do </td>\n   <td style=\"text-align:right;\"> 24,836 </td>\n   <td style=\"text-align:right;\"> 25,690 </td>\n   <td style=\"text-align:right;\"> 22,056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeju </td>\n   <td style=\"text-align:right;\"> 5,862 </td>\n   <td style=\"text-align:right;\"> 6,023 </td>\n   <td style=\"text-align:right;\"> 5,157 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nemp_num %>% \n    mutate(Increase_Rate=formattable::percent((employee_2020-employee_2018)/employee_2018)) %>%\n    select(Local_Divisions,Increase_Rate) %>% \n    kbl(col.names = gsub(\"[_]\", \" \", names(.)),\n        caption = \"The decrease rate of the number of employees in 2020 compared to 2018\") %>% \n    kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>The decrease rate of the number of employees in 2020 compared to 2018</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Local Divisions </th>\n   <th style=\"text-align:right;\"> Increase Rate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Whole country </td>\n   <td style=\"text-align:right;\"> -9.50% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Seoul </td>\n   <td style=\"text-align:right;\"> -9.43% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Busan </td>\n   <td style=\"text-align:right;\"> -13.51% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Daegu </td>\n   <td style=\"text-align:right;\"> -15.00% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Incheon </td>\n   <td style=\"text-align:right;\"> -7.14% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gwangju </td>\n   <td style=\"text-align:right;\"> -7.28% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Daejeon </td>\n   <td style=\"text-align:right;\"> -12.98% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ulsan </td>\n   <td style=\"text-align:right;\"> -11.94% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sejong </td>\n   <td style=\"text-align:right;\"> -7.29% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeonggi-do </td>\n   <td style=\"text-align:right;\"> -6.77% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gangwon-do </td>\n   <td style=\"text-align:right;\"> -13.72% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Chungcheongbuk-do </td>\n   <td style=\"text-align:right;\"> -6.50% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Chungcheongnam-do </td>\n   <td style=\"text-align:right;\"> -9.12% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeollabuk-do </td>\n   <td style=\"text-align:right;\"> -8.23% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeollanam-do </td>\n   <td style=\"text-align:right;\"> -6.69% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeongsangbuk-do </td>\n   <td style=\"text-align:right;\"> -10.09% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gyeongsangnam-do </td>\n   <td style=\"text-align:right;\"> -11.19% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Jeju </td>\n   <td style=\"text-align:right;\"> -12.03% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n```{=html}\n<p align=\"justify\">\nOverall, the number of employees in every local divisions decreased by around 6 to 15 percentage points.\n</p>\n```\n\n# 2. Visualization\n\n## - Increase rate of the number of employees in 2019 compared to 2018\n\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nemp_num %>% \n    mutate(increase=round(((employee_2019-employee_2018)/employee_2018)*100,2)) %>%\n    select(Local_Divisions,increase) %>% \n    ggplot(aes(x=Local_Divisions,y=increase)) + \n    geom_bar(stat = \"identity\", position = \"dodge\") +\n    theme_classic() +\n    geom_text(aes(label= paste(sprintf(\"%2.2f\", increase),\"%\",sep=\"\")), size=3, position = position_dodge(width = 1))+\n  labs(x=\"17 first-tier administrative divisions\",\n       y=\"Increase Rate(%)\")+\n  scale_y_continuous(breaks=seq(0, 15, 1)) + \n  theme(text=element_text(family=\"Lato\",size=10),\n        plot.title = element_text(size = 5))+\n  coord_flip() -> p \n\nplotly::ggplotly(p, tooltip=\"text\") %>% \n    style(textposition = \"right\") %>% \n    layout(title = list(text = paste0(\n        'Increase rate of employees in 2019 (compared to 2018)',\n        '<br>',\n        '<sup>',\n        'Source: Ministry of Public Administration and Security (KOSIS)','</sup>'),\n        x = 0.1,\n        font=list(size=15)))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-1ef151a6d6a126786b99\" style=\"width:100%;height:590px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1ef151a6d6a126786b99\">{\"x\":{\"data\":[{\"orientation\":\"h\",\"width\":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.9,0.9,0.9],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[4.4,2.93,1.08,3.17,7.9,5.69,3.6,4.29,11.86,6.25,3.31,5.12,6.23,4.51,4.55,4.05,3.44,2.75],\"y\":[18,17,16,15,14,13,12,11,1,10,9,8,7,6,5,4,3,2],\"text\":\"\",\"type\":\"bar\",\"textposition\":\"right\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(89,89,89,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[4.4,2.93,1.08,3.17,7.9,5.69,3.6,4.29,11.86,6.25,3.31,5.12,6.23,4.51,4.55,4.05,3.44,2.75],\"y\":[18,17,16,15,14,13,12,11,1,10,9,8,7,6,5,4,3,2],\"text\":[\"4.40%\",\"2.93%\",\"1.08%\",\"3.17%\",\"7.90%\",\"5.69%\",\"3.60%\",\"4.29%\",\"11.86%\",\"6.25%\",\"3.31%\",\"5.12%\",\"6.23%\",\"4.51%\",\"4.55%\",\"4.05%\",\"3.44%\",\"2.75%\"],\"hovertext\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],\"textfont\":{\"size\":11.3385826771654,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null,\"textposition\":\"right\"}],\"layout\":{\"margin\":{\"t\":24.0365296803653,\"r\":7.30593607305936,\"b\":35.5998339559983,\"l\":114.570361145704},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.593,12.453],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\"],\"tickvals\":[0,1,2,3,4,5,6,7,8,9,10,11,12],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Increase Rate(%)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,18.6],\"tickmode\":\"array\",\"ticktext\":[\"Sejong\",\"Jeju\",\"Gyeongsangnam-do\",\"Gyeongsangbuk-do\",\"Jeollanam-do\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Chungcheongbuk-do\",\"Gangwon-do\",\"Gyeonggi-do\",\"Ulsan\",\"Daejeon\",\"Gwangju\",\"Incheon\",\"Daegu\",\"Busan\",\"Seoul\",\"Whole country\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],\"categoryorder\":\"array\",\"categoryarray\":[\"Sejong\",\"Jeju\",\"Gyeongsangnam-do\",\"Gyeongsangbuk-do\",\"Jeollanam-do\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Chungcheongbuk-do\",\"Gangwon-do\",\"Gyeonggi-do\",\"Ulsan\",\"Daejeon\",\"Gwangju\",\"Incheon\",\"Daegu\",\"Busan\",\"Seoul\",\"Whole country\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"17 first-tier administrative divisions\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":10.6268161062682}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"title\":{\"text\":\"Increase rate of employees in 2019 (compared to 2018)<br><sup>Source: Ministry of Public Administration and Security (KOSIS)<\\/sup>\",\"x\":0.1,\"font\":{\"size\":15}}},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"11144b53a52\":{\"x\":{},\"y\":{},\"type\":\"bar\"},\"111469dc4ce6\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"11144b53a52\",\"visdat\":{\"11144b53a52\":[\"function (y) \",\"x\"],\"111469dc4ce6\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## - Increase rate of the number of employees in 2020 compared to 2018\n\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nemp_num %>% \n    mutate(increase=round(((employee_2020-employee_2018)/employee_2018)*100,2)) %>%\n    select(Local_Divisions,increase) %>% \n    arrange(increase) %>% \n    ggplot(aes(x=Local_Divisions,y=increase)) + \n    geom_bar(stat = \"identity\", position = \"dodge\") +\n    theme_classic() +\n    geom_text(aes(label= paste(sprintf(\"%2.2f\", increase),\"%\",sep=\"\")), size=3, position = position_dodge(width = 1))+\n  labs(x=\"17 first-tier administrative divisions\",\n       y=\"Increase Rate(%)\")+\n  scale_y_continuous(breaks=seq(0, 15, 1)) + \n  theme(text=element_text(family=\"Lato\",size=10),\n        plot.title = element_text(size = 5)) +\n  coord_flip() -> p \n\nplotly::ggplotly(p, tooltip=\"text\") %>% \n    style(textposition = \"left\") %>% \n    layout(title = list(text = paste0(\n        'Decrease rate of employees in 2020 (compared to 2018)',\n        '<br>',\n        '<sup>',\n        'Source: Ministry of Public Administration and Security (KOSIS)','</sup>'),\n        x = 0.1,\n        font=list(size=15)))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-594244f3b4214bd89801\" style=\"width:100%;height:590px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-594244f3b4214bd89801\">{\"x\":{\"data\":[{\"orientation\":\"h\",\"width\":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999,0.9,0.9,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.899999999999999],\"base\":[-15,-13.72,-13.51,-12.98,-12.03,-11.94,-11.19,-10.09,-9.5,-9.43,-9.12,-8.23,-7.29,-7.28,-7.14,-6.77,-6.69,-6.5],\"x\":[15,13.72,13.51,12.98,12.03,11.94,11.19,10.09,9.5,9.43,9.12,8.23,7.29,7.28,7.14,6.77,6.69,6.5],\"y\":[15,9,16,12,2,11,3,4,18,17,7,6,1,13,14,10,5,8],\"text\":\"\",\"type\":\"bar\",\"textposition\":\"left\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(89,89,89,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-15,-13.72,-13.51,-12.98,-12.03,-11.94,-11.19,-10.09,-9.5,-9.43,-9.12,-8.23,-7.29,-7.28,-7.14,-6.77,-6.69,-6.5],\"y\":[15,9,16,12,2,11,3,4,18,17,7,6,1,13,14,10,5,8],\"text\":[\"-15.00%\",\"-13.72%\",\"-13.51%\",\"-12.98%\",\"-12.03%\",\"-11.94%\",\"-11.19%\",\"-10.09%\",\"-9.50%\",\"-9.43%\",\"-9.12%\",\"-8.23%\",\"-7.29%\",\"-7.28%\",\"-7.14%\",\"-6.77%\",\"-6.69%\",\"-6.50%\"],\"hovertext\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],\"textfont\":{\"size\":11.3385826771654,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null,\"textposition\":\"left\"}],\"layout\":{\"margin\":{\"t\":24.0365296803653,\"r\":7.30593607305936,\"b\":35.5998339559983,\"l\":114.570361145704},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-15.75,0.75],\"tickmode\":\"array\",\"ticktext\":[\"0\"],\"tickvals\":[0],\"categoryorder\":\"array\",\"categoryarray\":[\"0\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Increase Rate(%)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,18.6],\"tickmode\":\"array\",\"ticktext\":[\"Sejong\",\"Jeju\",\"Gyeongsangnam-do\",\"Gyeongsangbuk-do\",\"Jeollanam-do\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Chungcheongbuk-do\",\"Gangwon-do\",\"Gyeonggi-do\",\"Ulsan\",\"Daejeon\",\"Gwangju\",\"Incheon\",\"Daegu\",\"Busan\",\"Seoul\",\"Whole country\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],\"categoryorder\":\"array\",\"categoryarray\":[\"Sejong\",\"Jeju\",\"Gyeongsangnam-do\",\"Gyeongsangbuk-do\",\"Jeollanam-do\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Chungcheongbuk-do\",\"Gangwon-do\",\"Gyeonggi-do\",\"Ulsan\",\"Daejeon\",\"Gwangju\",\"Incheon\",\"Daegu\",\"Busan\",\"Seoul\",\"Whole country\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"17 first-tier administrative divisions\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":10.6268161062682}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"title\":{\"text\":\"Decrease rate of employees in 2020 (compared to 2018)<br><sup>Source: Ministry of Public Administration and Security (KOSIS)<\\/sup>\",\"x\":0.1,\"font\":{\"size\":15}}},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"11143c3e32d4\":{\"x\":{},\"y\":{},\"type\":\"bar\"},\"1114424f6891\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"11143c3e32d4\",\"visdat\":{\"11143c3e32d4\":[\"function (y) \",\"x\"],\"1114424f6891\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nemp_num %>% \n    mutate(increase=round(((employee_2020-employee_2018)/employee_2018)*100,2)) %>%\n    select(Local_Divisions,increase) %>% \n    arrange(increase) %>% \n    ggplot(aes(x=factor(Local_Divisions,levels=rev(.$Local_Divisions)),y=increase)) + \n    geom_bar(stat = \"identity\", position = \"dodge\") +\n    theme_classic() +\n    geom_text(aes(label= paste(sprintf(\"%2.2f\", increase),\"%\",sep=\"\")), size=3, position = position_dodge(width = 1))+\n  labs(x=\"17 first-tier administrative divisions\",\n       y=\"Increase Rate(%)\")+\n  scale_y_continuous(breaks=seq(0, 15, 1)) + \n  theme(text=element_text(family=\"Lato\",size=10),\n        plot.title = element_text(size = 5)) +\n  coord_flip() -> p \n\nplotly::ggplotly(p, tooltip=\"text\") %>% \n    style(textposition = \"left\") %>% \n    layout(title = list(text = paste0(\n        'Decrease rate of employees in 2020 (compared to 2018)',\n        '<br>',\n        '<sup>',\n        'Source: Ministry of Public Administration and Security (KOSIS)','</sup>'),\n        x = 0.1,\n        font=list(size=15)))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Use of `.$Local_Divisions` is discouraged. Use `Local_Divisions` instead.\nUse of `.$Local_Divisions` is discouraged. Use `Local_Divisions` instead.\n```\n:::\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-489b9e1ca4f8eb739d01\" style=\"width:100%;height:590px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-489b9e1ca4f8eb739d01\">{\"x\":{\"data\":[{\"orientation\":\"h\",\"width\":[0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.9,0.9,0.9,0.9,0.9,0.9,0.9],\"base\":[-15,-13.72,-13.51,-12.98,-12.03,-11.94,-11.19,-10.09,-9.5,-9.43,-9.12,-8.23,-7.29,-7.28,-7.14,-6.77,-6.69,-6.5],\"x\":[15,13.72,13.51,12.98,12.03,11.94,11.19,10.09,9.5,9.43,9.12,8.23,7.29,7.28,7.14,6.77,6.69,6.5],\"y\":[18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],\"text\":\"\",\"type\":\"bar\",\"textposition\":\"left\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(89,89,89,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-15,-13.72,-13.51,-12.98,-12.03,-11.94,-11.19,-10.09,-9.5,-9.43,-9.12,-8.23,-7.29,-7.28,-7.14,-6.77,-6.69,-6.5],\"y\":[18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],\"text\":[\"-15.00%\",\"-13.72%\",\"-13.51%\",\"-12.98%\",\"-12.03%\",\"-11.94%\",\"-11.19%\",\"-10.09%\",\"-9.50%\",\"-9.43%\",\"-9.12%\",\"-8.23%\",\"-7.29%\",\"-7.28%\",\"-7.14%\",\"-6.77%\",\"-6.69%\",\"-6.50%\"],\"hovertext\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],\"textfont\":{\"size\":11.3385826771654,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null,\"textposition\":\"left\"}],\"layout\":{\"margin\":{\"t\":24.0365296803653,\"r\":7.30593607305936,\"b\":35.5998339559983,\"l\":114.570361145704},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-15.75,0.75],\"tickmode\":\"array\",\"ticktext\":[\"0\"],\"tickvals\":[0],\"categoryorder\":\"array\",\"categoryarray\":[\"0\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Increase Rate(%)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,18.6],\"tickmode\":\"array\",\"ticktext\":[\"Chungcheongbuk-do\",\"Jeollanam-do\",\"Gyeonggi-do\",\"Incheon\",\"Gwangju\",\"Sejong\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Seoul\",\"Whole country\",\"Gyeongsangbuk-do\",\"Gyeongsangnam-do\",\"Ulsan\",\"Jeju\",\"Daejeon\",\"Busan\",\"Gangwon-do\",\"Daegu\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],\"categoryorder\":\"array\",\"categoryarray\":[\"Chungcheongbuk-do\",\"Jeollanam-do\",\"Gyeonggi-do\",\"Incheon\",\"Gwangju\",\"Sejong\",\"Jeollabuk-do\",\"Chungcheongnam-do\",\"Seoul\",\"Whole country\",\"Gyeongsangbuk-do\",\"Gyeongsangnam-do\",\"Ulsan\",\"Jeju\",\"Daejeon\",\"Busan\",\"Gangwon-do\",\"Daegu\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Lato\",\"size\":10.6268161062682},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"17 first-tier administrative divisions\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":13.2835201328352}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Lato\",\"size\":10.6268161062682}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"title\":{\"text\":\"Decrease rate of employees in 2020 (compared to 2018)<br><sup>Source: Ministry of Public Administration and Security (KOSIS)<\\/sup>\",\"x\":0.1,\"font\":{\"size\":15}}},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"11143a0b211d\":{\"x\":{},\"y\":{},\"type\":\"bar\"},\"11146aa766f0\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"11143a0b211d\",\"visdat\":{\"11143a0b211d\":[\"function (y) \",\"x\"],\"11146aa766f0\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## - Trends of the number of local government employees from 2009 to 2020\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemployee_data %>% \n    filter(ad_division==\"Whole country\") %>%  \n    arrange(PRD_DE) %>% \n    transmute(year=(PRD_DE),number=DT) %>%\n    mutate_if(is.character,as.numeric) %>%\n    dplyr::mutate(Diff_growth = number - lag(number), \n    # Difference in route between years\n     Rate_percent = round((Diff_growth)/lag(number) * 100,2)) %>% \n    # growth rate in percent\n    filter(year>2008) %>% \n    mutate(year=factor(year)) -> employee3\n\n employee3 %>% \n    kbl(col.names = gsub(\"[_]\", \" \", names(.)),\n        caption = \"The decrease rate of the number of employees in 2020 compared to 2018\",\n        format.args = list(big.mark = \",\")) %>% \n    kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>The decrease rate of the number of employees in 2020 compared to 2018</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> year </th>\n   <th style=\"text-align:right;\"> number </th>\n   <th style=\"text-align:right;\"> Diff growth </th>\n   <th style=\"text-align:right;\"> Rate percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2009 </td>\n   <td style=\"text-align:right;\"> 278,303 </td>\n   <td style=\"text-align:right;\"> 3,072 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2010 </td>\n   <td style=\"text-align:right;\"> 279,636 </td>\n   <td style=\"text-align:right;\"> 1,333 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2011 </td>\n   <td style=\"text-align:right;\"> 281,035 </td>\n   <td style=\"text-align:right;\"> 1,399 </td>\n   <td style=\"text-align:right;\"> 0.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2012 </td>\n   <td style=\"text-align:right;\"> 284,355 </td>\n   <td style=\"text-align:right;\"> 3,320 </td>\n   <td style=\"text-align:right;\"> 1.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2013 </td>\n   <td style=\"text-align:right;\"> 287,299 </td>\n   <td style=\"text-align:right;\"> 2,944 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2014 </td>\n   <td style=\"text-align:right;\"> 289,914 </td>\n   <td style=\"text-align:right;\"> 2,615 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 296,273 </td>\n   <td style=\"text-align:right;\"> 6,359 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2016 </td>\n   <td style=\"text-align:right;\"> 303,401 </td>\n   <td style=\"text-align:right;\"> 7,128 </td>\n   <td style=\"text-align:right;\"> 2.41 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2017 </td>\n   <td style=\"text-align:right;\"> 310,654 </td>\n   <td style=\"text-align:right;\"> 7,253 </td>\n   <td style=\"text-align:right;\"> 2.39 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2018 </td>\n   <td style=\"text-align:right;\"> 322,862 </td>\n   <td style=\"text-align:right;\"> 12,208 </td>\n   <td style=\"text-align:right;\"> 3.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2019 </td>\n   <td style=\"text-align:right;\"> 337,084 </td>\n   <td style=\"text-align:right;\"> 14,222 </td>\n   <td style=\"text-align:right;\"> 4.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2020 </td>\n   <td style=\"text-align:right;\"> 292,182 </td>\n   <td style=\"text-align:right;\"> -44,902 </td>\n   <td style=\"text-align:right;\"> -13.32 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nfont_add_google(name=\"Noto Serif\")\nemployee3  %>% \n  ggplot(aes(x=as.factor(year))) + \n  geom_bar(aes(fill=\"pink\",y=Diff_growth),stat = \"identity\") + \n  theme_classic()+\n  geom_text(aes(y=Diff_growth+sign(Diff_growth)*-15,label= scales::comma(Diff_growth)), size=5,position = position_dodge(width = 1))+\n  theme(text=element_text(family=\"Noto Serif\",size=12),legend.position = \"none\")+\n  scale_x_discrete(labels = c(2009:2020))+\n  scale_y_continuous(breaks =seq(-45000,15000,by=5000)) +\n  labs(x=\"17 first-tier administrative divisions\",\n       y=\"Increase Rate(%)\")-> p1\n\nplotly::ggplotly(p1, tooltip=\"text\") %>% \n    style(textposition = \"center\") %>% \n    layout(title = list(text = paste0(\n        'Trends of the number of local government employees from 2009 to 2020',\n        '<br>',\n        '<sup>',\n        'Source: Ministry of Public Administration and Security (KOSIS)','</sup>'),\n        x = 0.01,\n        font=list(size=16)))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-4ac9a0c749d5c53694e4\" style=\"width:100%;height:590px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ac9a0c749d5c53694e4\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],\"base\":[0,0,0,0,0,0,0,0,0,0,0,-44902],\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[3072,1333,1399,3320,2944,2615,6359,7128,7253,12208,14222,44902],\"text\":\"\",\"type\":\"bar\",\"textposition\":\"center\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"name\":\"pink\",\"legendgroup\":\"pink\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[3057,1318,1384,3305,2929,2600,6344,7113,7238,12193,14207,-44887],\"text\":[\"3,072\",\"1,333\",\"1,399\",\"3,320\",\"2,944\",\"2,615\",\"6,359\",\"7,128\",\"7,253\",\"12,208\",\"14,222\",\"-44,902\"],\"hovertext\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],\"textfont\":{\"size\":18.8976377952756,\"color\":\"rgba(0,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null,\"textposition\":\"center\"}],\"layout\":{\"margin\":{\"t\":24.0365296803653,\"r\":7.30593607305936,\"b\":40.381901203819,\"l\":65.1556662515567},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Noto Serif\",\"size\":15.9402241594022},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,12.6],\"tickmode\":\"array\",\"ticktext\":[2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12],\"categoryorder\":\"array\",\"categoryarray\":[2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Noto Serif\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"17 first-tier administrative divisions\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Noto Serif\",\"size\":15.9402241594022}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-47858.2,17178.2],\"tickmode\":\"array\",\"ticktext\":[\"-45000\",\"-40000\",\"-35000\",\"-30000\",\"-25000\",\"-20000\",\"-15000\",\"-10000\",\"-5000\",\"0\",\"5000\",\"10000\",\"15000\"],\"tickvals\":[-45000,-40000,-35000,-30000,-25000,-20000,-15000,-10000,-5000,0,5000,10000,15000],\"categoryorder\":\"array\",\"categoryarray\":[\"-45000\",\"-40000\",\"-35000\",\"-30000\",\"-25000\",\"-20000\",\"-15000\",\"-10000\",\"-5000\",\"0\",\"5000\",\"10000\",\"15000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Noto Serif\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Increase Rate(%)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Noto Serif\",\"size\":15.9402241594022}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Noto Serif\",\"size\":12.7521793275218}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"title\":{\"text\":\"Trends of the number of local government employees from 2009 to 2020<br><sup>Source: Ministry of Public Administration and Security (KOSIS)<\\/sup>\",\"x\":0.01,\"font\":{\"size\":16}}},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"11146fe74dde\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"},\"111424283fd3\":{\"x\":{},\"y\":{},\"label\":{}}},\"cur_data\":\"11146fe74dde\",\"visdat\":{\"11146fe74dde\":[\"function (y) \",\"x\"],\"111424283fd3\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nemployee3  %>% \n  ggplot(aes(x=as.factor(year))) + \n  geom_bar(aes(x = as.factor(year), y = Diff_growth), stat = \"identity\",fill=\"gray\",alpha=0.3)+\n  geom_line(aes(x = as.integer(1:12), y = Rate_percent*3500),color=\"orange\",size=1)+\n  geom_point(aes(x = as.factor(year), y = Rate_percent*3500),color=\"red\",size=2, alpha=0.7) +\n  geom_text(aes(x = as.factor(year),y=Rate_percent*3500,label= paste(sprintf(\"%2.2f\", Rate_percent),\"%\",sep=\"\")),color=\"black\",hjust=-0.1,vjust=-2.3, size=8,position = position_dodge(width = 2))+\n  theme_classic()+\n  scale_y_continuous(sec.axis = sec_axis(~./3500, name = paste(\"Increase Rate  (%)\",\"\\n\"),breaks = seq(-15,10,5)),breaks =comma(seq(-50000,25000,by=5000),format = \"d\") )+\n  scale_x_discrete(labels = as.factor(c(2009:2020)))+\n  coord_cartesian(ylim=c(-50000,25000))+\n  labs(x=\"17 first-tier administrative divisions\",\n       y=\"Change in # of employees\",\n       title=\"Trends of the number of local government employees from 2009 to 2020\",\n       subtitle=\"Source: Ministry of Public Administration and Security (KOSIS)\") +\n  theme(text=element_text(family=\"Noto Serif\",size=25))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: position_dodge requires non-overlapping x intervals\n```\n:::\n\n::: {.cell-output-display}\n![](employees_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=1440}\n:::\n:::\n\n\n# 3. Conclusion\n\n-   The number of local government employees in 2020 decreased by 9.5% (compared to 2018) and 13.32 % (compared to 2019) by on average .\n\n-   This decrease was transitory, since it was affected by \"The Transition of Fire Officials to National Position (2020)\".\n\n-   However, there was severe conflict between politicians and local government regarding appropriate number of public employees. Some local governments use this data as an evidence for increasing local government employees. However, if the data are misinterpreted, there is a possibility of drawing a wrong conclusion.\n",
    "supporting": [
      "employees_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\r\n<script src=\"../site_libs/plotly-binding-4.10.0/plotly.js\"></script>\r\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/plotly-main-2.5.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}