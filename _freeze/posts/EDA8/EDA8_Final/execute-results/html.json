{
  "hash": "c8e95664d6fd0841b35c1075e9bf49d5",
  "result": {
    "markdown": "---\ntitle: \"EDA Assignment 8: Final Exam\"\nauthor: \"연세대학교 행정학과 2015128003 주상원\"\ndate: '2021 06 15'\noutput:\n  html_document:\n    df_print: paged\n    code-fold: true\n  word_document: default\ncategories: \n    \"Exploratory Data Analysis (2021 Spring) [in Korean]\"\n---\n\n\nEDA 방법 이외의 회귀분석, 다변량, 실험계획 등에서 배운 다른 방법도 사용할 수 있으나 EDA 방법이 기본이 되어야 한다. 같은 자료를 여러 가지 방법으로 분석할 수 있다. 한 가지 방법으로 끝내지 말고 다른 방법은 없는지 생각하여 보아라. 자료파일은 ASCII 형태로 되어 있다. \\[보조프로그램\\]의 \\[메모장\\]으로 파일을 열어 그 형식을 확인한 후 엑셀을 통하거나 R에서 직접 읽어 들여라. 아래한글에서도 열 수 있으나 <문자코드>를 잘 선택하여야 한다.\n\n작업한 부분은 기한 이내에 제출하여야 그 부분만이라도 감점없이 점수를 받을 수 있다.\n\n# 1.\n\n다음 자료는 사춘기 여성의 신경성 식욕 감퇴증에 대하여 일정 기간 동안 세 가지 방법으로 치료한 결과이다. 어느 방법이 가장 큰 효과를 보았나? \\[ANOREXIA.DAT\\]\n\nI Cognitive behavioral treatment\n\nII Control; standard treatment\n\nIII Family therapy\n\nWeights in Kg\n\n전처리 후 정리\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# weights \n\n# I Cognitive behavioral treatment \ncbt=read.delim(file=\"C://r/ANOREXIA.DAT\",header=F)[c(1,2)]\nnames(cbt)=c(\"before\",\"after\")\nhead(cbt,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  before after\n1   80.5  82.2\n2   84.9  85.6\n3   81.5  81.4\n4   82.6  81.9\n5   79.9  76.4\n```\n:::\n\n```{.r .cell-code}\ndim(cbt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29  2\n```\n:::\n\n```{.r .cell-code}\n# II Control; standard treatment\ncontrol=read.delim(file=\"C://r/ANOREXIA.DAT\",header=F)[c(3,4)][c(1:26),]\nnames(control)=c(\"before\",\"after\")\nhead(control,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  before after\n1   80.7  80.2\n2   89.4  80.1\n3   91.8  86.4\n4   74.0  86.3\n5   78.1  76.1\n```\n:::\n\n```{.r .cell-code}\ndim(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26  2\n```\n:::\n\n```{.r .cell-code}\n# III Family therapy\nfamily=read.delim(file=\"C://r/ANOREXIA.DAT\",header=F)[c(5,6)][c(1:17),]\nnames(family)=c(\"before\",\"after\")\nhead(family,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  before after\n1   83.8  95.2\n2   83.3  94.3\n3   86.0  91.5\n4   82.5  91.9\n5   86.7 100.3\n```\n:::\n\n```{.r .cell-code}\ndim(family)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17  2\n```\n:::\n:::\n\n\n항목의 수가 Cognitive behavioral treatment: 29 Control group: 26 Family Therapy: 17로 서로 다르다. 따라서 결측치를 처리하여 각각을 나누어서 표현하였다.\n\nTreatment별로 기술통계량을 제시하고 시각화 한 후 자료의 특성을 확인하고 각 Sample에 대한 paired t-Test를 진행할 예정이다.\n\n먼저, Cognitive behavioral treatment의 분석이다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(cbt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     before          after      \n Min.   :70.00   Min.   : 71.3  \n 1st Qu.:80.40   1st Qu.: 81.9  \n Median :82.60   Median : 83.9  \n Mean   :82.69   Mean   : 85.7  \n 3rd Qu.:85.00   3rd Qu.: 90.9  \n Max.   :94.90   Max.   :103.6  \n```\n:::\n\n```{.r .cell-code}\n85.7-82.69\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.01\n```\n:::\n\n```{.r .cell-code}\n83.9-82.60\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.3\n```\n:::\n\n```{.r .cell-code}\n# Cognitive behavioral treatment를 시행하기 이전 집단과 이후집단의 평균은 약 3kg정도 차이나고, median값은 1.3kg정도 차이나는 것으로 보인다.\n# 성장기의 식용 감퇴증이 다소 완화되어진 것을 확인할 수 있다.\nfivenum(cbt$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 70.0 80.4 82.6 85.0 94.9\n```\n:::\n\n```{.r .cell-code}\nfivenum(cbt$after)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  71.3  81.9  83.9  90.9 103.6\n```\n:::\n\n```{.r .cell-code}\n# Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 treament 이전 집단의 경우 stem 8*을 기준으로 leaf들이 어느정도 종모양의 대칭적 분포를 이루고 있는데, 반면 treatment 이후 집단의 경우 stem 8*이 중심이 되어지는 것은 맞지만 다소 퍼지게 된 것을 확인할 수 있다. \nlibrary(aplpack)\nstem.leaf.backback(cbt$before,cbt$after,rule.line = \"Sturges\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n_____________________________________________________\n  1 | 2: represents 12, leaf unit: 1 \n             cbt$before       cbt$after          \n_____________________________________________________\n    1                 0|  7* |123                3   \n    6             99666|  7. |56                 5   \n  (15)  444333211100000|  8* |11122222334      (11)  \n    8           9877765|  8. |55569             13   \n    1                 4|  9* |03                 8   \n                       |  9. |5668               6   \n                       | 10* |03                 2   \n_____________________________________________________\nn:                   29       29                 \n_____________________________________________________\n```\n:::\n\n```{.r .cell-code}\n# Boxplot\nboxplot(cbt,main=\"Boxplot of before and after Cognitive behavioral treatment\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(cbt)$out #처리 이전 집단의 총 두개의 Outlier: lower fence인 76.3 밖의 값과 outer fence인 89.2 밖의 두개의 값\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 94.9 70.0\n```\n:::\n\n```{.r .cell-code}\nboxplot(cbt)$stats\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1]  [,2]\n[1,] 76.3  71.3\n[2,] 80.4  81.9\n[3,] 82.6  83.9\n[4,] 85.0  90.9\n[5,] 89.2 103.6\n```\n:::\n\n```{.r .cell-code}\n# Skewness\nskewness = function(x) {\n  hl=fivenum(x)[2]\n  median=fivenum(x)[3]\n  hu=fivenum(x)[4]\n  skew=((hu-median)-(median-hl))/((hu-median)+(median-hl))\n  return(skew)\n}\nskewness(cbt$before) # 거의 Skewed 되어지지 않음 (매우 미세하게 skewed to the right)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.04347826\n```\n:::\n\n```{.r .cell-code}\nskewness(cbt$after) # Boxplot에서 확인하였듯이 Skewed to the right 되어 있음.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5555556\n```\n:::\n\n```{.r .cell-code}\n# Letter Value Display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\nlvd1=(lsum(cbt$before,6))\nlvd2=(lsum(cbt$after,6))\nlvd1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M  15.0 82.60 82.600 82.60   0.00\n2      H   8.0 80.40 82.700 85.00   4.60\n3      E   4.5 78.10 82.925 87.75   9.65\n4      D   2.5 76.40 82.675 88.95  12.55\n5      C   1.5 73.15 82.600 92.05  18.90\n6      B   1.0 70.00 82.450 94.90  24.90\n```\n:::\n\n```{.r .cell-code}\nlvd2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid  upper spread\n1      M  15.0 83.90 83.900  83.90   0.00\n2      H   8.0 81.90 86.400  90.90   9.00\n3      E   4.5 76.05 86.250  96.45  20.40\n4      D   2.5 72.95 86.175  99.40  26.45\n5      C   1.5 71.90 86.950 102.00  30.10\n6      B   1.0 71.30 87.450 103.60  32.30\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nlsum(cbt$before)[2,5]-lsum(cbt$before)[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.6\n```\n:::\n\n```{.r .cell-code}\nlsum(cbt$after)[2,5]-lsum(cbt$after)[2,3] #더 넓게 퍼져있는 것을 확인할 수 있음. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread / H-spread - 1.705)\n(lvd1[3,5]-lvd1[3,3])/(lvd1[2,5]-lvd1[2,3])-1.705 # more peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3928261\n```\n:::\n\n```{.r .cell-code}\n(lvd2[3,5]-lvd2[3,3])/(lvd2[2,5]-lvd2[2,3])-1.705 # more peaked than normal (Kurtosis값도 더 크게 나타남)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5616667\n```\n:::\n\n```{.r .cell-code}\n# 정규성\nqqnorm(cbt$before, ylab=\"before quantiles\",main=\"before\");qqline(cbt$before, col='red',lty=2,lwd=2) #위에서 언급했던 두개의 Outlier들만 제외하면 대부분 정규분포를 잘 따르고 있는 것이 확인되어지고 있다. \nfiv1=fivenum(cbt$before)\n(pseudosigma1 = (fiv1[4]-fiv1[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.432836\n```\n:::\n\n```{.r .cell-code}\nsd(cbt$before) # 약 1.4정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.845495\n```\n:::\n\n```{.r .cell-code}\nabline(fiv1[3],pseudosigma1,col=\"blue\",lty=2,lwd=2)\nlegend(x = -2, y = 92, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 거의 일치중\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(cbt$after, ylab=\"after quantiles\", main=\"after\");qqline(cbt$after, col='red',lty=2,lwd=2) #정규분포를 따른다고 보기 어려운 이유가 값들이 직선을 따르기 보다는 곡선의 형태를 띄고 있음을 확인할 수 있다.  \nfiv2=fivenum(cbt$after)\n(pseudosigma2 = (fiv2[4]-fiv2[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.716418\n```\n:::\n\n```{.r .cell-code}\nsd(cbt$after) # 약 1.6정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8.351924\n```\n:::\n\n```{.r .cell-code}\nabline(fiv2[3],pseudosigma2,col=\"blue\",lty=2,lwd=2)\nlegend(x = -2, y = 100, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 약간차이를 보임\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Paired T-test\n# H0: cbt$after-cbt$before=0  H1: cbt$after-cbt$before>0 \ncbt_test<-t.test(cbt$after,cbt$before, paired=TRUE, alternative=\"greater\",conf.level=0.05)\ncbt_test # reject null hypothesis, the weight of after treatment is heavier\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  cbt$after and cbt$before\nt = 2.2156, df = 28, p-value = 0.01751\nalternative hypothesis: true mean difference is greater than 0\n5 percent confidence interval:\n 5.315595      Inf\nsample estimates:\nmean difference \n       3.006897 \n```\n:::\n:::\n\n\n다음으로는 통제집단의 분석이다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     before          after      \n Min.   :70.50   Min.   :73.00  \n 1st Qu.:77.72   1st Qu.:77.58  \n Median :80.65   Median :80.70  \n Mean   :81.56   Mean   :81.11  \n 3rd Qu.:85.88   3rd Qu.:84.67  \n Max.   :91.80   Max.   :89.60  \n```\n:::\n\n```{.r .cell-code}\nmean(control$after)-mean(control$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.45\n```\n:::\n\n```{.r .cell-code}\nmedian(control$after)-median(control$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05\n```\n:::\n\n```{.r .cell-code}\n# 통제집단의 경우 실험 시행하기 이전 집단과 실험 이후 집단의 평균은 0.45kg정도 차이를 보이며 중위값은 큰 차이가 없다.\n# Cognitive behavioral treatment에서 보였던 차이보다 적은 차이를 보이고 있는 것을 확인할 수 있다.\n\nfivenum(control$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 70.50 77.60 80.65 86.00 91.80\n```\n:::\n\n```{.r .cell-code}\nfivenum(control$after)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 73.0 77.4 80.7 84.7 89.6\n```\n:::\n\n```{.r .cell-code}\n# Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 처치 이전 집단의 경우 stem 7. stem 8. 두개의 축을 기준으로 Cluster를 가지고 있는데 비해 처치 이후의 집단의 경우 stem 7., stem8*두개의 stem을 기준으로 어느정도 대칭적으로 종모양을 보이고 있는 것이 확인된다.\nstem.leaf.backback(control$before,control$after,rule.line = \"Sturge\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n_______________________________________\n  1 | 2: represents 12, leaf unit: 1 \n    control$before       control$after\n_______________________________________\n   3         420|  7* |33          2   \n  12   998887775|  7. |556778899  11   \n  (5)      44100|  8* |001111444  (9)  \n   9    99887655|  8. |666889      6   \n   1           1|  9* |                \n                |  9. |                \n                | 10* |                \n_______________________________________\nn:            26       26          \n_______________________________________\n```\n:::\n\n```{.r .cell-code}\n# Boxplot\nboxplot(control,main=\"Boxplot of before and after standard treatment\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(control)$out #처리 이전 이후 둘다 outlier는 없는 것으로 보인다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nnumeric(0)\n```\n:::\n\n```{.r .cell-code}\nboxplot(control)$stats\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1] [,2]\n[1,] 70.50 73.0\n[2,] 77.60 77.4\n[3,] 80.65 80.7\n[4,] 86.00 84.7\n[5,] 91.80 89.6\n```\n:::\n\n```{.r .cell-code}\n# Skewness\nskewness(control$before) # skewed to the right\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2738095\n```\n:::\n\n```{.r .cell-code}\nskewness(control$after) # 거의 Skewed 되어지지 않음 (매우 미세하게 skewed to the right)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.09589041\n```\n:::\n\n```{.r .cell-code}\n# Letter Value Display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\nlvd3=(lsum(control$before,6))\nlvd4=(lsum(control$after,6))\nlvd3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M  13.5 80.65 80.650 80.65   0.00\n2      H   7.0 77.60 81.800 86.00   8.40\n3      E   4.0 75.10 81.900 88.70  13.60\n4      D   2.5 73.15 81.175 89.20  16.05\n5      C   1.5 71.40 81.000 90.60  19.20\n6      B   1.0 70.50 81.150 91.80  21.30\n```\n:::\n\n```{.r .cell-code}\nlvd4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M  13.5 80.70 80.700 80.70   0.00\n2      H   7.0 77.40 81.050 84.70   7.30\n3      E   4.0 75.40 81.050 86.70  11.30\n4      D   2.5 74.30 81.275 88.25  13.95\n5      C   1.5 73.25 81.100 88.95  15.70\n6      B   1.0 73.00 81.300 89.60  16.60\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nlsum(control$before)[2,5]-lsum(control$before)[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8.4\n```\n:::\n\n```{.r .cell-code}\nlsum(control$after)[2,5]-lsum(control$after)[2,3] # 처치 이후 spread의 크기가 더 줄어들었음 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7.3\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread / H-spread - 1.705)\n(lvd3[3,5]-lvd3[3,3])/(lvd3[2,5]-lvd3[2,3])-1.705 # less peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.08595238\n```\n:::\n\n```{.r .cell-code}\n(lvd4[3,5]-lvd4[3,3])/(lvd4[2,5]-lvd4[2,3])-1.705 # less peaked than normal (Kurtosis값은 after집단에서 더 작게 나타남)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.1570548\n```\n:::\n\n```{.r .cell-code}\n# 정규성\nqqnorm(control$before, ylab=\"before quantiles\",main=\"before\");qqline(control$before, col='red',lty=2) # 점들이 완벽히 qqline을 따르기 보다는 곡선의 형태를 이루고 있는 것을 확인할 수 있다.\nfiv3=fivenum(control$before)\n(pseudosigma3 = (fiv3[4]-fiv3[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.268657\n```\n:::\n\n```{.r .cell-code}\nsd(control$before) # 약 0.5정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.70706\n```\n:::\n\n```{.r .cell-code}\nabline(fiv3[3],pseudosigma3,col=\"blue\",lty=2)\nlegend(x = -2, y = 92, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 약간차이를 보임\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(control$after, ylab=\"after quantiles\", main=\"after\");qqline(control$after, col='red',lty=2) # 처치 이전에 비해서 처치 이후의 데이터들이 직선을 따르기 때문에 정규분포를 조금 더 따르고 있다.  \nfiv4=fivenum(control$after)\n(pseudosigma4 = (fiv4[4]-fiv4[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.447761\n```\n:::\n\n```{.r .cell-code}\nsd(control$after) # 약 0.7정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.744253\n```\n:::\n\n```{.r .cell-code}\nabline(fiv4[3],pseudosigma4,col=\"blue\",lty=2)\nlegend(x = -2, y = 88, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 거의 차이가 없음\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Paired T-test\n# H0: 처지 이전의 집단과 처치 이후의 집단의 몸무게 차이는 없다. H1: 처치 이후의 집단의 몸무게가 처지 이전의 집단보다 더 무겁다.\ncontrol_test<-t.test(control$after,control$before, paired=TRUE, alternative=\"greater\",conf.level=0.05)\ncontrol_test # do not reject null hypothesis.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  control$after and control$before\nt = -0.28723, df = 25, p-value = 0.6118\nalternative hypothesis: true mean difference is greater than 0\n5 percent confidence interval:\n 2.226168      Inf\nsample estimates:\nmean difference \n          -0.45 \n```\n:::\n:::\n\n\n마지막으로 Family therapy에 대한 분석이다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(family)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     before          after       \n Min.   :73.40   Min.   : 75.20  \n 1st Qu.:80.50   1st Qu.: 90.70  \n Median :83.30   Median : 92.50  \n Mean   :83.23   Mean   : 90.49  \n 3rd Qu.:86.00   3rd Qu.: 95.20  \n Max.   :94.20   Max.   :101.60  \n```\n:::\n\n```{.r .cell-code}\nmean(family$after)-mean(family$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7.264706\n```\n:::\n\n```{.r .cell-code}\nmedian(family$after)-median(family$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9.2\n```\n:::\n\n```{.r .cell-code}\n# Family Therapy의 경우 실험 시행하기 이전 집단과 실험 이후 집단의 평균은 7.2kg정도 차이를 보이며 중위값은 9.2kg정도 차이가 나타난다.\n# Cognitive behavioral treatment에서 보였던 차이보다 적은 차이를 보이고 있는 것을 확인할 수 있다.\n\nfivenum(family$before)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 73.4 80.5 83.3 86.0 94.2\n```\n:::\n\n```{.r .cell-code}\nfivenum(family$after)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  75.2  90.7  92.5  95.2 101.6\n```\n:::\n\n```{.r .cell-code}\n# Stem and leaf Plot을 통해서 두 집단의 분포를 비교해 보았는데 처치 이전 집단의 경우  stem 8*을 기준으로 대칭적인 종모양을 보이는데 비해 처치 이후의 집단의 경우 stem 9*이 가장 많고 대칭적이지 않으며 중간에 빈 부분이 보인다.\nstem.leaf.backback(family$before,family$after,rule.line = \"Sturge\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n_____________________________________\n  1 | 2: represents 12, leaf unit: 1 \n    family$before       family$after\n_____________________________________\n   1          3|  7* |               \n   4        976|  7. |5667       4   \n  (7)   3332210|  8* |               \n   6      97666|  8. |               \n   1          4|  9* |01112344  (8)  \n               |  9. |558        5   \n               | 10* |01         2   \n               | 10. |               \n               | 11* |               \n_____________________________________\nn:           17       17         \n_____________________________________\n```\n:::\n\n```{.r .cell-code}\n# Boxplot\nboxplot(family,main=\"Boxplot of before and after family treatment\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(family)$out #처리 이후의 집단에서 4개의 outlier 확인됨. (아까 Stem and leaf에서 확인 한 부분 재확인)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 76.7 76.8 75.2 77.8\n```\n:::\n\n```{.r .cell-code}\nboxplot(family)$stats # lower fence=lower hinge\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1]  [,2]\n[1,] 73.4  90.7\n[2,] 80.5  90.7\n[3,] 83.3  92.5\n[4,] 86.0  95.2\n[5,] 94.2 101.6\n```\n:::\n\n```{.r .cell-code}\n# Skewness\nskewness(family$before) # skewed to the left (but 매우 미세함)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.01818182\n```\n:::\n\n```{.r .cell-code}\nskewness(family$after) # skewed to the right\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2\n```\n:::\n\n```{.r .cell-code}\n# Letter Value Display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\nlvd5=(lsum(family$before,6))\nlvd6=(lsum(family$after,6))\nlvd5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower   mid upper spread\n1      M   9.0 83.30 83.30 83.30    0.0\n2      H   5.0 80.50 83.25 86.00    5.5\n3      E   3.0 77.60 82.45 87.30    9.7\n4      D   2.0 76.90 83.40 89.90   13.0\n5      C   1.5 75.15 83.60 92.05   16.9\n6      B   1.0 73.40 83.80 94.20   20.8\n```\n:::\n\n```{.r .cell-code}\nlvd6\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower   mid  upper spread\n1      M   9.0 92.50 92.50  92.50    0.0\n2      H   5.0 90.70 92.95  95.20    4.5\n3      E   3.0 76.80 87.40  98.00   21.2\n4      D   2.0 76.70 88.50 100.30   23.6\n5      C   1.5 75.95 88.45 100.95   25.0\n6      B   1.0 75.20 88.40 101.60   26.4\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nlvd5[2,5]-lvd5[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.5\n```\n:::\n\n```{.r .cell-code}\nlvd6[2,5]-lvd6[2,3] # 처치 이전이후의 차이가 1정도로 크지 않음.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.5\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread / H-spread - 1.705)\n(lvd5[3,5]-lvd5[3,3])/(lvd5[2,5]-lvd5[2,3])-1.705 # 정규분포와 거의 차이가 없음\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05863636\n```\n:::\n\n```{.r .cell-code}\n(lvd6[3,5]-lvd6[3,3])/(lvd6[2,5]-lvd6[2,3])-1.705 # more peaked than normal (Kurtosis값은 after집단에서 더 작게 나타남) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.006111\n```\n:::\n\n```{.r .cell-code}\n# 다만 after집단의 분포가 17개의 자료중 4개의 outlier로 인해서 왜곡되었을 가능성이 있다.\n\n# 정규성\nqqnorm(family$before, ylab=\"before quantiles\",main=\"before\");qqline(family$before, col='red',lty=2) # 점들이 직선을 잘 따르고 있는 것으로 보인다. \nfiv5=fivenum(family$before)\n(pseudosigma5 = (fiv5[4]-fiv5[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.104478\n```\n:::\n\n```{.r .cell-code}\nsd(family$before) # 약 0.9정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.016693\n```\n:::\n\n```{.r .cell-code}\nabline(fiv5[3],pseudosigma5,col=\"blue\",lty=2)\nlegend(x = -1.8, y = 92, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 거의 차이가 없음\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(family$after, ylab=\"after quantiles\", main=\"after\");qqline(family$after, col='red',lty=2) # 이상치 4개를 제외하면 나머지들이 직선을 잘 따르는 것으로 보이나 표본이 작아 신뢰성이 낮다.   \nfiv6=fivenum(family$after)\n(pseudosigma6 = (fiv6[4]-fiv6[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.358209\n```\n:::\n\n```{.r .cell-code}\nsd(family$after) # 약 5 정도의 차이 - 매우 큼\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8.475072\n```\n:::\n\n```{.r .cell-code}\nabline(fiv6[3],pseudosigma6,col=\"blue\",lty=2)\nlegend(x = -1.8, y = 99, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 거의 차이가 없음 \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Paired T-test\n# H0: family$after-family$before=0 H1:family$after-family$before>0\nfamily_test<-t.test(family$after,family$before, paired=TRUE, alternative=\"greater\",conf.level=0.05)\nfamily_test # Reject Null Hypothesis. The weight of treated group is larger than the group without treatment.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  family$after and family$before\nt = 4.1849, df = 16, p-value = 0.0003501\nalternative hypothesis: true mean difference is greater than 0\n5 percent confidence interval:\n 10.29544      Inf\nsample estimates:\nmean difference \n       7.264706 \n```\n:::\n:::\n\n\n세집단의 차이에 대해 일원분산분석을 진행하고자 한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbt_diff=cbt$after-cbt$before\ncon_diff=control$after-control$before\nfam_diff=family$after-family$before\n\nboxplot(cbt_diff,con_diff,fam_diff,names=c(\"Cognitive\",\"Control\",\"Family\"))$out #Cognitive Behavior Treament 7개의 outlier\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 14.9 17.1 11.7 20.9 -9.1 12.6 15.4\n```\n:::\n\n```{.r .cell-code}\nnaming=c(rep(\"cbt\",length(cbt_diff)),rep(\"control\",length(con_diff)),rep(\"family\",length(fam_diff)))\nvalue=c(cbt_diff,con_diff,fam_diff)\ndiffs=data.frame(naming,value)\n\naov1=aov(value~naming,data=diffs)\nsummary(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)   \nnaming       2    615  307.32   5.422 0.0065 **\nResiduals   69   3911   56.68                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#H0: 각 집단간 평균은 차이가 없다. #H1: 각 집단간 평균은 차이가 없지 않다.\n# Reject Null Hypothesis. 신뢰수준 95% 수준에서 사춘기 여성의 신경성 식욕 감퇴증의 각 치료 방법(Cognitive behavior, control, family treatment)을 적용할 경우 각 집단간 몸무게에서 차이를 보인다. \n\nbartlett.test(value~naming, data = diffs) #H0: 오차의 등분산성, 유의수준 10%에서 Select Null Hypothesis. (오차의 등분산성 만족)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  value by naming\nBartlett's K-squared = 0.30428, df = 2, p-value = 0.8589\n```\n:::\n\n```{.r .cell-code}\ntapply(value,naming,mean)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      cbt   control    family \n 3.006897 -0.450000  7.264706 \n```\n:::\n\n```{.r .cell-code}\nTukeyHSD(aov1) # Tukey multiple comparisons of means 95% family-wise\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = value ~ naming, data = diffs)\n\n$naming\n                    diff       lwr       upr     p adj\ncontrol-cbt    -3.456897 -8.327276  1.413483 0.2124428\nfamily-cbt      4.257809 -1.250554  9.766173 0.1607461\nfamily-control  7.714706  2.090124 13.339288 0.0045127\n```\n:::\n\n```{.r .cell-code}\n# install.packages(\"agricolae\")\nlibrary(agricolae)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'agricolae'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked _by_ '.GlobalEnv':\n\n    skewness\n```\n:::\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nHSD.test(aov1, \"naming\", group=TRUE,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov1 ~ \"naming\"\n\nHSD Test for value \n\nMean Square Error:  56.67743 \n\nnaming,  means\n\n            value      std  r   Min  Max\ncbt      3.006897 7.308504 29  -9.1 20.9\ncontrol -0.450000 7.988705 26 -12.2 15.9\nfamily   7.264706 7.157421 17  -5.3 21.5\n\nAlpha: 0.05 ; DF Error: 69 \nCritical Value of Studentized Range: 3.387483 \n\nGroups according to probability of means differences and alpha level( 0.05 )\n\nTreatments with the same letter are not significantly different.\n\n            value groups\nfamily   7.264706      a\ncbt      3.006897     ab\ncontrol -0.450000      b\n```\n:::\n\n```{.r .cell-code}\nLSD.test(aov1, \"naming\", group=TRUE,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov1 ~ \"naming\"\n\nLSD t Test for value \n\nMean Square Error:  56.67743 \n\nnaming,  means and individual ( 95 %) CI\n\n            value      std  r       LCL       UCL   Min  Max\ncbt      3.006897 7.308504 29  0.217970  5.795823  -9.1 20.9\ncontrol -0.450000 7.988705 26 -3.395435  2.495435 -12.2 15.9\nfamily   7.264706 7.157421 17  3.622105 10.907307  -5.3 21.5\n\nAlpha: 0.05 ; DF Error: 69\nCritical Value of t: 1.994945 \n\nGroups according to probability of means differences and alpha level( 0.05 )\n\nTreatments with the same letter are not significantly different.\n\n            value groups\nfamily   7.264706      a\ncbt      3.006897     ab\ncontrol -0.450000      b\n```\n:::\n:::\n\n\n통제집단에 비해서 cognitive behavior treatemnt는 3.46kg정도 높음. cognitive behavior treatment 집단에 비해서 family treatemnt 집단의 경우 4.26kg 정도 높음. 따라서 가장 효과가 좋은 순서대로 family treatment, cognitive behavior treatment, control 순이다.\n\n그러나 cognitive behavior treatment집단이 다른 집단에 비해서 크거나 작다라고 보기에는 HSD, LSD test를 통해서 확인할 경우 신뢰구간이 겹쳐 다소 모호한 부분이 있다. 실제 Boxplot을 통해 확인할 경우 outlier들이 넓게 퍼져있어서 cognitive behavior treatment집단의 몸무게가 유의수준 5%수준에서 두 집단의 몸무게와 완전히 다르다고 보기 어렵다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 이원분산분석 \n\nlibrary(reshape2)\n\ncontrol2=melt(control)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\ncontrol2=cbind(rep(\"control\",dim(control2)[1]),control2)\nnames(control2)=c(\"treatment\",\"ba\",\"value\")\n\ncbt2=melt(cbt)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\ncbt2=cbind(rep(\"cognitive\",dim(cbt2)[1]),cbt2)\nnames(cbt2)=c(\"treatment\",\"ba\",\"value\")\n\nfamily2=melt(family)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\nfamily2=cbind(rep(\"family\",dim(family2)[1]),family2)\nnames(family2)=c(\"treatment\",\"ba\",\"value\")\nfamily2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   treatment     ba value\n1     family before  83.8\n2     family before  83.3\n3     family before  86.0\n4     family before  82.5\n5     family before  86.7\n6     family before  79.6\n7     family before  76.9\n8     family before  94.2\n9     family before  73.4\n10    family before  80.5\n11    family before  81.6\n12    family before  82.1\n13    family before  77.6\n14    family before  83.5\n15    family before  89.9\n16    family before  86.0\n17    family before  87.3\n18    family  after  95.2\n19    family  after  94.3\n20    family  after  91.5\n21    family  after  91.9\n22    family  after 100.3\n23    family  after  76.7\n24    family  after  76.8\n25    family  after 101.6\n26    family  after  94.9\n27    family  after  75.2\n28    family  after  77.8\n29    family  after  95.5\n30    family  after  90.7\n31    family  after  92.5\n32    family  after  93.8\n33    family  after  91.7\n34    family  after  98.0\n```\n:::\n\n```{.r .cell-code}\naov2=rbind(control2,cbt2,family2)\naov3=aov(value~treatment+ba,data=aov2) \nsummary(aov3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment     2    644   322.1   7.713 0.000664 ***\nba            1    275   275.0   6.585 0.011335 *  \nResiduals   140   5847    41.8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlibrary(doBy)\nsummaryBy(value ~ treatment, data=aov2, FUN = c(mean, sd, min, max))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  treatment value.mean value.sd value.min value.max\n1 cognitive   84.19310 6.935337      70.0     103.6\n2   control   81.33269 5.201045      70.5      91.8\n3    family   86.86176 7.785963      73.4     101.6\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov3, \"treatment\", group=TRUE,console=TRUE) # family cognitive standard 순이지만 cognitive behavior treatment는 a그룹 b그룹 모두에 속하므로 해석에 유의해야 한다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov3 ~ \"treatment\"\n\nHSD Test for value \n\nMean Square Error:  41.76232 \n\ntreatment,  means\n\n             value      std  r  Min   Max\ncognitive 84.19310 6.935337 58 70.0 103.6\ncontrol   81.33269 5.201045 52 70.5  91.8\nfamily    86.86176 7.785963 34 73.4 101.6\n\nAlpha: 0.05 ; DF Error: 140 \nCritical Value of Studentized Range: 3.350136 \n\nGroups according to probability of means differences and alpha level( 0.05 )\n\nTreatments with the same letter are not significantly different.\n\n             value groups\nfamily    86.86176      a\ncognitive 84.19310     ab\ncontrol   81.33269      b\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov3, \"ba\", group=TRUE,console=TRUE) # 전반적으로 더 높다 treatment 취한 그룹에서 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov3 ~ \"ba\"\n\nHSD Test for value \n\nMean Square Error:  41.76232 \n\nba,  means\n\n          value      std  r  Min   Max\nafter  85.17222 8.035173 72 71.3 103.6\nbefore 82.40833 5.182466 72 70.0  94.9\n\nAlpha: 0.05 ; DF Error: 140 \nCritical Value of Studentized Range: 2.795976 \n\nMinimun Significant Difference: 2.129411 \n\nTreatments with the same letter are not significantly different.\n\n          value groups\nafter  85.17222      a\nbefore 82.40833      b\n```\n:::\n\n```{.r .cell-code}\n# Interaction Plot\n\nid=(1:dim(aov2)[1])\naov2=cbind(id,aov2)\naov2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     id treatment     ba value\n1     1   control before  80.7\n2     2   control before  89.4\n3     3   control before  91.8\n4     4   control before  74.0\n5     5   control before  78.1\n6     6   control before  88.3\n7     7   control before  87.3\n8     8   control before  75.1\n9     9   control before  80.6\n10   10   control before  78.4\n11   11   control before  77.6\n12   12   control before  88.7\n13   13   control before  81.3\n14   14   control before  78.1\n15   15   control before  70.5\n16   16   control before  77.3\n17   17   control before  85.2\n18   18   control before  86.0\n19   19   control before  84.1\n20   20   control before  79.7\n21   21   control before  85.5\n22   22   control before  84.4\n23   23   control before  79.6\n24   24   control before  77.5\n25   25   control before  72.3\n26   26   control before  89.0\n27   27   control  after  80.2\n28   28   control  after  80.1\n29   29   control  after  86.4\n30   30   control  after  86.3\n31   31   control  after  76.1\n32   32   control  after  78.1\n33   33   control  after  75.1\n34   34   control  after  86.7\n35   35   control  after  73.5\n36   36   control  after  84.6\n37   37   control  after  77.4\n38   38   control  after  79.5\n39   39   control  after  89.6\n40   40   control  after  81.4\n41   41   control  after  81.8\n42   42   control  after  77.3\n43   43   control  after  84.2\n44   44   control  after  75.4\n45   45   control  after  79.5\n46   46   control  after  73.0\n47   47   control  after  88.3\n48   48   control  after  84.7\n49   49   control  after  81.4\n50   50   control  after  81.2\n51   51   control  after  88.2\n52   52   control  after  78.8\n53   53 cognitive before  80.5\n54   54 cognitive before  84.9\n55   55 cognitive before  81.5\n56   56 cognitive before  82.6\n57   57 cognitive before  79.9\n58   58 cognitive before  88.7\n59   59 cognitive before  94.9\n60   60 cognitive before  76.3\n61   61 cognitive before  81.0\n62   62 cognitive before  80.5\n63   63 cognitive before  85.0\n64   64 cognitive before  89.2\n65   65 cognitive before  81.3\n66   66 cognitive before  76.5\n67   67 cognitive before  70.0\n68   68 cognitive before  80.4\n69   69 cognitive before  83.3\n70   70 cognitive before  83.0\n71   71 cognitive before  87.7\n72   72 cognitive before  84.2\n73   73 cognitive before  86.4\n74   74 cognitive before  76.5\n75   75 cognitive before  80.2\n76   76 cognitive before  87.8\n77   77 cognitive before  83.3\n78   78 cognitive before  79.7\n79   79 cognitive before  84.5\n80   80 cognitive before  80.8\n81   81 cognitive before  87.4\n82   82 cognitive  after  82.2\n83   83 cognitive  after  85.6\n84   84 cognitive  after  81.4\n85   85 cognitive  after  81.9\n86   86 cognitive  after  76.4\n87   87 cognitive  after 103.6\n88   88 cognitive  after  98.4\n89   89 cognitive  after  93.4\n90   90 cognitive  after  73.4\n91   91 cognitive  after  82.1\n92   92 cognitive  after  96.7\n93   93 cognitive  after  95.3\n94   94 cognitive  after  82.4\n95   95 cognitive  after  72.5\n96   96 cognitive  after  90.9\n97   97 cognitive  after  71.3\n98   98 cognitive  after  85.4\n99   99 cognitive  after  81.6\n100 100 cognitive  after  89.1\n101 101 cognitive  after  83.9\n102 102 cognitive  after  82.7\n103 103 cognitive  after  75.7\n104 104 cognitive  after  82.6\n105 105 cognitive  after 100.4\n106 106 cognitive  after  85.2\n107 107 cognitive  after  83.6\n108 108 cognitive  after  84.6\n109 109 cognitive  after  96.2\n110 110 cognitive  after  86.7\n111 111    family before  83.8\n112 112    family before  83.3\n113 113    family before  86.0\n114 114    family before  82.5\n115 115    family before  86.7\n116 116    family before  79.6\n117 117    family before  76.9\n118 118    family before  94.2\n119 119    family before  73.4\n120 120    family before  80.5\n121 121    family before  81.6\n122 122    family before  82.1\n123 123    family before  77.6\n124 124    family before  83.5\n125 125    family before  89.9\n126 126    family before  86.0\n127 127    family before  87.3\n128 128    family  after  95.2\n129 129    family  after  94.3\n130 130    family  after  91.5\n131 131    family  after  91.9\n132 132    family  after 100.3\n133 133    family  after  76.7\n134 134    family  after  76.8\n135 135    family  after 101.6\n136 136    family  after  94.9\n137 137    family  after  75.2\n138 138    family  after  77.8\n139 139    family  after  95.5\n140 140    family  after  90.7\n141 141    family  after  92.5\n142 142    family  after  93.8\n143 143    family  after  91.7\n144 144    family  after  98.0\n```\n:::\n\n```{.r .cell-code}\naov2$treatment=as.factor(aov2$treatment)\naov2$ba=as.factor(aov2$ba)\naov2$id=as.factor(aov2$id)\nstr(aov2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t144 obs. of  4 variables:\n $ id       : Factor w/ 144 levels \"1\",\"2\",\"3\",\"4\",..: 1 2 3 4 5 6 7 8 9 10 ...\n $ treatment: Factor w/ 3 levels \"cognitive\",\"control\",..: 2 2 2 2 2 2 2 2 2 2 ...\n $ ba       : Factor w/ 2 levels \"before\",\"after\": 1 1 1 1 1 1 1 1 1 1 ...\n $ value    : num  80.7 89.4 91.8 74 78.1 88.3 87.3 75.1 80.6 78.4 ...\n```\n:::\n\n```{.r .cell-code}\naov4=aov(value~treatment*ba,data=aov2)\nsummary(aov4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment      2    644   322.1   8.025 0.000505 ***\nba             1    275   275.0   6.851 0.009847 ** \ntreatment:ba   2    307   153.7   3.828 0.024097 *  \nResiduals    138   5539    40.1                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(aov2$ba, aov2$treatment, aov2$value,main=\"Interaction plot\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nHSD.test(aov4, \"treatment\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov4 ~ \"treatment\"\n\nHSD Test for value \n\nMean Square Error:  40.1406 \n\ntreatment,  means\n\n             value      std  r  Min   Max\ncognitive 84.19310 6.935337 58 70.0 103.6\ncontrol   81.33269 5.201045 52 70.5  91.8\nfamily    86.86176 7.785963 34 73.4 101.6\n\nAlpha: 0.05 ; DF Error: 138 \nCritical Value of Studentized Range: 3.350657 \n\nGroups according to probability of means differences and alpha level( 0.05 )\n\nTreatments with the same letter are not significantly different.\n\n             value groups\nfamily    86.86176      a\ncognitive 84.19310     ab\ncontrol   81.33269      b\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov4, \"ba\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov4 ~ \"ba\"\n\nHSD Test for value \n\nMean Square Error:  40.1406 \n\nba,  means\n\n          value      std  r  Min   Max\nafter  85.17222 8.035173 72 71.3 103.6\nbefore 82.40833 5.182466 72 70.0  94.9\n\nAlpha: 0.05 ; DF Error: 138 \nCritical Value of Studentized Range: 2.796329 \n\nMinimun Significant Difference: 2.087921 \n\nTreatments with the same letter are not significantly different.\n\n          value groups\nafter  85.17222      a\nbefore 82.40833      b\n```\n:::\n:::\n\n\n# 2.\n\n근육 피로도의 지표로 쓰이는 혈중젖산농도의 참값과 계측기에서의 값의 자료이다. 계측기가 정확하다면 두 자료의 직선식은 원점을 지나는 45도 직선이어야 한다. 분석하여라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrue_val=c(rep(1,4),rep(3,5),rep(5,3),rep(10,4),rep(15,4))\nest_val=c(1.1,0.7,1.8,0.4,3.0,1.4,4.9,4.4,4.5,7.3,8.2,6.2,12,13.1,12.6,13.2,18.7,19.7,17.4,17.1)\n\nlactic=data.frame(true_val,est_val)\nlactic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   true_val est_val\n1         1     1.1\n2         1     0.7\n3         1     1.8\n4         1     0.4\n5         3     3.0\n6         3     1.4\n7         3     4.9\n8         3     4.4\n9         3     4.5\n10        5     7.3\n11        5     8.2\n12        5     6.2\n13       10    12.0\n14       10    13.1\n15       10    12.6\n16       10    13.2\n17       15    18.7\n18       15    19.7\n19       15    17.4\n20       15    17.1\n```\n:::\n\n```{.r .cell-code}\ndim(lactic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 20  2\n```\n:::\n\n```{.r .cell-code}\nsummary(lactic) #평균 실제 젖산값은 6.7, 평균 측정 젖산값은 8.385로 실제 값에 비해서 높게 측정되었다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    true_val       est_val      \n Min.   : 1.0   Min.   : 0.400  \n 1st Qu.: 3.0   1st Qu.: 2.700  \n Median : 5.0   Median : 6.750  \n Mean   : 6.7   Mean   : 8.385  \n 3rd Qu.:10.0   3rd Qu.:13.125  \n Max.   :15.0   Max.   :19.700  \n```\n:::\n\n```{.r .cell-code}\nmedtrue <- as.vector(3)\nmedest <- as.vector(3)\n\nmedtrue[1] <- median(lactic$true_val[1:6]); medest[1] <- median(lactic$est_val[1:6])\nmedtrue[2] <- median(lactic$true_val[7:14]); medest[2] <- median(lactic$est_val[7:14])\nmedtrue[3] <- median(lactic$true_val[15:20]); medest[3] <- median(lactic$est_val[15:20])\nplot(medest~medtrue, type=\"b\",main=\"True value와 Estimation Value 사이의 관계\")   # 다소 Concave 한 관계인 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(lactic$est_val~lactic$true_val,main=\"relationship of truevalue and estimatedvalue\")\n(z <- line(x=lactic$true_val,y=lactic$est_val))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nline(x = lactic$true_val, y = lactic$est_val)\n\nCoefficients:\n[1]  -0.9026   1.4053\n```\n:::\n\n```{.r .cell-code}\nabline(coef(z))\nresiduals(z)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  0.59736842  0.19736842  1.29736842 -0.10263158 -0.31315789 -1.91315789\n [7]  1.58684211  1.08684211  1.18684211  1.17631579  2.07631579  0.07631579\n[13] -1.15000000 -0.05000000 -0.55000000  0.05000000 -1.47631579 -0.47631579\n[19] -2.77631579 -3.07631579\n```\n:::\n\n```{.r .cell-code}\nz.ls <- lm(lactic$est_val ~ lactic$true_val)\nabline(z.ls$coef, lty=2,col=\"red\")\n\nlegend(x = 2, y = 18, c(\"R - Line\", \"Regression\"), \n       lty=c(1,2),lwd=2,col = c(\"black\",\"red\"),cex=0.7)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 잔차제곱합\nsum(residuals(z))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -2.552632\n```\n:::\n\n```{.r .cell-code}\nsum(residuals(z)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37.86429\n```\n:::\n\n```{.r .cell-code}\nattach(lactic)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked _by_ .GlobalEnv:\n\n    est_val, true_val\n```\n:::\n\n```{.r .cell-code}\n# 두 자료가 같은 분포에서 온게 맞을까?\nqqplot(true_val,est_val,main=\"qqplot\")\nabline(line(qqplot(true_val,est_val,main=\"qqplot\"))$coef) # 전반적으로 Tukey's robust line estimation 직선위에 잘 존재하는 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# 분포 예측하기\nlibrary(aplpack)\nstem.leaf.backback(true_val,est_val,rule.line=\"Sturges\") # 두 자료 모두 정규분포보다는 Skewed to the right 되어 있는 것을 어느정도 예측할 수 있다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n______________________________________\n  1 | 2: represents 12, leaf unit: 1 \n        true_val      est_val     \n______________________________________\n   9   333331111| 0* |001113444   9   \n  (3)        555| 0. |678        (3)  \n   8        0000| 1* |2233        8   \n   4        5555| 1. |7789        4   \n                | 2* |                \n______________________________________\nn:            20      20          \n______________________________________\n```\n:::\n\n```{.r .cell-code}\nskewness(true_val) # skewed to the right \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4285714\n```\n:::\n\n```{.r .cell-code}\nskewness(est_val) # 실제 자료에 비해서 덜 skewed 되어있다 (skewed to the right)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1906977\n```\n:::\n\n```{.r .cell-code}\n# Letter Value Display\nlvd7=(lsum(true_val,6))\nlvd8=(lsum(est_val,6))\nlvd7\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower mid upper spread\n1      M  10.5     5 5.0     5      0\n2      H   5.5     3 6.5    10      7\n3      E   3.0     1 8.0    15     14\n4      D   2.0     1 8.0    15     14\n5      C   1.5     1 8.0    15     14\n6      B   1.0     1 8.0    15     14\n```\n:::\n\n```{.r .cell-code}\nlvd8\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M  10.5  6.75  6.750  6.75   0.00\n2      H   5.5  2.40  7.775 13.15  10.75\n3      E   3.0  1.10  9.250 17.40  16.30\n4      D   2.0  0.70  9.700 18.70  18.00\n5      C   1.5  0.55  9.875 19.20  18.65\n6      B   1.0  0.40 10.050 19.70  19.30\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nlvd7[2,5]-lvd7[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7\n```\n:::\n\n```{.r .cell-code}\nlvd8[2,5]-lvd8[2,3] # H Spread의 경우 예측값에서 더 길게 나타나고 있다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 10.75\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread / H-spread - 1.705)\n(lvd7[3,5]-lvd7[3,3])/(lvd7[2,5]-lvd7[2,3])-1.705 # more peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.295\n```\n:::\n\n```{.r .cell-code}\n(lvd8[3,5]-lvd8[3,3])/(lvd8[2,5]-lvd8[2,3])-1.705 # less peaked than normal \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.1887209\n```\n:::\n\n```{.r .cell-code}\n# 두 데이터를 합치고 해당 데이터들이 동일한 분포를 따르고 있는지 확인하기 \nlactic2=c(true_val,est_val)\nlactic2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  1.0  1.0  1.0  1.0  3.0  3.0  3.0  3.0  3.0  5.0  5.0  5.0 10.0 10.0 10.0\n[16] 10.0 15.0 15.0 15.0 15.0  1.1  0.7  1.8  0.4  3.0  1.4  4.9  4.4  4.5  7.3\n[31]  8.2  6.2 12.0 13.1 12.6 13.2 18.7 19.7 17.4 17.1\n```\n:::\n\n```{.r .cell-code}\nqqnorm(lactic2);qqline(lactic2,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#점들이 Tukey's robust line estimation위를 따르기 보다는 역s자 형태의 곡선의 형태를 띄고 있는 것을 확인할 수 있다.\n#허명회교수님의 책 113pg에 보면 혼합정규분포에서의 모의생성자료가 역 S자 형태를 띄고 있는데 현재 Plot도 그러한 것으로 보아 실제 데이터와 측정치 데이터가 서로 다른 분포를 따르고 있지 않을까 추측할 수 있다.\n#또한, 꼬리가 짧은 분포일때의 형태와 비슷하게 왼쪽 끝 자료들이 직선을 벗어나있다. \n\n# 두 데이터는 서로 다른 분포에서 왔다고 추정할 수 있다. 그러나 눈대중으로 판단하는 것은 한계가 있기 때문에 이 판단을 재확인하기 위해서는 Tuckey의 Mean-Difference Plot을 활용해야한다. \nqqplot(x=true_val,y=est_val,xlim=c(min(true_val,est_val),max(true_val,est_val)),\n       ylim=c(min(true_val,est_val),max(true_val,est_val))\n       ,main=\"QQ_plot of true value and estimated value\")\nabline(0,1,lty=2,col=\"darkgreen\",lwd=2) #초반의 일부 데이터를 제외하면 대부분이 주대각선 위에 존재하고 있다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# 따라서 두 Estimation의 평균은 같다고 보기 힘들다.\n\nqq.x <- qqplot(x=true_val,y=est_val)$x\nqq.y <- qqplot(x=true_val,y=est_val)$y\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-6.png){width=672}\n:::\n\n```{.r .cell-code}\nplot((qq.x+qq.y)/2, qq.y-qq.x, main=\"Tukey mean difference plot\", \n     ylab=\"est_val - true_val\", xlab=\"mean\")\nabline(0,0)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-7-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# mean difference plot을 통해서 확인하더라도 몇몇자료를 제외하면 대부분의 자료가 x축보다 위에 존재하는 것으로 보인다.\n```\n:::\n\n\nqqplot을 통해서 처음 확인하였을 때 자료들이 전부 직선위에 존재하는 것 처럼 보였으나 실제로 자료들을 합쳐서 qqplot을 그릴경우 역s자 형태로 나타나서 동일한 분포에서 나온 데이터가 아닐 수도 있음을 확인할 수 있었고 mean-difference plot을 통해서 이를 재 확인할 수 있었다. 따라서 어떤 자료를 측정하는 경우 계측기가 정확하다면 두 자료는 동일한 분포를 따르는 것이 맞겠지만, 계측기가 정확하지 않기 때문에 두 자료들이 서로 다른 분포를 따르고 있다는 것을 확인할 수 있었다. 시각적으로 예측해보는 것은 항상 정확하지 않기 때문에 지금처럼 검증이 필요하다고 생각한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(lactic)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked _by_ .GlobalEnv:\n\n    est_val, true_val\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from lactic (pos = 3):\n\n    est_val, true_val\n```\n:::\n\n```{.r .cell-code}\ncor.test(true_val,est_val) #매우 높은 상관관계가 존재함.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  true_val and est_val\nt = 26.107, df = 18, p-value = 9.278e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9668337 0.9949756\nsample estimates:\n      cor \n0.9870507 \n```\n:::\n\n```{.r .cell-code}\nplot(est_val~true_val)\n(z <- line(x=true_val,y=est_val))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nline(x = true_val, y = est_val)\n\nCoefficients:\n[1]  -0.9026   1.4053\n```\n:::\n\n```{.r .cell-code}\nabline(coef(z),lty=2,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(residuals(z) ~ fitted(z), main = \"Residual plot by rline\")\nabline(0,0) # 잔차들이 우하향하는 듯하게 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sqrt(est_val)~(true_val))\n(z1 <- line(x=(true_val),y=sqrt(est_val)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nline(x = (true_val), y = sqrt(est_val))\n\nCoefficients:\n[1]  0.9012  0.2676\n```\n:::\n\n```{.r .cell-code}\nabline(coef(z1),lty=2,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(residuals(z1) ~ fitted(z1), main = \"Residual plot by rline\")\nabline(0,0) #다소 완화되었다 그러나 자료들이 곡선의 경향성을 보여준다는 점에서 변환은 부적절하다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n\n```{.r .cell-code}\ndetach(lactic)\n```\n:::\n\n\n상관관계가 매우 높게 나타나서, r-line을 활용해 두 자료를 적합시키려고 하였는데 변환을 진행하기전 자료가 더 적합해보인다.\n\n# 3.\n\n취학아동의 정신 장애 상태와 부모의 사회경제적 지위(1=낮음, 6=높음)에 대한 표이다. 분석하여라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nordered(1:6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1 2 3 4 5 6\nLevels: 1 < 2 < 3 < 4 < 5 < 6\n```\n:::\n\n```{.r .cell-code}\nsoseco=as.data.frame(matrix(c(64,57,57,72,36,21,94,94,105,141,97,71,58,54,65,77,54,54,46,40,60,94,78,71),nrow=4,ncol=6,byrow=T))\ncolnames(soseco)=ordered(1:6)\nrownames(soseco)=c(\"Well\",\"Mild\",\"Moderate\",\"Impaired\")\n\n# median polish\nsoseco_polished=medpolish(soseco)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1: 219\n2: 202.75\n3: 200\nFinal: 200\n```\n:::\n\n```{.r .cell-code}\n# maxiter를 설정하지 않고 분석한 결과 maxiter=3에서 결과 값이 나오는 것을 확인하였다.\nsoseco_polished\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMedian Polish Results (Dataset: \"soseco\")\n\nOverall: 56.375\n\nRow Effects:\n    Well     Mild Moderate Impaired \n -11.875   39.375   -0.625    0.625 \n\nColumn Effects:\n      1       2       3       4       5       6 \n  0.250  -1.750   9.250  32.250  -0.250 -12.625 \n\nResiduals:\n              1      2     3      4     5       6\nWell      19.25  14.25  3.25  -4.75 -8.25 -10.875\nMild      -2.00   0.00  0.00  13.00  1.50 -12.125\nModerate   2.00   0.00  0.00 -11.00 -1.50  10.875\nImpaired -11.25 -15.25 -6.25   4.75 21.25  26.625\n```\n:::\n\n```{.r .cell-code}\nplot(soseco_polished)\n#x축과 y축위에 데이터가 많이 있는 것으로 보인다. outlier로 보이는 4개의 점을 제외하면 전반적으로 residual들이 안정적이다.\nplot(soseco_polished)\nabline(0,1) #나름 점들이 경향성을 가지고 있는 것으로 보인다.\n\nz7=lm(as.vector(soseco_polished$residuals) ~ \n     as.vector(outer(soseco_polished$row,soseco_polished$col, \"*\")/soseco_polished$overall))[1]\nabline(z7,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 기울기가 0.5665495이므로 1과는 다르므로 log변환의 필요성이 떨어져 보인다.\n# 직선을 그리기 어렵고 의미있는 패턴이 보이지 않기 때문에 변환이 요구되어보이지는 않는다. \n\nboxplot(soseco_polished$residuals) # Boxplot그릴경우 Outlier가 확인되어지지는 않는다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 행 효과 크기 순으로 재정렬한 잔차표\nround(soseco_polished$residuals[order(soseco_polished$row),],1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             1     2    3     4    5     6\nWell      19.2  14.2  3.2  -4.8 -8.2 -10.9\nModerate   2.0   0.0  0.0 -11.0 -1.5  10.9\nImpaired -11.2 -15.2 -6.2   4.8 21.2  26.6\nMild      -2.0   0.0  0.0  13.0  1.5 -12.1\n```\n:::\n\n```{.r .cell-code}\n# Check Decomposition\ndecomposed=(soseco_polished$overall + outer(soseco_polished$row,soseco_polished$col, \"+\") + soseco_polished$residuals)\ndecomposed\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          1  2   3   4  5  6\nWell     64 57  57  72 36 21\nMild     94 94 105 141 97 71\nModerate 58 54  65  77 54 54\nImpaired 46 40  60  94 78 71\n```\n:::\n\n```{.r .cell-code}\nall(decomposed==soseco) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n# 가법성 모형이 확인되어지고 있다.\n\n# Comparison Values\nround(outer(soseco_polished$row,soseco_polished$col, \"*\")/soseco_polished$overall,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             1     2     3     4     5     6\nWell     -0.05  0.37 -1.95 -6.79  0.05  2.66\nMild      0.17 -1.22  6.46 22.52 -0.17 -8.82\nModerate  0.00  0.02 -0.10 -0.36  0.00  0.14\nImpaired  0.00 -0.02  0.10  0.36  0.00 -0.14\n```\n:::\n\n```{.r .cell-code}\n# Comparison value 기준으로 0값이 총 4개 확인됨. 그런데 더 많은 값들이 Additivity Plot의 x축과 y축 근처에 존재하는 것으로 보아 몇몇 피팅에서 벗어난 값을 제외하면 대부분 0근처에서 존재하고 있는 것이 확인된다. \n\n#stem and leaf plot\nstem(soseco_polished$residuals) # stem 0이 가장 높음 (낮은 잔차인 stem -1의 잔차들이 다소 많이 나타나고 있음)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  -1 | 52111\n  -0 | 86522\n   0 | 00002235\n   1 | 1349\n   2 | 17\n```\n:::\n\n```{.r .cell-code}\n# Row Effect \nbarplot(soseco_polished$row,ylim=c(-15,40), main=\"정신상태의 효과\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n```{.r .cell-code}\nsoseco_polished$row\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Well     Mild Moderate Impaired \n -11.875   39.375   -0.625    0.625 \n```\n:::\n\n```{.r .cell-code}\n# Row Effect에 대해서 먼저 분석을 진행해 보았다. 정신상태가 Mild인 경우 부모님의 사회경제적 지위가 가장 높아졌고, Well인경우 부모님의 사회경제적 지위가 낮은 것으로 보인다. \n\n# Column Effect\nbarplot(soseco_polished$col, ylim=c(-20,40) , main=\"부모님 사회경제적 지위의 효과\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n```{.r .cell-code}\nsoseco_polished$col\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1       2       3       4       5       6 \n  0.250  -1.750   9.250  32.250  -0.250 -12.625 \n```\n:::\n\n```{.r .cell-code}\n# Column Effect에 대해서 분석을 진행해 보았다. 부모님의 사회경제적 지위가 4인 경우에 정신상태가 나빠질 가능성이 많은 편이다. 부모님의 사회경제적 지위가 6인경우 정신상태가 다른 집단들에 비해서 긍정적으로 나타나는 것이 확인되어진다. \n\n\npar(mfrow=c(2,2))\nfor (i in 1:4) {barplot(soseco_polished$residuals[i,],main=rownames(soseco)[i])}\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# 정신상태가 Well과 Impaired 된 집단을 기준으로 볼 경우 부모님의 사회경제적 지위가 높을수록 정신상태가 나쁜 Case가 많고, 낮을수록 정신상태가 좋은 Case가 많다. \n\npar(mfrow=c(2,3))\nfor (i in 1:6) {barplot(soseco_polished$residuals[,i],main=names(soseco)[i])}\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 부모님의 사회경제적 지위가 높을 수록 정신상태가 나쁜 경향성을 보이고, 사회 경제적 지위가 낮을 때 정신상태가 좋게 나타나고 있다.\n\npar(mfrow=c(1,1))\n\n# twoway plot\nlibrary(\"twoway\")\ntwoway(soseco, method=\"median\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMedian polish decomposition (Dataset: \"soseco\"; Response: Value)\nResiduals bordered by row effects, column effects, and overall\n\n           1       2       3       4       5       6         roweff \n         + ------- ------- ------- ------- ------- ------- + -------\nWell     |  19.250  14.250   3.250  -4.750  -8.250 -10.875 : -11.875\nMild     |  -2.000   0.000   0.000  13.000   1.500 -12.125 :  39.375\nModerate |   2.000   0.000   0.000 -11.000  -1.500  10.875 :  -0.625\nImpaired | -11.250 -15.250  -6.250   4.750  21.250  26.625 :   0.625\n         + ....... ....... ....... ....... ....... ....... + .......\ncoleff   |   0.250  -1.750   9.250  32.250  -0.250 -12.625 :  56.375\n```\n:::\n\n```{.r .cell-code}\nplot(twoway(soseco, method=\"median\"))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# mosaic plot\nlibrary(ghibli)\npal=ghibli_palette(\"PonyoMedium\",n=6)\npal\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-8.png){width=672}\n:::\n\n```{.r .cell-code}\nmosaicplot(soseco,color=pal,main=\"mosaic plot of sosioeconomic data\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-9-9.png){width=672}\n:::\n\n```{.r .cell-code}\n#부모님의 사회 경제적 위치가 높을수록 정신 상태가 안 좋은 사람들의 비율이 올라가는 듯한 경향성이 보이는 듯 하다. \n\n# coded plot\nresid=soseco_polished$residuals\nstandard=as.vector(resid)\nfivenum(standard)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -15.2500  -7.2500   0.0000   7.8125  26.6250\n```\n:::\n\n```{.r .cell-code}\nHspread=fivenum(standard)[4]-fivenum(standard)[2]\ninner=c(fivenum(standard)[4]+1.5*Hspread,fivenum(standard)[2]-1.5*Hspread)\nouter=c(fivenum(standard)[4]+3*Hspread,fivenum(standard)[2]-3*Hspread)\n\nresid=as.data.frame(resid)\n# 교과서 기준과 동일하게 \"M\" - Far outside low, \"=\"- below low inner fence(outise), \"-\" - Below lower hinge but within inner fence\n# \".\" - Between Hinges , \"+\"- Above upper hinge, \"#\" - Above High inner fence (outside), \"F\" - Far outside high\nresid_coded=ifelse(resid >= outer[1], \"F\",\n                        ifelse(resid>= inner[1], \"#\",\n                               ifelse(resid >= fivenum(standard)[4],\"+\",\n                                      ifelse(resid >=fivenum(standard)[2] ,\".\",\n                                             ifelse(resid>= inner[2],\"-\",\n                                                    ifelse(resid >= outer[2],\"=\",\"M\"))))))\nresid_coded=as.data.frame(resid_coded)\nresid_coded #위에서 확인하였던 경향성이 다시한번 확인된다 (부모의 사회경제적 위치가 올라갈수록 정신질환을 가지는 경우가 높아짐)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         1 2 3 4 5 6\nWell     + + . . - -\nMild     . . . + . -\nModerate . . . - . +\nImpaired - - . . + +\n```\n:::\n:::\n\n\n# 4.\n\n자료는 정상적인 쥐, 알록산(alloxan)에 의해 당뇨병이 유발된 쥐, 당뇨병이 유발된 후 인슐린으로 치료한 쥐에서의 알부민양이다. 세 자료의 분포가 같은 지 분석하여라. 자료를 재표현하여 대칭형으로 만들고 분포가 같은 지 다시 분석하여라. \\[DIABETIC.DAT\\]\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes=read.delim(\"C:/r/DIABETIC.DAT\",header=F)\nnames(diabetes)=c(\"normal\",\"alloxan\",\"insulin\")\n\ndim(diabetes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 20  3\n```\n:::\n\n```{.r .cell-code}\nsummary(diabetes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     normal         alloxan          insulin     \n Min.   : 14.0   Min.   : 13.00   Min.   : 18.0  \n 1st Qu.:104.0   1st Qu.: 76.25   1st Qu.: 45.0  \n Median :124.5   Median :139.50   Median : 82.0  \n Mean   :186.1   Mean   :181.83   Mean   :112.9  \n 3rd Qu.:260.2   3rd Qu.:251.00   3rd Qu.:132.0  \n Max.   :655.0   Max.   :499.00   Max.   :465.0  \n                 NA's   :2        NA's   :1      \n```\n:::\n\n```{.r .cell-code}\n# 결측치의 확인 \ncolSums(is.na(diabetes)) # alloxan에서 2개 insulin에서 1개\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n normal alloxan insulin \n      0       2       1 \n```\n:::\n\n```{.r .cell-code}\n# Stem and leaf를 활용하여 각 집단의 분포를 비교\nattach(diabetes)\nlibrary(aplpack)\nstem.leaf.backback(normal,alloxan,rule.line=\"Sturges\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n_____________________________________\n  1 | 2: represents 120, leaf unit: 10 \n          normal     alloxan     \n_____________________________________\n   5       86221| 0 |145678      6   \n  (9)  954222111| 1 |0234677    (7)  \n   6         985| 2 |77          5   \n   3           4| 3 |9           3   \n   2           5| 4 |69          2   \n                | 5 |                \n_____________________________________\nHI: 655                              \nn:            20     20          \nNAs:           0     2           \n_____________________________________\n```\n:::\n\n```{.r .cell-code}\n# normal data와 alloxan data모두 skewed to the right 되어 있는 자료로 stem 1에서 가장 많은 데이터를 보인다.\nstem.leaf.backback(normal,insulin,rule.line=\"Sturges\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n__________________________________\n  1 | 2: represents 120, leaf unit: 10 \n        normal      insulin   \n__________________________________\n   3       221| 0* |123444    6   \n   5        86| 0. |67789    (5)  \n  (7)  4222111| 1* |0033      8   \n   8        95| 1. |5         4   \n              | 2* |24        3   \n   6       985| 2. |              \n   3         4| 3* |              \n__________________________________\nHI: 455 655         HI: 465       \nn:          20      20        \nNAs:         0      1         \n__________________________________\n```\n:::\n\n```{.r .cell-code}\n# normal data의 경우 stem 1*을 중심으로 하고 있으며 stem 2*의 경우 중간에 비어 있는 모습을 확인할 수 있다. (Outlier의 가능성)\n# insulin data의 경우 stem 0*에서 가장 많은 자료가 있고 해당 자료도 skewed to the right 되어 있는 것을 확인할 수 있다.\nstem.leaf.backback(alloxan,insulin,rule.line=\"Sturges\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n________________________________\n  1 | 2: represents 120, leaf unit: 10 \n      alloxan      insulin  \n________________________________\n   2       41| 0* |123444   6   \n   6     8765| 0. |67789   (5)  \n  (4)    4320| 1* |0033     8   \n   8      776| 1. |5        4   \n             | 2* |24       3   \n   5       77| 2. |             \n             | 3* |             \n________________________________\nHI: 391 469        HI: 465      \n499                             \nn:         20      20       \nNAs:        2      1        \n________________________________\n```\n:::\n\n```{.r .cell-code}\n# 첫번째 stem and leaf에서는 alloxan data가 종모양을 이루고 있지 않은 것으로 보였으나 조금더 확대하였더니 어느정도 종모양을 띄고 있는 것이 확인된다.\n\n\nfivenum(normal)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  14.0  98.0 124.5 267.5 655.0\n```\n:::\n\n```{.r .cell-code}\nfivenum(alloxan)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  13.0  73.0 139.5 276.0 499.0\n```\n:::\n\n```{.r .cell-code}\nfivenum(insulin)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  18  45  82 132 465\n```\n:::\n\n```{.r .cell-code}\n# Boxplot\nboxplot(diabetes,main=\"Comparison of groups\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(diabetes)$out #2개의 outlier 확인됨. (아까 Stem and leaf에서 확인 한 부분 재확인)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 655 465\n```\n:::\n\n```{.r .cell-code}\n# normal data에서 655의 outlier, insulin 투여 쥐에서 465의 outlier 확인\nboxplot(diabetes)$stats \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]  [,2] [,3]\n[1,]  14.0  13.0   18\n[2,]  98.0  73.0   45\n[3,] 124.5 139.5   82\n[4,] 267.5 276.0  132\n[5,] 455.0 499.0  243\n```\n:::\n\n```{.r .cell-code}\n# Skewness\nskewness(normal) # skewed to the right\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6873156\n```\n:::\n\n```{.r .cell-code}\nskewness(alloxan) # skewed to the right\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3448276\n```\n:::\n\n```{.r .cell-code}\nskewness(insulin) # skewed to the right\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1494253\n```\n:::\n\n```{.r .cell-code}\n# Letter Value Display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\nlvd9=(lsum(normal,6))\nlvd10=(lsum(alloxan,6))\nlvd11=(lsum(insulin,6))\nlvd9\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M  10.5 124.5 124.50 124.5    0.0\n2      H   5.5  98.0 182.75 267.5  169.5\n3      E   3.0  29.0 189.00 349.0  320.0\n4      D   2.0  26.0 240.50 455.0  429.0\n5      C   1.5  20.0 287.50 555.0  535.0\n6      B   1.0  14.0 334.50 655.0  641.0\n```\n:::\n\n```{.r .cell-code}\nlvd10\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower    mid upper spread\n1      M   9.5 139.5 139.50 139.5    0.0\n2      H   5.0  73.0 174.50 276.0  203.0\n3      E   3.0  50.0 220.50 391.0  341.0\n4      D   2.0  46.0 257.50 469.0  423.0\n5      C   1.5  29.5 256.75 484.0  454.5\n6      B   1.0  13.0 256.00 499.0  486.0\n```\n:::\n\n```{.r .cell-code}\nlvd11\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower   mid upper spread\n1      M  10.0    82  82.0    82      0\n2      H   5.5    45  88.5   132     87\n3      E   3.0    34 131.0   228    194\n4      D   2.0    20 131.5   243    223\n5      C   1.5    19 186.5   354    335\n6      B   1.0    18 241.5   465    447\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nlvd9[2,5]-lvd9[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 169.5\n```\n:::\n\n```{.r .cell-code}\nlvd10[2,5]-lvd10[2,3] \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 203\n```\n:::\n\n```{.r .cell-code}\nlvd11[2,5]-lvd11[2,3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 87\n```\n:::\n\n```{.r .cell-code}\n# alloxan 집단에서 spread가 가장 크게 나타나며, normal 집단이 그다음, insulin 투여 집단의 분포는 좁게 나타나고 있다.\n\n# Kurtosis (E-spread / H-spread - 1.705)\n(lvd9[3,5]-lvd9[3,3])/(lvd9[2,5]-lvd9[2,3])-1.705 # more peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1829056\n```\n:::\n\n```{.r .cell-code}\n(lvd10[3,5]-lvd10[3,3])/(lvd10[2,5]-lvd10[2,3])-1.705 # less peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.02519704\n```\n:::\n\n```{.r .cell-code}\n(lvd11[3,5]-lvd11[3,3])/(lvd11[2,5]-lvd11[2,3])-1.705 # more peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5248851\n```\n:::\n\n```{.r .cell-code}\n# 정규성\nqqnorm(normal, ylab=\"normal group quantiles\",main=\"normal group\");qqline(normal, col='red',lty=2)\n# 점들이 직선을 잘 따르고 있지 않다. 앞에서 언급했던 outlier을 재확인하였으며, 점들이 convex한 곡선을 띄고 있는 것을 확인할 있다. \nfiv9=fivenum(normal)\n(pseudosigma9 = (fiv9[4]-fiv9[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 126.4925\n```\n:::\n\n```{.r .cell-code}\nsd(normal) # 약 32정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 158.8349\n```\n:::\n\n```{.r .cell-code}\nabline(fiv9[3],pseudosigma9,col=\"blue\",lty=2)\nlegend(x = -1.8, y = 600, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 차이 존재\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(alloxan, ylab=\"alloxan group quantiles\",main=\"alloxan group\");qqline(alloxan, col='red',lty=2)\n# 점들이 직선을 잘 따르고 있지 않다. 점들이 곡선을 띄고 있는 것을 확인할 있다. \nfiv10=fivenum(alloxan)\n(pseudosigma10 = (fiv10[4]-fiv10[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 151.4925\n```\n:::\n\n```{.r .cell-code}\nsd(alloxan,na.rm=T) # 약 7정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 144.8493\n```\n:::\n\n```{.r .cell-code}\nabline(fiv10[3],pseudosigma10,col=\"blue\",lty=2)\nlegend(x = -1.8, y = 500, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 차이 존재\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(insulin, ylab=\"insulin group quantiles\",main=\"insulin group\");qqline(insulin, col='red',lty=2)\n# oulier와 몇몇 2~3개의 점을 제외하면 점들이 직선을 잘 따르고 있는 것으로 보인다. \nfiv11=fivenum(insulin)\n(pseudosigma11 = (fiv11[4]-fiv11[2])/1.34)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 64.92537\n```\n:::\n\n```{.r .cell-code}\nsd(insulin,na.rm=T) # 약 41정도의 차이\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 105.7896\n```\n:::\n\n```{.r .cell-code}\nabline(fiv11[3],pseudosigma11,col=\"blue\",lty=2)\nlegend(x = -1.8, y = 450, c(\"qqline\", \"robustline\"), \n       lty=2,lwd=2,col = c(\"red\",\"blue\")) # 거의 비슷함.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-5.png){width=672}\n:::\n\n```{.r .cell-code}\n#전반적으로 자료들이 skewed to the right되어있고 정규분포를 잘 따르지 않는 것으로 보인다. \n\n# 두 데이터를 합치고 해당 데이터들이 동일한 분포를 따르고 있는지 확인하기 \ndiabetes2=c(normal,alloxan,insulin)\ndiabetes2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 156 282 197 297 116 127 119  29 253 122 349 110 143  64  26  86 122 455 655\n[20]  14 391  46 469  86 174 133  13 499 168  62 127 276 176 146 108 276  50  73\n[39]  NA  NA  82 100  98 150 243  68 228 131  73  18  20 100  72 133 465  40  46\n[58]  34  44  NA\n```\n:::\n\n```{.r .cell-code}\nqqnorm(diabetes2);qqline(diabetes2,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-6.png){width=672}\n:::\n\n```{.r .cell-code}\n#자료들이 Convex한 곡선의 형태를 띄고 있다 따라서 변환을 통해서 동일한 분포를 따르고 있는지 재확인해야 한다.\n#큰 값쪽으로 긴 꼬리를 뻗은 기울어진 분포\n\n# 자료의 재표현 - 일반적으로 많이 사용하는 재표현 방식의 사용\nboxplot(log(diabetes))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-7.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(sqrt(diabetes))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-8.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(-1/(diabetes))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-9.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(-1/sqrt(diabetes))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-10.png){width=672}\n:::\n\n```{.r .cell-code}\n# Spread-versus-level Plot\ndiabetes_spread=c(lvd9[2,5]-lvd9[2,3],lvd10[2,5]-lvd10[2,3],lvd11[2,5]-lvd11[2,3])\ndiabetes_med=c(median(normal),median(alloxan,na.rm=T),median(insulin,na.rm=T))\n\nplot(log(diabetes_med), log(diabetes_spread), main=\"Spread vs. Level plot\")\n\nlogspread=log(diabetes_spread)\nlogmed=log(diabetes_med)\n(RegrLine <- lm(logspread~logmed))     \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = logspread ~ logmed)\n\nCoefficients:\n(Intercept)       logmed  \n     -2.564        1.595  \n```\n:::\n\n```{.r .cell-code}\nabline(coef(RegrLine))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-11.png){width=672}\n:::\n\n```{.r .cell-code}\n1 - coef(RegrLine)[2] #-0.5853975 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    logmed \n-0.5953067 \n```\n:::\n\n```{.r .cell-code}\n# -0.5에 가까움\n\nboxplot(-(diabetes)^-0.5,main=\"-0.5 transformation\")\nboxplot(-(diabetes)^-0.5,main=\"-0.5 transformation\")$out # 총 4개의 outlier\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-12.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.1856953 -0.1961161 -0.2672612 -0.2773501\n```\n:::\n\n```{.r .cell-code}\nskewness_transformed1=c(skewness((-(diabetes)^-0.5)[,1]), skewness((-(diabetes)^-0.5)[,2]), skewness((-(diabetes)^-0.5)[,3]))\nskewness_transformed1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  0.4079370 -0.1365476 -0.2461638\n```\n:::\n\n```{.r .cell-code}\nmean(skewness_transformed1) # skewness가 가장적음\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.008408507\n```\n:::\n\n```{.r .cell-code}\nboxplot(log(diabetes),main=\"log transformation\")\nboxplot(log(diabetes),main=\"log transformation\")$out # 총 3개의 outlier\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.639057\n```\n:::\n\n```{.r .cell-code}\nskewness_transformed2=c(skewness(log(diabetes)[,1]), skewness(log(diabetes)[,2]), skewness(log(diabetes)[,3]))\nskewness_transformed2     \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  0.51161785  0.02774901 -0.11543537\n```\n:::\n\n```{.r .cell-code}\nmean(skewness_transformed2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1413105\n```\n:::\n\n```{.r .cell-code}\ndiabetes3=-(c(normal,alloxan,insulin))^-0.5\nqqnorm(diabetes3,main=\"minus sqrt inverse qqplot\");qqline(diabetes3,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-14.png){width=672}\n:::\n\n```{.r .cell-code}\ndiabetes4=log(c(normal,alloxan,insulin))\nqqnorm(diabetes4,main=\"log qqplot\");qqline(diabetes4,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-15.png){width=672}\n:::\n\n```{.r .cell-code}\ndiabetes5=sqrt(c(normal,alloxan,insulin))\nqqnorm(diabetes5,main=\"sqrt qqplot\");qqline(diabetes5,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-16.png){width=672}\n:::\n\n```{.r .cell-code}\ndiabetes6=-(c(normal,alloxan,insulin))^-1\nqqnorm(diabetes6,main=\"minus inverseqqplot\");qqline(diabetes6,col=\"red\",lty=2) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-17.png){width=672}\n:::\n\n```{.r .cell-code}\n# 전반적으로 log 나 sqrt변환 이후 자료들이 직선을 더 잘 따르고 있는 것을 확인할 수 있다. \n# QQplot 하에서 양 극단의 일부 데이터를 제외한 나머지 데이터들은 전부 qqline위에 있다는 점에서 변환이후 데이터들은 동일한 정규분포에서 나타난 것을 확인할 수 있다.\n\n# 가장 정규분포를 잘 따르고 있는 것으로 보이는 log변환을 활용해 Tuckey_Mean_Difference_Plot\n\nnor_log=log(diabetes)[,1];alo_log=log(diabetes)[,2];ins_log=log(diabetes)[,3]\nalo_log=alo_log[!is.na(alo_log)]\nins_log=ins_log[!is.na(ins_log)]\n\nqqplot(nor_log,alo_log,xlim=c(min(nor_log,alo_log),max(nor_log,alo_log)),\n       ylim=c(min(nor_log,alo_log),max(nor_log,alo_log))\n       ,main=\"QQ_plot of logged normal group and alloxan group\")\nabline(0,1,lty=2,col=\"darkgreen\",lwd=2) # 대부분의 자료들이 주대각선을 따르는 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-18.png){width=672}\n:::\n\n```{.r .cell-code}\nqqplot(nor_log,ins_log,xlim=c(min(nor_log,ins_log),max(nor_log,ins_log)),\n       ylim=c(min(nor_log,ins_log),max(nor_log,ins_log))\n       ,main=\"QQ_plot of logged normal group and insulin group\")\nabline(0,1,lty=2,col=\"darkgreen\",lwd=2) # 대부분의 자료들이 주대각선 밑에 있는 것으로 보인다. 따라서 같은 분포에서 나오지 않았을 가능성이 있다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-19.png){width=672}\n:::\n\n```{.r .cell-code}\nqqplot(alo_log,ins_log,xlim=c(min(alo_log,ins_log),max(alo_log,ins_log)),\n       ylim=c(min(alo_log,ins_log),max(alo_log,ins_log))\n       ,main=\"QQ_plot of logged alloxan group and insulin group\")\nabline(0,1,lty=2,col=\"darkgreen\",lwd=2)  # 대부분의 자료들이 주대각선 밑에 있는 것으로 보인다. 따라서 같은 분포에서 나오지 않았을 가능성이 있다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-20.png){width=672}\n:::\n\n```{.r .cell-code}\n#정리하면 Normal Group과 Alloxan Group의 경우는 같은 분포에서 나왔을 가능성이 높지만, insulin 투여 그룹은 다른 분포를 따르고 있을 가능성이 높다. \n\nqq.x1 <- qqplot(nor_log,alo_log)$x\nqq.y1 <- qqplot(nor_log,alo_log)$y\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-21.png){width=672}\n:::\n\n```{.r .cell-code}\nplot((qq.x1+qq.y1)/2, qq.y1-qq.x1, main=\"Tukey mean difference plot\", \n     ylab=\"alo_log-nor_log\", xlab=\"mean\")\nabline(0,0)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-22.png){width=672}\n:::\n\n```{.r .cell-code}\nqq.x2 <- qqplot(nor_log,ins_log)$x\nqq.y2 <- qqplot(nor_log,ins_log)$y\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-23.png){width=672}\n:::\n\n```{.r .cell-code}\nplot((qq.x2+qq.y2)/2, qq.y2-qq.x2, main=\"Tukey mean difference plot\", \n     ylab=\"ins_log-nor_log\", xlab=\"mean\")\nabline(0,0) # 대부분의 자료들이 X축의 밑에 있다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-24.png){width=672}\n:::\n\n```{.r .cell-code}\nqq.x3 <- qqplot(alo_log,ins_log)$x\nqq.y3 <- qqplot(alo_log,ins_log)$y\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-25.png){width=672}\n:::\n\n```{.r .cell-code}\nplot((qq.x3+qq.y3)/2, qq.y3-qq.x3, main=\"Tukey mean difference plot\", \n     ylab=\"ins_log-alo_log\", xlab=\"mean\")\nabline(0,0) # 대부분의 자료들이 X축의 밑에 있다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-26.png){width=672}\n:::\n\n```{.r .cell-code}\n# 변환 이후 각 자료는 정규분포를 따르는가?\nqqnorm(nor_log);qqline(nor_log,col=\"red\") # outlier들을 제외하면 정규분포를 잘 따르는 것으로 보인다. (곡선의 흔적이 있으나 완화됨)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-27.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(alo_log);qqline(alo_log,col=\"red\") # 한두개의 점을 제외하면 정규분포를 잘 따르는 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-28.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(ins_log);qqline(ins_log,col=\"red\") # 가장 정규분포를 잘 따른다\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-10-29.png){width=672}\n:::\n\n```{.r .cell-code}\n# 결론: 변환이후 각 자료들은 정규분포를 따르고 있는 것으로 보이나 그 각각의 평균은 다른 것으로 보이기에 서로 다른 분포를 따르고 있다고 보는 것이 타당하다. \n\n# 각 집단별 평균차이를 확인하기 위해서 일원분산분석을 진행하고자 한다.\nlibrary(reshape2)\ndia_melt=melt(diabetes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\ndia_melt=dia_melt[!is.na(dia_melt$value),]\naov4=aov(value~variable,data=dia_melt)\nsummary(aov4) #H0: 각 집단간 평균차이는 없다. H1: 각 집단간 평균차이는 있다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df  Sum Sq Mean Sq F value Pr(>F)\nvariable     2   64357   32178   1.675  0.197\nResiduals   54 1037470   19212               \n```\n:::\n\n```{.r .cell-code}\n# Do not reject null hypothesis\n\nlibrary(doBy)\nsummaryBy(value ~ variable, data=dia_melt, FUN = c(mean, sd, min, max))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  variable value.mean value.sd value.min value.max\n1   normal   186.1000 158.8349        14       655\n2  alloxan   181.8333 144.8493        13       499\n3  insulin   112.8947 105.7896        18       465\n```\n:::\n\n```{.r .cell-code}\nlibrary(agricolae)\nHSD.test(aov4, \"variable\", group=TRUE,console=TRUE) # 각집단간 차이가 명확하게 드러나지 않는다\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov4 ~ \"variable\"\n\nHSD Test for value \n\nMean Square Error:  19212.41 \n\nvariable,  means\n\n           value      std  r Min Max\nalloxan 181.8333 144.8493 18  13 499\ninsulin 112.8947 105.7896 19  18 465\nnormal  186.1000 158.8349 20  14 655\n\nAlpha: 0.05 ; DF Error: 54 \nCritical Value of Studentized Range: 3.408232 \n\nGroups according to probability of means differences and alpha level( 0.05 )\n\nTreatments with the same letter are not significantly different.\n\n           value groups\nnormal  186.1000      a\nalloxan 181.8333      a\ninsulin 112.8947      a\n```\n:::\n\n```{.r .cell-code}\ndia_melt2=dia_melt\ndia_melt2$value=log(dia_melt$value)\naov5=aov(value~variable,data=dia_melt2)\nsummary(aov5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\nvariable     2   2.75  1.3751   1.665  0.199\nResiduals   54  44.61  0.8261               \n```\n:::\n:::\n\n\n# 5.\n\n1974년부터 1979년 까지 영국에서 기관지염, 폐기종, 천식의 폐 질환에 의한 월별 사망자 수이다. 분석하라. \\[MONTHLY.DAT\\]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlung=as.matrix(read.delim(\"C:/r/MONTHLY.DAT\",header=F,)[,c(2:13)])\nlung\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       V2   V3   V4   V5   V6   V7   V8   V9  V10  V11  V12  V13\n[1,] 3035 2552 2704 2554 2014 1655 1721 1524 1596 2074 2199 2512\n[2,] 2933 2889 2938 2497 1870 1726 1607 1545 1396 1787 2076 2837\n[3,] 2787 3891 3179 2011 1636 1580 1489 1300 1356 1653 2013 2823\n[4,] 2996 2523 2540 2520 1994 1641 1691 1479 1596 1877 2032 2484\n[5,] 2899 2990 2890 2379 1933 1734 1617 1495 1440 1777 1970 2745\n[6,] 2841 3535 3010 2091 1667 1589 1518 1349 1392 1619 1954 2633\n```\n:::\n\n```{.r .cell-code}\nlung2=as.vector(c(lung[1,],lung[2,],lung[3,],lung[4,],lung[5,],lung[6,]))\nlung_ts=ts(lung2,frequency=12,start = c(1974,1), end=c(1979,12))\n\nsummary(lung_ts) #최소값은 1300, 최대값은 3891, 평균은 2002이다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   1300    1618    2002    2144    2651    3891 \n```\n:::\n\n```{.r .cell-code}\n# 결측치와 outlier의 존재여부를 체크하고자 한다.\nboxplot(lung_ts, main=\"Lung Disease Deaths\")  # Outlier는 없다. Upper Whisker의 길이가 및의 Whisker에 비해서 길게 나타나진다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsum(is.na(lung_ts)) # 결측치 없음.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\n# Steam and leaf plot을 활용해서 자료의 분포를 예측해보고자 했다.\nstem(lung_ts,1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 3 digit(s) to the right of the |\n\n  1 | 334444\n  1 | 555555666666666777777788999\n  2 | 000000011124\n  2 | 55555566677888899999\n  3 | 00002\n  3 | 59\n```\n:::\n\n```{.r .cell-code}\n# 쌍봉분포의 경향. 두개의 Cluster가 존재하는 것 처럼 보인다. \nstem(lung_ts,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 2 digit(s) to the right of the |\n\n  12 | 0569\n  14 | 0489022589\n  16 | 0012244567923389\n  18 | 783579\n  20 | 1113789\n  22 | 08\n  24 | 80122455\n  26 | 3059\n  28 | 244990349\n  30 | 0148\n  32 | \n  34 | 4\n  36 | \n  38 | 9\n```\n:::\n\n```{.r .cell-code}\n#자료들이 Skewed to the right 되어 있는 것으로 보인다. Stem 16에서 가장 높게 나타나고 있으며 대칭적으로 보이지는 않는다. \n#중간에 빈칸이 있어서 두개의 Outlier가 있을 것으로 예상되었지만 Boxplot을 통해 보았듯이 따로 Outlier는 나타나지 않는 것으로 보인다.\n\n#skewness\nskewness(lung_ts) #Skewed to the right되어 있음.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2679676\n```\n:::\n\n```{.r .cell-code}\nskewness(log(lung_ts))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1476176\n```\n:::\n\n```{.r .cell-code}\nboxplot(log(lung_ts)) # log 변환을 하면 다소 완화됨\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# letter value display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\n(lvd12=lsum(lung_ts,9)) # mid 값이 점차 커지는 중\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth  lower     mid  upper spread\n1      M  36.5 2002.5 2002.50 2002.5    0.0\n2      H  18.5 1618.0 2143.25 2668.5 1050.5\n3      E   9.5 1506.5 2211.25 2916.0 1409.5\n4      D   5.0 1396.0 2203.00 3010.0 1614.0\n5      C   3.0 1356.0 2267.50 3179.0 1823.0\n6      B   2.0 1349.0 2442.00 3535.0 2186.0\n7      A   1.5 1324.5 2518.75 3713.0 2388.5\n8      Z   1.0 1300.0 2595.50 3891.0 2591.0\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread) / (H-spread) - 1.705\n(lvd12[3,5]-lvd12[3,3])/(lvd12[2,5]-lvd12[2,3])-1.705 # less peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.363258\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\nHspread=fivenum(lung_ts)[4]-fivenum(lung_ts)[2]\nHspread\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1050.5\n```\n:::\n\n```{.r .cell-code}\n# 자료들이 정규성 따르냐?\nqqnorm(lung_ts, ylab=\"Lung Disease Deaths Quantiles\");qqline(lung_ts, col='red',lty=2) #역 S자 모양\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(log(lung_ts), ylab=\"Logged Lung Disease Deaths Quantiles\");qqline(log(lung_ts), col='red',lty=2) #역 S자 모양\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# 데이터들이 혼합 분포에서 나오지 않았을까하고 추측되어진다. (단일 정규분포를 따르지 않으므로 정규성은 X)\n\nlibrary(forecast)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n:::\n\n```{.r .cell-code}\nts.plot(lung_ts, main = \"Time-Series Plot: Lung Diseases Deaths\") #1976년과 1979년의 봉우리에 두번의 특이값이 확인됨\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-5.png){width=672}\n:::\n\n```{.r .cell-code}\nts.plot(diff(lung_ts), main = \"Time-Series Plot: Lung Diseases Deaths\") #차분데이터에 대해서 시계열자료는 다음과 같다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 6년동안 6개의 봉우리가 있으므로 매년 이러한 계절성이 존재한다는 것을 확인할 수 있다. \n\n# Box-Cox Transformation을 통해서 데이터를 변환하였다. (계절변동을 확인하기 위해서, 데이터의 정규성을 개선하기 위해)\nlambda <- forecast::BoxCox.lambda(lung_ts)\nlung_ts_new <- forecast::BoxCox(lung_ts, lambda)\n\n# 데이터가 0인 경우가 없기 때문에 Boxcox transforamtion을 진행해도 문제 없다.\nplot(lung_ts_new, main = \"Box-Cox : Lung Diseases Deaths\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-7.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(diff(lung_ts_new), main = \"Difference & Box-Cox : Lung Diseases Deaths\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-8.png){width=672}\n:::\n\n```{.r .cell-code}\n# 계절요인 분해시계열\nlung_ts.decompose <- decompose(lung_ts)       # 데이터에서 4가지 요인을 분해\nlung_ts.decompose$seasonal                     # 계절요인으로 분해된 부분이다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Jan       Feb       Mar       Apr       May       Jun       Jul\n1974  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n1975  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n1976  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n1977  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n1978  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n1979  732.1972 1009.7472  758.7056  152.3972 -321.3694 -486.3361 -530.4278\n           Aug       Sep       Oct       Nov       Dec\n1974 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n1975 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n1976 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n1977 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n1978 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n1979 -693.4028 -695.9444 -337.8361 -106.6861  518.9556\n```\n:::\n\n```{.r .cell-code}\nplot(lung_ts.decompose)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-9.png){width=672}\n:::\n\n```{.r .cell-code}\nts.plot(lung_ts.decompose$seasonal,main=\"The Plot of Seasoal Decomposition\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-10.png){width=672}\n:::\n\n```{.r .cell-code}\n# 계절요인 제외시키기\nlung_ts.decompose_new <- lung_ts - lung_ts.decompose$seasonal\nts.plot(lung_ts.decompose_new, main=\"Time-Series without Seasonal Effect\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-11.png){width=672}\n:::\n\n```{.r .cell-code}\n# 계절성을 제외한 나머지 요인들을 분석할 경우 1976,1979년도의 Random한 요인에 의해서 데이터가 늘어난 것을 확인 할 수 있다.\n# 또한 1974년 1977년 두번의 Random한 요인에 의해서 데이터가 줄어듦\n\nlung_1974=ts(lung_ts[1:12],start=1)\nlung_1975=ts(lung_ts[13:24],start=1)\nlung_1976=ts(lung_ts[25:36],start=1)\nlung_1977=ts(lung_ts[37:48],start=1)  \nlung_1978=ts(lung_ts[49:60],start=1)\nlung_1979=ts(lung_ts[61:72],start=1)\nyr=paste(\"lung\",\"_\",1974:1979,sep=\"\")\nxat=seq(0,12,by=1)\n\npar(mfrow=c(2,3))\n\nfor (i in yr) {ts.plot(as.name(i),main=i,ylab=\"Deaths by lung diseases\")\n  axis(side=1,at=xat)}\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-12.png){width=672}\n:::\n\n```{.r .cell-code}\n#각 년도별 계절성을 비교하기 위해서 이런식으로 그래프를 연도별로 쪼개서 그렸다. 연도별로 그러한 경향성이 비슷하게 드러나고 있는 것으로 보인다.\n\nlibrary(\"ghibli\")\npal=ghibli_palette(\"PonyoMedium\",n=6)\nas.character(pal)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"#4C413FFF\" \"#5A6F80FF\" \"#278B9AFF\" \"#E75B64FF\" \"#DE7862FF\" \"#D8AF39FF\"\n```\n:::\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\n\n\nts.plot(lung_1974,main=\"Deaths by lung diseases\",xlab=\"Month\",ylab=\"# of Deaths\",col=pal[1],lwd=2,ylim=c(1000,4000))\naxis(side=1,at=xat)\nlines(lung_1975,lwd=2,col=pal[2])\nlines(lung_1976,lwd=2,col=pal[3])\nlines(lung_1977,lwd=2,col=pal[4])\nlines(lung_1978,lwd=2,col=pal[5])\nlines(lung_1979,lwd=2,col=pal[6])\n\nlegend(x = 10, y = 4000, c(1974:1979), \n       lty=c(rep(1,6)),lwd=2,col = c(as.character(pal)),cex=0.6)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-13.png){width=672}\n:::\n\n```{.r .cell-code}\n# 전체데이터와 월별데이터에 평활을 진행하고자 한다. 평활법은 교수님께서 추천하셨던 3RSSH Twice, 4253H Twice에 더해 Hanning이 이루어지기 전 평활법인 3RS3R Twice를 추가하고자 한다.\n\n# 3RSSH Twice\nsmooth_3RSSH=function(data){\n  smooth3RSS=smooth(data, kind=\"3RSS\")\n  \n  n=length(data)\n  smooth3RSSH=smooth3RSS\n  \n  \n  for (i in 2:(n-1)) {smooth3RSSH[i] <- smooth3RSS[i-1]/4 + smooth3RSS[i]/2 + smooth3RSS[i+1]/4}\n  smooth3RSSH[1] <- smooth3RSS[1]; smooth3RSSH[n] <- smooth3RSS[n]\n  rough=data-smooth3RSSH\n  roughH=rough\n  \n  smooth3RSS2=smooth(rough,kind=\"3RSS\")\n  \n  for (i in 2:(n-1)) roughH[i] <- smooth3RSS2[i-1]/4 + smooth3RSS2[i]/2 + smooth3RSS2[i+1]/4\n  roughH[1] <- smooth3RSS2[1]; roughH[n] <- smooth3RSS2[n]\n  out=smooth3RSSH+roughH\n  out=as.vector(out)\n  return(out)\n}\n\nlibrary(sleekts)\npal2=as.vector(ghibli_palette(\"MononokeMedium\")[c(1,3,5,6)])\nts.plot(lung_ts,main=\"Raw Data:All\",ylab=\"# of deaths\",lty=2,col=pal2[1])\nlines(ts(smooth(lung_ts, kind=\"3RS3R\",twiceit=T),frequency = 12,start=c(1974,1),end=c(1979,12)),col=pal2[2],lwd=2)\nlines(ts(smooth_3RSSH(lung_ts),frequency = 12,start=c(1974,1),end=c(1979,12)),col=pal2[3],lwd=2)\nlines(ts(sleek(lung_ts),frequency = 12,start=c(1974,1),end=c(1979,12)),col=pal2[4],lwd=2)\n\nlegend(x =1974, y = 3900, c(\"Default\", \"3RS3R Twice\", \"3RSSH Twice\",\"4253H Twice\"), \n       lty=c(2,1,1,1),lwd=2,col = pal2,cex=0.7)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-14.png){width=672}\n:::\n\n```{.r .cell-code}\n#평활법을 적용하여 확인할 경우 원 자료에 비해 최댓값과 최솟값의 폭이 많이 줄어들었음을 확인할 수 있다. 작은 값에서는 크게 변화가 없지만 값이 큰 자료들의 경우 많이 깎여나갔다.\n#시계열을 확인하는데 있어서 그 계절성을 확인하기 좋은 형태로 평활이 된 것은 사실이지만, 위에서 언급한 1976, 1979년도의 특이값이 사라지게 되었고 그 특이값을 해석하는데 있어서 주의를 기울여야 할 것으로 보인다. 3RS3R Twice 기법의 경우 Hanning이 진행되지 않았기 때문에 다소 각진 부분이 남아있지만, 전반적으로 계절성이 나타나는 형태로 데이터를 변화시켰다. 나머지 Hanning을 사용한 2가지 평활법의 차이를 분석하면 4253H방법에서 큰 값들의 감소폭이 크게 나타나고 있다. 3가지 평활법의 양 끝자료의 경우 실제 존재하는 데이터를 가지고 만든 것이 아니기 때문에 그 추세를 해석하는데 있어서 용이하지만 실제 데이터와 차이가 있으므로 해석에 유의해야 할 것이다.\n# 앞에서 시계열 Decompose를 통해서 그렸던 계절성 그래프의 모양과 4253H Twice의 그래프가 상당히 유사한 것으로 보인다. 1년을 주기로 폐질환 사망자수가 Fluctuate 하고 있는데 겨울철에 전반적으로 증가하고 여름철에 감소하는 경향성을 가지는 것이 확인된다. 각 주기는 거의 대칭적으로 증감을 반복하고 있으며 1976, 1977년도를 제외하면 사망건수는 거의 비슷하게 유지 되는 것을 확인할 수 있다. 따라서 시계열 자료를 해석할 때 1976년도와 1977년도 자료는 유의해서 해석해야 할 것으로 보인다.\n\n# Raw Data\nts.plot(lung_1974,main=\"Deaths by lung diseases\",xlab=\"Month\",ylab=\"# of Deaths\",col=pal[1],lwd=2,ylim=c(1000,4000))\naxis(side=1,at=xat)\nlines(lung_1975,lwd=2,col=pal[2])\nlines(lung_1976,lwd=2,col=pal[3])\nlines(lung_1977,lwd=2,col=pal[4])\nlines(lung_1978,lwd=2,col=pal[5])\nlines(lung_1979,lwd=2,col=pal[6])\nlegend(x = 10, y = 4000, c(1974:1979), \n       lty=c(rep(1,6)),lwd=2,col = c(as.character(pal)),cex=0.6)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-15.png){width=672}\n:::\n\n```{.r .cell-code}\n### 3RS3R Twice\nts.plot(ts(smooth(lung_1974, kind=\"3RS3R\",twiceit=T),start=1, end=12),main=\"3RS3R TwicC: Deaths by lung diseases\",xlab=\"Month\",ylab=\"# of Deaths\",col=pal[1],lwd=2,ylim=c(1000,4000))\naxis(side=1,at=xat)\nlines(ts(smooth(lung_1975, kind=\"3RS3R\",twiceit=T),start=1, end=12),lwd=2,col=pal[2])\nlines(ts(smooth(lung_1976, kind=\"3RS3R\",twiceit=T),start=1, end=12),lwd=2,col=pal[3])\nlines(ts(smooth(lung_1977, kind=\"3RS3R\",twiceit=T),start=1, end=12),lwd=2,col=pal[4])\nlines(ts(smooth(lung_1978, kind=\"3RS3R\",twiceit=T),start=1, end=12),lwd=2,col=pal[5])\nlines(ts(smooth(lung_1979, kind=\"3RS3R\",twiceit=T),start=1, end=12),lwd=2,col=pal[6])\nlegend(x = 10, y = 4000, c(1974:1979), \n       lty=c(rep(1,6)),lwd=2,col = c(as.character(pal)),cex=0.6)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-16.png){width=672}\n:::\n\n```{.r .cell-code}\n### 3RSSH Twice\nts.plot(ts(smooth_3RSSH(lung_1974),start=1, end=12),main=\"3RSSH TwicC: Deaths by lung diseases\",xlab=\"Month\",ylab=\"# of Deaths\",col=pal[1],lwd=2,ylim=c(1000,4000))\naxis(side=1,at=xat)\nlines(ts(smooth_3RSSH(lung_1975),start=1, end=12),lwd=2,col=pal[2])\nlines(ts(smooth_3RSSH(lung_1976),start=1, end=12),lwd=2,col=pal[3])\nlines(ts(smooth_3RSSH(lung_1977),start=1, end=12),lwd=2,col=pal[4])\nlines(ts(smooth_3RSSH(lung_1978),start=1, end=12),lwd=2,col=pal[5])\nlines(ts(smooth_3RSSH(lung_1979),start=1, end=12),lwd=2,col=pal[6])\nlegend(x = 10, y = 4000, c(1974:1979), \n       lty=c(rep(1,6)),lwd=2,col = c(as.character(pal)),cex=0.6)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-17.png){width=672}\n:::\n\n```{.r .cell-code}\n### 4253H Twice\n\nts.plot(ts(sleek(lung_1974),start=1, end=12),main=\"4253H TwicC: Deaths by lung diseases\",xlab=\"Month\",ylab=\"# of Deaths\",col=pal[1],lwd=2,ylim=c(1000,4000))\naxis(side=1,at=xat)\nlines(ts(sleek(lung_1975),start=1, end=12),lwd=2,col=pal[2])\nlines(ts(sleek(lung_1976),start=1, end=12),lwd=2,col=pal[3])\nlines(ts(sleek(lung_1977),start=1, end=12),lwd=2,col=pal[4])\nlines(ts(sleek(lung_1978),start=1, end=12),lwd=2,col=pal[5])\nlines(ts(sleek(lung_1979),start=1, end=12),lwd=2,col=pal[6])\nlegend(x = 10, y = 4000, c(1974:1979), \n       lty=c(rep(1,6)),lwd=2,col = c(as.character(pal)),cex=0.6)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-18.png){width=672}\n:::\n\n```{.r .cell-code}\n# 원자료 --> 3RS3R Twice --> 3RSSH Twice--> 4253H Twice순으로 시계열의 추세가 유사해지고 있는것을 확인할 수 있다.\n# Hanning을 사용하여 3RSSH Twice, 4253H Twice는 평평한 구간 없이 부드럽게 넘어가고 있으며 1976,1979년도 평활법을 통해서 최대값이 줄어들어 다른 년도와 유사한 계절성을 확인할 수 있게 되었다.\n# 다만 4253H Twice 방법보다는 3RSSH Twice 방법이 더 적절한 것으로 보인다. 왜냐하면 11월~12월의 값이 서로 같게 나타나고 있기 때문이다. \n\nlibrary(forecast)\naTSA::adf.test(lung_ts, nlag = NULL, output = TRUE) # p-value<=0.01 귀무가설을 기각하여 정상시계열\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAugmented Dickey-Fuller Test \nalternative: stationary \n \nType 1: no drift no trend \n     lag    ADF p.value\n[1,]   0 -0.922   0.347\n[2,]   1 -0.938   0.341\n[3,]   2 -1.067   0.295\n[4,]   3 -0.926   0.345\nType 2: with drift no trend \n     lag   ADF p.value\n[1,]   0 -3.12  0.0328\n[2,]   1 -4.71  0.0100\n[3,]   2 -5.93  0.0100\n[4,]   3 -6.96  0.0100\nType 3: with drift and trend \n     lag   ADF p.value\n[1,]   0 -3.02   0.159\n[2,]   1 -4.67   0.010\n[3,]   2 -5.85   0.010\n[4,]   3 -6.89   0.010\n---- \nNote: in fact, p.value = 0.01 means p.value <= 0.01 \n```\n:::\n\n```{.r .cell-code}\nfit <- auto.arima(lung_ts)\nplot(forecast(fit, level=c(75, 95), h=12),col='black') \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-11-19.png){width=672}\n:::\n\n```{.r .cell-code}\n# 다음 1년간의 변화를 예측할 경우 이전의 자료들과 비슷한 추세를 가지고 있는 것이 확인되어 진다.\n```\n:::\n\n\n# 6.\n\n헬멧의 충돌 실험에서 충돌 이후 머리의 가속(g)과 시간의 경과(milliseconds)에 대한 자료이다. 자료를 평활하고 특징을 설명하여라. \\[HELMETS.DAT\\]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhelmet=(read.delim(\"C:/r/HELMETS.DAT\",header=F,))\nh1=helmet[c(1,2)]\nnames(h1)=c(\"imptime\",\"accel\")\nh2=helmet[c(3,4)]\nnames(h2)=c(\"imptime\",\"accel\")\nh3=helmet[c(5,6)]\nnames(h3)=c(\"imptime\",\"accel\")\n\nhelmet=rbind(h1,h2,h3)\ndim(helmet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 135   2\n```\n:::\n\n```{.r .cell-code}\nplot(helmet$accel~helmet$imptime,main=\"scatter plot of impact time and head\") # 두 좌표간의 관계를 보면 곡선의 관계를 띄고 있는 것을 확인할 수 있다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 결측치와 outlier의 존재여부를 체크하고자 한다.\nboxplot(helmet, main=\"Helmet\")  # Outlier는 없다. 충돌 후 시간의 경우 median이 lower hinge쪽으로 기울어 있고, 머리의 가속의 경우 median이 upper hinge쪽으로 기울어 있다. \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncolSums(is.na(helmet)) # 결측치 각각 두개씩\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nimptime   accel \n      2       2 \n```\n:::\n\n```{.r .cell-code}\nhelmet=helmet[ifelse(!is.na(helmet)[,1]==F|!is.na(helmet)[,2]==F,F,T),]\nhead(helmet,5) # 결측치 제거 후 분석 시작\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  imptime accel\n1     2.4   0.0\n2     2.6  -1.3\n3     3.2  -2.7\n4     3.6   0.0\n5     4.0  -2.7\n```\n:::\n\n```{.r .cell-code}\ndim(helmet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 133   2\n```\n:::\n\n```{.r .cell-code}\nattach(helmet)\nsummary(imptime) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.40   15.60   23.40   25.18   34.80   57.60 \n```\n:::\n\n```{.r .cell-code}\nsummary(accel) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-134.00  -54.90  -13.30  -25.55    0.00   75.00 \n```\n:::\n\n```{.r .cell-code}\n# Steam and leaf plot을 활용해서 자료의 분포를 예측해보고자 했다.\nstem(imptime,1) # stem 1을 기준으로 skewed 된 종모양\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  0 | 23344\n  0 | 6778899\n  1 | 000111344\n  1 | 5555555555566666666666777788888899999\n  2 | 000112233444\n  2 | 55555666667777888899\n  3 | 011223344\n  3 | 555566668899\n  4 | 0022233344\n  4 | 57889\n  5 | 123\n  5 | 5558\n```\n:::\n\n```{.r .cell-code}\nstem(accel,0.5) # stem -0을 기준으로 skewed 종모양\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  -12 | 49733333\n  -10 | 83387422\n   -8 | 9516620\n   -6 | 8221642\n   -4 | 9855441116430\n   -2 | 882777433222222\n   -0 | 76665533311955555533333333333333311111\n    0 | 000000014580111111256\n    2 | 3912568\n    4 | 677785\n    6 | 055\n```\n:::\n\n```{.r .cell-code}\n#skewness\nskewness(imptime) #Skewed to the right되어 있음.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1875\n```\n:::\n\n```{.r .cell-code}\nskewness(accel) #Skewed to the left되어 있음\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.5154827\n```\n:::\n\n```{.r .cell-code}\n# letter value display\nsource(\"http://mgimond.github.io/ES218/es218.R\")\n(lvd13=lsum(imptime,9)) # mid 값이 점차 커지는 중\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth lower  mid upper spread\n1      M  67.0  23.4 23.4  23.4    0.0\n2      H  34.0  15.6 25.2  34.8   19.2\n3      E  17.5  11.2 26.9  42.6   31.4\n4      D   9.0   7.8 27.8  47.8   40.0\n5      C   5.0   4.0 28.6  53.2   49.2\n6      B   3.0   3.2 29.1  55.0   51.8\n7      A   2.0   2.6 29.0  55.4   52.8\n8      Z   1.5   2.5 29.5  56.5   54.0\n9      Y   1.0   2.4 30.0  57.6   55.2\n```\n:::\n\n```{.r .cell-code}\n(lvd14=lsum(accel,9))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  letter depth   lower     mid  upper spread\n1      M  67.0  -13.30 -13.300 -13.30   0.00\n2      H  34.0  -54.90 -27.450   0.00  54.90\n3      E  17.5  -97.10 -40.875  15.35 112.45\n4      D   9.0 -117.90 -36.150  45.60 163.50\n5      C   5.0 -123.10 -37.450  48.20 171.30\n6      B   3.0 -127.20 -28.800  69.60 196.80\n7      A   2.0 -128.50 -26.750  75.00 203.50\n8      Z   1.5 -131.25 -28.125  75.00 206.25\n9      Y   1.0 -134.00 -29.500  75.00 209.00\n```\n:::\n\n```{.r .cell-code}\n# Kurtosis (E-spread) / (H-spread) - 1.705\n(lvd13[3,5]-lvd13[3,3])/(lvd13[2,5]-lvd13[2,3])-1.705 # less peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.06958333\n```\n:::\n\n```{.r .cell-code}\n(lvd14[3,5]-lvd14[3,3])/(lvd14[2,5]-lvd14[2,3])-1.705 # more peaked than normal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3432696\n```\n:::\n\n```{.r .cell-code}\n# H-Spread\n(lvd13[2,5]-lvd13[2,3]) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19.2\n```\n:::\n\n```{.r .cell-code}\n(lvd14[2,5]-lvd14[2,3]) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 54.9\n```\n:::\n\n```{.r .cell-code}\n# 자료들이 정규성 따르냐?\nqqnorm(imptime, ylab=\"Impact Time Quantiles\");qqline(imptime, col='red',lty=2) # 자료들이 정규분포를 잘 따르고 있는 것으로 보인다. (꼬리부분에서 다소 벗어나 보이나)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(accel, ylab=\"Head Acceleration Quantiles\");qqline(accel, col='red',lty=2) # 자료들이 qqline을 잘 따르기 보다는 역s자 곡선의 형태를 띄고 있는 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# 시계열 분석이 아니라 산점도 평활법을 적용해 분석을 진행해보고자 한다. \nplot(helmet$accel~helmet$imptime,main=\"scatter plot of impact time and head acceleration\")\nlines(lowess(accel~imptime,f=2/3), col = \"Red\")\nlines(lowess(accel~imptime,f=1/2), col = \"blue\")\nlines(lowess(accel~imptime,f=1/3), col = \"darkgreen\")\nlegend(3, 75, c(paste(\"f = \", c(\"2/3\", \"1/2\",\"1/3\"))), lty = 1, col = c(\"red\",\"blue\",\"darkgreen\"), cex=0.7)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# f=1/3일때 가장 이상적으로 보인다.\n\n# residuals with the default span f = 2/3\nresiduals <- helmet$accel - lowess(helmet)$y\nplot(residuals ~ helmet$imptime, main = \"Residuals with f = 2/3\")\nlines(lowess(helmet$imptime, residuals, f=0.3))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-6.png){width=672}\n:::\n\n```{.r .cell-code}\n#여전히 잔차들이 경향성을 가지는 것으로 보인다.\n\n\n# residuals with span f = 1/2\nresiduals <- helmet$accel - lowess(helmet,f=0.5)$y\nplot(residuals ~ helmet$imptime, main = \"Residuals with f = 1/2\")\nlines(lowess(helmet$imptime, residuals, f=0.3))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-7.png){width=672}\n:::\n\n```{.r .cell-code}\n#여전히 잔차들이 경향성을 가지는 것으로 보인다.\n\n# residuals with span f = 1/3\nresiduals <- helmet$accel - lowess(helmet,f=1/3)$y\nplot(residuals ~ helmet$imptime, main = \"Residuals with f = 1/3\")\nlines(lowess(helmet$imptime, residuals, f=1))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-8.png){width=672}\n:::\n\n```{.r .cell-code}\n# 잔차들의 경향성이 완화되었다.\n\nplot(helmet, main = \"loess(cars)\")\n\nhelmet.lo <- loess(accel ~ imptime, helmet)\nhelmet.lo.pred <- predict(helmet.lo, data.frame(imptime=seq(0, 60, length=133)), se=TRUE)\nlines(helmet.lo.pred$fit ~ seq(0, 60, length=133), col = 2)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-12-9.png){width=672}\n:::\n:::\n\n\n# 7.\n\n어린 아이들의 나이별 평균 사용 단어 수이다. 분석하여라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nage=c(1.0,1.5,2.0,2.5,3.0,3.5,4.0,4.5,5.0,6.0)\nwords=c(3,22,272,446,896,1222,1540,1870,2072,2562)\n\nlength(words) #총 10개의 자료\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 10\n```\n:::\n\n```{.r .cell-code}\nsummary(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   2.125   3.250   3.300   4.375   6.000 \n```\n:::\n\n```{.r .cell-code}\nsummary(words)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    3.0   315.5  1059.0  1090.5  1787.5  2562.0 \n```\n:::\n\n```{.r .cell-code}\nboxplot(age,main=\"age\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(words,main=\"words\") #outlier는 없다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmedage <- as.vector(3)\nmedwords <- as.vector(3)\nmedage[1] <- median(age[1:3],na.rm=T); medwords[1] <- median(words[1:3],na.rm=T)\nmedage[2] <- median(age[4:7],na.rm=T); medwords[2] <- median(words[4:7],na.rm=T)\nmedage[3] <- median(age[8:10],na.rm=T); medwords[3] <- median(words[8:10],na.rm=T)\nplot(medwords ~ medage, type=\"b\") \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# 선형 관계로 나타나는 것을 확인할 수 있다. \n\ncor.test(words,age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  words and age\nt = 23.134, df = 8, p-value = 1.294e-08\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9678822 0.9983153\nsample estimates:\n      cor \n0.9926087 \n```\n:::\n\n```{.r .cell-code}\nlmfit=lm(words~age)\nlmfit2=lm(words~age+0)\nsummary(lmfit) #단순회귀에서는 상관계수/회귀값 모두 두 변수가 상관정도가 높게 나타나고 있다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = words ~ age)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-194.959  -54.200   -3.404   48.670  204.931 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -763.86      88.25  -8.656 2.47e-05 ***\nage           561.93      24.29  23.134 1.29e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 116.7 on 8 degrees of freedom\nMultiple R-squared:  0.9853,\tAdjusted R-squared:  0.9834 \nF-statistic: 535.2 on 1 and 8 DF,  p-value: 1.294e-08\n```\n:::\n\n```{.r .cell-code}\n# 나이가 한살 많아질수록 알고 있는 단어의 수는 561.93개로 나타남. \n\nsummary(lmfit2) #모르는 단어가 음수일 수는 없기 때문에 절편을 원점으로 고정하고 회귀분석을 진행할 경우 나이 한살이 많아질 수록 370.96개의 단어를 추가적으로 알 것이다라고 추론 할 수 있다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = words ~ age + 0)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-534.4 -444.4 -146.6  164.5  336.2 \n\nCoefficients:\n    Estimate Std. Error t value Pr(>|t|)    \nage   370.96      30.84   12.03 7.55e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 354.4 on 9 degrees of freedom\nMultiple R-squared:  0.9414,\tAdjusted R-squared:  0.9349 \nF-statistic: 144.7 on 1 and 9 DF,  p-value: 7.551e-07\n```\n:::\n\n```{.r .cell-code}\nplot(words~age,main=\"linearity of words ~ age\")\n(z5<-line(x=age,y=words))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nline(x = age, y = words)\n\nCoefficients:\n[1]  -917   608\n```\n:::\n\n```{.r .cell-code}\nabline(coef(z5))\nz5.ls <- lm(words~age)\nabline(z5.ls$coef, lty=2,col=\"red\")\nlegend(x = 1, y = 2300, c(\"R - Line\", \"Regression\"), \n       lty=c(1,2),lwd=2,col = c(\"black\",\"red\"),cex=0.7)       \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(residuals(z5) ~ fitted(z5), main = \"Residual plot by rline\") \nabline(0,0) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# 1살에서의 단어의 수를 제외하면 대부분의 데이터들이 0 근처에 있는 것이 확인되어 진다.\n\nboxplot(residuals(z5))\nboxplot(residuals(z5))$out #lower fence 밖의 oulier -169, upper fence 밖의 outlier 312\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-13-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  312 -169\n```\n:::\n\n```{.r .cell-code}\nstem(residuals(z5)) # Outlier 재확인 가능\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 2 digit(s) to the right of the |\n\n  -1 | 76\n  -0 | 531\n   0 | 1335\n   1 | \n   2 | \n   3 | 1\n```\n:::\n\n```{.r .cell-code}\nsum(residuals(z5)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 158081\n```\n:::\n:::\n\n\n# 8.\n\n다음 자료는 권투선수 Mike Tyson과 Frank Bruno의 1989년 World Heavyweight Championship match의 자료이다. 타이슨이 이겼다. connected는 펀치를 정확히 맞힌 것이다. 누가 펀치를 많이 날렸는지? 누가 정확히 맞혔는지? 누가 잽(작은 펀치)을 많이 했는지? 누가 파워펀치를 많이 했는지? 등등을 분석하여 보아라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntyson=as.data.frame(matrix(c(43,39,28,37,55,13,14,13,15,34,6,9,5,13,8,0,1,1,3,3,37,30,23,24,47,13,13,12,12,31,1,0,0,0,0),nrow=7,byrow=T))\nnames(tyson)=1:5\nrownames(tyson)=c(\"Total punches\",\"Punches connected\",\"Jabs thrown\",\"Jabs conneted\",\"Power punches\",\"Power connected\",\"Knockdowns\")\ntyson\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   1  2  3  4  5\nTotal punches     43 39 28 37 55\nPunches connected 13 14 13 15 34\nJabs thrown        6  9  5 13  8\nJabs conneted      0  1  1  3  3\nPower punches     37 30 23 24 47\nPower connected   13 13 12 12 31\nKnockdowns         1  0  0  0  0\n```\n:::\n\n```{.r .cell-code}\nbruno=as.data.frame(matrix(c(55,42,35,18,20,14,8,5,3,7,14,24,16,8,6,2,1,0,0,1,41,18,19,10,14,12,7,5,3,6,0,0,0,0,0),nrow=7,byrow=T))           \nnames(bruno)=1:5              \nrownames(bruno)=c(\"Total punches\",\"Punches connected\",\"Jabs thrown\",\"Jabs conneted\",\"Power punches\",\"Power connected\",\"Knockdowns\")                   \nbruno   \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   1  2  3  4  5\nTotal punches     55 42 35 18 20\nPunches connected 14  8  5  3  7\nJabs thrown       14 24 16  8  6\nJabs conneted      2  1  0  0  1\nPower punches     41 18 19 10 14\nPower connected   12  7  5  3  6\nKnockdowns         0  0  0  0  0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ghibli)\npal=ghibli_palette(\"PonyoMedium\",5)\nmosaicplot(tyson,col=pal,main=\"mosaic plot of tyson\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmosaicplot(bruno,col=pal,main=\"mosaic plot of bruno\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n\n\n-   Punch\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# connected는 펀치를 정확히 맞힌 것이다. \n# 누가 펀치를 많이 했는지         \ntotalpunch=rbind(tyson[1,],bruno[1,])\nrownames(totalpunch)=c(\"tyson\",\"bruno\")\ntotalpunch\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1  2  3  4  5\ntyson 43 39 28 37 55\nbruno 55 42 35 18 20\n```\n:::\n\n```{.r .cell-code}\nchisq.test(totalpunch)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  totalpunch\nX-squared = 22.67, df = 4, p-value = 0.0001473\n```\n:::\n\n```{.r .cell-code}\n# Null hypothesis (H0): the row and the column variables of the contingency table are independent.\n# Alternative hypothesis (H1): row and column variables are dependent\n# 따라서, tyson의 round별 파워펀치 수와 bruno의 round별 파워펀치 수는 차이가 있다.\n\ntotalpunch_polished=medpolish(totalpunch)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1: 80\n2: 73\nFinal: 73\n```\n:::\n\n```{.r .cell-code}\ntotalpunch_polished\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMedian Polish Results (Dataset: \"totalpunch\")\n\nOverall: 37.5\n\nRow Effects:\ntyson bruno \n -1.5   1.5 \n\nColumn Effects:\n    1     2     3     4     5 \n 11.5   3.0  -6.0 -10.0   0.0 \n\nResiduals:\n         1 2  3   4   5\ntyson -4.5 0 -2  11  19\nbruno  4.5 0  2 -11 -19\n```\n:::\n\n```{.r .cell-code}\nbarplot(totalpunch_polished$col) # 1라운드에서 펀치가 가장 많고 4라운드에서 펀치가 적다\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totalpunch_polished$row) # Bruno가 Tyson에 비해 펀치를 많이 한 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totalpunch_polished$residuals)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(reshape2)\ntotalpunch2=cbind(c(\"tyson\",\"bruno\"),totalpunch)\ntotalpunch2=melt(totalpunch2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson\", \"bruno\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(totalpunch2)=c(\"player\",\"round\",\"value\")\ntotalpunch2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   player round value\n1   tyson     1    43\n2   bruno     1    55\n3   tyson     2    39\n4   bruno     2    42\n5   tyson     3    28\n6   bruno     3    35\n7   tyson     4    37\n8   bruno     4    18\n9   tyson     5    55\n10  bruno     5    20\n```\n:::\n\n```{.r .cell-code}\nlibrary(doBy)\nsummaryBy(value ~player, data=totalpunch2, FUN = c(mean,sum,min,max)) #평균적으로 bruno가 펀치의 횟수가 많았다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  player value.mean value.sum value.min value.max\n1  bruno       34.0       170        18        55\n2  tyson       40.4       202        28        55\n```\n:::\n\n```{.r .cell-code}\nsummaryBy(value ~round, data=totalpunch2, FUN = c(mean,sum,min,max)) #라운드별로 보았을 때에는 1라운드에서 펀치횟수가 가장 많고 4라운드에서 펀치횟수가 가장 적다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  round value.mean value.sum value.min value.max\n1     1       49.0        98        43        55\n2     2       40.5        81        39        42\n3     3       31.5        63        28        35\n4     4       27.5        55        18        37\n5     5       37.5        75        20        55\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(totalpunch2,aes(x=as.factor(round),y=value))+\n  geom_bar(stat=\"identity\",position=\"dodge\",fill=rep(pal,2))+\n  facet_wrap(~ player, nrow=1)+\n  geom_text(aes(label=value), vjust=-0.4, size=3.5)+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Punch Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(totalpunch2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= value),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Punch Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-5.png){width=672}\n:::\n\n```{.r .cell-code}\naov10=aov(value~player+round,data=totalpunch2)\nsummary(aov10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\nplayer       1  102.4   102.4   0.517  0.512\nround        4  553.6   138.4   0.699  0.631\nResiduals    4  791.6   197.9               \n```\n:::\n\n```{.r .cell-code}\nlibrary(agricolae)\nHSD.test(aov10, \"round\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov10 ~ \"round\"\n\nHSD Test for value \n\nMean Square Error:  197.9 \n\nround,  means\n\n  value       std r Min Max\n1  49.0  8.485281 2  43  55\n2  40.5  2.121320 2  39  42\n3  31.5  4.949747 2  28  35\n4  27.5 13.435029 2  18  37\n5  37.5 24.748737 2  20  55\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 6.287027 \n\nMinimun Significant Difference: 62.53933 \n\nTreatments with the same letter are not significantly different.\n\n  value groups\n1  49.0      a\n2  40.5      a\n5  37.5      a\n3  31.5      a\n4  27.5      a\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov10, \"player\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov10 ~ \"player\"\n\nHSD Test for value \n\nMean Square Error:  197.9 \n\nplayer,  means\n\n      value       std r Min Max\nbruno  34.0 15.475788 5  18  55\ntyson  40.4  9.838699 5  28  55\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 3.926503 \n\nMinimun Significant Difference: 24.70267 \n\nTreatments with the same letter are not significantly different.\n\n      value groups\ntyson  40.4      a\nbruno  34.0      a\n```\n:::\n\n```{.r .cell-code}\nlibrary(twoway)\ntwoway(totalpunch)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMean decomposition (Dataset: \"totalpunch\"; Response: Value)\nResiduals bordered by row effects, column effects, and overall\n\n         1     2     3     4     5       roweff\n       + ----- ----- ----- ----- ----- + ----- \ntyson  |  -9.2  -4.7  -6.7   6.3  14.3 :   3.2 \nbruno  |   9.2   4.7   6.7  -6.3 -14.3 :  -3.2 \n       + ..... ..... ..... ..... ..... + ..... \ncoleff |  11.8   3.3  -5.7  -9.7   0.3 :  37.2 \n```\n:::\n\n```{.r .cell-code}\nplot(twoway(totalpunch))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 누가 정확히 맞혔는지? \npunch_accu=cbind((tyson[2,]/tyson[1,]),sum(tyson[2,])/sum(tyson[1,]))\nnames(punch_accu)=c(1:5,\"total\")\nrownames(punch_accu)=\"tyson_connect\"\npunch_accu=round(punch_accu*100,2)\n\npunch_accu1=cbind((bruno[2,]/bruno[1,]),sum(bruno[2,])/sum(bruno[1,]))\nnames(punch_accu1)=c(1:5,\"total\")\nrownames(punch_accu1)=\"bruno_connect\"\npunch_accu1=round(punch_accu1*100,2)\npunch_accu1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1     2     3     4  5 total\nbruno_connect 25.45 19.05 14.29 16.67 35 21.76\n```\n:::\n\n```{.r .cell-code}\nconnect_prob=rbind(punch_accu,punch_accu1)\nconnect_prob\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1     2     3     4     5 total\ntyson_connect 30.23 35.90 46.43 40.54 61.82 44.06\nbruno_connect 25.45 19.05 14.29 16.67 35.00 21.76\n```\n:::\n\n```{.r .cell-code}\n# 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.\n# Punch가 Connected될 비율은 모든 라운드에서 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. \n\nconnect_prob=cbind(c(\"tyson_connect\",\"bruno_connect\"),connect_prob)\nconnect_prob2=melt(connect_prob)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson_connect\", \"bruno_connect\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(connect_prob2)=c(\"player\",\"round\",\"value\")\nggplot(connect_prob2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= paste(sprintf(\"%2.1f\", value),\"%\",sep=\"\")),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Punch Connect Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value(prop(%)\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-16-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# tyson이 bruno에 비해서 punch를 더 정확하게 하였다.\n```\n:::\n\n\n-   Jab\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 누가 잽(작은 펀치)을 많이 했는지? \ntotaljab=rbind(tyson[3,],bruno[3,])\nrownames(totaljab)=c(\"tyson\",\"bruno\")\ntotaljab\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1  2  3  4 5\ntyson  6  9  5 13 8\nbruno 14 24 16  8 6\n```\n:::\n\n```{.r .cell-code}\nchisq.test(totaljab)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  totaljab\nX-squared = 11.259, df = 4, p-value = 0.0238\n```\n:::\n\n```{.r .cell-code}\n# Null hypothesis (H0): the row and the column variables of the contingency table are independent.\n# Alternative hypothesis (H1): row and column variables are dependent\n# 따라서, tyson의 round별 jab수와 bruno의 round별 jab수는 차이가 있다.\n\ntotaljab_polished=medpolish(totaljab)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1: 35\n2: 33\nFinal: 33\n```\n:::\n\n```{.r .cell-code}\ntotaljab_polished\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMedian Polish Results (Dataset: \"totaljab\")\n\nOverall: 10.5\n\nRow Effects:\ntyson bruno \n   -4     4 \n\nColumn Effects:\n   1    2    3    4    5 \n-0.5  6.0  0.0  0.0 -3.5 \n\nResiduals:\n      1    2    3    4  5\ntyson 0 -3.5 -1.5  6.5  5\nbruno 0  3.5  1.5 -6.5 -5\n```\n:::\n\n```{.r .cell-code}\nbarplot(totaljab_polished$col) # 2라운드에서 Jab이 가장 많고 5라운드에서 Jab이 적게 나타난다. (5라운드에서 punch가 많았던 것에 비교하면 약간의 차이를 보인다) \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totaljab_polished$row) # Bruno가 Tyson에 비해 Jab을 많이 한 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totaljab_polished$residuals)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntotaljab2=cbind(c(\"tyson\",\"bruno\"),totaljab)\ntotaljab2=melt(totaljab2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson\", \"bruno\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(totaljab2)=c(\"player\",\"round\",\"value\")\ntotaljab2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   player round value\n1   tyson     1     6\n2   bruno     1    14\n3   tyson     2     9\n4   bruno     2    24\n5   tyson     3     5\n6   bruno     3    16\n7   tyson     4    13\n8   bruno     4     8\n9   tyson     5     8\n10  bruno     5     6\n```\n:::\n\n```{.r .cell-code}\nlibrary(doBy)\nsummaryBy(value ~player, data=totaljab2, FUN = c(mean,sum,min,max)) #평균적으로 Bruno가 잽을 많이 했다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  player value.mean value.sum value.min value.max\n1  bruno       13.6        68         6        24\n2  tyson        8.2        41         5        13\n```\n:::\n\n```{.r .cell-code}\nsummaryBy(value ~round, data=totaljab2, FUN = c(mean,sum,min,max)) #라운드별로 보았을 때에는 2라운드에서 Jab이 가장 많고 5라운드에서 Jab이 가장 적다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  round value.mean value.sum value.min value.max\n1     1       10.0        20         6        14\n2     2       16.5        33         9        24\n3     3       10.5        21         5        16\n4     4       10.5        21         8        13\n5     5        7.0        14         6         8\n```\n:::\n\n```{.r .cell-code}\nggplot(totaljab2,aes(x=as.factor(round),y=value))+\n  geom_bar(stat=\"identity\",position=\"dodge\",fill=rep(pal,2))+\n  facet_wrap(~ player, nrow=1)+\n  geom_text(aes(label=value), vjust=-0.4, size=3.5)+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Jab Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(totaljab2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= value),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Jab Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-5.png){width=672}\n:::\n\n```{.r .cell-code}\naov11=aov(value~player+round,data=totaljab2)\nsummary(aov11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\nplayer       1   72.9   72.90   1.989  0.231\nround        4   95.4   23.85   0.651  0.656\nResiduals    4  146.6   36.65               \n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov11, \"round\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov11 ~ \"round\"\n\nHSD Test for value \n\nMean Square Error:  36.65 \n\nround,  means\n\n  value       std r Min Max\n1  10.0  5.656854 2   6  14\n2  16.5 10.606602 2   9  24\n3  10.5  7.778175 2   5  16\n4  10.5  3.535534 2   8  13\n5   7.0  1.414214 2   6   8\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 6.287027 \n\nMinimun Significant Difference: 26.91332 \n\nTreatments with the same letter are not significantly different.\n\n  value groups\n2  16.5      a\n3  10.5      a\n4  10.5      a\n1  10.0      a\n5   7.0      a\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov11, \"player\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov11 ~ \"player\"\n\nHSD Test for value \n\nMean Square Error:  36.65 \n\nplayer,  means\n\n      value      std r Min Max\nbruno  13.6 7.127412 5   6  24\ntyson   8.2 3.114482 5   5  13\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 3.926503 \n\nMinimun Significant Difference: 10.6306 \n\nTreatments with the same letter are not significantly different.\n\n      value groups\nbruno  13.6      a\ntyson   8.2      a\n```\n:::\n\n```{.r .cell-code}\nlibrary(twoway)\ntwoway(totaljab)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMean decomposition (Dataset: \"totaljab\"; Response: Value)\nResiduals bordered by row effects, column effects, and overall\n\n         1    2    3    4    5      roweff\n       + ---- ---- ---- ---- ---- + ----  \ntyson  | -1.3 -4.8 -2.8  5.2  3.7 : -2.7  \nbruno  |  1.3  4.8  2.8 -5.2 -3.7 :  2.7  \n       + .... .... .... .... .... + ....  \ncoleff | -0.9  5.6 -0.4 -0.4 -3.9 : 10.9  \n```\n:::\n\n```{.r .cell-code}\nplot(twoway(totaljab))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 누가 정확히 맞혔는지? \njab_accu=cbind((tyson[4,]/tyson[3,]),sum(tyson[4,])/sum(tyson[3,]))\nnames(jab_accu)=c(1:5,\"total\")\nrownames(jab_accu)=\"tyson_connect\"\njab_accu=round(jab_accu*100,2)\n\njab_accu1=cbind((bruno[4,]/bruno[3,]),sum(bruno[4,])/sum(bruno[3,]))\nnames(jab_accu1)=c(1:5,\"total\")\nrownames(jab_accu1)=\"bruno_connect\"\njab_accu1=round(jab_accu1*100,2)\njab_accu1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1    2 3 4     5 total\nbruno_connect 14.29 4.17 0 0 16.67  5.88\n```\n:::\n\n```{.r .cell-code}\njconnect_prob=rbind(jab_accu,jab_accu1)\njconnect_prob\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1     2  3     4     5 total\ntyson_connect  0.00 11.11 20 23.08 37.50 19.51\nbruno_connect 14.29  4.17  0  0.00 16.67  5.88\n```\n:::\n\n```{.r .cell-code}\n# 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.\n# Punch의 Connected될 비율은 1라운드를 제외하면 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. \n\njconnect_prob=cbind(c(\"tyson_connect\",\"bruno_connect\"),jconnect_prob)\njconnect_prob2=melt(jconnect_prob)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson_connect\", \"bruno_connect\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(jconnect_prob2)=c(\"player\",\"round\",\"value\")\nggplot(jconnect_prob2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= paste(sprintf(\"%2.1f\", value),\"%\",sep=\"\")),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Jab Punch Connect Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value(prop(%)\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-17-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# tyson이 bruno에 비해서 더 정확한 Jab 펀치를 하였다.\n```\n:::\n\n\n-   power punch\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 누가 파워펀치를 많이 했는지         \ntotalpower=rbind(tyson[5,],bruno[5,])\nrownames(totalpower)=c(\"tyson\",\"bruno\")\ntotalpower\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1  2  3  4  5\ntyson 37 30 23 24 47\nbruno 41 18 19 10 14\n```\n:::\n\n```{.r .cell-code}\nchisq.test(totalpower)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  totalpower\nX-squared = 14.708, df = 4, p-value = 0.005348\n```\n:::\n\n```{.r .cell-code}\n# Null hypothesis (H0): the row and the column variables of the contingency table are independent.\n# Alternative hypothesis (H1): row and column variables are dependent\n# 따라서, tyson의 round별 파워펀치 수와 bruno의 round별 파워펀치 수는 차이가 있다.\n\ntotalpower_polished=medpolish(totalpower)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1: 47\nFinal: 47\n```\n:::\n\n```{.r .cell-code}\ntotalpower_polished\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMedian Polish Results (Dataset: \"totalpower\")\n\nOverall: 24\n\nRow Effects:\ntyson bruno \n    6    -6 \n\nColumn Effects:\n   1    2    3    4    5 \n15.0  0.0 -3.0 -7.0  6.5 \n\nResiduals:\n       1 2  3  4     5\ntyson -8 0 -4  1  10.5\nbruno  8 0  4 -1 -10.5\n```\n:::\n\n```{.r .cell-code}\nbarplot(totalpower_polished$col) # 1라운드에서 파워펀치가 가장 많고 점점 줄다가 5라운드에서 다시 늘어남 \n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totalpower_polished$row) # Tyson이 Bruno에 비해 파워펀치를 많이 한 것으로 보인다.\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(totalpower_polished$residuals)\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntotalpower2=cbind(c(\"tyson\",\"bruno\"),totalpower)\ntotalpower2=melt(totalpower2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson\", \"bruno\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(totalpower2)=c(\"player\",\"round\",\"value\")\ntotalpower2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   player round value\n1   tyson     1    37\n2   bruno     1    41\n3   tyson     2    30\n4   bruno     2    18\n5   tyson     3    23\n6   bruno     3    19\n7   tyson     4    24\n8   bruno     4    10\n9   tyson     5    47\n10  bruno     5    14\n```\n:::\n\n```{.r .cell-code}\nlibrary(doBy)\nsummaryBy(value ~player, data=totalpower2, FUN = c(mean,sum,min,max)) #평균적으로 tyson이 파워펀치가 많았다.\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  player value.mean value.sum value.min value.max\n1  bruno       20.4       102        10        41\n2  tyson       32.2       161        23        47\n```\n:::\n\n```{.r .cell-code}\nsummaryBy(value ~round, data=totalpower2, FUN = c(mean,sum,min,max)) #라운드별로 보았을 때에는 1라운드에서 파워펀치가 가장 많고 4라운드에서 파워펀치가 가장 적다. \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  round value.mean value.sum value.min value.max\n1     1       39.0        78        37        41\n2     2       24.0        48        18        30\n3     3       21.0        42        19        23\n4     4       17.0        34        10        24\n5     5       30.5        61        14        47\n```\n:::\n\n```{.r .cell-code}\nggplot(totalpower2,aes(x=as.factor(round),y=value))+\n  geom_bar(stat=\"identity\",position=\"dodge\",fill=rep(pal,2))+\n  facet_wrap(~ player, nrow=1)+\n  geom_text(aes(label=value), vjust=-0.4, size=3.5)+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Power Punch Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(totalpower2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= value),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Total Power Punch Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-5.png){width=672}\n:::\n\n```{.r .cell-code}\naov12=aov(value~player+round,data=totalpower2)\nsummary(aov12)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\nplayer       1  348.1   348.1   3.641  0.129\nround        4  597.6   149.4   1.563  0.338\nResiduals    4  382.4    95.6               \n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov12, \"round\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov12 ~ \"round\"\n\nHSD Test for value \n\nMean Square Error:  95.6 \n\nround,  means\n\n  value       std r Min Max\n1  39.0  2.828427 2  37  41\n2  24.0  8.485281 2  18  30\n3  21.0  2.828427 2  19  23\n4  17.0  9.899495 2  10  24\n5  30.5 23.334524 2  14  47\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 6.287027 \n\nMinimun Significant Difference: 43.46696 \n\nTreatments with the same letter are not significantly different.\n\n  value groups\n1  39.0      a\n5  30.5      a\n2  24.0      a\n3  21.0      a\n4  17.0      a\n```\n:::\n\n```{.r .cell-code}\nHSD.test(aov12, \"player\", group=T,console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov12 ~ \"player\"\n\nHSD Test for value \n\nMean Square Error:  95.6 \n\nplayer,  means\n\n      value       std r Min Max\nbruno  20.4 12.054045 5  10  41\ntyson  32.2  9.984989 5  23  47\n\nAlpha: 0.05 ; DF Error: 4 \nCritical Value of Studentized Range: 3.926503 \n\nMinimun Significant Difference: 17.16919 \n\nTreatments with the same letter are not significantly different.\n\n      value groups\ntyson  32.2      a\nbruno  20.4      a\n```\n:::\n\n```{.r .cell-code}\nlibrary(twoway)\ntwoway(totalpower)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMean decomposition (Dataset: \"totalpower\"; Response: Value)\nResiduals bordered by row effects, column effects, and overall\n\n         1     2     3     4     5       roweff\n       + ----- ----- ----- ----- ----- + ----- \ntyson  |  -7.9   0.1  -3.9   1.1  10.6 :   5.9 \nbruno  |   7.9  -0.1   3.9  -1.1 -10.6 :  -5.9 \n       + ..... ..... ..... ..... ..... + ..... \ncoleff |  12.7  -2.3  -5.3  -9.3   4.2 :  26.3 \n```\n:::\n\n```{.r .cell-code}\nplot(twoway(totalpower))\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 누가 정확히 맞혔는지? \npower_accu=cbind((tyson[6,]/tyson[5,]),sum(tyson[6,])/sum(tyson[5,]))\nnames(power_accu)=c(1:5,\"total\")\nrownames(power_accu)=\"tyson_connect\"\npower_accu=round(power_accu*100,2)\n\npower_accu1=cbind((bruno[6,]/bruno[5,]),sum(bruno[6,])/sum(bruno[5,]))\nnames(power_accu1)=c(1:5,\"total\")\nrownames(power_accu1)=\"bruno_connect\"\npower_accu1=round(power_accu1*100,2)\npower_accu1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1     2     3  4     5 total\nbruno_connect 29.27 38.89 26.32 30 42.86 32.35\n```\n:::\n\n```{.r .cell-code}\npconnect_prob=rbind(power_accu,power_accu1)\npconnect_prob\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  1     2     3  4     5 total\ntyson_connect 35.14 43.33 52.17 50 65.96 50.31\nbruno_connect 29.27 38.89 26.32 30 42.86 32.35\n```\n:::\n\n```{.r .cell-code}\n# 전반적으로 정확히 맞춘 비율의 경우 Tyson이 Bruno에 비해서 높은 것으로 보인다.\n# Punch의 Connected될 비율은 1라운드를 제외하면 tyson이 bruno에 비해 높은 것으로 나타났으며 전체 비율의 경우에도 tyson이 bruno에 비해서 높게 나타난 것을 확인할 수 있다. \n\npconnect_prob=cbind(c(\"tyson_connect\",\"bruno_connect\"),pconnect_prob)\npconnect_prob2=melt(pconnect_prob)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing c(\"tyson_connect\", \"bruno_connect\") as id variables\n```\n:::\n\n```{.r .cell-code}\nnames(pconnect_prob2)=c(\"player\",\"round\",\"value\")\nggplot(pconnect_prob2, aes(round, value, fill=player))+\n  geom_bar(stat='identity', position = 'dodge')+\n  geom_text(aes(label= paste(sprintf(\"%2.1f\", value),\"%\",sep=\"\")),vjust=-0.4, size=3,position = position_dodge(width = 1))+\n  theme_classic()+\n  ggtitle(\"Bruno & Tyson Power Punch Connect Comparison\")+\n  xlab(\"round\")+\n  ylab(\"value(prop(%)\")\n```\n\n::: {.cell-output-display}\n![](EDA8_Final_files/figure-html/unnamed-chunk-18-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# tyson이 bruno에 비해서 power punch를 더 정확하게 하였다.\n```\n:::\n",
    "supporting": [
      "EDA8_Final_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}