{
  "hash": "5194b9a6b336b45f31e16bdb05897b32",
  "result": {
    "markdown": "---\ntitle: \"EDA Assignment 3: Chapter 5\"\nauthor: \"Sangwon Ju, Yonsei Public Administration\"\ndate: 'apr/07/2021'\npage-layout: full\nformat: \n    html\ncategories: \n    \"Exploratory Data Analysis (2021 Spring) [in Korean]\"\nimage: \"image.png\"\n---\n\n\n5장. 자료의 재표현\n\n# 1번\n\n적당한 범위에서 x의 1/2승, 1/3승, 1/4승, log 함수 그래프를 그려 함수의 기울어진 형태가 log 함수 쪽으로 변하는 것을 보여라. 반대로 x의 -1/2, -1/3, -1/4, log 함수 그래프를 그려 함수의 기울어진 정도가 log 함수로 수렴하는 것을 보여라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(reshape)\n\n\n#적당한 범위에서 x의 1/2승, 1/3승, 1/4승, log 함수 그래프를 그려 함수의 기울어진 형태가 log 함수 쪽으로 변하는 것을 보여라.\n\nx=seq(0,10000,1)\ny=seq(0,10000,1)\n\n\nggplot()+\n  geom_point(aes(x,y))+\n  labs(title = \"y=x Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot()+\n  geom_point(aes(x,y^2))+\n  labs(title = \"y=x^2 Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncomparison=data.frame(x,y^(1/2),y^(1/3),y^(1/4),log(y+1e-05))\nnames(comparison)=c(\"x\",\"y의 1/2승\",\"y의 1/3승\",\"y의 1/4승\",\"logarithm\")\n\ncompare2=melt(comparison,id=\"x\")\n\n# 기본\nggplot()+\n  geom_line(aes(x,y))+\n  labs(title = \"y=x\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# 1/2 승\nggplot()+\n  geom_line(aes(x,y^(1/2)))+\n  labs(title = \"y=x^2 Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# 1/3 승\nggplot()+\n  geom_line(aes(x,y^(1/3)))+\n  labs(title = \"y=x^3 Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# 1/4 승\nggplot()+\n  geom_line(aes(x,y^(1/4)))+\n  labs(title = \"y=x^4 Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 로그함수일때\nggplot()+\n  geom_line(aes(x,log(y+1e-03)))+\n  labs(title = \"y=x^2 Graph\", x = \"X\", y = \"Y\",fill=\"count\") +\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# 함수 여러개 비교\nggplot(compare2,aes(x=x,y=value))+\n  theme_bw()+\n  geom_line(aes(y=value,color=variable),size=2)+\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-1-8.png){width=672}\n:::\n:::\n\n\nPower의 값이 x의 1/2승, 1/3승, 1/4승으로 작아질 수록 log함수로 수렴하고 있음을 확인할 수 있다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 반대로 x의 -1/2, -1/3, -1/4, log 함수 그래프를 그려 함수의 기울어진 정도가 log 함수로 수렴하는 것을 보여라.\nx1=seq(1,100,1)\ny1=seq(1,100,1)\n\n\ncomparison3=data.frame(x1,y1^(-1/4),y1^(-1/3),y1^(-1/2),log(y1+1e-05))\nnames(comparison3)=c(\"x\",\"y의 -1/4승\",\"y의 -1/3승\",\"y의 -1/2승\",\"logarithm\")\n\ncompare3=melt(comparison3,id=\"x\")\n# 함수 여러개 비교\nggplot(compare3,aes(x=x,y=value))+\n  theme_bw()+\n  geom_line(aes(y=value,color=variable),size=2)+\n  theme(axis.title.x = element_text(face=\"bold\", size=19, colour=\"black\")) +\n  theme(axis.title.y = element_text(face=\"bold\", size=19, colour=\"black\"))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nPower의 값이 x의 -1/2승, -1/3승, -1/4승으로 증가할수록 log함수로 수렴하고 있음을 확인할 수 있다.\n\n# 2번\n\n2020년 1월 1일부터 2021년 4월 6일까지의 삼성전자 주식 가격을 인터넷에서 찾아 줄기잎 전시와 상자그림을 그려 대칭성을 점검하고 필요하다면 대칭화하는 변환을 시행착오 방법으로 찾아라. 어떤 시행착오로 찾아갔는지 중간 과정을 전부 보여라. 변환 후의 줄기잎 전시와 상자그림을 그려 전, 후를 비교하여라. 변환 전, 후의 skewness 값을 비교하여라.\n\n## 크롤링을 통해 삼성전자 주식가격 데이터 확인\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\"rvest\",\"httr\",\"lubridate\",\"R6\",\"tidyverse\",\n               \"xml2\",\"stringr\",\"readr\",\"tqk\",\"XML\")\nremotes::install_github(\"mrchypark/tqk\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSkipping install of 'tqk' from a github remote, the SHA1 (79997bbe) has not changed since last install.\n  Use `force = TRUE` to force installation\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncode_samsung=function () \n{    . <- MKT_TP_NM <- ISU_ABBRV <- ISU_SRT_CD <- ISU_NM <- ISU_ENG_NM <- ISU_CD <- NULL\n    \"http://data.krx.co.kr/comm/bldAttendant/getJsonData.cmd\" %>% \n        httr::POST(body = list(bld = \"dbms/MDC/STAT/standard/MDCSTAT01901\", \n            locale = \"ko_KR\", mktId = \"ALL\", share = 1, csvxls_isNo = \"false\"), \n            encode = \"form\") %>% \n        httr::content(\"text\") %>% \n        jsonlite::fromJSON() %>% \n        .$OutBlock_1 %>% \n        tibble() %>% \n        dplyr::transmute(\n            market = MKT_TP_NM, \n            name = ISU_ABBRV, \n            code = ISU_SRT_CD, \n            name_full = ISU_NM,\n            name_eng = ISU_ENG_NM, \n            code_full = ISU_CD) %>%\n    \n        dplyr::filter(stringr::str_detect(name,pattern=\"삼성+\")) %>% \n        return() \n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 삼성전자 코드\ncode_samsung()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 24 × 6\n   market name              code   name_full                 name_eng    code_…¹\n   <chr>  <chr>             <chr>  <chr>                     <chr>       <chr>  \n 1 KOSPI  삼성SDI우         006405 삼성SDI1우선주            SAMSUNG SD… KR7006…\n 2 KOSPI  삼성SDI           006400 삼성SDI보통주             SAMSUNG SD… KR7006…\n 3 KOSPI  삼성공조          006660 삼성공조보통주            SamsungCli… KR7006…\n 4 KOSDAQ 삼성스팩4호       377630 삼성기업인수목적4호       SAMSUNG SP… KR7377…\n 5 KOSDAQ 삼성스팩6호       425290 삼성기업인수목적6호       SAMSUNG SP… KR7425…\n 6 KOSDAQ 삼성머스트스팩5호 380320 삼성머스트기업인수목적5호 SAMSUNG MU… KR7380…\n 7 KOSPI  삼성물산우B       02826K 삼성물산1우선주(신형)     SAMSUNG C&… KR7028…\n 8 KOSPI  삼성물산          028260 삼성물산보통주            SAMSUNG C&… KR7028…\n 9 KOSPI  삼성바이오로직스  207940 삼성바이오로직스보통주    SAMSUNG BI… KR7207…\n10 KOSPI  삼성생명          032830 삼성생명보험보통주        Samsung Li… KR7032…\n# … with 14 more rows, and abbreviated variable name ¹​code_full\n```\n:::\n\n```{.r .cell-code}\nsamsung <- code_samsung() %>% \n    select(name,code) %>% \n    filter(name==\"삼성전자\")\n```\n:::\n\n\n삼성전자 코드는 005930\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamsung$code\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"005930\"\n```\n:::\n\n```{.r .cell-code}\nurl=\"https://fchart.stock.naver.com/sise.nhn?timeframe=day&count=6000&requestType=0&symbol=\"\nsamsung_data=read_xml(glue::glue({url},samsung$code))\n\nsplitting=function(a){\n    result=str_split(a,pattern=\"\\\\|\",simplify=T)\n    result=data.frame(result)\n    names(result)=c('date','시가','고가','저가','종가',\"거래량\")\n    return(result)}\n\nsamsung <- samsung_data %>%\n    xmlParse(useInternalNodes = TRUE) %>% \n    xmlToList() %>% \n    plyr::ldply(tibble) %>%\n    select(data1=\"<named list>\") %>% \n    unlist() %>% \n    tibble(data1=as.character(.)) %>% \n    select(data1) %>% \n    do(head(., nrow(.)-6)) %>% \n    transmute(data2=map(data1,splitting)) %>% \n    unnest(data2) %>% \n    mutate_all(.funs=as.numeric) %>% \n    mutate(date=ymd(date)) %>% \n    filter(date>=ymd(20200101) & date<=ymd(20210406))\n\nlibrary(ggplot2)\nggplot(samsung, aes(x = date, y = 시가)) +\n    theme_bw()+\n    geom_line(size=1, color = \"blue\") + \n    ggtitle(\"삼성전자 시가 변화 추이\") +\n    ggeasy::easy_center_title()\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# install.packages(\"reshape\")\nlibrary(reshape)\nsamsung1=samsung %>% \n    select(-거래량) %>% \n    pivot_longer(!date,names_to=\"variable\",values_to=\"value\")\n\n# 주가 추이 시각화\nggplot(samsung1, aes(x = date, y = value)) +\n    theme_minimal()+\n    geom_line(size=1, aes(colour=variable)) + \n    ggtitle(\"삼성전자 주가 변화 추이\")+\n    scale_color_discrete(name=\"주가 유형\")+\n    labs(y=\"주가\",x=\"거래일\")+\n    scale_x_date(date_breaks = \"months\" , date_labels = \"%b/%y\")+\n    scale_y_continuous(limits = c(40000,96000), breaks=seq(40000,96000,5000))+\n    ggeasy::easy_center_title()+\n    ggeasy::easy_rotate_x_labels()\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmax(samsung$고가)-min(samsung$저가)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 54500\n```\n:::\n\n```{.r .cell-code}\nfivenum(samsung$시가)[4]-fivenum(samsung$시가)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18450\n```\n:::\n\n```{.r .cell-code}\n18450/1.35\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 13666.67\n```\n:::\n:::\n\n\n고점과 저점 비교시 54500 정도의 변동성 존재\n\nhspread: 18450정도이고 pseudo-sigma 13666.67 정도. 한국 코스피 변동성을 계산하여 표준편차를 확인하고 이를 계산된 변동성과 비교한다면 삼성전자 주식의 안정성에 대해서 예측해볼 수 있다. (단순히 상승했다, 상승하지 않았다 정도의 지식에 더해 주식의 변동성을 이해한다면 안정적인 주식인지 안정적이지 않은 주식인지 확인할 수 있다.)\n\n이후 시계열 분석을 활용해 추가적인 분석이 요구됨\n\n주식 가격을 인터넷에서 찾아 줄기잎 전시와 상자그림을 그려 대칭성을 점검 - 주식 가격은 시가를 기준으로 파악한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Stem and Leaf\nstem(samsung$시가)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 3 digit(s) to the right of the |\n\n  42 | 69\n  44 | 2\n  46 | 24913455588\n  48 | 00447778899000001244466677899\n  50 | 0011238800124489\n  52 | 0111125568012346789\n  54 | 001233344567788890122355678888\n  56 | 000112223344445701123445666778899\n  58 | 0002223344788899001111234444556678889\n  60 | 000123333344455577777789900011223689\n  62 | 009\n  64 | 0187\n  66 | 10199\n  68 | 044\n  70 | 14\n  72 | 124457134568\n  74 | 11\n  76 | 4\n  78 | 80\n  80 | 0000124466778\n  82 | 0123445666888889112233558889\n  84 | 0001555818\n  86 | 26605\n  88 | 780088\n  90 | 03\n```\n:::\n\n```{.r .cell-code}\n#Boxplot\nggplot(samsung1, aes(x = variable, y = value))+\n    ggtitle(\"삼성전자 주가 변화 추이\")+\n    geom_boxplot(aes(fill=variable))+\n    labs(y=\"주가\",x='주가 유형')+\n    theme_minimal()+\n    ggeasy::easy_center_title()\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n박스플롯 상으로는 자료들의 대칭성을 어느정도 확인할 수 있다. 특이값이 없는 대신 큰쪽의 Whisker의 길이가 작은쪽의 Whisker의 길이에 비해서 긴 것으로 확인된다. 또한 Median의 값이 Lower-hinge 쪽에 더 가까운 것 이 확인되기 때문에 Skewed to the right에 해당하는 분포로 보인다. Stem-leaf Display에서는 두개의 cluster를 확인할 수 있는데, stem 58을 기준으로한 하나의 cluster와 stem 82를 기준으로 한 또 하나의 cluster가 있다. 작은 쪽의 cluster가 더 큰쪽의 cluster에 비해서 더 많은 숫자들을 가지고 있는 것을 확인할 수 있다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskewness = function(x) {\n  hl=fivenum(x)[2]\n  median=fivenum(x)[3]\n  hu=fivenum(x)[4]\n  skew=((hu-median)-(median-hl))/((hu-median)+(median-hl))\n  return(skew)\n}\nskewness(samsung$시가)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4634146\n```\n:::\n:::\n\n\nA measure of symmetry로 skewness 값을 계산할 경우 0.46정도로 skewed to the right 되어 있음을 확인할 수 있다.\n\nSkewness를 조절하기 위해서 수업시간에 제시한 4가지 방법들을 적용해보고자 한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Log\nstem(log(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the left of the |\n\n  106 | 69\n  107 | 04\n  107 | 566677777788999999\n  108 | 000000000011111111122222223444444\n  108 | 55666666667777888899999\n  109 | 000000000111111112222222333333333334444444444\n  109 | 555556666666666677777777778888888899999999999999\n  110 | 000000000001111111111111111112222222222233333\n  110 | 77789\n  111 | 01133333\n  111 | 66999999\n  112 | 00011111\n  112 | 678\n  113 | 000000111111112222222222222233333333344444444444\n  113 | 5566777899\n  114 | 001111\n```\n:::\n\n```{.r .cell-code}\nboxplot(log(samsung$시가))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# sqrt\nstem(sqrt(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  20 | 69\n  21 | 0\n  21 | 5577788889999\n  22 | 001111111111112222233333333444444\n  22 | 5566667788888888999\n  23 | 000111222222333333334444444\n  23 | 5555566666666777777777777778899999\n  24 | 000000000011111111112222223333333334444444444\n  24 | 555555555666666666666666667777777777889999\n  25 | 333\n  25 | 56799\n  26 | 11122\n  26 | 5599999\n  27 | 001111222\n  27 | 8\n  28 | 11\n  28 | 5555555566666677777777788888888889999999\n  29 | 00000111123444\n  29 | 568888\n  30 | 0000\n```\n:::\n\n```{.r .cell-code}\nboxplot(sqrt(samsung$시가))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# minus inverse\nstem(-1/(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 6 digit(s) to the left of the |\n\n  -23 | 5\n  -22 | 87\n  -21 | 663321111\n  -20 | 99987765555444444443332222111100000\n  -19 | 997766655533222222000\n  -18 | 998887766655554444433332222211110000\n  -17 | 99999998888888777776555554444443333332222222211000000\n  -16 | 99999999888888888777777766666666665555555554444444433322211\n  -15 | 666421\n  -14 | 997776632\n  -13 | 99888876666655\n  -12 | 9773333333333222222211111111111100000000\n  -11 | 999999998888876555433221111\n```\n:::\n\n```{.r .cell-code}\nboxplot(-1/(samsung$시가))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# minus inverse of sqrt\nstem(-1/sqrt((samsung$시가)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 4 digit(s) to the left of the |\n\n  -48 | 5\n  -47 | 86\n  -46 | 54210\n  -45 | 999988765533333222222211000\n  -44 | 9999988877776644332211\n  -43 | 9998888866654443322110000\n  -42 | 999998888777766665444433333332222211111110\n  -41 | 9888877777766666655555544443222222211111100000000\n  -40 | 9999988888777777777776666666555555544432222\n  -39 | 65530\n  -38 | 96644322\n  -37 | 872222110\n  -36 | 9999877\n  -35 | 9661111110000000\n  -34 | 99998888888888877777666655555555444331100\n  -33 | 9866554433\n```\n:::\n\n```{.r .cell-code}\nboxplot(-1/sqrt((samsung$시가)))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n:::\n\n\nSkewness 값을 변환전후로 비교\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskewness(samsung$시가)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4634146\n```\n:::\n\n```{.r .cell-code}\nskewness(log(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4031337\n```\n:::\n\n```{.r .cell-code}\nskewness(sqrt(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.433612\n```\n:::\n\n```{.r .cell-code}\nskewness(-1/(samsung$시가)) # 가장 낮은 수준의 Skewness를 보여줌\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3404237\n```\n:::\n\n```{.r .cell-code}\nskewness(-1/sqrt(samsung$시가))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.372047\n```\n:::\n:::\n\n\n일반적으로 사용하는 변환으로는 만족스러운 수준으로 skewness 값이 감소되었는지 알수가 없었다. 따라서 skewness 값을 감소시키기 위해 함수를 활용하여 가능한 여러 경우의 값들을 비교해보고자 한다. (skewness값은 0일때 최소가 되고, 이때 자료가 대칭적이 되었다고 가정할 수 있다.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ns=c()\nstart=samsung$시가\nfor (i in seq(-10,10,0.1)) {\n  if(i>0){\n    s = c(s,skewness(start^i))\n  }\n  \n  else if(i==0){\n    s = c(s,skewness(log(start)))\n  }\n  \n  else{\n    s = c(s,skewness(-(start^i)))\n  }\n}\ny=cbind(seq(-10,10,0.1),s)\nplot(y,xlab=\"Power Value\",ylab=\"Skewness\")\nabline(h=0)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# -6정도일때 Skewness 자체는 최소가 된다. \nboxplot(-(start^-6))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\nskewness공식은 ((Hu-M)-(M-Hl))/((Hu-M)+(M-Hl))이다.\n\nskewness의 공식이 H-Spread 범위의 Lower Hinge Upper Hinge 등에 의해서 만들어지기 때문에 i=-6을 활용할 경우 Spread 내부의 Symmery는 보정이 되었지만 Whisker의 길이가 오히려 길어졌다는 점에서 처음에 사용하였던 기존의 변환을 활용해보고자 한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,3))\nboxplot(log(samsung$시가))\nboxplot(sqrt(samsung$시가))\nboxplot(-1/sqrt((samsung$시가)))\nboxplot(-1/(samsung$시가)) # 선택\nboxplot(-1/(samsung$시가)^2)\nboxplot(-1/(samsung$시가)^3)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n다시한번 확인해보면, H-spread 내의 대칭성 정도 및 Whisker의 길이 까지 고려하여 가장 적절한 변환을 선택한다면 minus inverse 변환이나 minus sqrt inverse 변환 둘중에서 선택하면 된다고 본다. skewness가 더 0에 가까운 minus inverse 변환을 활용해서 데이터를 변환한다면 H-spread내 Hinge와 Median의 대칭성 그리고 whisker들의 대칭성 모두 다 확보할수 있다고 생각한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecided=-1/(samsung$시가)\nhist(decided,breaks=20) # 그럼에도 불구하고 stem and leaf display에서 확인하였던 오른쪽의 두번째 Cluster의 흔적은 사라지지 않고 남아 있다.\nabline(v=median(decided),col=\"red\")\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n# 3번\n\nairquality 자료에서 Ozone 자료를 대칭화하기 위한 변환공식을 이용하여 변환 전과 변화 후를 비교하여라. 변환 후의 줄기잎 전시와 상자그림을 그려 전, 후를 비교하여라. 변환 전, 후의 skewness 값을 비교하여라.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(airquality)\nattach(airquality)\nstr(Ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n int [1:153] 41 36 12 18 NA 28 23 19 8 NA ...\n```\n:::\n\n```{.r .cell-code}\nsummary(Ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   1.00   18.00   31.50   42.13   63.25  168.00      37 \n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n\nsum(is.na(Ozone)) # 37개의 결측치\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37\n```\n:::\n\n```{.r .cell-code}\nskewness = function(x) {\n  hl=fivenum(x)[2]\n  median=fivenum(x)[3]\n  hu=fivenum(x)[4]\n  skew=((hu-median)-(median-hl))/((hu-median)+(median-hl))\n  return(skew)\n}\n\n# 변환전 \nstem(Ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is 1 digit(s) to the right of the |\n\n   0 | 1467778999\n   1 | 01112233334444666688889\n   2 | 0000111123333334478889\n   3 | 001222455667799\n   4 | 01444556789\n   5 | 0299\n   6 | 134456\n   7 | 13367889\n   8 | 024559\n   9 | 1677\n  10 | 8\n  11 | 058\n  12 | 2\n  13 | 5\n  14 | \n  15 | \n  16 | 8\n```\n:::\n\n```{.r .cell-code}\nggplot()+\n  theme_bw()+\n  stat_boxplot(aes(Ozone),fill=\"pink\")+\n  labs(title=\"Ozone Boxplot before conversion\")+\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 37 rows containing non-finite values (stat_boxplot).\n```\n:::\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nskewness(Ozone) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4065934\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Handout에 제시된 Conversion 공식을 활용했다.\nconversion=function(x){\n  m=fivenum(x)[3]\n  hu=fivenum(x)[4]\n  hl=fivenum(x)[2]\n  k=1-(2*m*((hu-m)+(hl-m))/((hu-m)^2+(hl-m)^2))\n  return(k)\n}\n\nconversion(airquality$Ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03378238\n```\n:::\n\n```{.r .cell-code}\n# 0.3378238 정도로 0에 가까워 로그를 활용한 변환을 진행하고자 한다. \n\n#변환 후 (오존이 1인 데이터 로그 Transformation 오류 방지를 위해 매우 작은 숫자를 더해주자)\nstem(log(Ozone+1e-04))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  The decimal point is at the |\n\n  0 | 0\n  0 | \n  1 | 4\n  1 | 8999\n  2 | 12223444\n  2 | 5566666666888899999\n  3 | 0000000011111112233334444\n  3 | 555566666677778888889999\n  4 | 0111122223333344444444\n  4 | 55666777889\n  5 | 1\n```\n:::\n\n```{.r .cell-code}\nggplot(airquality)+\n  theme_bw()+\n  stat_boxplot(aes(log(Ozone+1e-04)),fill=\"pink\")+\n  labs(title=\"Ozone Boxplot after conversion\")+\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 37 rows containing non-finite values (stat_boxplot).\n```\n:::\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nskewness(log(Ozone+1e-04))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1123708\n```\n:::\n:::\n\n\n변환 이전에는 stem and leaf display를 활용해서 그래프를 확인할 경우 Skewed to the right되어있는 것을 어느정도 확인할 수 있다. 중간에 blank가 있는 것으로 보아 outlier의 존재 가능성이 존재한다. 또한 stem 1과 2를 기준으로 Cluster가 이루어져 있는데, 높은 수준의 Ozone보다는 낮은 수준의 Ozone양이 많음을 확인할 수 있다. 실제로 Boxplot을 가지고 확인할 경우 결측치가 두개 존재하며, median은 Lower Hinge에 가깝게 설정되어 있다. Skewness는 0.4065394로 계산되어지므로 다시한번 Skewed to the right임을 확인할 수 있다.\n\n변환 이후에 stem and leaf display를 확인할 경우 cluster가 2개에서 stem 3을 중심으로 하는 하나의 cluster로 줄어들었으며, skewed된 정도도 상당히 완화된 것이 확인된다. Boxplot을 통해서 확인할 경우 Outlier가 두개에서 한개로 감소하였으며, whisker의 길이도 위아래 어느정도 비슷해 진 것으로 보인다. skewness 또한 0.1123698로 0.4065394에서 줄어들었으므로 확실히 skewed to the right 되어 있는 성향이 완화된 것으로 보인다. (다만, Ourlier의 발생은 Ozone의 값이 1이라 로그의 성질에 의해서 0으로 계산되어 그러한 것으로 보인다.)\n\n# 4번\n\n지난번 숙제의 도시별 구의 인구 자료를 도시별 퍼짐이 비슷하여지도록 하는 변환을 찾아 전과 후를 비교하여라. (무턱대고 lm 함수를 쓰면 낭패를 볼 수 있으니 조심하여야 한다. '눈대중'이 좋을 때도 많음.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop2021<-read.csv(\"https://raw.githubusercontent.com/SangwonJu/data/main/2021.02%20pop.csv\",header=T)\npop2021$시=ordered(reorder(pop2021$지역명,pop2021$지역코드))\n\nmy_xlab<-paste(levels(pop2021$시),\"\\n(N=\",table(pop2021$시),\")\",sep=\"\") \nggplot(data=pop2021,aes(x=시,y=인구,fill=시))+ \n    geom_boxplot(varwidth=T)+ \n    scale_y_continuous(labels = scales::comma)+\n    scale_fill_brewer(palette=\"Pastel1\")+ \n    scale_x_discrete(labels=my_xlab)+\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in levels(pop2021$시)){\n  assign(paste0(\"spread\",i),fivenum(pop2021$인구[pop2021$시==i])[4] - fivenum(pop2021$인구[pop2021$시==i])[2])\n}\n\npop2021_spread=c(spread서울,spread부산,spread대구,spread인천,spread광주,spread대전,spread울산,spread세종)\npop2021_spread\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 153076.0 150790.0 273447.5 424374.0 190473.0 126271.0   5735.0      0.0\n```\n:::\n\n```{.r .cell-code}\npop2021_med <- c(median(pop2021$인구[pop2021$시==\"서울\"]), \n       +      median(pop2021$인구[pop2021$시==\"부산\"]),\n       +      median(pop2021$인구[pop2021$시==\"대구\"]),\n       +      median(pop2021$인구[pop2021$시==\"인천\"]),\n       +      median(pop2021$인구[pop2021$시==\"광주\"]),\n       +      median(pop2021$인구[pop2021$시==\"대전\"]),\n       +      median(pop2021$인구[pop2021$시==\"울산\"]),\n       +      median(pop2021$인구[pop2021$시==\"세종\"]))\nplot(log(pop2021_med), log(pop2021_spread), main=\"Spread vs. Level plot\")\n\nlogspread=log(pop2021_spread[1:length(log(pop2021_spread))-1])\nlogmed=log(pop2021_med[1:length(log(pop2021_med))-1])\n(RegrLine <- lm(logspread~logmed))     \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = logspread ~ logmed)\n\nCoefficients:\n(Intercept)       logmed  \n    -29.716        3.304  \n```\n:::\n\n```{.r .cell-code}\nabline(coef(RegrLine))\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n1 - coef(RegrLine)[2] #2.30394\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  logmed \n-2.30394 \n```\n:::\n\n```{.r .cell-code}\nskewness = function(x) {\n  hl=fivenum(x)[2]\n  median=fivenum(x)[3]\n  hu=fivenum(x)[4]\n  skew=((hu-median)-(median-hl))/((hu-median)+(median-hl))\n  return(skew)\n}\n\nx=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(pop2021$인구[pop2021$시==i])\n  x=c(x,k)\n}\ndefault=data.frame(x)\ncolnames(default)=\"skewness_per_city\"\nrownames(default)=levels(pop2021$시)\nmean(default$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1026098\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 순서대로 log, sqrt, negative inverse, negative sqrt inverse\n\n# log\nggplot(data=pop2021,aes(x=시,y=log(인구),fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\nx1=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(log(pop2021$인구[pop2021$시==i]))\n  x1=c(x1,k)\n}\nlog=data.frame(x1)\ncolnames(log)=\"skewness_per_city\"\nrownames(log)=levels(pop2021$시)\nlog\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울      -0.126167466\n부산      -0.308713929\n대구      -0.264876458\n인천      -0.620004590\n광주      -0.005903398\n대전       0.794106977\n울산       0.208750686\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(log$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.04611545\n```\n:::\n\n```{.r .cell-code}\n#sqrt\n# 가장 대칭성 문제를 잘 해결 한 것으로 보임 (결측치도 적은편)\nggplot(data=pop2021,aes(x=시,y=sqrt(인구),fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab) \n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n```{.r .cell-code}\nx2=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(sqrt(pop2021$인구[pop2021$시==i]))\n  x2=c(x2,k)\n}\nsqrt=data.frame(x2)\ncolnames(sqrt)=\"skewness_per_city\"\nrownames(sqrt)=levels(pop2021$시)\nsqrt\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울       -0.07678271\n부산       -0.21515088\n대구       -0.15462785\n인천       -0.46187455\n광주        0.07336924\n대전        0.81412452\n울산        0.21187462\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(sqrt$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.02727606\n```\n:::\n\n```{.r .cell-code}\n#negative inverse\n\nggplot(data=pop2021,aes(x=시,y=-인구^-(1),fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-3.png){width=672}\n:::\n\n```{.r .cell-code}\nx3=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(-1/(pop2021$인구[pop2021$시==i]))\n  x3=c(x3,k)\n}\ninverse=data.frame(x3)\ncolnames(inverse)=\"skewness_per_city\"\nrownames(inverse)=levels(pop2021$시)\ninverse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울        -0.2234579\n부산        -0.4840709\n대구        -0.4712234\n인천        -0.8479779\n광주        -0.1633118\n대전         0.7504693\n울산         0.2024944\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(inverse$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.1767255\n```\n:::\n\n```{.r .cell-code}\n#negative sqrt inverse\n\nggplot(data=pop2021,aes(x=시,y=-1/sqrt(인구),fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-4.png){width=672}\n:::\n\n```{.r .cell-code}\nx4=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(-1/(sqrt(pop2021$인구[pop2021$시==i])))\n  x4=c(x4,k)\n}\nsqrtinverse=data.frame(x4)\ncolnames(sqrtinverse)=\"skewness_per_city\"\nrownames(sqrtinverse)=levels(pop2021$시)\nsqrtinverse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울       -0.17513860\n부산       -0.39889958\n대구       -0.37136339\n인천       -0.75097488\n광주       -0.08512654\n대전        0.77287023\n울산        0.20562391\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(sqrtinverse$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.1147156\n```\n:::\n\n```{.r .cell-code}\n# Spread-versus-level Plot의 기준으로\nggplot(data=pop2021,aes(x=시,y=-인구^-2.30394 ,fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-5.png){width=672}\n:::\n\n```{.r .cell-code}\nx5=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(-1/((pop2021$인구[pop2021$시==i])^-2.30394))\n  x5=c(x5,k)\n}\nlm=data.frame(x5)\ncolnames(lm)=\"skewness_per_city\"\nrownames(lm)=levels(pop2021$시)\nlm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울        -0.1010454\n부산        -0.1230972\n대구        -0.2279831\n인천        -0.1235627\n광주        -0.3450204\n대전        -0.8757588\n울산        -0.2231208\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(lm$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.2885126\n```\n:::\n\n```{.r .cell-code}\n# -2.303에 가까운 정수값 : -2 적용\nggplot(data=pop2021,aes(x=시,y=-인구^-2 ,fill=시))+ \n  theme_bw()+\n  geom_boxplot(varwidth=T)+ \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_brewer(palette=\"Pastel1\")+ \n  scale_x_discrete(labels=my_xlab)\n```\n\n::: {.cell-output-display}\n![](과제3_files/figure-html/unnamed-chunk-18-6.png){width=672}\n:::\n\n```{.r .cell-code}\nx6=c()\nfor(i in levels(pop2021$시)){\n  k=skewness(-1/((pop2021$인구[pop2021$시==i])^-2))\n  x6=c(x6,k)\n}\nlm2=data.frame(x6)\ncolnames(lm2)=\"skewness_per_city\"\nrownames(lm2)=levels(pop2021$시)\nlm2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     skewness_per_city\n서울       -0.07141391\n부산       -0.06805030\n대구       -0.16831292\n인천       -0.03676154\n광주       -0.30186291\n대전       -0.86654647\n울산       -0.22122872\n세종               NaN\n```\n:::\n\n```{.r .cell-code}\nmean(lm2$skewness_per_city,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.2477395\n```\n:::\n\n```{.r .cell-code}\ncombined_skewness=cbind(log,sqrt,inverse,sqrtinverse,lm,lm2)\n\n# Spread-versus-level Plot에 선형회귀분석을 사용하여 얻어진 값을 가지고 Transformation을 진행해 보았으나, 만족할 만한 변환이 이루어지지는 않았다.\n# 그 이유로는 데이터의 갯수가 많지 않은 점도 있고, 회귀식 자체가 reliable하지 않은 부분도 있는 것으로 보인다.\n\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'data.table'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    transpose\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:reshape':\n\n    melt\n```\n:::\n\n```{.r .cell-code}\ncombined_skewness=transpose(combined_skewness)\nrownames(combined_skewness)=c(\"log\",\"sqrt\",\"inverse\",\"sqrtinverse\",\"^-2.30394\",\"^-2\")\ncolnames(combined_skewness)=levels(pop2021$시)\ncombined_skewness$mean=apply(combined_skewness,1,mean,na.rm=T)\ncombined_skewness\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   서울       부산       대구        인천         광주\nlog         -0.12616747 -0.3087139 -0.2648765 -0.62000459 -0.005903398\nsqrt        -0.07678271 -0.2151509 -0.1546278 -0.46187455  0.073369236\ninverse     -0.22345787 -0.4840709 -0.4712234 -0.84797788 -0.163311830\nsqrtinverse -0.17513860 -0.3988996 -0.3713634 -0.75097488 -0.085126536\n^-2.30394   -0.10104542 -0.1230972 -0.2279831 -0.12356274 -0.345020412\n^-2         -0.07141391 -0.0680503 -0.1683129 -0.03676154 -0.301862912\n                  대전       울산 세종        mean\nlog          0.7941070  0.2087507  NaN -0.04611545\nsqrt         0.8141245  0.2118746  NaN  0.02727606\ninverse      0.7504693  0.2024944  NaN -0.17672546\nsqrtinverse  0.7728702  0.2056239  NaN -0.11471555\n^-2.30394   -0.8757588 -0.2231208  NaN -0.28851264\n^-2         -0.8665465 -0.2212287  NaN -0.24773954\n```\n:::\n\n```{.r .cell-code}\nwhich.min(abs(combined_skewness$mean))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2\n```\n:::\n\n```{.r .cell-code}\n# 따라서 sqrt일 때가 전체적인 Boxplot의 whisker 비율도 적절하고, H-spread내의 skewness도 작은 편이라고 볼 수 있다.\n```\n:::\n",
    "supporting": [
      "과제3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}